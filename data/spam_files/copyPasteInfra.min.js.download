var copyPasteInfra;!function(){var e={971:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[o]&&(r[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[o]};const r={},o="promises"},58:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let o=!1;const n="undefined"!=typeof performance?performance:void 0;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(o){t.perfNow=!0;let e=Math.floor(100*n.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},558:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},495:function(e,t,r){"use strict";t.TZ=t.nh=t.kp=t.Hv=t.Wp=void 0;const o=r(906);t.Wp=o;const n=r(239);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return n.LogCategory}}),r(971);const a=r(873);t.TZ=a;r(884),r(497);r(58),r(145),r(558)},239:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,o)=>t.traceTag(0,e,r,o),traceTag:(e,r,o,n)=>t.traceTag(e,r,o,n),debugTrace:(e,r,o)=>t.debugTraceTag(0,e,r,o),debugTraceTag:(e,r,o,n)=>t.debugTraceTag(e,r,o,n),assert:(e,r,o)=>t.assertTag(0,e,r,o),assertTag:(e,r,o,n)=>t.assertTag(e,r,o,n),shipAssert:(e,r,o)=>t.shipAssertTag(0,e,r,o),shipAssertTag:(e,r,o,n)=>t.shipAssertTag(e,r,o,n),dnmTrace:(e,r,o)=>t.dnmTraceTag(0,e,r,o),dnmTraceTag:(e,r,o,n)=>t.dnmTraceTag(e,r,o,n)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)}assertTag(e,t,r,o){console.assert(r,"assertTag",e,t,o)}traceTag(e,t,r,o){console.log("traceTag",e,o,t,r)}dnmTraceTag(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)}debugTraceTag(e,t,r,o){console.log("debugTraceTag",e,o,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},873:function(e,t){"use strict";function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,o){e[t]=r()-o}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),n=e,a=t,i={},s=(e,t,r)=>function(e,t,r,n,a,i){o(e,"end",r);const s={sessionName:t,result:n?"success":"failure",message:i,marks:e};a(JSON.stringify(s))}(i,n,a,e,t,r);return i.start=0,{mark:e=>(e=>o(i,e,a))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},145:function(e,t){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},884:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(o){let n=r(),a=o;return{reset(e){null!=e&&(a=e),n=r()},stop(o){const i=r()-n,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:o});e(s)}}}};let r=()=>Date.now()},497:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},906:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,o)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(o,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(o(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(a,n).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===n&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===n&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let o=1;o<=t;o+=1)r=r.catch((t=>e(o,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let o=1;o<e.length;o+=1){const n=e[o];r=r.catch((()=>t(n)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const o=e.length;for(let n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));let n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function o(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const n={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const a=Object.getPrototypeOf(e);a&&"object"==typeof a&&Object.keys(a).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(n[t]=e[t])}));const i={};return Object.keys(n).forEach((e=>{i[e]=o(n[e],t+1)})),i}const n="_",a=new RegExp("\\W+","g")},344:function(e,t){"use strict";function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},47:function(e,t){"use strict";function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=r(e),n=r(t);let a=[];for(let e=0;e<=n.length;++e)a[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let r=1;r<=n.length;++r)t[r]=o[e-1]===n[r-1]?a[r-1]:1+Math.min(a[r],a[r-1],t[r-1]);a=t}return a[n.length]}},200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();return"true"===r||"false"!==r&&t},t.getNumberFeatureGate=function(e,t){const r=i(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const o=parseFloat(r);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const r=i(e)?.trim();if(void 0===r)return t;const o=parseInt(r,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=r(47),n={};function a(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return a()[e]??t;const r=a();if(Object.hasOwn(r,e))return r[e]??t;const n=globalThis.__office_online_feature_gates_verbose_log_callback;n(`Failed lookup for FeatureGate ${e}...`);const i=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,o.editDistance)(e.toLowerCase(),s)<=4&&i.push(e);return i.length>0&&n(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),n(`FeatureGate override not found, returning default: ${t}`),t}},872:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(533);o.__exportStar(r(200),t),o.__exportStar(r(531),t),o.__exportStar(r(344),t),o.__exportStar(r(900),t),o.__exportStar(r(8),t),o.__exportStar(r(110),t)},531:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,o.getBooleanFeatureGate)(t,r);case"number":return(0,o.getNumberFeatureGate)(t,r);case"string":return(0,o.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const o=r(200)},900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=r(344)},8:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)};const o=r(344);function n(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},110:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)};const o=r(200);function n(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},366:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRuntimeAllowedOriginsTypedWorkers=t.setRuntimeAllowedOriginsTypedWorkers=t.urlOriginPolicy=void 0;var o=r(519);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return o.urlOriginPolicy}}),Object.defineProperty(t,"setRuntimeAllowedOriginsTypedWorkers",{enumerable:!0,get:function(){return o.setRuntimeAllowedOriginsTypedWorkers}}),Object.defineProperty(t,"getRuntimeAllowedOriginsTypedWorkers",{enumerable:!0,get:function(){return o.getRuntimeAllowedOriginsTypedWorkers}})},702:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},o="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,n=o,a)=>{try{r[e]||(r[e]=n.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){a?.(`${e}`)}return r[e]}},519:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.getRuntimeAllowedOriginsTypedWorkers=t.setRuntimeAllowedOriginsTypedWorkers=void 0;const o=r(702);function n(){return void 0===globalThis.__typed_workers_runtime_allowed_origins&&(globalThis.__typed_workers_runtime_allowed_origins=[]),globalThis.__typed_workers_runtime_allowed_origins}const a=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft"].map((e=>e.trim())),i=[/^https?:\/\/([0-9a-zA-Z]+-)?(excel)\.officeapps\.live\.com$/],s=[/^https?:\/\/([\w-]+-)?(excel)(-[\w-]+)?\.cdn\.office\.net$/],c=new RegExp("https?://((localhost|local\\.teams\\.(office|live)\\.com|cpc-[\\w-]+|[\\w-]+\\.[\\w-]+\\.corp\\.microsoft\\.com)(:\\d+)?)(:|/|$)"),l=new RegExp("^https?://[\\w-]+\\.pyxidis\\.off(:\\d+)?$");t.setRuntimeAllowedOriginsTypedWorkers=e=>{n().push(...e)},t.getRuntimeAllowedOriginsTypedWorkers=()=>n(),t.createUrlOriginPolicy=(e,t)=>(0,o.createPolicy)(e,{createScriptURL:e=>{let t;try{t=new URL(e,document.baseURI)?.origin}catch(r){t=new URL(e)?.origin}if(t&&(e=>{const t=n();return a.includes(e)||t.includes(e)||i.some((t=>t.test(e)))||s.some((t=>t.test(e)))||c.test(e)||l.test(e)})(t))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${t}`)}},t),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("typedWorkersUrlOriginPolicy")},256:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,n(r(658),t);var a=r(880);Object.defineProperty(t,"createWorker",{enumerable:!0,get:function(){return a.createWorker}})},658:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransferableWrapper=t.wrapTransferable=t.workerName=t.isWorkerThread=t.setUpTrustedTypesConfig=t.importScriptsWithRetry=t.Endpoint=t.paramInsideDef=t.dispatchWorkerError=t.setConfig=t.isThreadingSupported=t.WorkerError=void 0;var o=r(422);Object.defineProperty(t,"WorkerError",{enumerable:!0,get:function(){return o.WorkerError}});var n=r(226);Object.defineProperty(t,"isThreadingSupported",{enumerable:!0,get:function(){return n.isThreadingSupported}}),Object.defineProperty(t,"setConfig",{enumerable:!0,get:function(){return n.setConfig}}),Object.defineProperty(t,"dispatchWorkerError",{enumerable:!0,get:function(){return n.dispatchWorkerError}});var a=r(182);Object.defineProperty(t,"paramInsideDef",{enumerable:!0,get:function(){return a.paramInsideDef}});var i=r(417);Object.defineProperty(t,"Endpoint",{enumerable:!0,get:function(){return i.Endpoint}});var s=r(919);Object.defineProperty(t,"importScriptsWithRetry",{enumerable:!0,get:function(){return s.importScriptsWithRetry}});var c=r(266);Object.defineProperty(t,"setUpTrustedTypesConfig",{enumerable:!0,get:function(){return c.setUpTrustedTypesConfig}});var l=r(491);Object.defineProperty(t,"isWorkerThread",{enumerable:!0,get:function(){return l.isWorkerThread}}),Object.defineProperty(t,"workerName",{enumerable:!0,get:function(){return l.workerName}});var d=r(802);Object.defineProperty(t,"wrapTransferable",{enumerable:!0,get:function(){return d.wrapTransferable}}),Object.defineProperty(t,"isTransferableWrapper",{enumerable:!0,get:function(){return d.isTransferableWrapper}})},226:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=s,t.setConfig=function(e){if(c)throw new TypeError("setConfig has already been called");c=e},t.getSafeParams=function(){const e=c??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??c?.createTimeout??n},t.getCreateMode=function(e){const t=e?.createMode??c?.createMode??a;return"ThreadOrLocal"===t?s()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(c?.onWorkerError??u)(e)}catch(t){console.warn(e),l(t)}},t.dispatchCreateWorker=function(e){try{(c?.onCreateWorker??p)(e)}catch(e){l(e)}};const o=r(352),n=3e5,a="Thread";var i;function s(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let c;function l(e){setTimeout((()=>{throw e}))}function d(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function u(e){const t=d();if(void 0!==t){const r={kind:i.WorkerError,error:(0,o.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function p(e){const t=d();if(void 0!==t){const r={kind:i.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(i||(t.ThreadMessageKind=i={}))},880:function(e,t,r){"use strict";var o,n=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=o(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=_;const s=r(226),c=r(417),l=r(740),d=r(182),u=r(753),p=r(48),f=r(422),m={...i(r(658)),createWorker:_};function g(e,t,r,o,n){const{port1:a,port2:i}=new MessageChannel;let s;return Promise.all([o({port:a,options:e,createMode:t}),(0,u.timePromise)(r.createOutside=(0,u.startStopwatch)(),(()=>c.Endpoint.createOutside({port:i,options:e,createMode:t},(e=>n(s=e)))))]).then((()=>s),(e=>(s?s.close("Force"):i.close(),Promise.reject(e))))}function h(e,t,r,o){return g(e,"Local",t,(e=>function(e,t,r){const{def:o,args:n}="def"in r?r:(0,d.paramInsideDef)(r);if("function"!=typeof o){const t={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new f.WorkerError("Loading an InsideScript to create a local worker is unimplemented",t))}return Promise.resolve().then((()=>(0,u.timePromise)(t.insideInit=(0,u.startStopwatch)(),(()=>o({config:(0,s.getSafeParams)(),importTypedWorkers:()=>m,connection:e},...n).then((()=>{}))))))}(e,t,r)),o)}function y(e,t,r,o){let n;t.createThread=(0,u.startStopwatch)();try{n=new p.Thread(e,r)}catch(e){return(0,u.stopStopwatch)(t.createThread,"Error"),Promise.reject(e)}return(0,u.stopStopwatch)(t.createThread,"Success"),g(e,"Thread",t,(e=>n.createInside(e,t)),o).then((e=>(e.hasBeenClosed()?n.terminate():e._onClose=n.terminate.bind(n),e)),(e=>(n.terminate(),Promise.reject(e))))}function _(e,t,r=(()=>{})){const o=(0,s.getCreateMode)(e),n="local"in t?"Local"===o?t.local:t.thread:t,a="Local"===o?h:y,i={id:e.id,createMode:o,createWorker:(0,u.startStopwatch)()},d=(0,u.timePromise)(i.createWorker,(()=>a((0,c.getSafeOptions)(e),i,n,r)));return(0,l.promiseFinally)(d,(()=>{const e=(0,u.createWorkerStats)(i);e&&(0,s.dispatchCreateWorker)(e)}))}},417:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Endpoint=void 0,t.getSafeOptions=function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries,isTrustedTypesPolicyEnabled:e.isTrustedTypesPolicyEnabled}};const o=r(226),n=r(56),a=r(352),i=r(740),s=r(422);class c{static _create(e,t,r){const{port:a,options:l,createMode:d}=t,u={type:"Endpoint",side:e,id:l?.id};let p,f;try{p=new n.EndpointState(u,a),f=new c(u,p,d)}catch(e){return Promise.reject(e)}return new Promise(((t,n)=>{p.getCallTimeout=()=>f.callTimeout,p.getOnPostMessageError=()=>f.onPostMessageError,p.onImports=(e,t)=>{Object.defineProperties(f,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),c.resolve()},p.onClose=()=>f.close("Force");const a=(0,o.getCreateTimeout)(l),c=(0,i.setCallbacksTimeout)(a,(()=>{const t="Outside"===e?"inside":"outside",r={cause:"Timeout",idInfo:u,timeout:a},o=new s.WorkerError(`${e} Endpoint timed out waiting for the ${t} to start`,r);c.reject(o)}),{resolve:t,reject:n});let d;f._closedDuringCreate=()=>{c.resolve()};try{d=r(f)}catch(e){return c.reject(e)}f._state?.setExports(d)})).then((()=>(f._closedDuringCreate=void 0,f)),(e=>(f._closedDuringCreate=void 0,f.close(),Promise.reject(e))))}hasBeenClosed(){return void 0===this._state}close(e){if(!this._state)return;if(this._closedDuringCreate){if("Force"!==e){const e={cause:"Connection",idInfo:this._idInfo};throw new s.WorkerError(`${this._idInfo.side} Endpoint's close called during creation`,e)}this._closedDuringCreate()}const t=this._state;this._state=void 0;try{t.close(),this._onClose?.(),this.onClose?.()}catch(e){const t={cause:"Connection",idInfo:this._idInfo,error:(0,a.asError)(e)};(0,o.dispatchWorkerError)(new s.WorkerError(`${this._idInfo.side} Endpoint's close threw an error`,t))}}constructor(e,t,r){this.callTimeout=1/0,this.onPostMessageError=n.throwWorkerError,this._idInfo=e,this._state=t,this.createMode=r;const o=t=>()=>{const r="Outside"===e.side?"inside":"outside",o={cause:"Connection",idInfo:e};throw new s.WorkerError(`${e.side} Endpoint's ${t} referenced before the ${r} Endpoint started`,o)};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:o("post")},call:{configurable:!0,enumerable:!1,get:o("call")}})}}t.Endpoint=c,c.createOutside=(e,t=(()=>{}))=>c._create("Outside",e,t),c.createInside=(e,t)=>c._create("Inside",e,t)},56:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndpointState=void 0,t.throwWorkerError=l;const o=r(226),n=r(352),a=r(740),i=r(802),s=r(422);var c;function l(e){throw e}!function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"}(c||(c={}));let d=-1;t.EndpointState=class{setExports(e){this.exports=e;const t=(0,a.haveNativeProxy)()?void 0:(0,a.getFunctionPropertyNames)(e),r={kind:c.Names,funcNames:t};this.port.postMessage(r)}close(){if(this.isClosed)return;this.isClosed=!0;const e={kind:c.Close};this.port.postMessage(e),this.port.close();for(const e in this.unresolvedCalls){const{reject:t,funcName:r}=this.unresolvedCalls[e],o={cause:"Connection",idInfo:this.idInfo,funcName:r};t(new s.WorkerError(`Importing Endpoint closed while waiting for ${r} result`,o))}}onInvoke({callId:e,funcName:t,args:r}){const a=Promise.resolve().then((()=>{const o=this.exports[t];if(o)return o.apply(this.exports,r);const n=e>=0?"call":"post",a={cause:"Connection",idInfo:this.idInfo,callId:e,funcName:t};throw new s.WorkerError(`Exporting Endpoint received a ${n} to unknown function ${t}`,a)}));e>=0?a.then((r=>this.sendResult(e,t,!0,r)),(r=>this.sendResult(e,t,!1,r))):a.catch((r=>{const a=(0,n.asError)(r),i={cause:"UnhandledError",idInfo:this.idInfo,error:a,callId:e,funcName:t};(0,o.dispatchWorkerError)(new s.WorkerError(`Exporting Endpoint's ${t} implementation threw or rejected`,i))}))}sendResult(e,t,r,o){let a;(0,i.isTransferableWrapper)(o)&&(a=o.transferables,delete o.transferables,delete o.__isTransferableWrapper);const s=(0,n.encodeResultValue)(o),l={kind:c.Result,callId:e,funcName:t,isFulfilled:r,resultValue:s};try{this.port.postMessage(l,a)}catch(e){this.onSendResultFailed(l,(0,n.asError)(e))}}onSendResultFailed({callId:e,funcName:t,resultValue:r},n){const a=n?`Exporting Endpoint failed to send ${t} result`:`Importing Endpoint failed to deserialize ${t} result`,i={cause:"MessageError",idInfo:this.idInfo,error:n,callId:e,funcName:t},c=new s.WorkerError(a,i);r.isError?(0,o.dispatchWorkerError)(c):this.sendResult(e,t,!1,c)}takeCallbacks(e){const t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t}setCallTimeout(e,t,r,o){return r>a.maxTimeout?o:(0,a.setCallbacksTimeout)(r,(()=>{const o=this.takeCallbacks(e);if(o){const n={cause:"Timeout",idInfo:this.idInfo,timeout:r,callId:e,funcName:t};o.reject(new s.WorkerError(`Importing Endpoint's call to ${t} timed out`,n))}}),o)}sendCall(e,t,r,o){return new Promise(((a,i)=>{const l=d+=1,u={kind:c.Invoke,callId:l,funcName:e,args:t};this.unresolvedCalls[l]={...this.setCallTimeout(l,e,r,{resolve:a,reject:i}),funcName:e};try{this.port.postMessage(u,o)}catch(t){const r=this.takeCallbacks(l);if(r){const o=(0,n.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:l,funcName:e};r.reject(new s.WorkerError(`Importing Endpoint failed to send call to ${e}`,a))}}}))}sendPost(e,t,r,o){const a={kind:c.Invoke,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,o)}catch(t){const o=(0,n.asError)(t),a={cause:"MessageError",idInfo:this.idInfo,error:o,callId:-1,funcName:e};r(new s.WorkerError(`Importing Endpoint failed to post to ${e}`,a))}}onSendInvokeFailed({callId:e,funcName:t}){const r=e>=0?"call":"post",n={cause:"MessageError",idInfo:this.idInfo,callId:e,funcName:t},a=new s.WorkerError(`Exporting Endpoint failed to deserialize ${r} to ${t}`,n),i=e>=0?this.takeCallbacks(e):void 0;(i?.reject??o.dispatchWorkerError)(a)}onResult({callId:e,funcName:t,isFulfilled:r,resultValue:n}){if(e>=0){const t=this.takeCallbacks(e);t&&(r?t.resolve:t.reject)((0,s.decodeResultValue)(n))}else{const r={cause:"InternalError",idInfo:this.idInfo,callId:e,funcName:t};(0,o.dispatchWorkerError)(new s.WorkerError(`Exporting Endpoint sent a result for a post to ${t}`,r))}}createPostProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed)return;const n=t.onPostMessageError??this.getOnPostMessageError?.()??l;this.sendPost(e,o,n,r)},t}createCallProxy(e){const t=(...e)=>t.transfer(void 0,...e);return t.transfer=(r,...o)=>{if(this.isClosed){const t={cause:"Connection",idInfo:this.idInfo,funcName:e};return Promise.reject(new s.WorkerError(`${this.idInfo.side} Endpoint's call.${e} called after close`,t))}const n=t.callTimeout??this.getCallTimeout?.()??1/0;return this.sendCall(e,o,n,r)},t.callTimeout=void 0,t}constructor(e,t){this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,a.createEmptyRecord)();const r=()=>this.onClose?.(),o={[c.Invoke]:this.onInvoke.bind(this),[c.Result]:this.onResult.bind(this),[c.Names]:({funcNames:e})=>{this.onImports?.((0,a.createObjectFromFunction)(this.createPostProxy.bind(this),e),(0,a.createObjectFromFunction)(this.createCallProxy.bind(this),e))},[c.Close]:r},n={[c.Invoke]:this.onSendInvokeFailed.bind(this),[c.Result]:this.onSendResultFailed.bind(this),[c.Names]:r,[c.Close]:r};this.port.onmessage=({data:e})=>o[e.kind](e),this.port.onmessageerror=({data:e})=>n[e.kind](e)}}},352:function(e,t){"use strict";function r(e){return o(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function o(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function n(e){return{...e,error:e.error?a(e.error):void 0}}function a(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?n(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=o,t.asError=function(e){return o(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=n,t.encodeError=a,t.encodeResultValue=function(e){return o(e)?{isError:!0,value:a(e)}:{isError:!1,value:e}}},740:function(e,t){"use strict";function r(){const e=Object.create(null);return e.key=void 0,delete e.key,e}let o;Object.defineProperty(t,"__esModule",{value:!0}),t.maxTimeout=void 0,t.promiseFinally=function(e,t){return e.then((e=>(t(),e)),(e=>(t(),Promise.reject(e))))},t.setCallbacksTimeout=function(e,r,o){if(e>t.maxTimeout)return o;const n=setTimeout(r,Math.max(0,e));return{resolve:e=>{clearTimeout(n),o.resolve(e)},reject:e=>{clearTimeout(n),o.reject(e)}}},t.createEmptyRecord=r,t.getFunctionPropertyNames=function(e){const t=r();for(;null!=e;){for(const r of Object.getOwnPropertyNames(e))try{"function"==typeof e[r]&&(t[r]=!0)}catch{}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)},t.haveNativeProxy=function(){return o??(o=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:()=>!0}).k}catch{return!1}}())},t.createObjectFromFunction=function(e,t){const o=r(),n=(t,r)=>"then"===r?void 0:t[r]??(t[r]=e(r));return t?(t.forEach((e=>n(o,e))),o):new Proxy(o,{get:n})},t.maxTimeout=1<<30},919:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0!==t)for(const r of e)a(r,t);else{const t=(0,o.getTrustedScriptUrls)([...e]);importScripts(...t)}};const o=r(266);function n(e,t,r){const o=e.indexOf("?");if(o<0)return`${e}?${t}=${r}`;const n=e.slice(0,o+1),a=e.slice(o+1).split("&");let i=0;for(;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]=`${t}=${r}`,n+a.join("&")}function a(e,t){let r;for(let a=0;a<=t;a+=1)try{const t=a>0?n(e,"retries",String(a)):e,r=(0,o.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},182:function(e,t){"use strict";function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,o=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??o(t)}catch{return o(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},753:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:n()}},t.stopStopwatch=a,t.timePromise=function(e,t){function r(t){throw a(e,(0,o.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>a(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:o,insideInit:n,createOutside:a,createThread:s}=e,{status:l,start:d,end:u}=o;if("Pending"!==l&&void 0!==u)return{id:t,createMode:r,createWorker:{status:l,absStart:d,duration:i(u-d)},createThread:"Thread"===r?c(s,d,u):void 0,createOutside:c(a,d,u),insideInit:c(n,d,u)}};const o=r(352),n="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function a(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??n()))}function i(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function c(e,t,r){const o=s(e?.start??1/0,t,r),n=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:i(o-t),end:i(n-t),duration:i(n-o)}}},48:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const n=r(872),a=r(226),i=r(740),s=r(182),c=o(r(572)),l=r(266),d=r(422);let u=-1;t.Thread=class{revokeBlobUrl(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)}createInside(e,t){const{port:r,options:o}=e,s={type:"Thread",side:"Outside",id:o.id},c=this.worker,u=new Promise(((e,i)=>{this.createCallbacks={resolve:e,reject:i};const u={config:(0,a.getSafeParams)(),port:r,options:o,script:this.script,args:this.args,runtimeAllowedOrigins:(0,l.getRuntimeAllowedOrigins)(),featureGateDictionary:(0,n.getFeatureGateDictionary)(),changeGateDictionary:(0,n.getChangeGateDictionary)()};c.postMessage(u,[r,...this.transferables]),c.onerror=e=>{e.preventDefault();const t=(0,d.getErrorEventWorkerError)(s,"worker.onerror",e);this.createCallbacks?this.createCallbacks.reject(t):(0,a.dispatchWorkerError)(t)},c.onmessage=({data:e})=>{switch(e.kind){case a.ThreadMessageKind.InitResult:return t.insideInit=e.stopwatch,void 0===e.error?this.createCallbacks?.resolve():this.createCallbacks?.reject((0,d.decodeResultValue)(e.error));case a.ThreadMessageKind.WorkerError:return(0,a.dispatchWorkerError)((0,d.decodeResultValue)(e.error));case a.ThreadMessageKind.CreateWorker:return(0,a.dispatchCreateWorker)(e.stats)}}}));return(0,i.promiseFinally)(u,(()=>{this.createCallbacks=void 0}))}terminate(){if(!this.worker)return;const e=this.worker;this.worker=void 0,this.createCallbacks?.resolve(),e.terminate(),this.revokeBlobUrl()}constructor(e,t){try{let r;(0,l.setUpTrustedTypesConfig)(e.isTrustedTypesPolicyEnabled),[this.script,this.args,this.transferables,r]=function(e){const{def:t,args:r,transferables:o}="def"in e?e:(0,s.paramInsideDef)(e);if("function"!=typeof t)return[t,r,o,void 0];const n=`__generatedInsideInit${u+=1}`;return[{scriptUrl:void 0,insideInitName:n},r,o,`var ${n} = ${t.toString()};`]}(t);const o=void 0===r?[c.default]:[r,"\n\n",c.default];this.blobUrl=URL.createObjectURL(new Blob(o,{type:"application/javascript"}));const n={};null!=e.id&&(n.name=e.id);const a=(0,l.getTrustedUrl)(this.blobUrl);this.worker=new Worker(a,n)}catch(e){throw this.worker?.terminate(),this.revokeBlobUrl(),e}}}},572:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default='(function(){var threadBootstrap;(()=>{"use strict";var e={216:(e,t)=>{function r(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=r,t.isChangeGateEnabled=function(e){return r()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},87:(e,t)=>{function r(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const n=r(e),o=r(t);let i=[];for(let e=0;e<=o.length;++e)i[e]=e;for(let e=1;e<=n.length;++e){const t=[e];for(let r=1;r<=o.length;++r)t[r]=n[e-1]===o[r-1]?i[r-1]:1+Math.min(i[r],i[r-1],t[r-1]);i=t}return i[o.length]}},448:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if("true"===r)return!0;if("false"===r)return!1;return t},t.getNumberFeatureGate=function(e,t){const r=a(e)?.trim().toLowerCase();if(void 0===r)return t;if("infinity"===r||"+infinity"===r)return 1/0;if("-infinity"===r)return-1/0;const n=parseFloat(r);return isNaN(n)?t:n},t.getIntFeatureGate=function(e,t){const r=a(e)?.trim();if(void 0===r)return t;const n=parseInt(r,10);return isNaN(n)?t:n},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const n=r(87);const o={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?o:globalThis.__get_feature_gate_dictionary_variable()}function a(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const r=i();if(Object.hasOwn(r,e))return r[e]??t;const o=globalThis.__office_online_feature_gates_verbose_log_callback;o(`Failed lookup for FeatureGate ${e}...`);const a=[],s=e.toLowerCase();for(const e of Object.keys(r))(0,n.editDistance)(e.toLowerCase(),s)<=4&&a.push(e);return a.length>0&&o(`Potential candidates found (edit distance <= 4, case-insensitive): [${a.join(", ")}]`),o(`FeatureGate override not found, returning default: ${t}`),t}},400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(533);n.__exportStar(r(448),t),n.__exportStar(r(187),t),n.__exportStar(r(216),t),n.__exportStar(r(340),t),n.__exportStar(r(56),t),n.__exportStar(r(96),t)},187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}};const n=r(448)},340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,n.isChangeGateEnabled)(e)};const n=r(216)},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=o,t.overrideTypedChangeGates=function(e,t){return o(t)};const n=r(216);function o(e){const t=(0,n.setChangeGateDictionaryGetter)(void 0);return(0,n.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},96:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=o,t.overrideTypedFeatureGates=function(e,t){return o(t)};const n=r(448);function o(e){const t={};for(const r of Object.keys(e))t[r]=e[r]?.toString();const r=(0,n.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,n.setFeatureGateDictionaryGetter)((()=>({...r(),...t}))),r}},598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRuntimeAllowedOriginsTypedWorkers=t.setRuntimeAllowedOriginsTypedWorkers=t.urlOriginPolicy=void 0;var n=r(719);Object.defineProperty(t,"urlOriginPolicy",{enumerable:!0,get:function(){return n.urlOriginPolicy}}),Object.defineProperty(t,"setRuntimeAllowedOriginsTypedWorkers",{enumerable:!0,get:function(){return n.setRuntimeAllowedOriginsTypedWorkers}}),Object.defineProperty(t,"getRuntimeAllowedOriginsTypedWorkers",{enumerable:!0,get:function(){return n.getRuntimeAllowedOriginsTypedWorkers}})},654:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPolicy=void 0;const r={},n="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t};t.createPolicy=(e,t,o=n,i)=>{try{r[e]||(r[e]=o.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){i?.(`${e}`)}return r[e]}},719:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.urlOriginPolicy=t.createUrlOriginPolicy=t.getRuntimeAllowedOriginsTypedWorkers=t.setRuntimeAllowedOriginsTypedWorkers=void 0;const n=r(654);function o(){return void 0===globalThis.__typed_workers_runtime_allowed_origins&&(globalThis.__typed_workers_runtime_allowed_origins=[]),globalThis.__typed_workers_runtime_allowed_origins}const i=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-v-sdf.cdn.office.net","https://res-v.cdn.office.net","https://uci.edog.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-h1.cdn.office.net","https://res-1-sdf.cdn.office.net","https://res-2-sdf.cdn.office.net","https://res-1-dev.cdn.officeppe.net","https://res-2-dev.cdn.officeppe.net","https://content.lifecycle.office.net","https://content.lifecycle.officeppe.net","https://res.df.onecdn.static.microsoft","https://res.public.onecdn.static.microsoft","https://res-1.public.onecdn.static.microsoft"].map((e=>e.trim())),a=[/^https?:\\/\\/([0-9a-zA-Z]+-)?(excel)\\.officeapps\\.live\\.com$/],s=[/^https?:\\/\\/([\\w-]+-)?(excel)(-[\\w-]+)?\\.cdn\\.office\\.net$/],c=new RegExp("https?://((localhost|local\\\\.teams\\\\.(office|live)\\\\.com|cpc-[\\\\w-]+|[\\\\w-]+\\\\.[\\\\w-]+\\\\.corp\\\\.microsoft\\\\.com)(:\\\\d+)?)(:|/|$)"),u=new RegExp("^https?://[\\\\w-]+\\\\.pyxidis\\\\.off(:\\\\d+)?$");t.setRuntimeAllowedOriginsTypedWorkers=e=>{o().push(...e)};t.getRuntimeAllowedOriginsTypedWorkers=()=>o();t.createUrlOriginPolicy=(e,t)=>(0,n.createPolicy)(e,{createScriptURL:e=>{let t;try{t=new URL(e,document.baseURI)?.origin}catch(r){t=new URL(e)?.origin}if(t&&(e=>{const t=o();return i.includes(e)||t.includes(e)||a.some((t=>t.test(e)))||s.some((t=>t.test(e)))||c.test(e)||u.test(e)})(t))return e;throw new Error(`TrustedTypes policy does not allow loading URL: ${e} with origin: ${t}`)}},t),t.urlOriginPolicy=(0,t.createUrlOriginPolicy)("typedWorkersUrlOriginPolicy")},691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadMessageKind=void 0,t.isThreadingSupported=s,t.setConfig=function(e){if(c)throw new TypeError("setConfig has already been called");c=e},t.getSafeParams=function(){const e=c??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?[...e.importScriptUrls]:void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}},t.getCreateTimeout=function(e){return e?.createTimeout??c?.createTimeout??o},t.getCreateMode=function(e){const t=e?.createMode??c?.createMode??i;return"ThreadOrLocal"===t?s()?"Thread":"Local":t},t.dispatchWorkerError=function(e){try{(c?.onWorkerError??f)(e)}catch(t){console.warn(e),u(t)}},t.dispatchCreateWorker=function(e){try{(c?.onCreateWorker??d)(e)}catch(e){u(e)}};const n=r(739),o=3e5,i="Thread";var a;function s(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}let c;function u(e){setTimeout((()=>{throw e}))}function l(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function f(e){const t=l();if(void 0!==t){const r={kind:a.WorkerError,error:(0,n.encodeResultValue)(e)};t.postMessage(r)}else console.warn(e)}function d(e){const t=l();if(void 0!==t){const r={kind:a.CreateWorker,stats:e};t.postMessage(r)}}!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(a||(t.ThreadMessageKind=a={}))},739:(e,t)=>{function r(e){return n(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function n(e){if(null==e)return!1;if(e instanceof Error)return!0;const t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return{...e,error:e.error?i(e.error):void 0}}function i(e){return{name:e.name,message:r(e)?e.baseMessage:e.message,stack:e.stack,info:r(e)?o(e.info):void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerError=r,t.isError=n,t.asError=function(e){return n(e)?e:new Error(`(non-Error object) ${function(e){const t=typeof e;switch(t){case"function":case"symbol":case"undefined":return`<${t}>`;case"object":return JSON.stringify(e);default:return`${e}`}}(e)}`)},t.encodeWorkerErrorInfo=o,t.encodeError=i,t.encodeResultValue=function(e){return n(e)?{isError:!0,value:i(e)}:{isError:!1,value:e}}},762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importScriptsWithRetry=function(e,t){if(0===t){const t=(0,n.getTrustedScriptUrls)([...e]);return void importScripts(...t)}for(const r of e)i(r,t)};const n=r(481);function o(e,t,r){const n=e.indexOf("?");if(n<0)return`${e}?${t}=${r}`;const o=e.slice(0,n+1),i=e.slice(n+1).split("&");let a=0;for(;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]=`${t}=${r}`,o+i.join("&")}function i(e,t){let r;for(let i=0;i<=t;i+=1)try{const t=i>0?o(e,"retries",String(i)):e,r=(0,n.getTrustedUrl)(t);return void importScripts(r)}catch(e){r=e}throw r}},619:(e,t)=>{function r(e){throw new ReferenceError(`${e} is not defined`)}Object.defineProperty(t,"__esModule",{value:!0}),t.paramInsideDef=void 0,t.indexObject=function(e,t,n=r){try{const r=t.split(".");for(const t of r)e=e[t];return e??n(t)}catch{return n(t)}},t.paramInsideDef=(e,...r)=>t.paramInsideDef.transfer(e,void 0,...r),t.paramInsideDef.transfer=(e,t,...r)=>({def:e,args:r,transferables:t??[]})},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startStopwatch=function(){return{status:"Pending",start:o()}},t.stopStopwatch=i,t.timePromise=function(e,t){function r(t){throw i(e,(0,n.isWorkerError)(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((t=>i(e,"Success")??t),r)}catch(e){r(e)}},t.createWorkerStats=function(e){const{id:t,createMode:r,createWorker:n,insideInit:o,createOutside:i,createThread:s}=e,{status:u,start:l,end:f}=n;if("Pending"===u||void 0===f)return;return{id:t,createMode:r,createWorker:{status:u,absStart:l,duration:a(f-l)},createThread:"Thread"===r?c(s,l,f):void 0,createOutside:c(i,l,f),insideInit:c(o,l,f)}};const n=r(739),o="undefined"!=typeof performance&&void 0!==performance.timeOrigin?()=>performance.now()+performance.timeOrigin:()=>Date.now();function i(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,r??o()))}function a(e){return Math.round(1e3*e)/1e3}function s(e,t,r){return e<t?t:e>r?r:e}function c(e,t,r){const n=s(e?.start??1/0,t,r),o=s(e?.end??1/0,t,r);return{status:e?.status??"Pending",start:a(n-t),end:a(o-t),duration:a(o-n)}}},481:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e,t=[]){o=e??!1,i=o?function(){return n.urlOriginPolicy}():void 0,o&&t?.length>0&&(0,n.setRuntimeAllowedOriginsTypedWorkers)(t)},t.getTrustedUrl=a,t.getTrustedScriptUrls=function(e){if(!o||!i)return e;return e.map(a)},t.getRuntimeAllowedOrigins=function(){return o?(0,n.getRuntimeAllowedOriginsTypedWorkers)():[]};const n=r(598);let o,i;function a(e){if(o&&i)try{return i.createScriptURL(e)}catch{return e}return e}},533:(e,t,r)=>{r.r(t),r.d(t,{__addDisposableResource:()=>U,__assign:()=>i,__asyncDelegator:()=>S,__asyncGenerator:()=>P,__asyncValues:()=>j,__await:()=>T,__awaiter:()=>y,__classPrivateFieldGet:()=>W,__classPrivateFieldIn:()=>G,__classPrivateFieldSet:()=>x,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>C,__esDecorate:()=>u,__exportStar:()=>h,__extends:()=>o,__generator:()=>_,__importDefault:()=>M,__importStar:()=>R,__makeTemplateObject:()=>k,__metadata:()=>p,__param:()=>c,__propKey:()=>f,__read:()=>v,__rest:()=>a,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>m,__spreadArray:()=>O,__spreadArrays:()=>w,__values:()=>b,default:()=>F});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=n.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,f=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var _ in n)y[_]="access"===_?{}:n[_];for(var _ in n.access)y.access[_]=n.access[_];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var g=(0,r[p])("accessor"===c?{get:f.get,set:f.set}:f[u],y);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=a(g.get))&&(f.get=s),(s=a(g.set))&&(f.set=s),(s=a(g.init))&&o.unshift(s)}else(s=a(g))&&("field"===c?o.unshift(s):f[u]=s)}l&&Object.defineProperty(l,n.name,f),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function f(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function _(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof T?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:T(e[n](t)),done:!1}:o?o(t):t}:o}}function j(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function k(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var E=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return E(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function W(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function G(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function U(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var D="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function C(e){function t(t){e.error=e.hasError?new D(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:o,__assign:i,__rest:a,__decorate:s,__param:c,__metadata:p,__awaiter:y,__generator:_,__createBinding:g,__exportStar:h,__values:b,__read:v,__spread:m,__spreadArrays:w,__spreadArray:O,__await:T,__asyncGenerator:P,__asyncDelegator:S,__asyncValues:j,__makeTemplateObject:k,__importStar:R,__importDefault:M,__classPrivateFieldGet:W,__classPrivateFieldSet:x,__classPrivateFieldIn:G,__addDisposableResource:U,__disposeResources:C}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=r(400),o=r(691),i=r(739),a=r(762),s=r(619),c=r(506),u=r(481);self.onmessage=({data:{config:e,port:r,options:n,script:l,args:f,runtimeAllowedOrigins:d,featureGateDictionary:p,changeGateDictionary:y}})=>{self.onmessage=null,self.__typed_workers_thread=!0,(0,u.setUpTrustedTypesConfig)(n.isTrustedTypesPolicyEnabled,d),(0,t.setFeatureGateDictionaryGetter)((()=>p)),(0,t.setChangeGateDictionaryGetter)((()=>y));const _=n.importScriptsMaxRetries??e.importScriptsMaxRetries??0;let g;function h(){if(g)return g;if(void 0===e.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return(0,a.importScriptsWithRetry)([e.typedWorkersUrl],_),g=(0,s.indexObject)(self,e.typedWorkersName??"typedWorkers"),g.setConfig(e),g}const b=(0,c.startStopwatch)();function v(e,t){const r=e?void 0:(0,i.encodeResultValue)((0,i.asError)(t)),n={kind:o.ThreadMessageKind.InitResult,error:r,stopwatch:b};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(0,c.timePromise)(b,(()=>{(0,a.importScriptsWithRetry)([...n?.importScriptUrls??e.importScriptUrls??[],...void 0!==l.scriptUrl?[l.scriptUrl]:[]],_);return(0,s.indexObject)(self,l.insideInitName)({config:e,importTypedWorkers:h,connection:{port:r,options:n,createMode:"Thread"}},...f)})).then((()=>v(!0)),(e=>v(!1,e)))}catch(e){v(!1,e)}}})(),threadBootstrap=n})();})()'},802:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapTransferable=function(e,t){return{value:e,__isTransferableWrapper:!0,transferables:t}},t.isTransferableWrapper=function(e){return"object"==typeof e&&null!==e&&"__isTransferableWrapper"in e&&!0===e.__isTransferableWrapper&&"value"in e}},266:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpTrustedTypesConfig=function(e,t=[]){n=e??!1,a=n?o.urlOriginPolicy:void 0,n&&t?.length>0&&(0,o.setRuntimeAllowedOriginsTypedWorkers)(t)},t.getTrustedUrl=i,t.getTrustedScriptUrls=function(e){return n&&a?e.map(i):e},t.getRuntimeAllowedOrigins=function(){return n?(0,o.getRuntimeAllowedOriginsTypedWorkers)():[]};const o=r(366);let n,a;function i(e){if(n&&a)try{return a.createScriptURL(e)}catch{return e}return e}},422:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.knownErrorClasses=t.WorkerError=void 0,t.getErrorEventWorkerError=function(e,t,r){if((0,o.isError)(r.error)){if((0,o.isWorkerError)(r.error))return r.error;const a={cause:"UnhandledError",idInfo:e,error:r.error};return new n(`${t} received an unhandled error`,a)}if(null==r.message)return new n(`${t} received a non-error (worker script fetch probably failed)`,{cause:"UnhandledError",idInfo:e});const a={cause:"UnhandledError",idInfo:e},i=`${r.message} at ${r.filename}:${r.lineno}:${r.colno}`;return new n(`${t} received an unhandled error: ${i}`,a)},t.decodeError=a,t.decodeWorkerErrorInfo=i,t.decodeResultValue=function(e){return e.isError?a(e.value):e.value};const o=r(352);class n extends Error{constructor(e,t){super(`${e}; info = ${JSON.stringify({...t,error:t.error?.message})}`),this.baseMessage=e,this.info=t,this.name="WorkerError"}}function a(e){let r;if("WorkerError"===e.name)r=new n(e.message,i(e.info));else{const o=t.knownErrorClasses[e.name];o?r=new o(e.message):(r=new Error(e.message),r.name=e.name)}return null!=e.stack&&(r.stack=e.stack),r}function i(e){return{...e,error:e.error?a(e.error):void 0}}t.WorkerError=n,n.isWorkerError=o.isWorkerError,t.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError}},491:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerThread=function(){return"undefined"!=typeof WorkerGlobalScope},t.workerName=function(){return"undefined"==typeof self?void 0:self.name}},533:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return L},__assign:function(){return a},__asyncDelegator:function(){return v},__asyncGenerator:function(){return T},__asyncValues:function(){return P},__await:function(){return E},__awaiter:function(){return m},__classPrivateFieldGet:function(){return M},__classPrivateFieldIn:function(){return x},__classPrivateFieldSet:function(){return O},__createBinding:function(){return h},__decorate:function(){return s},__disposeResources:function(){return R},__esDecorate:function(){return l},__exportStar:function(){return y},__extends:function(){return n},__generator:function(){return g},__importDefault:function(){return k},__importStar:function(){return W},__makeTemplateObject:function(){return I},__metadata:function(){return f},__param:function(){return c},__propKey:function(){return u},__read:function(){return S},__rest:function(){return i},__runInitializers:function(){return d},__setFunctionName:function(){return p},__spread:function(){return b},__spreadArray:function(){return w},__spreadArrays:function(){return C},__values:function(){return _},default:function(){return D}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t,r,o,n,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=o.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?o.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,o.name):{}),p=!1,f=r.length-1;f>=0;f--){var m={};for(var g in o)m[g]="access"===g?{}:o[g];for(var g in o.access)m.access[g]=o.access[g];m.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[f])("accessor"===c?{get:u.get,set:u.set}:u[l],m);if("accessor"===c){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(s=i(h.get))&&(u.get=s),(s=i(h.set))&&(u.set=s),(s=i(h.init))&&n.unshift(s)}else(s=i(h))&&("field"===c?n.unshift(s):u[l]=s)}d&&Object.defineProperty(d,o.name,u),p=!0}function d(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))}function g(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){i.label=s[1];break}if(6===s[0]&&i.label<n[1]){i.label=n[1],n=s;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(s);break}n[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var h=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function y(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function w(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function E(e){return this instanceof E?(this.v=e,this):new E(e)}function T(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof E?Promise.resolve(r.value.v).then(c,l):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function v(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:E(e[o](t)),done:!1}:n?n(t):t}:n}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=_(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function W(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return A(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function O(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function L(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var F="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function R(e){function t(t){e.error=e.hasError?new F(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var o=e.stack.pop();try{var n=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const D={__extends:n,__assign:a,__rest:i,__decorate:s,__param:c,__metadata:f,__awaiter:m,__generator:g,__createBinding:h,__exportStar:y,__values:_,__read:S,__spread:b,__spreadArrays:C,__spreadArray:w,__await:E,__asyncGenerator:T,__asyncDelegator:v,__asyncValues:P,__makeTemplateObject:I,__importStar:W,__importDefault:k,__classPrivateFieldGet:M,__classPrivateFieldSet:O,__classPrivateFieldIn:x,__addDisposableResource:L,__disposeResources:R}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";r.r(o),r.d(o,{AsyncClipboardChangeTracker:function(){return vr},BaseError:function(){return I},CCPError:function(){return U},CancelError:function(){return N},CancelErrorTypes:function(){return w},ClipboardPlatformError:function(){return H},ClipboardPlatformErrorTypes:function(){return S},ClipboardStorageType:function(){return je},ClipboardStrategyBase:function(){return Rt},ClipboardStrategyType:function(){return _},CopyClipboardCommand:function(){return ie},CopyClipboardEvent:function(){return le},CopyContext:function(){return gr},CopyError:function(){return $},CopyErrorTypes:function(){return b},CopyStatus:function(){return yr},CutClipboardCommand:function(){return se},CutClipboardEvent:function(){return de},CutCopyPasteFlags:function(){return Ne},InfraInitializationErrorTypes:function(){return He},InvalidArgumentError:function(){return k},InvalidOperationError:function(){return M},LocalStorageChangedEventFlagPostfix:function(){return dr},LocalStorageClipboardStorage:function(){return Cr},LocalStorageClipboardStrategy:function(){return Er},LocalStorageKeyChangeTracker:function(){return Tr},MessageDestinationConst:function(){return kt},MismatchVersionError:function(){return x},MissingArgumentError:function(){return W},NoUserHash:function(){return Et},NoValidKeyError:function(){return A},PasteClipboardCommand:function(){return ce},PasteClipboardEvent:function(){return ue},PasteContext:function(){return hr},PasteError:function(){return j},PasteErrorTypes:function(){return C},SharedClipboardError:function(){return J},TTLClipboardDataError:function(){return L},UnexpectedError:function(){return R},UnsupportedError:function(){return O},UserHashMismatchError:function(){return F},WindowRPCBase:function(){return Xt},addEventListener:function(){return pe},cloneMetadata:function(){return Sr},createClipboardItems:function(){return Oe},createClipboardOperationMessage:function(){return Wt},createClipboardOperationResultMessage:function(){return xt},createContextId:function(){return Pt},createCopyPasteInfra:function(){return Sn},createDeferredPromise:function(){return Ut},createDeferredPromiseCache:function(){return Jt},createDisposableImplementationExtension:function(){return Ft},createLocalStorageClipboardStorage:function(){return br},createLocalStorageClipboardStrategy:function(){return wr},createMessageDeserializer:function(){return Gt},createMessageId:function(){return vt},createMessageSerializer:function(){return Vt},createWindowRPCClientReceiver:function(){return tr},createWindowRPCClientSender:function(){return ar},createWindowRPCServerReceiver:function(){return er},createWindowRPCServerSender:function(){return nr},defaultClipboardDataFormat:function(){return fe},defaultIEClipboardDataFormat:function(){return me},emptyString:function(){return f},getCanonicalValidatedMessageId:function(){return It},getClipboardItem:function(){return Re},getClipboardItemContent:function(){return xe},getClipboardItemsCount:function(){return Me},getClipboardItemsDataCount:function(){return ke},getDefaultClipboardData:function(){return De},getDeferredClipboardItemContent:function(){return Le},getEmptyClipboardItemsData:function(){return Ie},getEmptyMetadata:function(){return _r},getImmutableEmptyClipboardItems:function(){return We},getItemsFromClipboardItems:function(){return Ue},getLocalStorageDataKey:function(){return pr},getLocalStorageMetadataKey:function(){return fr},getLocalStorageMetadataKeyToWatch:function(){return mr},getSharedClipboardValidatedOrigin:function(){return ht},getStringifiedError:function(){return Cn.getStringifiedError},getValidatedRemoteWindow:function(){return Yt},getWindowLocation:function(){return nt},getWindowMessaging:function(){return ne},htmlClipboardItem:function(){return n},imageClipboardDataFormat:function(){return he},init:function(){return K},initLogger:function(){return p},initMessageIdPrefix:function(){return Bt},initializeHtmlMinifierWorker:function(){return kn},isChromiumEdge:function(){return oe},isClipboardPlatformErrorType:function(){return E},isClipboardPlatformErrorTypes:function(){return T},isEdge:function(){return ee},isEdgeVersionWithTextHtmlWrapperSupport:function(){return re},isEdgeWithTextHtmlClipboardSupport:function(){return te},isIE:function(){return Q},isLocalStorageInaccessible:function(){return v},isLocalStorageSupported:function(){return ur},isValidClipboardOperationCode:function(){return Mt},metadataAdditionalSignatureDataAttributes:function(){return Te},metadataChromeExtensionId:function(){return Ce},metadataCopyContextClipboardDataFormat:function(){return ve},metadataCopyContextWebCustomDataFormat:function(){return Pe},metadataCopyId:function(){return Ee},metadataInfraVersionFormat:function(){return we},metadataIsLastCopyWasExternal:function(){return Se},metadataIsLastCopyWasExternalXLOSource:function(){return be},metadataLastCopyWasExternal:function(){return h},metadataLastCopyWasExternalXLOSource:function(){return y},oneDot:function(){return g},oneSpace:function(){return m},queryStringBulsEndpointUrlParameter:function(){return Je},queryStringCreatorOriginParameter:function(){return qt},queryStringSessionIdParameter:function(){return Ge},queryStringWacClusterParameter:function(){return ze},rethrowAfterAllActions:function(){return z},setCopyPasteInfraFeatureGateManager:function(){return Mn},shadowWorkbookClipboardDataFormat:function(){return ye},shadowWorkbookClipboardWebCustomDataFormat:function(){return _e},sharedClipboardSettings:function(){return e},shouldClearClipboard:function(){return Tt},textHtmlClipboardDataFormat:function(){return ge},ulsLogger:function(){return u},unknownMessageId:function(){return Kt},validateClipboardOperationMessage:function(){return Ot},validateClipboardOperationResultMessage:function(){return Lt},validateRemoteWindowOrigin:function(){return yt}});var e={};r.r(e),r.d(e,{createEmptySharedClipboardSettings:function(){return ot},defaultPromiseTimeoutInMinutes:function(){return Ye},getSharedClipboardSettings:function(){return Qe},initializeSharedClipboardSettings:function(){return tt},initializeSharedClipboardSettingsFromWindow:function(){return et},sharedClipboardSettingsVariableName:function(){return Be}});var t={};r.r(t),r.d(t,{default:function(){return Io}});var n={};let a;r.r(n),r.d(n,{addClipboardWrapperForEdge:function(){return fn},ccpTimestampHtmlCustomAttributeName:function(){return on},createHtmlItemFromTextPlain:function(){return ln},createPlainTextFromHtml:function(){return dn},createTextHtmlFromTextPlain:function(){return cn},divTagName:function(){return zo},encodeAngleBrackets:function(){return yn},ensureOneLFPerNewLine:function(){return an},getCcpTimestampHtmlCustomAttributeFromWrappingTag:function(){return gn},getExternalSource:function(){return hn},getFragmentFromTextHtml:function(){return mn},isContainsTimestampWrapper:function(){return pn},minCcpTimestampHtmlCustomAttributeValue:function(){return nn},preTagName:function(){return Go},tableTagName:function(){return Vo},tdTagName:function(){return Ko},trTagName:function(){return Bo},trimToLength:function(){return sn},wrapContentWithTagAndAttributes:function(){return _n}});const i=e=>{a=e},s=(e,t=!1)=>a?a.getBooleanFeatureGate(e,t):t;class c{static setFeatureGateManager(e){i(e)}}var l=r(495);let d;function u(){return d}function p(e){if(!e)throw new Error("The 'logger' argument is missing");d=l.Hv.getFromExternalLogger(e)}const f="",m=" ",g=".",h="1",y="1";var _,S,b,C,w;function E(e,t){return T(e,[t])}function T(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;return!!function(e){if(!e&&0!==e)return!1;const t=Number(e);return!isNaN(t)&&t.toString()===e.toString()}(e.reason)}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;const r=e.reason;return t.indexOf(r)>=0}function v(e){if(e&&"object"==typeof e){if(P(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(P(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(P(JSON.parse(e).reason))return!0}catch{}return!1}function P(e){return e===S.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",e[e.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory"}(_||(_={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",e[e.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",e[e.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure"}(S||(S={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(b||(b={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(C||(C={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(w||(w={}));class I extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():f}constructor(e,t,r){const o=I.augmentParameterValue(e);if(super(o),this.name=I.augmentParameterValue(t),this.errorName=this.name,this.name?u().ULS.traceTag(596456211,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Error '${this.name}': ${o}`):u().ULS.traceTag(596456212,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Error message: ${o}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=I.augmentParameterValue(e);t.length>0&&u().ULS.traceTag(596456213,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class A extends I{constructor(e,t){super(e,"NoValidKeyError",t)}}class W extends I{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const o=I.augmentParameterValue(t),n=W.getDefaultMessage(o);let a=I.augmentParameterValue(e);0===a.length&&(a=n),super(a,"MissingArgumentError",r),this.name=o}}class k extends I{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,o){const n=I.augmentParameterValue(t);let a=r;a||(a=f);const i=k.getDefaultMessage(n,a);let s=I.augmentParameterValue(e);0===e.length&&(s=i),super(s,"InvalidArgumentError",o),this.name=n,this.value=a}}class M extends I{constructor(e,t){super(e,"InvalidOperationError",t)}}class O extends I{constructor(e,t){super(e,"UnsupportedError",t)}}class x extends I{constructor(e,t,r,o,n){super(`${e}. Data version: ${t}, Infra version: ${r}, blockMismatchDataVersion: ${o}`,"MismatchVersionError",n)}}class L extends I{constructor(e,t,r,o){super(`${e}. Duration in clipboard (ms) : ${t}, TTL (ms): ${r}`,"TTLClipboardDataError",o)}}class F extends I{constructor(e,t,r,o){super(`${e}. Data User Hash : ${t}, infra User Hash: ${r}`,"UserHashMismatchError",o)}}class R extends I{constructor(e,t){super(e,"UnexpectedError",t)}}function D(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:f}class U extends I{constructor(e,t,r,o,n){super(t||`reason=${e}`,r,o),this.reason=e,n&&(this.errorName=n)}}class $ extends U{constructor(e,t,r){super(e,t,"CopyError",r,D(e,b))}}class j extends U{constructor(e,t,r){super(e,t,"PasteError",r,D(e,C))}}class N extends U{constructor(e,t,r){super(e,t,"CancelError",r,D(e,w))}}class H extends U{constructor(e,t,r){super(e,t,"ClipboardPlatformError",r,D(e,S))}}class J extends U{constructor(e,t,r){super(e,t,"SharedClipboardError",r,D(e,S))}}function z(e){if(!e||!Array.isArray(e)||0===e.length)return void u().ULS.traceTag(596456214,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){u().ULS.traceTag(596456216,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new M(e.message,e))}else u().ULS.traceTag(596456215,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}function G(){return V}const V={userAgent:()=>window&&window.navigator?window.navigator.userAgent:f,appVersion:()=>window&&window.navigator?window.navigator.appVersion:f};let B={};function K(){B={}}const q=new RegExp("(\\bTrident/| MSIE )"),Y=16.16299,X=17.17123,Z=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function Q(){if(void 0===B.isIEProperty){B.isIEProperty=!1;const e=G();if(e&&e.userAgent&&"function"==typeof e.userAgent){const t=e.userAgent();if(t){const e=t.match(q);e&&2===e.length&&(B.isIEProperty=!0)}}}return B.isIEProperty}function ee(){if(void 0===B.isEdgeProperty){B.isEdgeProperty=!1,B.isEdgeWithTextHtmlClipboardSupportProperty=!1,B.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;const e=G();if(e&&e.appVersion&&"function"==typeof e.appVersion){const t=e.appVersion();if(t){const e=t.match(Z);if(e&&2===e.length){B.isEdgeProperty=!0;const t=Number(e[1]);isNaN(t)||(t>=Y&&(B.isEdgeWithTextHtmlClipboardSupportProperty=!0),t>=X&&(B.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return B.isEdgeProperty}function te(){return ee()&&B.isEdgeWithTextHtmlClipboardSupportProperty}function re(){return ee()&&B.isEdgeVersionWithTextHtmlWrapperSupportProperty}function oe(){const e=G();let t=!1;if(e&&e.userAgent){const r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function ne(){return ae}const ae={postMessage:(e,t,r,o)=>{e.postMessage(t,r,o)}},ie="copy",se="cut",ce="paste",le="copy",de="cut",ue="paste",pe=(e,t,r,o)=>{const n=o||!1;return e.addEventListener(t,r,n),()=>{e.removeEventListener(t,r,n)}},fe="text/plain",me="Text",ge="text/html",he="image/png",ye="data/shadow-workbook",_e="web data/shadow-workbook",Se="metadata/is-last-copy-was-external",be="metadata/is-last-copy-was-external-XLO-source",Ce="metadata/chrome-extension-id",we="metadata/ccp-infra-version",Ee="copyId",Te="metadata/additional-signature-data-attributes",ve="metadata/copy-context",Pe="web metadata/copy-context";function Ie(){return{items:{}}}const Ae=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new M(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":f}empty)`)},setDeferredItem:(e,t)=>{throw new M(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>$e(void 0)}}();function We(){return Ae}function ke(e){return e&&e.items?Object.keys(e.items).length:0}function Me(e){return ke(e&&e.getData())}function Oe(e=void 0){let t=e;return t||(t={items:{}}),{getItem:e=>xe(t,e),setItem:(e,r)=>{Fe(t,e,r)},setDeferredItem:(e,r)=>{Fe(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>Le(t,e),getData:()=>t,get:()=>$e(t)}}function xe(e,t){if(!e)throw new W(f,"clipboardItemsData");if(!e.items)throw new k(f,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}function Le(e,t){if(!e)throw new W(f,"clipboardItemsData");if(!e.items)throw new k(f,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:fe}))}function Fe(e,t,r){if(!e)throw new W(f,"clipboardItemsData");if(!e.items)throw new k(f,"clipboardItemsData.items");e.items[t]=r}function Re(e,t){if(!e||0===e.length||!t||!t.trim())return f;let r;return e.forEach((e=>{e.clipboardDataFormat!==t||e.deferred||(r=e.data)})),r||f}function De(e){return Re(e,fe)}function Ue(e){let t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:fe,data:f}),t}function $e(e){const t=[];if(0===ke(e))return t;for(const r in e.items){let o=e.items[r];o||(o=f);const n={clipboardDataFormat:r,data:o,deferred:o instanceof Promise};t.push(n)}return t}var je,Ne,He;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(je||(je={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}(Ne||(Ne={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(He||(He={}));const Je="BulsEndpointUrl",ze="WacCluster",Ge="usid",Ve="-",Be="sharedClipboardSettings",Ke=1,qe=3600,Ye=2;let Xe=ot(),Ze=!1;function Qe(){if(!Ze)throw new M("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return Xe}function et(){Ze=!1,function(){if(!window||!(Be in window))return Xe=ot(),void(Ze=!0);const e=window[Be];if(!e||"object"!=typeof e)return Xe=ot(),void(Ze=!0);rt(e)}()}function tt(e){Ze=!1,rt(e)}function rt(e){if(!e)throw new W(f,"sharedClipboardSettingsCandidate");const t=ot();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return Xe=t,void(Ze=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return u().ULS.traceTag(596124181,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),Xe=t,void(Ze=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const o=r.indexOf(Ve);o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{u().ULS.traceTag(579737680,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return u().ULS.traceTag(596124182,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],Xe=t,void(Ze=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{u().ULS.traceTag(579737681,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return u().ULS.traceTag(596124183,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Xe=t,void(Ze=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return u().ULS.traceTag(596124184,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Xe=t,void(Ze=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return u().ULS.traceTag(596124185,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Xe=t,void(Ze=!0)}t.whitelistOriginComponents=!0,Xe=t,Ze=!0}function ot(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:f,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Ke,sharedClipboardExpirationInMinutes:qe,clipboardPromiseTimeoutInMinutes:Ye,remoteLoggerPath:f}}function nt(){let e=f;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=f)):(u().ULS.traceTag(595932950,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}const at="://",it="http",st="https",ct=".",lt="/",dt=":",ut=new RegExp("^\\d+$");let pt,ft,mt=!1;function gt(e){if(!e)throw new W(f,"origin");const t=e.trim().toLowerCase();let r=f,o=t.split(at,3);if(!o||0===o.length||!o[0]||o[0]!==it&&o[0]!==st)throw new k("Missing protocol","origin",e);if(1===o.length)throw new k("Missing domain","origin",e);if(o.length>2)throw new k(`'${at}' should appear once`,"origin",e);let n=o[1];if(!n)throw new k("Missing domain","origin",e);if(r=o[0]+at,n=n.trim(),o=n.trim().split(lt,3),!o||0===o.length||!o[0]||!o[0].trim())throw new k("Missing domain","origin",e);if(o.length>2)throw new k("The last part of the origin should be the domain","origin",e);if(2===o.length&&o[1])throw new k("The last part of the origin should be the domain","origin",e);if(o=n.split(dt,3),!o||0===o.length||!o[0]||!o[0].trim())throw new k("Missing domain","origin",e);if(o.length>2||2===o.length&&(!o[1]||!o[1].trim()))throw new k("The last part of the origin should be the domain and an optional port number","origin",e);if(n=o[0].trim(),r+=n,2===o.length){const t=o[1].trim(),n=ut.exec(t);if(!n||1!==n.length)throw new k("Invalid port number","origin",e);const a=Number(t);if(isNaN(a))throw new k("Invalid port number","origin",e);r+=dt+t}return u().ULS.traceTag(596452423,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function ht(e){Ct();const t=gt(e);let r=t.split(at);if(!r||2!==r.length||!r[0]||!r[1])throw new k("Invalid origin","parentOrigin",e);const o=Qe();let n=f;if(o.whitelistOriginComponents){const t=r[0]+at;if(r=r[1].split(ct),!r||r.length<2||!r[0])throw new k("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=t+r.join(ct)}else n=t;return u().ULS.traceTag(596452424,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`getSharedClipboardValidatedOrigin: app's origin = '${e}'; Shared Clipboard iframe origin = '${n}' components=${JSON.stringify(r)}`),n}function yt(e){Ct();const t=gt(e),r=gt(nt().origin);if(t===r)return t;if(!Qe().whitelistOriginComponents)throw new M(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const o=_t(t),n=_t(r);if(o.protocol!==n.protocol)throw new M(`validateRemoteWindowOrigin: Caller origin's protocol '${o.protocol}' doesn't match the current window origin's protocol '${n.protocol}'`);if(o.environment!==n.environment)throw new M(`validateRemoteWindowOrigin: Caller origin's environment '${o.environment}' doesn't match the current window origin's environment '${n.environment}'`);return t}function _t(e){Ct();const t=e.split(at,2),r=t[0],o=St(t[1]),n={protocol:r};if(n.environment=bt(e,o,ft),o.length<=n.environment.length+1)throw new k("Missing app component","origin",e);if(o.charAt(n.environment.length)!==ct)throw new k("Missing a domain separator after the environment component","origin",e);const a=o.substr(n.environment.length+ct.length);if(n.app=bt(e,a,pt),n.app.length<a.length&&a.charAt(n.app.length)!==Ve)throw new k(`When the Office Online app name is not the domain prefix, '${Ve}' should precede it`,"origin",e);return n}function St(e){if(!e)throw new W(f,"stringToReverse");const t=e.length;let r=f;for(let o=t-1;o>=0;o-=1)r+=e.charAt(o);return r}function bt(e,t,r){if(!t)throw new W(f,"reversedValidatedHostname");if(!r)throw new W(f,"reversedStringsToLengthMap");const o=t.length,n=Object.keys(r).filter((e=>{const n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return St(n[0]);throw new k("Invalid origin","validatedOrigin",e)}function Ct(){if(mt)return;const e=Qe();e.whitelistOriginComponents&&(pt=wt(e.sharedClipboardHostingApps),ft=wt(e.sharedClipboardHostingEnvironments),mt=!0)}function wt(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[St(e)]=e.length})),t):t}const Et=1;function Tt(e,t){return null==e||e===Et||null==t||e!==t}function vt(){return At()}function Pt(){return At()}function It(e){if(!e)throw new W(f,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new k(f,"id");return t}function At(){return(Math.random()+1).toString(36).substring(7)}function Wt(e,t,r,o,n){const a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return Ot(a),a}class kt{}function Mt(e){return"get"===e||"set"===e||"init"===e}kt.localStorageData="localStorage/data",kt.localStorageMetadata="localStorage/metadata",kt.initIframe="initIframe";const Ot=function(e){if(!e)throw new W(f,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new W(f,"id");if(!e.operationCode)throw new W(f,"operationCode");if(!e.destination)throw new W(f,"destination");if(!Mt(e.operationCode))throw new k(f,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new k(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function xt(e,t,r,o,n){const a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return Lt(a),a}const Lt=function(e){if(!e)throw new W(f,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const o of t)if(e.hasOwnProperty(o)){r=!0;break}if(!r)throw new A("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw u().ULS.traceTag(553747865,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new W(f,"id");if(!e.operationCode)throw new W(f,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new k(f,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new k(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new k(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new k(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new k(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new k(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new k(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function Ft(e){if(!e||0===e.trim().length)throw new k(f,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&u().ULS.traceTag(596456217,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new M(r(e))}}})()}class Rt{initialize(e){return e.then((e=>(this.clipboardStorage=e,u().ULS.traceTag(596453007,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(u().ULS.traceTag(596453008,l.nh.msoulscat_ES_EWAJS,v(e)?l.kp.Info:l.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${l.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return u().ULS.shipAssertTag(596121485,l.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new H(S.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new H(S.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return u().ULS.shipAssertTag(596121486,l.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new H(S.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw u().ULS.traceTag(507848131,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${l.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new H(S.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(We(),e):(u().ULS.shipAssertTag(595882508,l.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new H(S.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new H(S.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=Ft(`${e}`)}}const Dt=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Ut(e){let t=e;return t&&0!==t.trim().length||(t=vt()),new Ht(t)}function $t(){return Dt?window.performance.now():Date.now()}function jt(e){return Dt?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Nt(e,t,r){if(!r)throw new W(f,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":$t()-r}ms`}class Ht{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):u().ULS.traceTag(596456257,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):u().ULS.traceTag(596456260,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=$t(),u().ULS.traceTag(596456261,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${Nt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return u().ULS.traceTag(596456258,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&u().ULS.traceTag(596456259,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${jt(this.fulfillmentTimestamp)}. ${Nt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=It(e),Ht.sequenceId+=1,this.sequenceId=Ht.sequenceId,this.creationTimestamp=$t(),u().ULS.traceTag(596456225,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${jt(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{u().ULS.traceTag(596456226,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${jt($t())}`),this.internalResolve=e,this.internalReject=t}))}}function Jt(){return new zt}Ht.sequenceId=0;class zt{getDeferredPromise(e){const t=It(e);return this.deferredResultMessagePromiseCache[t]}getPromise(e){const t=this.getDeferredPromise(e);if(t)return u().ULS.traceTag(596456218,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise cache: found a deferred promise with id '${e}'.`),t.promise;u().ULS.traceTag(596456219,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise cache: there is no deferred promise with id '${e}'.`)}addNewPromise(e){const t=Ut(e);if(this.getDeferredPromise(t.id))throw new k("A deferred promise already exists in the cache for the specified id","id",t.id);const r=It(t.id);return this.deferredResultMessagePromiseCache[r]=t,u().ULS.traceTag(596456220,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise cache: added a new deferred promise with id '${t.id}'.`),t}getLength(){let e=0;for(const t in this.deferredResultMessagePromiseCache)e+=1;return e}delete(e){if(!this.getDeferredPromise(e))return void u().ULS.traceTag(596456221,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise cache: no need to delete an item with id '${e}' since this id is not associated with an existing deferred promise.`);const t=It(e);delete this.deferredResultMessagePromiseCache[t],u().ULS.traceTag(596456222,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise cache: deleted id '${e}'.`)}clear(){if(u().ULS.traceTag(596456223,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Deferred promise cache: clearing ${this.getLength()} items from the cache`),this.deferredResultMessagePromiseCache)for(const e in this.deferredResultMessagePromiseCache){const t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){u().ULS.traceTag(596456224,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`Deferred promise cache: clear failed to reject promise id '${e}' with this exception: ${t.message}. Ignoring.`)}}this.deferredResultMessagePromiseCache={}}constructor(){this.deferredResultMessagePromiseCache={}}}function Gt(e){if(!e)throw new W(f,"validator");const t={deserialize:t=>function(e,t){if(!e)throw new W(f,"incomingMessage");if(!t)throw new W(f,"validator");if(0===e.length)throw new k("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new k("A message cannot contain only spaces","incomingMessage");let o;try{o=JSON.parse(r)}catch(t){throw new k("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!o)throw new k("Deserialization returned nothing","incomingMessage");return t(o),o}(t,e)};return t}function Vt(e){if(!e)throw new W(f,"validator");const t={serialize:t=>function(e,t){if(!e)throw new W(f,"outgoingMessage");if(!t)throw new W(f,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new k("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return u().ULS.traceTag(596452375,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)};return t}const Bt="initmessageid",Kt="unknownmessageid",qt="CreatorOrigin";function Yt(e){if(!e)throw new W(f,"remoteWindow");if(!("window"in e)||!e.window)throw new W(f,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new W(f,"remoteWindow.windowOrigin");const t=yt(e.windowOrigin);return{window:e.window,windowOrigin:t}}class Xt{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(z([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new W(f,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw u().ULS.shipAssertTag(596121484,l.nh.msoulscat_ES_EWAJS,!1,e),new M(e)}this.sender.postMessage(e)}constructor(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=Ft(o)}}function Zt(){return Qt}const Qt={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)};function er(e,t,r){return new or(e,t,r)}function tr(e,t,r){return new or(e,t,r)}const rr="message";class or{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Zt().removeEventListener(rr,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return u().ULS.traceTag(596452370,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return u().ULS.traceTag(596452371,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return u().ULS.traceTag(596452372,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return u().ULS.traceTag(596452373,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){u().ULS.traceTag(596452374,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${l.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){u().ULS.traceTag(596452184,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${l.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{u().ULS.traceTag(595985880,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`Window RPC Receiver: unable to process incoming message. ${l.Wp.getStringifiedError(e)}`)}))}catch(e){u().ULS.traceTag(596452186,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`Window RPC Receiver: unable to process incoming message. ${l.Wp.getStringifiedError(e)}`)}else u().ULS.traceTag(596452185,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new W(f,"deserializer");if(!t)throw new W(f,"handler");if(!r)throw new W(f,"windowRPC");this.disposableImplementationExtension=Ft("WindowRPCReceiverInternal"),this.remoteWindow=Yt(r.remoteWindow),Zt().addEventListener(rr,this.windowMessageHandler)}}function nr(e,t){return new ir(e,t)}function ar(e,t){return new ir(e,t)}class ir{postMessage(e){if(!e)throw new W(f,"outgoingMessage");if(!this.remoteWindow.window)throw new M("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new M("The remote window does not support postMessage");const t=this.serializer.serialize(e);ne().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new W(f,"serializer");if(!t)throw new W(f,"windowRPC");this.disposableImplementationExtension=Ft("WindowRPCSenderInternal"),this.remoteWindow=Yt(t.remoteWindow)}}const sr="OfficeOnlineCCP_",cr=sr+"Metadata_",lr=sr+"Data_",dr="_LocalStorageChangedFlag";function ur(){try{const e="XLO_CCP",t="1";return localStorage.setItem(e,t),localStorage.getItem(e)===t}catch{return!1}}function pr(e){return lr+e}function fr(e){return cr+e}function mr(e){return fr(e)+dr}class gr{constructor(){this.copyStatus=yr.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1}}class hr{profilingMessage(e){const t=l.TZ.timeStamp()-this.startTime;return`onPasteProfiling: ${e}, pasteId: ${this.id}, timeMS: ${t.toFixed()}`}constructor(){this.startTime=l.TZ.timeStamp()}}var yr;function _r(){return{}}function Sr(e){let t;return e&&e.lastCopy&&(t={...e.lastCopy}),{lastCopy:t}}function br(e){try{u().ULS.traceTag(595716237,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Attempting to create clipboard storage type '${je.LocalStorage}'`);const t=new Cr(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(yr||(yr={}));class Cr{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),u().ULS.traceTag(595716238,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:f}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(We());try{const e=JSON.parse(t);if(!e||0===ke(e))return Promise.resolve(We());const r=Oe(e);return Promise.resolve(r)}catch(e){return Promise.resolve(We())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),u().ULS.traceTag(595716239,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`localStorageClipboardStorage.set: item count=${Me(e)}'; commandParameters.id='${t?t.id:f}'`),0===Me(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+dr}`,o=vt();return u().ULS.traceTag(595654546,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${o}`),localStorage.setItem(r,o),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[fe,ge,"data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new H(S.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new H(S.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=je.LocalStorage,this.disposableImplementationExtension=Ft("LocalStorageClipboardStorage")}}function wr(e){return u().ULS.traceTag(595716236,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`Attempting to create clipboard strategy type '${_.LocalStorage}' with localStorageKey: '${e}'`),(new Er).initialize(br(e))}class Er extends Rt{constructor(e){super(_.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Tr{onStorageChanged(e){u().ULS.shipAssertTag(595716249,l.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),u().ULS.traceTag(595716288,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),u().ULS.traceTag(595716289,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{u().ULS.traceTag(595716295,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return u().ULS.traceTag(595715525,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),u().ULS.traceTag(595716232,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{u().ULS.traceTag(595716233,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return u().ULS.traceTag(595715526,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(u().ULS.traceTag(595715527,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return u().ULS.traceTag(595715528,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=Ut(),r=new Date,o=setInterval((()=>{const n=(new Date).getTime()-r.getTime();u().ULS.traceTag(595715529,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(o),u().ULS.traceTag(595716234,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):n>e&&(clearInterval(o),u().ULS.traceTag(595716235,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}class vr{async onClipboardChanged(){if(this.clipboardStrategy.clipboardStrategyType!==_.AsyncSystemClipboard)return;const e={userHash:0};try{const t=await this.clipboardStrategy.get(e);this.listener(t)}catch(e){u().ULS.traceTag(503719453,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`AsyncClipboardChangeTracker: Failed to read clipboard items on clipboard change event. Error: ${e}`)}}constructor(e,t){this.clipboardStrategy=e,this.listener=t,navigator?.clipboard?.addEventListener?navigator.clipboard.addEventListener("clipboardchange",this.onClipboardChanged.bind(this)):u().ULS.traceTag(503719454,l.nh.msoulscat_ES_EWAJS,l.kp.Info,'AsyncClipboardChangeTracker: "clipboardchange" event not supported in this browser.')}}const Pr={},Ir="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(e,t)=>t},{entries:Ar,setPrototypeOf:Wr,isFrozen:kr,getPrototypeOf:Mr,getOwnPropertyDescriptor:Or}=Object;let{freeze:xr,seal:Lr,create:Fr}=Object,{apply:Rr,construct:Dr}="undefined"!=typeof Reflect&&Reflect;xr||(xr=function(e){return e}),Lr||(Lr=function(e){return e}),Rr||(Rr=function(e,t,r){return e.apply(t,r)}),Dr||(Dr=function(e,t){return new e(...t)});const Ur=Qr(Array.prototype.forEach),$r=Qr(Array.prototype.lastIndexOf),jr=Qr(Array.prototype.pop),Nr=Qr(Array.prototype.push),Hr=Qr(Array.prototype.splice),Jr=Qr(String.prototype.toLowerCase),zr=Qr(String.prototype.toString),Gr=Qr(String.prototype.match),Vr=Qr(String.prototype.replace),Br=Qr(String.prototype.indexOf),Kr=Qr(String.prototype.trim),qr=Qr(Object.prototype.hasOwnProperty),Yr=Qr(RegExp.prototype.test),Xr=(Zr=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Dr(Zr,t)});var Zr;function Qr(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return Rr(e,t,o)}}function eo(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jr;Wr&&Wr(e,null);let o=t.length;for(;o--;){let n=t[o];if("string"==typeof n){const e=r(n);e!==n&&(kr(t)||(t[o]=e),n=e)}e[n]=!0}return e}function to(e){for(let t=0;t<e.length;t++)qr(e,t)||(e[t]=null);return e}function ro(e){const t=Fr(null);for(const[r,o]of Ar(e))qr(e,r)&&(Array.isArray(o)?t[r]=to(o):o&&"object"==typeof o&&o.constructor===Object?t[r]=ro(o):t[r]=o);return t}function oo(e,t){for(;null!==e;){const r=Or(e,t);if(r){if(r.get)return Qr(r.get);if("function"==typeof r.value)return Qr(r.value)}e=Mr(e)}return function(){return null}}const no=xr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ao=xr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),io=xr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),so=xr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),co=xr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),lo=xr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),uo=xr(["#text"]),po=xr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),fo=xr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mo=xr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),go=xr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ho=Lr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yo=Lr(/<%[\w\W]*|[\w\W]*%>/gm),_o=Lr(/\$\{[\w\W]*/gm),So=Lr(/^data-[\-\w.\u00B7-\uFFFF]+$/),bo=Lr(/^aria-[\-\w]+$/),Co=Lr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wo=Lr(/^(?:\w+script|data):/i),Eo=Lr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),To=Lr(/^html$/i),vo=Lr(/^[a-z][.\w]*(-[.\w]+)+$/i);var Po=Object.freeze({__proto__:null,ARIA_ATTR:bo,ATTR_WHITESPACE:Eo,CUSTOM_ELEMENT:vo,DATA_ATTR:So,DOCTYPE_NAME:To,ERB_EXPR:yo,IS_ALLOWED_URI:Co,IS_SCRIPT_OR_DATA:wo,MUSTACHE_EXPR:ho,TMPLIT_EXPR:_o});var Io=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const r=t=>e(t);if(r.version="3.2.6",r.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return r.isSupported=!1,r;let{document:o}=t;const n=o,a=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:s,Node:c,Element:l,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:f,trustedTypes:m}=t,g=l.prototype,h=oo(g,"cloneNode"),y=oo(g,"remove"),_=oo(g,"nextSibling"),S=oo(g,"childNodes"),b=oo(g,"parentNode");if("function"==typeof s){const e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let C,w="";const{implementation:E,createNodeIterator:T,createDocumentFragment:v,getElementsByTagName:P}=o,{importNode:I}=n;let A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof Ar&&"function"==typeof b&&E&&void 0!==E.createHTMLDocument;const{MUSTACHE_EXPR:W,ERB_EXPR:k,TMPLIT_EXPR:M,DATA_ATTR:O,ARIA_ATTR:x,IS_SCRIPT_OR_DATA:L,ATTR_WHITESPACE:F,CUSTOM_ELEMENT:R}=Po;let{IS_ALLOWED_URI:D}=Po,U=null;const $=eo({},[...no,...ao,...io,...co,...uo]);let j=null;const N=eo({},[...po,...fo,...mo,...go]);let H=Object.seal(Fr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),J=null,z=null,G=!0,V=!0,B=!1,K=!0,q=!1,Y=!0,X=!1,Z=!1,Q=!1,ee=!1,te=!1,re=!1,oe=!0,ne=!1,ae=!0,ie=!1,se={},ce=null;const le=eo({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const ue=eo({},["audio","video","img","source","image","track"]);let pe=null;const fe=eo({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",he="http://www.w3.org/1999/xhtml";let ye=he,_e=!1,Se=null;const be=eo({},[me,ge,he],zr);let Ce=eo({},["mi","mo","mn","ms","mtext"]),we=eo({},["annotation-xml"]);const Ee=eo({},["title","style","font","a","script"]);let Te=null;const ve=["application/xhtml+xml","text/html"];let Pe=null,Ie=null;const Ae=o.createElement("form"),We=function(e){return e instanceof RegExp||e instanceof Function},ke=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ie||Ie!==e){if(e&&"object"==typeof e||(e={}),e=ro(e),Te=-1===ve.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Pe="application/xhtml+xml"===Te?zr:Jr,U=qr(e,"ALLOWED_TAGS")?eo({},e.ALLOWED_TAGS,Pe):$,j=qr(e,"ALLOWED_ATTR")?eo({},e.ALLOWED_ATTR,Pe):N,Se=qr(e,"ALLOWED_NAMESPACES")?eo({},e.ALLOWED_NAMESPACES,zr):be,pe=qr(e,"ADD_URI_SAFE_ATTR")?eo(ro(fe),e.ADD_URI_SAFE_ATTR,Pe):fe,de=qr(e,"ADD_DATA_URI_TAGS")?eo(ro(ue),e.ADD_DATA_URI_TAGS,Pe):ue,ce=qr(e,"FORBID_CONTENTS")?eo({},e.FORBID_CONTENTS,Pe):le,J=qr(e,"FORBID_TAGS")?eo({},e.FORBID_TAGS,Pe):ro({}),z=qr(e,"FORBID_ATTR")?eo({},e.FORBID_ATTR,Pe):ro({}),se=!!qr(e,"USE_PROFILES")&&e.USE_PROFILES,G=!1!==e.ALLOW_ARIA_ATTR,V=!1!==e.ALLOW_DATA_ATTR,B=e.ALLOW_UNKNOWN_PROTOCOLS||!1,K=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,q=e.SAFE_FOR_TEMPLATES||!1,Y=!1!==e.SAFE_FOR_XML,X=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,Q=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,ne=e.SANITIZE_NAMED_PROPS||!1,ae=!1!==e.KEEP_CONTENT,ie=e.IN_PLACE||!1,D=e.ALLOWED_URI_REGEXP||Co,ye=e.NAMESPACE||he,Ce=e.MATHML_TEXT_INTEGRATION_POINTS||Ce,we=e.HTML_INTEGRATION_POINTS||we,H=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&We(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&We(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),q&&(V=!1),te&&(ee=!0),se&&(U=eo({},uo),j=[],!0===se.html&&(eo(U,no),eo(j,po)),!0===se.svg&&(eo(U,ao),eo(j,fo),eo(j,go)),!0===se.svgFilters&&(eo(U,io),eo(j,fo),eo(j,go)),!0===se.mathMl&&(eo(U,co),eo(j,mo),eo(j,go))),e.ADD_TAGS&&(U===$&&(U=ro(U)),eo(U,e.ADD_TAGS,Pe)),e.ADD_ATTR&&(j===N&&(j=ro(j)),eo(j,e.ADD_ATTR,Pe)),e.ADD_URI_SAFE_ATTR&&eo(pe,e.ADD_URI_SAFE_ATTR,Pe),e.FORBID_CONTENTS&&(ce===le&&(ce=ro(ce)),eo(ce,e.FORBID_CONTENTS,Pe)),ae&&(U["#text"]=!0),X&&eo(U,["html","head","body"]),U.table&&(eo(U,["tbody"]),delete J.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Xr('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Xr('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=e.TRUSTED_TYPES_POLICY,w=C.createHTML("")}else void 0===C&&(C=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let r=null;const o="data-tt-policy-suffix";t&&t.hasAttribute(o)&&(r=t.getAttribute(o));const n="dompurify"+(r?"#"+r:"");try{return e.createPolicy(n,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}}(m,a)),null!==C&&"string"==typeof w&&(w=C.createHTML(""));xr&&xr(e),Ie=e}},Me=eo({},[...ao,...io,...so]),Oe=eo({},[...co,...lo]),xe=function(e){Nr(r.removed,{element:e});try{b(e).removeChild(e)}catch(t){y(e)}},Le=function(e,t){try{Nr(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Nr(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{xe(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Fe=function(e){let t=null,r=null;if(Q)e="<remove></remove>"+e;else{const t=Gr(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===Te&&ye===he&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const n=C?C.createHTML(e):e;if(ye===he)try{t=(new f).parseFromString(n,Te)}catch(e){}if(!t||!t.documentElement){t=E.createDocument(ye,"template",null);try{t.documentElement.innerHTML=_e?w:n}catch(e){}}const a=t.body||t.documentElement;return e&&r&&a.insertBefore(o.createTextNode(r),a.childNodes[0]||null),ye===he?P.call(t,X?"html":"body")[0]:X?t.documentElement:a},Re=function(e){return T.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},De=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Ue=function(e){return"function"==typeof c&&e instanceof c};function $e(e,t,o){Ur(e,(e=>{e.call(r,t,o,Ie)}))}const je=function(e){let t=null;if($e(A.beforeSanitizeElements,e,null),De(e))return xe(e),!0;const o=Pe(e.nodeName);if($e(A.uponSanitizeElement,e,{tagName:o,allowedTags:U}),Y&&e.hasChildNodes()&&!Ue(e.firstElementChild)&&Yr(/<[/\w!]/g,e.innerHTML)&&Yr(/<[/\w!]/g,e.textContent))return xe(e),!0;if(7===e.nodeType)return xe(e),!0;if(Y&&8===e.nodeType&&Yr(/<[/\w]/g,e.data))return xe(e),!0;if(!U[o]||J[o]){if(!J[o]&&He(o)){if(H.tagNameCheck instanceof RegExp&&Yr(H.tagNameCheck,o))return!1;if(H.tagNameCheck instanceof Function&&H.tagNameCheck(o))return!1}if(ae&&!ce[o]){const t=b(e)||e.parentNode,r=S(e)||e.childNodes;if(r&&t)for(let o=r.length-1;o>=0;--o){const n=h(r[o],!0);n.__removalCount=(e.__removalCount||0)+1,t.insertBefore(n,_(e))}}return xe(e),!0}return e instanceof l&&!function(e){let t=b(e);t&&t.tagName||(t={namespaceURI:ye,tagName:"template"});const r=Jr(e.tagName),o=Jr(t.tagName);return!!Se[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===he?"svg"===r:t.namespaceURI===me?"svg"===r&&("annotation-xml"===o||Ce[o]):Boolean(Me[r]):e.namespaceURI===me?t.namespaceURI===he?"math"===r:t.namespaceURI===ge?"math"===r&&we[o]:Boolean(Oe[r]):e.namespaceURI===he?!(t.namespaceURI===ge&&!we[o])&&!(t.namespaceURI===me&&!Ce[o])&&!Oe[r]&&(Ee[r]||!Me[r]):!("application/xhtml+xml"!==Te||!Se[e.namespaceURI]))}(e)?(xe(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!Yr(/<\/no(script|embed|frames)/i,e.innerHTML)?(q&&3===e.nodeType&&(t=e.textContent,Ur([W,k,M],(e=>{t=Vr(t,e," ")})),e.textContent!==t&&(Nr(r.removed,{element:e.cloneNode()}),e.textContent=t)),$e(A.afterSanitizeElements,e,null),!1):(xe(e),!0)},Ne=function(e,t,r){if(oe&&("id"===t||"name"===t)&&(r in o||r in Ae))return!1;if(V&&!z[t]&&Yr(O,t));else if(G&&Yr(x,t));else if(!j[t]||z[t]){if(!(He(e)&&(H.tagNameCheck instanceof RegExp&&Yr(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&Yr(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&Yr(H.tagNameCheck,r)||H.tagNameCheck instanceof Function&&H.tagNameCheck(r))))return!1}else if(pe[t]);else if(Yr(D,Vr(r,F,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Br(r,"data:")||!de[e])if(B&&!Yr(L,Vr(r,F,"")));else if(r)return!1;return!0},He=function(e){return"annotation-xml"!==e&&Gr(e,R)},Je=function(e){$e(A.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||De(e))return;const o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:j,forceKeepAttr:void 0};let n=t.length;for(;n--;){const a=t[n],{name:i,namespaceURI:s,value:c}=a,l=Pe(i),d=c;let u="value"===i?d:Kr(d);if(o.attrName=l,o.attrValue=u,o.keepAttr=!0,o.forceKeepAttr=void 0,$e(A.uponSanitizeAttribute,e,o),u=o.attrValue,!ne||"id"!==l&&"name"!==l||(Le(i,e),u="user-content-"+u),Y&&Yr(/((--!?|])>)|<\/(style|title)/i,u)){Le(i,e);continue}if(o.forceKeepAttr)continue;if(!o.keepAttr){Le(i,e);continue}if(!K&&Yr(/\/>/i,u)){Le(i,e);continue}q&&Ur([W,k,M],(e=>{u=Vr(u,e," ")}));const p=Pe(e.nodeName);if(Ne(p,l,u)){if(C&&"object"==typeof m&&"function"==typeof m.getAttributeType)if(s);else switch(m.getAttributeType(p,l)){case"TrustedHTML":u=C.createHTML(u);break;case"TrustedScriptURL":u=C.createScriptURL(u)}if(u!==d)try{s?e.setAttributeNS(s,i,u):e.setAttribute(i,u),De(e)?xe(e):jr(r.removed)}catch(t){Le(i,e)}}else Le(i,e)}$e(A.afterSanitizeAttributes,e,null)},ze=function e(t){let r=null;const o=Re(t);for($e(A.beforeSanitizeShadowDOM,t,null);r=o.nextNode();)$e(A.uponSanitizeShadowNode,r,null),je(r),Je(r),r.content instanceof i&&e(r.content);$e(A.afterSanitizeShadowDOM,t,null)};return r.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,a=null,s=null,l=null;if(_e=!e,_e&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Ue(e)){if("function"!=typeof e.toString)throw Xr("toString is not a function");if("string"!=typeof(e=e.toString()))throw Xr("dirty is not a string, aborting")}if(!r.isSupported)return e;if(Z||ke(t),r.removed=[],"string"==typeof e&&(ie=!1),ie){if(e.nodeName){const t=Pe(e.nodeName);if(!U[t]||J[t])throw Xr("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)o=Fe("\x3c!----\x3e"),a=o.ownerDocument.importNode(e,!0),1===a.nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!ee&&!q&&!X&&-1===e.indexOf("<"))return C&&re?C.createHTML(e):e;if(o=Fe(e),!o)return ee?null:re?w:""}o&&Q&&xe(o.firstChild);const d=Re(ie?e:o);for(;s=d.nextNode();)je(s),Je(s),s.content instanceof i&&ze(s.content);if(ie)return e;if(ee){if(te)for(l=v.call(o.ownerDocument);o.firstChild;)l.appendChild(o.firstChild);else l=o;return(j.shadowroot||j.shadowrootmode)&&(l=I.call(n,l,!0)),l}let u=X?o.outerHTML:o.innerHTML;return X&&U["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&Yr(To,o.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+u),q&&Ur([W,k,M],(e=>{u=Vr(u,e," ")})),C&&re?C.createHTML(u):u},r.setConfig=function(){ke(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},r.clearConfig=function(){Ie=null,Z=!1},r.isValidAttribute=function(e,t,r){Ie||ke({});const o=Pe(e),n=Pe(t);return Ne(o,n,r)},r.addHook=function(e,t){"function"==typeof t&&Nr(A[e],t)},r.removeHook=function(e,t){if(void 0!==t){const r=$r(A[e],t);return-1===r?void 0:Hr(A[e],r,1)[0]}return jr(A[e])},r.removeHooks=function(e){A[e]=[]},r.removeAllHooks=function(){A={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();const Ao={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},Wo=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],ko=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],Mo=Io||t,Oo=(Mo.isValidAttribute,(e,t)=>((e,t,r=Ir,o,n=!1)=>{try{Pr[e]||(Pr[e]=r.createPolicy(e,{createHTML:t.createHTML,createScript:t.createScript,createScriptURL:t.createScriptURL}))}catch(e){if(o?.(`${e}`),n)throw e}return Pr[e]})(e,{createHTML:(e,t,r)=>((e,t,r)=>{let o=!1;const n=t?(e=>({...Ao,ALLOW_ARIA_ATTR:!1!==e.ALLOW_ARIA_ATTR,ALLOW_DATA_ATTR:!1!==e.ALLOW_DATA_ATTR,FORCE_BODY:e.FORCE_BODY||!1,IN_PLACE:e.IN_PLACE||!1,SAFE_FOR_TEMPLATES:e.SAFE_FOR_TEMPLATES||!1,SANITIZE_DOM:!1!==e.SANITIZE_DOM,SANITIZE_NAMED_PROPS:e.SANITIZE_NAMED_PROPS||!1,USE_PROFILES:!!e.USE_PROFILES&&e.USE_PROFILES,WHOLE_DOCUMENT:e.WHOLE_DOCUMENT||!1,PARSER_MEDIA_TYPE:e.PARSER_MEDIA_TYPE??"text/html"}))(t):Ao;r&&Object.entries(r).forEach((([e,t])=>{Mo.addHook(e,t)}));const a=Mo.sanitize(e,n);return r&&Object.entries(r).forEach((([e])=>{Mo.removeHooks(e)})),t?.USE_PROFILES?a:(o=(e=>{let t=!1,r=!1;const o=new Set,n=new Set;return e.length>0&&(e.forEach((e=>{e.attribute?(r=ko.includes(e.attribute.localName)||r,o.add(e.attribute.localName)):e.element&&(r=Wo.includes(e.element.localName)||r,n.add(e.element.localName))})),(o.size>0||n.size>0)&&(r||(t=!0))),t})(Mo.removed),o?e:a)})(e,t,r)},t)),xo=Oo("domPurifyHTML"),Lo="\t",Fo="\n",Ro="\r",Do=new RegExp(`(${Fo}${Ro})|(${Ro}${Fo})|(${Ro})`,"g"),Uo=new RegExp(`(${Lo})`,"g"),$o=10240,jo=new RegExp("<","g"),No="&lt;",Ho=new RegExp(">","g"),Jo="&gt;",zo="div",Go="pre",Vo="table",Bo="tr",Ko="td",qo="\x3c!--StartFragment--\x3e",Yo="\x3c!--EndFragment--\x3e",Xo=qo.length,Zo=Yo.length,Qo=`Version:0.9${Fo}StartHTML:0000000100${Fo}EndHTML:{EndHTML0}${Fo}StartFragment:0000000134${Fo}EndFragment:{EndFragm}${Fo}<html>${Fo}<body>${Fo}${qo}${Fo}`,en=`${Yo}${Fo}</body>${Fo}</html>`,tn="0000000000",rn=7,on="data-ccp-timestamp",nn=0;function an(e){return e?e.replace(Do,Fo):e}function sn(e){return e?e.length<=$o?e:e.substr(0,$o):f}function cn(e){var t;const r=function(e){return e?e.replace(Do,`</${Ko}></${Bo}><${Bo}><${Ko}>`):e}((t=yn(e))?t.replace(Uo,`</${Ko}><${Ko}>`):t);return`<${Vo}><${Bo}><${Ko}>${r}</${Ko}></${Bo}></${Vo}>`}function ln(e,t,r){if(r!==nn&&!r)throw new W(f,"timestamp");if(isNaN(r))throw new k(f,"timestamp",r.toString());const o=function(e,t,r){return`<${e} ${on}='${r}'>${t}</${e}>`}(e,cn(t),r);return fn(o)}function dn(e){const t=[],r=e.getElementsByTagName("tr");if(r.length>0){const e=un(r[0]);t.push(e);for(let e=1;e<r.length;e+=1){t.push(Ro),t.push(Fo);const o=un(r[e]);t.push(o)}}return t.join("")}function un(e){const t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(let e=1;e<r.length;e+=1)t.push(Lo),t.push(r[e].innerText)}return t.join("")}function pn(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(on)}function fn(e){if(!ee()||re())return e;const t=tn.length,r=Qo.length+e.length+en.length;let o=(r-en.length).toString();if(o.length<t&&(o=tn.substr(0,t-o.length)+o),o.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ${o.length} but it should be ${t}`;throw u().ULS.shipAssertTag(596128536,l.nh.msoulscat_ES_EWAJS,!1,e),new H(S.UnexpectedClipboardTextHtmlContentLength,e)}let n=(r-rn).toString();if(n.length<t&&(n=tn.substr(0,t-n.length)+n),n.length!==t){const e=`addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ${n.length} but it should be ${t}`;throw u().ULS.shipAssertTag(596128537,l.nh.msoulscat_ES_EWAJS,!1,e),new H(S.UnexpectedClipboardTextHtmlContentLength,e)}const a=Qo.replace("{EndHTML0}",n).replace("{EndFragm}",o)+e+en;return u().ULS.shipAssertTag(596128538,l.nh.msoulscat_ES_EWAJS,a.length===r,`addClipboardWrapperForEdge: The resulting text/html payload length of ${a.length} differs from the expected length of ${r}`),a}function mn(e){if(!e)return f;if(!e.trim())return e;const t=e.indexOf(qo),r=e.indexOf(Yo);if(t<0||r<0||t>r)return e;const o=t+Xo,n=r-o,a=e.indexOf(qo,o),i=e.indexOf(Yo,r+Zo);return a>=0||i>=0?e:e.substr(o,n)}function gn(e){const t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new W(f,"attributeName");const r=new RegExp(`${t}=['"](\\d+)['"]`,"i").exec(e);return!r||r.length<2?void 0:r[1]}(e,on);if(!t||!t.trim())return;const r=Number(t);return!r&&r!==nn||isNaN(r)?void 0:r}function hn(e){if(!e||!e.trim())return;const t=new DOMParser,r=xo.createHTML(e),o=t.parseFromString(r,"text/html"),n=function(e){const t=e.getElementsByTagName("meta");for(let e=0;e<t.length;e+=1){const r=t[e];if("ProgId"===r.getAttribute("name")){const e=r.getAttribute("content");if(null!==e){if(e.length>64)return void u().ULS.shipAssertTag(595683460,l.nh.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(e.startsWith("Word"))return"Word Desktop";if(e.startsWith("Excel"))return"Excel Desktop";if(e.startsWith("PowerPoint"))return"PowerPoint Desktop";if(e.startsWith("OneNote"))return"OneNote Desktop";u().ULS.traceTag(595683457,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}}(o);if(void 0!==n)return n;const a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;const t=e.body.children[0];if(null!=t&&null!=t.classList)for(let e=0;e<t.classList.length;e+=1){const r=t.classList[e];if(r.startsWith("SCXO"))return"OneNote Online";if(r.startsWith("SCXP"))return"PowerPoint Online";if(r.startsWith("SCXW"))return"Word Online"}}(o);return void 0!==a?a:function(e){if(null===e)return!1;const t=e.getElementsByTagName("b");if(0===t.length)return!1;const r=t[0];return!(null==r||null==r.id||null==r.id.startsWith||!r.id.startsWith("docs-internal-guid-"))}(o)?"Google Docs":void 0}function yn(e){return e?e.replace(jo,No).replace(Ho,Jo):f}function _n(e,t,r){let o="";return r&&(o=Object.keys(r).reduce(((e,t)=>t?`${e} ${t}='${r[t]}'`:e),"")),`<${t}${o}>${e}</${t}>`}function Sn(e,t,r){return new bn(e,t,r)}class bn{get clipboardStrategy(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new M("clipboardPlatformEnvironment is missing")}onCopy(e){if(!e)return Promise.reject(new $(b.MissingArgumentError,"Missing commandParameters argument",new W(f,"commandParameters")));let t,r;this.initialClipboardStrategyType=e.dataClipboardStrategyType,t=new gr;try{t.id=Pt(),u().ULS.traceTag(595937123,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onCopy: copy ${t.id} started.`),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;const o=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(o,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(o,t),u().ULS.traceTag(595937152,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after serialize.`),this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)&&r&&r.synchronousResult&&r.synchronousResult.setItem(ve,this.metadataManager.serializeMetadata({lastCopy:{...t,copyStatus:t.isFromCache?yr.Completed:yr.SynchronousPhaseCompleted}})),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?u().ULS.traceTag(595734742,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onCopy: catching error for copy id ${t.id} during serialize.`):u().ULS.traceTag(595734743,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.onCopy: catching error and no copy context during serialize. CopyCommandId: ${e?.id}`),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return this.writeClipboardItems(e,t,r).then((()=>this.rejectIfCopyCancelled(t))).then((()=>(u().ULS.traceTag(504715104,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,`CopyPasteFlowManager.onCopy: Write to clipboard completed for both sync and async phase. CopyId: ${t?.id}.`),this.copyCompleteCleanup(t,e),t)),(r=>{u().ULS.traceTag(595734747,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onCopy: Error in writeClipboardItems. CopyId: ${t?.id}. Error: ${l.Wp.getStringifiedError(r)}`);let o=r;return this.copyCompleteCleanup(t,e),o||(u().ULS.shipAssertTag(595854806,l.nh.msoulscat_ES_EWAJS,!1,`copyPasteFlowManager.onCopy: promise rejected without error. CopyId: ${t?.id}.`),o=new $(b.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),o.copyContext=t,Promise.reject(o)}))}catch(r){return this.copyCompleteCleanup(t,e),u().ULS.traceTag(596456160,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. CopyId: ${t?.id}. Exception: ${l.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(new $(b.SaveToTheClipboardFailed,`Failed to store content in the clipboard (with an exception): ${r.message}`,r))}}onPaste(e){const t=new hr;try{if(!e)return Promise.reject(new j(C.MissingArgumentError,"Missing commandParameters argument",new W(f,"commandParameters")));this.initialClipboardStrategyType=e.dataClipboardStrategyType,e.isTimestampStoredInSystemClipboard=!0,t.id=vt(),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e,t.clipboardItems=We(),t.isClipboardInaccessible=!1,u().ULS.traceTag(595685636,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("start"));const r=this.metadataManager.getCachedMetadata();t.copyContextSnapshot=r.lastCopy,this.applicationHost.initializePasteContext(t),t.copyContextSnapshot?u().ULS.traceTag(595937154,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onPaste: paste started for copy id ${t.copyContextSnapshot.id}`):u().ULS.traceTag(595730637,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");let o,n=!1;return e.skipClipboardAccess?(u().ULS.traceTag(595685637,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("skipClipboardAccess")),o=Promise.resolve()):o=this.readFromClipboard(t,e).then((r=>{if(u().ULS.traceTag(595685638,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("readFromClipboard_then")),e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)){let e={lastCopy:void 0};if(!this.isEmptyClipboard(r)){const o=r.getItem(ve);o&&(e=this.metadataManager.deserializeMetadata(o),(!t?.copyContextSnapshot||t.copyContextSnapshot.id!==e?.lastCopy?.id||t?.copyContextSnapshot?.id===e?.lastCopy?.id&&t?.copyContextSnapshot?.copyStatus!==yr.Completed&&e?.lastCopy?.copyStatus===yr.Completed)&&(t.copyContextSnapshot=e?.lastCopy,this.metadataManager.updateMetadata(e)))}e?.lastCopy||(t.copyContextSnapshot=void 0,this.metadataManager.updateMetadata({lastCopy:void 0}),r.setItem(Se,h))}return t.clipboardItems=r,Promise.resolve()}),(e=>e&&e.reason&&e.reason===C.ClipboardIsInaccessible?(t.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e))),o.then((()=>e.isAsyncClipboardAPI&&this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType)?t:this.readClipboardItemsAgainIfMetadataNotSync(t,e))).then((()=>(u().ULS.traceTag(595685639,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("getPasteFlowHandler")),this.getPasteFlowHandler(t)))).then((e=>(n||e.beforePaste&&e.beforePaste(t),e))).then((r=>{if(u().ULS.traceTag(595685640,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("getPasteFlowHandler_then")),(!this.isAsyncClipboardChangeIntegrationEnabled||t.copyContextSnapshot)&&t.clipboardItems?.getItem(Se)!==h&&!t.isSameSession&&(!e.isAsyncClipboardAPI||!this.isAsyncClipboardEnhancementsEnabled(e.dataClipboardStrategyType))&&t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus!==yr.Completed&&r.shouldWaitForCopyToComplete(t)){u().ULS.traceTag(595937155,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy (${t.copyContextSnapshot.id}) to complete. current status ${t.copyContextSnapshot.copyStatus}. copy session id is ${t.copyContextSnapshot.sessionId}`),u().ULS.traceTag(595683427,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("onDeferredPasteStarted")),r.onDeferredPasteStarted(t);const o=this.continueWhenCopyComplete(e,t).then((e=>(u().ULS.traceTag(595685642,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("onDeferredPasteCompleted")),r.onDeferredPasteCompleted(t),t.copyContextSnapshot=this.metadataManager.getCachedMetadata().lastCopy,t.clipboardItems=e,r)),(e=>(r.onDeferredPasteCompleted(t),u().ULS.traceTag(595882504,l.nh.msoulscat_ES_EWAJS,l.kp.Error,`CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: [${e}]`),Promise.reject(e))));return u().ULS.traceTag(595685643,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("continueWhenCopyComplete")),this.testHook("continueWhenCopyComplete"),o}return u().ULS.traceTag(595940941,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onPaste: not wait for copy(${t.copyContextSnapshot&&t.copyContextSnapshot.id}) to complete. is copyContextSnapshot defined: ${void 0!==t.copyContextSnapshot}. copyStatus: ${t.copyContextSnapshot&&t.copyContextSnapshot.copyStatus}`),r})).then((e=>this.deserialize(e,t))).then((()=>{u().ULS.traceTag(595685644,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("deserialize_then")),t.clipboardItems&&t.clipboardItems.getItem(Se)===h&&(u().ULS.traceTag(595685645,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("onSystemClipboardChangedExternally")),this.onSystemClipboardChangedExternally())})).then((()=>{const e=t.clipboardItems;if(void 0===e)return;const r=e.getItem(ge);if(void 0!==r){const e=hn(r);void 0!==e&&(t.externalAppSource=e)}})).then((()=>t)).catch((e=>{let r=e;return r||(u().ULS.shipAssertTag(595858762,l.nh.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),r=new j(C.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),r.pasteContext=t,Promise.reject(r)}))}catch(e){return u().ULS.shipAssertTag(596456161,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: ${l.Wp.getStringifiedError(e)}`),Promise.reject(new j(C.FailedToReadFromClipboard,`Failed to read data from the clipboard (with an exception): ${e.message}`,e,t))}}onCancelCopy(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,u().ULS.traceTag(595734748,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onCancelCopy: canceling copy for copy id ${this.inProgressCopyContext.id}.`)):u().ULS.traceTag(595734749,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();const t=We(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:Ne.Copy};return this.clipboardStrategy.set(t,r).catch((e=>(u().ULS.traceTag(596456162,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: ${l.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new N(w.FailedToClearClipboard,`Failed to clear the clipboard: ${e.message}`,e)))))}catch(e){return u().ULS.traceTag(596456163,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: ${l.Wp.getStringifiedError(e)}`),Promise.reject(new N(w.FailedToClearClipboard,`Failed to clear the clipboard (with an exception): ${e.message}`,e))}}isAsyncClipboardEnhancementsEnabled(e){return this.isAsyncClipboardEnhancementsFGEnabled&&e===_.AsyncSystemClipboard}async onSystemClipboardChangedExternally(){this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0});const e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:Ne.Copy};await this.clipboardStrategy.onSystemClipboardChangedExternally(e)}readClipboardItemsAgainIfMetadataNotSync(e,t){let r=!1;return this.metadataManager.getMetadataSyncPromise().then((t=>{t&&t.lastCopy?(e.copyContextSnapshot&&(r=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,u().ULS.traceTag(595937158,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = ${e.copyContextSnapshot.id}. copy status = ${e.copyContextSnapshot.copyStatus}. isMetadataChanged = ${r}`)):u().ULS.traceTag(595937025,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((()=>r?this.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems))).then((t=>(e.clipboardItems=t,e)))}getCopyFlowHandler(e){let t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw u().ULS.shipAssertTag(596456192,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: ${l.Wp.getStringifiedError(e)}`),new $(b.FetchCopyFlowHandlerFailed,`applicationHost.getCopyFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw u().ULS.shipAssertTag(596456193,l.nh.msoulscat_ES_EWAJS,!1,e),new $(b.CopyFlowHandlerNotFound,e)}return t}getSourceItem(e,t){try{return e.getSourceItem(t)}catch(e){throw u().ULS.shipAssertTag(596456194,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: ${l.Wp.getStringifiedError(e)}`),new $(b.FetchSourceItemFailed,`applicationHost.getSourceItem failed with an exception: ${e.message}`,e)}}serialize(e,t){try{e.beforeSerialize(t)}catch(e){throw u().ULS.shipAssertTag(596456195,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception. CopyId: ${t?.id}. Error: ${l.Wp.getStringifiedError(e)}`),new $(b.BeforeSerializeFailed,`copyFlowHandler.beforeSerialize failed with an exception: ${e.message}`,e)}let r;u().ULS.traceTag(504715103,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,`CopyPasteFlowManager.serialize: copyFlowHandler.beforeSerialize completed. CopyId: ${t?.id}.`);try{r=e.serialize(t)}catch(e){throw u().ULS.shipAssertTag(596456196,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize failed with an exception. CopyId: ${t?.id}. Error: ${l.Wp.getStringifiedError(e)}`),new $(b.SerializeFailed,`copyFlowHandler.serialize failed with an exception: ${e.message}`,e)}if(!r)throw u().ULS.shipAssertTag(596456197,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.serialize: copyFlowHandler.serialize should return a non null result. CopyId: ${t?.id}.`),new $(b.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return u().ULS.traceTag(504715102,l.nh.msoulscat_ES_EWAJS,l.kp.Verbose,`CopyPasteFlowManager.serialize completed. CopyId: ${t?.id}.`),r}setClipboardSync(e,t,r){try{r?u().ULS.traceTag(595734750,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id ${r.id}.`):u().ULS.traceTag(595734751,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");let o=e;return o||(o=We()),this.clipboardStrategy.set(o,t).catch((e=>{if(u().ULS.traceTag(596456198,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: ${t.isKeyboardEvent}, Error: ${l.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason){const t=e;if(t.reason===S.ClipboardIsInaccessible)return Promise.reject(new $(b.ClipboardIsInaccessible,t.message,t));if(t.reason===S.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new $(b.SuccessiveCutCopyOverridingPendingCutCopy,`A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: ${t.message}`,t));if(t.reason===S.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new $(b.BlockedSynchronousCutCopy,`In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: ${t.message}`,t))}return Promise.reject(new $(b.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard: ${e.message}`,e))})).then((()=>{r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return u().ULS.shipAssertTag(596456199,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: ${l.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new $(b.SaveToTheClipboardFailed,`Failed to synchronously store content in the clipboard (with an exception): ${e.message}`,e))}}setClipboardAsync(e,t,r){return u().ULS.traceTag(595734752,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id ${r.id}.`),e?e.then((e=>{try{if(u().ULS.traceTag(505794970,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.setClipboardAsync: clipboardItemsPromise resolved for copy id ${r?.id}.`),this.isEmptyClipboard(e))return Promise.resolve();this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&e.setItem(ve,this.metadataManager.serializeMetadata({lastCopy:{...r,copyStatus:yr.Completed}}));const o=t.stopwatch;t.stopwatch=void 0;const n={...t};return n.isTimestampStoredInSystemClipboard=!1,t.isAsyncSystemClipboardEnabled&&this.isAsyncClipboardEnhancementsEnabled(t.dataClipboardStrategyType)&&(n.stopwatch=o),t.stopwatch=o,t.isKeyboardEvent&&(n.isKeyboardEvent=!1,n.silentClipboardAccessFailures=!0),this.clipboardStrategy.set(e,n).catch((e=>(u().ULS.traceTag(596456200,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Error: ${l.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),e&&void 0!==e.reason&&e.reason===S.ClipboardIsInaccessible?Promise.resolve():Promise.reject(new $(b.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard: ${e&&e.message}`,e))))).then((()=>{u().ULS.traceTag(505794969,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.setClipboardAsync: setClipboardAsync completed for copy id ${r.id}.`),r.succeededPopulatingSystemClipboardAsync=n.isTimestampStoredInSystemClipboard}))}catch(e){return u().ULS.shipAssertTag(596456201,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously store content in the clipboard. CopyId: ${r?.id}. Exception: ${l.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),Promise.reject(new $(b.SaveToTheClipboardFailed,`Failed to asynchronously store content in the clipboard (with an exception): ${e.message}`,e))}}),(e=>(r.isAsyncSerializeFailed=!0,u().ULS.traceTag(596456202,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.setClipboardAsync: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. CopyId: ${r?.id}. Error: ${l.Wp.getStringifiedError(e)}. Call stack: ${e&&e.stack?e.stack:"NA"}`),Promise.reject(new $(b.AsyncSerializeFailed,`Failed to asynchronously serialize the content. Error: ${e?e.message:"..."}`,e))))):(u().ULS.traceTag(595734753,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id ${r.id}.`),Promise.resolve())}isEmptyClipboard(e){return e?0===Me(e)&&(u().ULS.traceTag(596456204,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(u().ULS.traceTag(596456203,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)}writeClipboardItems(e,t,r){return this.isAsyncClipboardEnhancementsEnabled(e?.dataClipboardStrategyType)?this.writeClipboardItemsInSyncPhase(e,t,r).then((()=>this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t))))):Promise.all([this.writeClipboardItemsInSyncPhase(e,t,r),this.rejectIfCopyCancelled(t).then((()=>this.setClipboardAsync(r.asynchronousResult,e,t)))])}writeClipboardItemsInSyncPhase(e,t,r){return this.setClipboardSync(r.synchronousResult,e,t).then((()=>this.rejectIfCopyCancelled(t))).then((()=>{t.copyStatus=yr.SynchronousPhaseCompleted,u().ULS.traceTag(595937153,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onCopy: updating metadata for copy id ${t.id} after status changed to SynchronousPhaseCompleted.`),this.metadataManager.updateMetadata({lastCopy:t})})).catch((r=>{if(t?u().ULS.traceTag(595734744,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: Error in setClipboardSync. CopyId: ${t?.id}. Error: ${l.Wp.getStringifiedError(r)}`):u().ULS.traceTag(595734745,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: no copy context. CopyCommandId: ${e?.id}`),r&&r.reason){const e=r.reason;if(e===b.SuccessiveCutCopyOverridingPendingCutCopy||e===b.BlockedSynchronousCutCopy||e===b.CopyOperationCancelled||this.initialClipboardStrategyType===_.AsyncSystemClipboard&&e===b.ClipboardIsInaccessible)return u().ULS.traceTag(595734746,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. CopyId: ${t?.id}. Rejecting the promise: ${l.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),Promise.reject(r)}return u().ULS.traceTag(596456159,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.writeClipboardItemsInSyncPhase: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality. CopyId: ${t?.id}. Error: ${l.Wp.getStringifiedError(r)}. Call stack: ${r.stack?r.stack:"NA"}`),this.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()}))}readFromClipboard(e,t){u().ULS.traceTag(595685646,l.nh.msoulscat_ES_EWAJS,l.kp.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);const r=this.clipboardStrategy.get(t);return u().ULS.traceTag(595685647,l.nh.msoulscat_ES_EWAJS,l.kp.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((t=>(u().ULS.traceTag(595685648,l.nh.msoulscat_ES_EWAJS,l.kp.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(u().ULS.traceTag(596456206,l.nh.msoulscat_ES_EWAJS,l.kp.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new j(C.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new j(C.ClipboardIsEmpty,f)))))),(e=>{if(u().ULS.traceTag(596456207,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: ${l.Wp.getStringifiedError(e)}. Call stack: ${e.stack?e.stack:"NA"}`),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return u().ULS.traceTag(577249542,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);const r=e;return E(e,S.ClipboardIsInaccessible)?Promise.reject(new j(C.ClipboardIsInaccessible,r.message,r)):E(e,S.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new j(C.SuccessivePasteOverridingPendingPaste,`A successive Paste user event occurred before the last Paste browser event fired: ${r.message}`,r)):E(e,S.AsyncClipboardReadFailure)?Promise.reject(new j(C.FailedToReadFromAsyncClipboard,r.message,r)):Promise.reject(new j(C.FailedToReadFromClipboard,`Failed to read data from the clipboard: ${e.message}`,e))})):(u().ULS.shipAssertTag(596456205,l.nh.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new j(C.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new j(C.ReadFromClipboardReturnNullOrUndefined,f))))}getPasteFlowHandler(e){let t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw u().ULS.shipAssertTag(596456208,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: ${l.Wp.getStringifiedError(e)}`),new j(C.FetchPasteFlowHandlerFailed,`applicationHost.getPasteFlowHandler failed with an exception: ${e.message}`,e)}if(!t){const e="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw u().ULS.shipAssertTag(596456209,l.nh.msoulscat_ES_EWAJS,!1,e),new j(C.PasteFlowHandlerNotFound,e)}return t}deserialize(e,t){return u().ULS.traceTag(595683456,l.nh.msoulscat_ES_EWAJS,l.kp.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((e=>{const t=l.Wp.getStringifiedError(e);return u().ULS.traceTag(596456210,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: ${t}.`),Promise.reject(new j(C.DeserializeOperationFailed,`Deserialization failed: ${t}`,e))}))}copyCompleteCleanup(e,t){e?(u().ULS.traceTag(595734754,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id ${e.id}.`),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=yr.Completed,u().ULS.traceTag(595937159,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id ${e.id} after copy completed.`),this.metadataManager.updateMetadata({lastCopy:e})):u().ULS.traceTag(595734755,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id ${e.id}.`)):u().ULS.traceTag(595734784,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.copyCompleteCleanup: no copy context. CopyCommandId: ${t?.id}`)}readRichClipboardOnly(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((e=>(u().ULS.traceTag(595937160,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e)),(e=>(u().ULS.traceTag(595940942,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,`CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: ${l.Wp.getStringifiedError(e)}. use clipboard items from the first read as fallback.`),Promise.resolve(r))))}continueWhenCopyComplete(e,t){if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===yr.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(u().ULS.shipAssertTag(595937161,l.nh.msoulscat_ES_EWAJS,!1,`CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy(${this.deferredPasteData.copyContextId} !== ${t.copyContextSnapshot.id}) exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)`),this.rejectDeferredPasteData(C.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){const r=this.metadataManager.getCachedMetadata();if(r&&r.lastCopy&&r.lastCopy.copyStatus===yr.Completed&&r.lastCopy.id===t.copyContextSnapshot.id)return u().ULS.traceTag(595937162,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: copy ${r.lastCopy.id} already completed, not need for waiting any longer, reading the rich clipboard items`),this.readRichClipboardOnly(t,e,t.clipboardItems);const o=Ut(),n=o.promise.then((()=>this.readRichClipboardOnly(t,e,t.clipboardItems)));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:o,readClipboardPromise:n,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,u().ULS.traceTag(595937163,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}`),this.deferredPasteData.readClipboardPromise}rejectDeferredPasteData(e){if(this.deferredPasteData){u().ULS.traceTag(595937164,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new j(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}}resolveDeferredPasteData(){if(this.deferredPasteData){u().ULS.traceTag(595937165,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: ${this.deferredPasteData.copyContextId}. number of deferred paste for this copy is: ${this.deferredPasteData.numberOfDeferredPaste}. first deferred paste created time: ${this.deferredPasteData.createdDate.toUTCString()}. totalTime = ${(new Date).getTime()-this.deferredPasteData.createdDate.getTime()}ms`);const e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}}rejectIfCopyCancelled(e){return e?u().ULS.traceTag(595734785,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id ${e.id}.`):u().ULS.traceTag(595734786,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(u().ULS.traceTag(595734787,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id ${e.id}.`),Promise.reject(new $(b.CopyOperationCancelled,`CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id ${e.id} is marked for cancellation`))):(e&&u().ULS.traceTag(595734788,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id ${e.id}.`),Promise.resolve())}clearInProgressCopyIfNeeded(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(u().ULS.traceTag(595937166,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = ${this.inProgressCopyContext.id}) as new copy started (${e.id})`),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)}onMetadataChanged(e){e&&e.lastCopy?(u().ULS.traceTag(595937167,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onMetadataChanged: the status of copy id ${e.lastCopy.id} from session ${e.lastCopy.sessionId} changed to ${e.lastCopy.copyStatus}`),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(u().ULS.traceTag(595734789,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id ${e.lastCopy.id} is not equal to ${this.deferredPasteData.copyContextId}`),this.rejectDeferredPasteData(C.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===yr.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(u().ULS.traceTag(595734790,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(u().ULS.traceTag(595724049,l.nh.msoulscat_ES_EWAJS,l.kp.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(C.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))}onCopyCompletedSuccessfully(e){e?u().ULS.traceTag(595734791,l.nh.msoulscat_ES_EWAJS,l.kp.Info,`CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id ${e.id}.`):u().ULS.traceTag(595734792,l.nh.msoulscat_ES_EWAJS,l.kp.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===yr.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()}testHook(e){}constructor(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,this.isAsyncClipboardEnhancementsFGEnabled=!1,this.isAsyncClipboardChangeIntegrationEnabled=!1,!r)throw new W(f,"logger");p(r),u().ULS.shipAssertTag(596456157,l.nh.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),u().ULS.shipAssertTag(596456158,l.nh.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),u().ULS.shipAssertTag(596456156,l.nh.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid"),this.isAsyncClipboardEnhancementsFGEnabled=s("Microsoft.Office.Excel.AsyncClipboardEnhancements",!1),this.isAsyncClipboardChangeIntegrationEnabled=s("Microsoft.Office.Excel.AsyncClipboardChangeIntegration",!1)}}var Cn=r(906);class wn{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const En=new class{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,r,o){this.externalLogger.sendTraceTag(e,t,r,o)}debugAssertTag(e,t,r,o){this.externalLogger.debugAssertTag(e,t,r,o)}shipAssertTag(e,t,r,o){this.externalLogger.shipAssertTag(e,t,r,o)}forwardFeedbackCacheLogs(){this.externalLogger.forwardFeedbackCacheLogs?.()}constructor(){this.externalLogger=new wn}};var Tn,vn;!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleLicensing=4013]="msoulscat_AIHub_CreateModuleLicensing",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(Tn||(Tn={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(vn||(vn={}));var Pn=r(256),In=r(872);let An,Wn=!1;async function kn(e){if(Wn)return En.sendTraceTag(504452609,Tn.msoulscat_ES_EWAJS,vn.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Worker already initialized"),null;const t=(0,In.isChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.OfficeVSO_10358639_EnableTTPolicyWorkerConstructor3");try{const r={reportProgress(e){An&&An(e)}},o=await(0,Pn.createWorker)({id:"HtmlMinifierWorker",createMode:"Thread",isTrustedTypesPolicyEnabled:t},{scriptUrl:e,insideInitName:"htmlMinifierWorker.htmlMinifierWorkerServiceInit"},(()=>r));return o?(Wn=!0,En.sendTraceTag(504452579,Tn.msoulscat_ES_EWAJS,vn.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: worker endpoint created"),{minifyHtml:async(e,t)=>(An=t,await o.call.minifyHtml(e))}):(En.sendTraceTag(504452608,Tn.msoulscat_ES_EWAJS,vn.Info,"HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Worker endpoint not initialized"),null)}catch(e){return En.sendTraceTag(504451539,Tn.msoulscat_ES_EWAJS,vn.Info,`HtmlMinifierWorkerClient.initializeHtmlMinifierWorker: Failed to create worker - ${e}`),null}}function Mn(e){c.setFeatureGateManager(e)}}(),copyPasteInfra=o}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/copyPasteInfra.min.js.map/775acb799ad53c5fb29c041b5397df46/copyPasteInfra.min.js.map