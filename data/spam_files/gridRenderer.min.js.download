!function(){var e={179:function(e,t,n){"use strict";n.d(t,{$E:function(){return c},EW:function(){return C},Il:function(){return h},JA:function(){return r},KJ:function(){return f},Kz:function(){return v},Mu:function(){return R},My:function(){return S},NU:function(){return s},Nn:function(){return w},OD:function(){return u},Q7:function(){return d},TA:function(){return y},ay:function(){return m},ig:function(){return l},nV:function(){return T},qw:function(){return p},rh:function(){return g},v2:function(){return a},xc:function(){return I},xv:function(){return i}});var o=n(244);function r(e,t){return e?e+"."+t:t}function i(e,t,n,i,l){void 0===l&&(l=4),i&&e.push((0,o.m9)("".concat(r(t,n)),i,l))}function l(e,t,n,i){"boolean"==typeof i&&e.push((0,o.LK)("".concat(r(t,n)),i))}function s(e,t,n,i){if("number"==typeof i){var l=Math.round(i);e.push((0,o.Ug)("".concat(r(t,n)),l))}}function a(e,t,n,i){"number"==typeof i&&e.push((0,o.ip)("".concat(r(t,n)),i))}function c(e,t,n,i){i&&e.push((0,o.k)("".concat(r(t,n)),i))}var u,d={getFields:function(e){var t="Activity.Result",n=[];return s(n,t,"Code",e.code),i(n,t,"Type",e.type),s(n,t,"Tag",e.tag),l(n,t,"IsExpected",e.isExpected),n.push((0,o.m9)("zC.Activity.Result","Office.System.Result")),n}},h={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return i(n,t,"CV",e.cV),s(n,t,"Duration",e.duration),s(n,t,"Count",e.count),s(n,t,"AggMode",e.aggMode),l(n,t,"Success",e.success),e.result&&n.push.apply(n,d.getFields(e.result)),n.push((0,o.m9)("zC.Activity",this.contractName)),n}},f={getFields:function(e){var t="User",n=[];return i(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(n,t,"TenantId",e.tenantId,1),i(n,t,"TenantGroup",e.tenantGroup,1),l(n,t,"IsAnonymous",e.isAnonymous),l(n,t,"IsSignedIn",e.isSignedIn),i(n,t,"TelemetryRegion",e.telemetryRegion),n}},g={getFields:function(e,t){var n=[];return i(n,e,"Name",t.name),i(n,e,"State",t.state),n}},m={getFields:function(e){var t="UserAction",n=[];return s(n,t,"Id",e.id),i(n,t,"Name",e.name),i(n,t,"CommandSurface",e.commandSurface),i(n,t,"ParentName",e.parentName),i(n,t,"TriggerMethod",e.triggerMethod),s(n,t,"TimeOffsetMs",e.timeOffsetMs),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.Mac="Mac",e.iOS="iOS",e.Android="Android"}(u||(u={}));var C,p={getFields:function(e){var t="App",n=[];return i(n,t,"Name",e.name,1),i(n,t,"Platform",e.platform,1),i(n,t,"Version",e.version,1),n}},w={getFields:function(e){var t="Session",n=[];return i(n,t,"Id",e.id,1),i(n,t,"EcsETag",e.ecsETag,1),n}},S={getFields:function(e){var t=[];return t.push((0,o.m9)("Pillar",e.pillar)),t.push((0,o.m9)("Veto",e.veto)),t.push((0,o.LK)("IsIntentional",e.isIntentional)),t.push((0,o.LK)("IsInternal",e.isInternal)),t.push((0,o.LK)("AlertOnPillar",e.alertOnPillar)),t.push((0,o.LK)("IsSessionEndingError",e.isSessionEndingError)),l(t,void 0,"InStaging",e.inStaging),t}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(C||(C={}));var y,R,T,I,v={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t,n,r,s,a,c,u="Copilot";(c=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",c.IsSeen="IsSeen",c.IsTried="IsTried",c.IsKept="IsKept",c.IsRejected="IsRejected",c.IsAutonomousRun="IsAutonomousRun",(a=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",a.Commanding="Commanding",a.QAandSummaries="QA and Summaries",a.Collaboration="Collaboration",a.Suggestions="Suggestions",(s=e.EntryPoint||(e.EntryPoint={})).BizChat="BizChat",s.Chat="Chat",s.Canvas="Canvas",s.SuggestionsPane="Suggestions Pane",s.Backstage="Backstage",(r=e.Verb||(e.Verb={})).Create="Create",r.Command="Command",r.Ask="Ask",r.Summarize="Summarize",r.Share="Share",r.Analyze="Analyze",(n=e.ActionOrigin||(e.ActionOrigin={})).Ribbon="Ribbon",n.Skittle="Skittle",n.Handoffs="Handoffs",n.TopOfDoc="TopOfDoc",n.ContextMenu="ContextMenu",n.FirstRunExperience="FirstRunExperience",n.Nudges="Nudges",n.AIRibbon="AIRibbon",n.CopilotLab="CopilotLab",n.Formula="Formula",(t=e.FeatureClass||(e.FeatureClass={})).Reactive="Reactive",t.Proactive="Proactive",t.Autonomous="Autonomous",e.getFields=function(e){var t=[];return i(t,u,"FeatureActionType",e.featureActionType),l(t,u,"IsUserInitiated",e.isUserInitiated),i(t,u,"FeatureName",e.featureName),i(t,u,"SubFeatureName",e.subFeatureName),i(t,u,"Capability",e.capability),l(t,u,"IsThumbsUp",e.isThumbsUp),i(t,u,"EntryPoint",e.entryPoint),i(t,u,"Verb",e.verb),i(t,u,"InteractionId",e.interactionId),i(t,u,"ConversationId",e.conversationId),i(t,u,"ActionOrigin",e.actionOrigin),i(t,u,"FeatureClass",e.featureClass),t.push((0,o.m9)("zC.".concat(u),"Office.System.Copilot")),t}}(y||(y={})),function(e){var t,n="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return i(t,n,"EventType",e.eventType),i(t,n,"Pillar",e.pillar),i(t,n,"Scenario",e.scenario),i(t,n,"Veto",e.veto),i(t,n,"Error",e.error),l(t,n,"InStaging",e.inStaging),l(t,n,"IsSessionEndingError",e.isSessionEndingError),l(t,n,"IsIntentional",e.isIntentional),l(t,n,"IsInternal",e.isInternal),t.push((0,o.m9)("zC.".concat(n),"Office.System.Asha")),t}}(R||(R={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,o.m9)("".concat(e,".Name"),t.name)),void 0!==t.platform&&n.push((0,o.m9)("".concat(e,".Platform"),t.platform)),void 0!==t.version&&n.push((0,o.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push((0,o.m9)("".concat(e,".SessionId"),t.sessionId)),void 0!==t.immediateHost&&n.push((0,o.m9)("".concat(e,".ImmediateHost"),t.immediateHost)),void 0!==t.subModuleName&&n.push((0,o.m9)("".concat(e,".SubModuleName"),t.subModuleName)),void 0!==t.context&&n.push((0,o.m9)("".concat(e,".Context"),t.context)),void 0!==t.referrer&&n.push((0,o.m9)("".concat(e,".Referrer"),t.referrer)),n}}(T||(T={})),function(e){var t="ContentIdentifier";e.getFields=function(e){var n=[];return n.push((0,o.m9)("".concat(t,".ContentType"),e.contentType)),n.push((0,o.m9)("".concat(t,".ContentId"),e.contentId)),void 0!==e.subContentType&&n.push((0,o.m9)("".concat(t,".SubContentType"),e.subContentType)),void 0!==e.subContentId&&n.push((0,o.m9)("".concat(t,".SubContentId"),e.subContentId)),n.push((0,o.m9)("zC.".concat(t),"Office.System.ContentIdentifier")),n}}(I||(I={}))},244:function(e,t,n){"use strict";function o(e,t,n){return a(e,1,t,n)}function r(e,t,n){return a(e,2,t,n)}function i(e,t,n){return a(e,3,t,n)}function l(e,t,n){return a(e,0,t,n)}function s(e,t,n){return a(e,4,t,n)}function a(e,t,n,o){return{name:e,dataType:t,value:n,classification:o||4}}n.d(t,{LK:function(){return o},Ug:function(){return r},ip:function(){return i},k:function(){return s},m9:function(){return l}})},842:function(e,t,n){"use strict";n.r(t),n.d(t,{Activity:function(){return R.Il},App:function(){return R.qw},Asha:function(){return R.Mu},AudienceGroup:function(){return R.EW},CV:function(){return Q},ContentIdentifier:function(){return R.xc},Contracts:function(){return h},Copilot:function(){return R.TA},CopilotContractBuilder:function(){return Z},EnumObjects:function(){return J},Funnel:function(){return R.rh},HealthQosError:function(){return R.My},IDEAs:function(){return V},Module:function(){return R.nV},Platform:function(){return R.OD},Release:function(){return R.Kz},Result:function(){return R.Q7},Session:function(){return R.Nn},SimpleTelemetryLogger:function(){return j},SpecializedTelemetryLogger:function(){return te},SuppressNexus:function(){return z},TelemetryLogger:function(){return ee},TraceContext:function(){return ye},TraceFlags:function(){return K},TraceParent:function(){return Ce},TraceState:function(){return de},User:function(){return R.KJ},UserAction:function(){return R.ay},addBooleanDataField:function(){return R.ig},addDoubleDataField:function(){return R.v2},addGuidDataField:function(){return R.$E},addInt64DataField:function(){return R.NU},addStringDataField:function(){return R.xv},cloneEvent:function(){return G},createTraceContext:function(){return Te},getCurrentMilliseconds:function(){return U},getEffectiveEventFlags:function(){return ne},getFields:function(){return Y},getFullFieldName:function(){return R.JA},logError:function(){return A},logNotification:function(){return M},makeBooleanDataField:function(){return d.LK},makeDoubleDataField:function(){return d.ip},makeGuidDataField:function(){return d.k},makeInt64DataField:function(){return d.Ug},makeStringDataField:function(){return d.m9},onNotification:function(){return D},parseTraceContext:function(){return Re},sendHealthQosError:function(){return oe}});var o,r,i,l,s,a,c,u,d=n(244);!function(e){e.getFields=function(e,t){var n=[];return n.push((0,d.Ug)("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push((0,d.m9)("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push((0,d.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push((0,d.LK)("".concat(e,".IsExpected"),t.isExpected)),n.push((0,d.m9)("zC.Activity.Result","Office.System.Result")),n}}(o||(o={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",r=[];return void 0!==t.cV&&r.push((0,d.m9)("".concat(n,".CV"),t.cV)),r.push((0,d.Ug)("".concat(n,".Duration"),t.duration)),r.push((0,d.Ug)("".concat(n,".Count"),t.count)),r.push((0,d.Ug)("".concat(n,".AggMode"),t.aggMode)),void 0!==t.success&&r.push((0,d.LK)("".concat(n,".Success"),t.success)),void 0!==t.result&&r.push.apply(r,o.getFields("".concat(n,".Result"),t.result)),r.push((0,d.m9)("zC.Activity",e.contractName)),r}}(r||(r={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.m9)("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push((0,d.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push((0,d.m9)("".concat(e,".SessionId"),t.sessionId)),n}}(i||(i={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push((0,d.m9)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push((0,d.m9)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push((0,d.m9)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push((0,d.m9)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push((0,d.m9)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push((0,d.LK)("".concat(e,".IsAnonymous"),t.isAnonymous)),void 0!==t.telemetryRegion&&n.push((0,d.m9)("".concat(e,".TelemetryRegion"),t.telemetryRegion)),n}}(l||(l={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,d.m9)("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push((0,d.m9)("".concat(e,".State"),t.state)),n}}(s||(s={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.Ug)("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push((0,d.m9)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push((0,d.m9)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push((0,d.m9)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push((0,d.m9)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push((0,d.Ug)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n}}(a||(a={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,d.m9)("".concat(e,".Name"),t.name)),void 0!==t.platform&&n.push((0,d.m9)("".concat(e,".Platform"),t.platform)),void 0!==t.version&&n.push((0,d.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push((0,d.m9)("".concat(e,".SessionId"),t.sessionId)),void 0!==t.immediateHost&&n.push((0,d.m9)("".concat(e,".ImmediateHost"),t.immediateHost)),n.push((0,d.m9)("zC.".concat(e),"Office.System.Module")),n}}(c||(c={})),(u||(u={})).getFields=function(e,t){var n=[];return n.push((0,d.m9)("".concat(e,".ErrorGroup"),t.errorGroup)),n.push((0,d.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push((0,d.Ug)("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push((0,d.Ug)("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push((0,d.Ug)("".concat(e,".Count"),t.count)),n};var h,f=r,g=o,m=u,C=s,p=i,w=a,S=l,y=c;!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=f,n.Result=g,n.Error=m,n.Funnel=C,n.Host=p,n.User=S,n.UserAction=w,n.Module=y}(h||(h={}));var R=n(179),T=function(e,t){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},T(e,t)};function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var v=function(){return v=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},v.apply(this,arguments)};function b(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}Object.create,Object.create;var x,F=(x=[],{fireEvent:function(e){x.forEach((function(t){return t(e)}))},addListener:function(e){e&&x.push(e)}});function D(){return F}function M(e,t,n){F.fireEvent({level:e,category:t,message:n})}function A(e,t,n){M(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var O={};function B(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?O[e]?(t.ariaTenantToken&&(O[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(O[e].dnmToken=t.dnmToken)):O[e]=t:M(0,0,(function(){return"Namespace: ".concat(e)}))}function k(e,t){for(var n=e.length;n>0;){var o=e.substr(0,n);if(O[o]){var r=O[o];return t.ariaTenantToken=r.ariaTenantToken,t.dnmToken=r.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var P=9007199254740991,E=-P,H=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,L=/^[a-zA-Z0-9_\.]{1,95}$/;function N(e){return L.test(e)}function W(e){e&&e.forEach((function(e){"string"==typeof e.name&&N(e.name)||_("dataField name",e.name,L),2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<E||e>P)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function _(e,t,n,o){throw new Error("Invalid ".concat(e," '").concat(t,"' as it does not match regex ").concat(n)+(o?" or exceeds ".concat(o," chars"):""))}var z=-1;function G(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?v({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var V,j=function(){function e(t,n,o){var r,i,l;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=o||{},this.instanceId=++e.instanceCounter,t&&(this.telemetrySinks=t.telemetrySinks,(r=this.persistentDataFields).push.apply(r,t.persistentDataFields),this.config=v(v({},t.getConfig()),this.config),(i=this.partAFields).push.apply(i,t.partAFields)),n&&(l=this.persistentDataFields).push.apply(l,n)}return e.prototype.addEventContentType=function(e,t){e.push((0,d.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=G(e),n=t.telemetryProperties;n.nexusTenantToken=z;var o=n.ariaTenantToken;o||k(t.eventName,n)||o?this.sendTelemetryEventInternal(t,1):M(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var n=G(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=G(e),n=t.telemetryProperties,o=n.customerContentVersion;return(!o||o>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=G(e),n=t.telemetryProperties;n.dnmToken||k(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):M(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):M(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void A(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else M(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,o,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift((0,d.m9)("OTelJS.Version","4.23.1149")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(o=i.dataFields).push.apply(o,this.partAFields),e.eventContract=i}this.config.disableValidation||function(e){var t;(t=e.eventName)&&!(t.length>98)&&H.test(t)||_("eventName",e.eventName,H,98);var n=e.eventContract;n&&(n.name&&!N(n.name)&&_("eventContract",n.name,L),W(n.dataFields)),W(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var o=n[t],r=o[0],i=o[1];this.sendTelemetryEventInternal(r,i)}},e.prototype.setTenantToken=function(e,t,n){B(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){B(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return G(e)},e.prototype.getConfig=function(){return this.config},e.instanceCounter=0,e}(),U=function(){return(U="object"==typeof self&&"object"==typeof self.performance&&"function"==typeof self.performance.now?function(){return self.performance.now()}:function(){return Date.now()})()},$=function(e){var t,n=U(),o=G(e.telemetryEvent);return v(v({cv:e.parentCv.getNext()},o),{createChildActivity:function(t){return $({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var o,r,i=this;if(!t){void 0===this.success&&void 0===this.result&&M(1,0,(function(){return"Activity does not have success or result set"}));var l=U(),s=Math.floor(1e3*(l-n));t=!0;var a={duration:s,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},c=null!==(r=null===(o=this.eventContract)||void 0===o?void 0:o.dataFields)&&void 0!==r?r:[];return c.push.apply(c,R.Il.getFields(a)),this.eventContract={name:R.Il.contractName,dataFields:c},e.sendTelemetryEvent(this)}M(0,0,(function(){return"'".concat(i.eventName,"' already ended")}))}})};!function(e){var t,n;t=e.Copilot||(e.Copilot={}),n=function(){function e(e){this.contractName="IDEAs.Copilot.UserSuccessRate",this.IsSuccess=e.IsSuccess,this.RAIBlockEncountered=e.RAIBlockEncountered,this.AuthBlockEncountered=e.AuthBlockEncountered,this.UnsupportedFeatureRequested=e.UnsupportedFeatureRequested,this.ClientBlockEncountered=e.ClientBlockEncountered,this.ServiceBlockEncountered=e.ServiceBlockEncountered}return e.prototype.Accept=function(e){e.Visit({name:"IsSuccess",value:this.IsSuccess,type:1}),e.Visit({name:"RAIBlockEncountered",value:this.RAIBlockEncountered,type:1}),e.Visit({name:"AuthBlockEncountered",value:this.AuthBlockEncountered,type:1}),e.Visit({name:"UnsupportedFeatureRequested",value:this.UnsupportedFeatureRequested,type:1}),e.Visit({name:"ClientBlockEncountered",value:this.ClientBlockEncountered,type:1}),e.Visit({name:"ServiceBlockEncountered",value:this.ServiceBlockEncountered,type:1})},e}(),t.UserSuccessRate=n}(V||(V={}));var q,X=function(e,t){return{Visit:function(n){try{if(void 0!==n.value){var o=n.name,r=n.value,i=n.type;switch(i){case 1:(0,R.ig)(e,t,o,r);break;case 0:(0,R.xv)(e,t,o,r);break;case 2:(0,R.NU)(e,t,o,r);break;case 3:(0,R.v2)(e,t,o,r);break;case 4:(0,R.$E)(e,t,o,r);break;default:throw new Error("Invalid type: ".concat(i))}}}catch(e){M(0,0,(function(){return"Error: ".concat(e)}))}}}};function Y(e,t){var n=[];return e.Accept(X(n,t)),n.push((0,d.m9)("zC.".concat(t),e.contractName)),n}var J,K,Q=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),Z=function(){function e(){this.featureActionType=void 0,this.isUserInitiated=void 0,this.featureName=void 0,this.isThumbsUp=void 0,this.entryPoint=void 0,this.subFeatureName=void 0,this.interactionId=void 0,this.conversationId=void 0}return e.Enabled=function(t){var n=new e;return n.featureActionType=R.TA.FeatureActionType.IsEnabled,n.featureName=t,n},e.Seen=function(t){var n=new e;return n.featureActionType=R.TA.FeatureActionType.IsSeen,n.featureName=t,n},e.Kept=function(t,n,o){var r=new e;return r.featureActionType=R.TA.FeatureActionType.IsKept,r.featureName=t,r.interactionId=n,r.conversationId=o,r},e.Rejected=function(t,n,o){var r=new e;return r.featureActionType=R.TA.FeatureActionType.IsRejected,r.featureName=t,r.isUserInitiated=!0,r.interactionId=n,r.conversationId=o,r},e.ThumbsUp=function(t,n,o){var r=new e;return r.featureName=t,r.isUserInitiated=!0,r.isThumbsUp=!0,r.interactionId=n,r.conversationId=o,r},e.ThumbsDown=function(t,n,o){var r=new e;return r.featureName=t,r.isUserInitiated=!0,r.isThumbsUp=!1,r.interactionId=n,r.conversationId=o,r},e.Tried=function(t,n,o,r,i){var l=new e;return l.featureActionType=R.TA.FeatureActionType.IsTried,l.featureName=t,l.isUserInitiated=o,l.entryPoint=r,l.interactionId=n,l.conversationId=i,l},e}(),ee=function(e){function t(t,n,o){var r=e.call(this,t,n,o)||this;return r.baseCv=function(){if(!q){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));q=new Q(e.join(""))}return q}(),r}return I(t,e),t.prototype.createActivity=function(e){return $({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,o){return this.sendTelemetryEvent({eventName:e,eventContract:{name:R.Il.contractName,dataFields:R.Il.getFields(t)},dataFields:n,eventFlags:o})},t.prototype.sendError=function(e){var t=function(e){var t="Error",n=[];return n.push((0,d.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push((0,d.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push((0,d.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push((0,d.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push((0,d.Ug)("".concat(t,".Count"),e.count)),n}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return $({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(j),te=function(e){function t(t,n,o){return e.call(this,t,n,o)||this}return I(t,e),t.prototype.sendCopilotEvent=function(e,t,n,o,r,i){var l=r?b([],r,!0):[];l.push.apply(l,R.TA.getFields(n)),this.sendTelemetryEvent({eventName:e,telemetryProperties:o,eventFlags:v(v({},t),{samplingPolicy:191}),dataFields:l,timestamp:i})},t.prototype.sendCopilotAshaErrorEvent=function(e){var t=e.eventName,n=e.eventFlags,o=e.copilotContractBuilder,r=e.veto,i=e.error,l=e.scenario,s=e.inStaging,a=void 0!==s&&s,c=e.isSessionEndingError,u=void 0!==c&&c,d=e.isIntentional,h=void 0===d||d,f=e.isInternal,g=void 0!==f&&f,m=e.telemetryProperties,C=e.dataFields,p=e.timestamp,w=C?b([],C,!0):[];w.push.apply(w,R.TA.getFields(o)),w.push.apply(w,R.Mu.getFields({eventType:R.Mu.EventType.Error,pillar:void 0,scenario:l,veto:r,error:i,inStaging:a,isSessionEndingError:u,isIntentional:h,isInternal:g})),this.sendTelemetryEvent({eventName:t,telemetryProperties:m,eventFlags:v(v({},n),{samplingPolicy:191}),dataFields:w,timestamp:p})},t.prototype.sendAshaPillarEvent=function(e,t,n,o,r,i,l){var s=i?b([],i,!0):[];s.push.apply(s,R.Mu.getFields({eventType:R.Mu.EventType.Pillar,pillar:n,scenario:o})),this.sendTelemetryEvent({eventName:e,telemetryProperties:r,eventFlags:v(v({},t),{samplingPolicy:194}),dataFields:s,timestamp:l})},t.prototype.sendAshaErrorEvent=function(e){var t=e.eventName,n=e.eventFlags,o=e.veto,r=e.error,i=e.scenario,l=e.inStaging,s=void 0!==l&&l,a=e.isSessionEndingError,c=void 0!==a&&a,u=e.isIntentional,d=void 0===u||u,h=e.isInternal,f=void 0!==h&&h,g=e.telemetryProperties,m=e.dataFields,C=e.timestamp,p=m?b([],m,!0):[];p.push.apply(p,R.Mu.getFields({eventType:R.Mu.EventType.Error,pillar:void 0,scenario:i,veto:o,error:r,inStaging:s,isSessionEndingError:c,isIntentional:d,isInternal:f})),this.sendTelemetryEvent({eventName:t,telemetryProperties:g,eventFlags:v(v({},n),{samplingPolicy:194}),dataFields:p,timestamp:C})},t.prototype.createCopilotTriedActivity=function(e){var t=e.eventName,n=e.eventFlags,o=e.featureName,r=e.interactionId,i=e.isUserInitiated,l=e.entryPoint,s=e.conversationId,a=e.subFeatureName,c=e.telemetryProperties,u=e.dataFields,d=e.timestamp,h=u?b([],u,!0):[];return h.push.apply(h,R.TA.getFields({featureActionType:R.TA.FeatureActionType.IsTried,featureName:o,interactionId:r,isUserInitiated:i,entryPoint:l,conversationId:s,subFeatureName:a,isThumbsUp:void 0})),this.createActivity({eventName:t,telemetryProperties:c,eventFlags:v(v({},n),{samplingPolicy:191}),dataFields:h,timestamp:d})},t}(ee);function ne(e){var t={costPriority:1,samplingPolicy:1,persistencePriority:1,dataCategories:0,diagnosticLevel:100};return e.eventFlags&&e.eventFlags.dataCategories||M(0,0,(function(){return"DataCategories"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}function oe(e,t,n,o,r,i,l,s,a,c,u){o.forEach((function(o){e.sendTelemetryEvent({eventName:t.name+".Qos.Error."+n,eventFlags:{diagnosticLevel:110},dataFields:b(b([],R.My.getFields({veto:o,pillar:r,isIntentional:i,isInternal:l,alertOnPillar:s,isSessionEndingError:a,inStaging:c}),!0),u||[],!0),telemetryProperties:{ariaTenantToken:t.token,nexusTenantToken:z}})}))}!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"},e.QosPillarName={Interruptions:"Interruptions",Open:"Open",Save:"Save",RealTimeCoauth:"RealTimeCoauth",NotebookNavigation:"NotebookNavigation",Fidelity:"Fidelity",AsyncCollab:"AsyncCollab",Present:"Present",ContentConsumption:"ContentConsumption",ContentCreation:"ContentCreation"}}(J||(J={})),function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(K||(K={}));var re="[-_*/0-9a-z]",ie="[a-z]".concat(re,"{0,255}"),le="[0-9a-z]".concat(re,"{0,240}"),se="[a-z]".concat(re,"{0,13}"),ae="".concat(le,"@").concat(se),ce=new RegExp("^(?:".concat(ie,"|").concat(ae,")$")),ue=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,de=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!ce.test(e)||!ue.test(t))return!1;var n=this._listMemberMap;return n.has(e)&&n.delete(e),n.set(e,t),n.size>32&&n.delete(n.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var n=new e,o=t.split(","),r=!0;return o.reverse().forEach((function(e){var t=e.trim();if(t){var o=t.split("=");2===o.length&&n.set(o[0],o[1])||(M(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),r=!1)}})),r?n:void 0},e}(),he=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,fe=function(e){return/^0+$/.test(e)},ge=/^([\da-f]{16})$/,me=16,Ce=function(){function e(e,t,n){void 0===e&&(e=we()),void 0===t&&(t=Se()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){return void 0===e&&(e=K.None),e&K.Sampled}(n)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return he.test(this.serialize())&&!fe(this.traceId)&&!fe(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&K.Sampled)===K.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|K.Sampled:this._traceFlags&~K.Sampled,!0)},e.prototype.updateParentId=function(e){return e?!(!ge.test(e)||fe(e)||(this._parentId=e,0)):(this._parentId=Se(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,n,o){var r=new e(t,n,o);return r.isValid()?r:void 0},e.createNew=function(t){return new e(we(),Se(),t)},e.parse=function(t){var n=he.exec(t);if(n&&"ff"!==n[1]&&("00"!==n[1]||!n[5]))return e.create(n[2],n[3],parseInt(n[4],me))},e}();function pe(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var n=Array.from(t).map((function(e){return(256+e).toString(me).slice(1)})).join("");return fe(n)?n.slice(1)+"1":n}function we(){return pe(16)}function Se(){return pe(8)}var ye=function(){function e(){}return e.getFields=function(e){var t="Event.",n=e.parent,o=e.state,r=o?o.serialize():void 0;return b([(0,d.m9)(t+"TraceId",n.traceId),(0,d.m9)(t+"TraceParentId",n.parentId),(0,d.Ug)(t+"TraceFlags",n.traceFlags)],r?[(0,d.m9)(t+"TraceState",r)]:[],!0)},e}();function Re(e,t){var n=Ce.parse(e);if(n){var o=void 0;return t&&(o=de.parse(t)),o||(o=new de),{parent:n,state:o}}}function Te(e){return{parent:Ce.createNew(e),state:new de}}},517:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AshaError=void 0,function(e){e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty="Augloop response empty",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_CustomCodeAnalyzerNotInitialized="Augloop response empty error - custom code analyzer not initialized",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_FetchCellsInRangeFailed="Augloop response empty error - fetch cells in range failed",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_NoChartTypeRecommendation="Augloop response empty error - no chart type recommendation",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_None="Augloop response empty error - no error code received",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_NoOfficeJsRecommendation="Augloop response empty error - no OfficeJs recommendation",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_NoOfficeJsRecommendationFromLLMs="Augloop response empty error - no OfficeJs recommendation from LLMs",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_UnexpectedErrorCode="Augloop response empty error - unexpected error code received",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Empty_Unknown="Augloop response empty error - unknown",e.Copilot_OnGridChartDesignRecommendations_Augloop_Response_Timed_Out="Augloop response timed out",e.Copilot_OnGridChartDesignRecommendations_Validation_Failed="Validation failed",e.Service_Error_Augloop="Service Error (AugLoop)",e.Multiple_Suggestion_Declines="Multiple Suggestion Declines",e.Formula_Completion_Internal_Error="Cant provide suggestion due to an internal error"}(n||(t.AshaError=n={}))},381:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logStandardizedAshaErrorEvent=function(e,t,n,o=!1){(0,r.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Voice.Copilot.Chat",eventFlags:s,dataFields:l(e,t,n,o)})};const o=n(36),r=n(268),i=n(842);function l(e,t,n,r=!1){const l=function(e){switch(e){case o.TelemetryStandardizedFeature.CleanData:return i.Copilot.Verb.Analyze;case o.TelemetryStandardizedFeature.FormulaByExample:case o.TelemetryStandardizedFeature.OnGridChartDesignRecommendations:case o.TelemetryStandardizedFeature.FormulaCompletion:return i.Copilot.Verb.Create;default:throw new Error("Missing verb map.")}}(n);return e&&t?[...i.Asha.getFields({eventType:i.Asha.EventType.Error,veto:l+" "+n+" "+e,error:t,inStaging:r??!0,scenario:n})]:[]}const s={dataCategories:i.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:i.EnumObjects.SamplingPolicy.CriticalCensus,diagnosticLevel:i.EnumObjects.DiagnosticLevel.RequiredServiceData}},382:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AshaVeto=void 0,function(e){e.Copilot_OnGridChartDesignRecommendations_Augloop_Service_Side_Issue_Prevents_Output="Augloop service side issue prevents output",e.Copilot_OnGridChartDesignRecommendations_Invalid_Suggestions_Prevents_Output="Invalid suggestions prevent output",e.Copilot_OnGridChartDesignRecommendations_Response_Delayed_Or_Timed_Out="Augloop response delayed or timed out",e.Unable_To_Complete_Task="Unable to Complete Task",e.User_Dissatisfied_With_Suggestions="User dissatisfied with suggestions"}(n||(t.AshaVeto=n={}))},36:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryStandardizedFeature=void 0,t.logCopilotEnabledEvent_Deprecated=function(e,t,n){a({featureName:e,actionType:o.Copilot.FeatureActionType.IsEnabled,eventFlags:l,entryPoint:t,interactionId:void 0,uiLanguage:n})},t.logCopilotEnabledEvent=function(e,t){a({featureName:e,actionType:o.Copilot.FeatureActionType.IsEnabled,eventFlags:l,entryPoint:void 0,interactionId:void 0,uiLanguage:t})},t.logCopilotSeenEvent=function(e,t,n){a({featureName:e,actionType:o.Copilot.FeatureActionType.IsSeen,eventFlags:s,entryPoint:t,interactionId:void 0,uiLanguage:n})},t.logCopilotTriedEvent=function(e,t,n,r){a({featureName:e,actionType:o.Copilot.FeatureActionType.IsTried,eventFlags:l,entryPoint:t,interactionId:n,uiLanguage:r})},t.logCopilotKeptEvent=function(e,t,n,r){a({featureName:e,actionType:o.Copilot.FeatureActionType.IsKept,eventFlags:l,entryPoint:t,interactionId:n,uiLanguage:r})},t.logCopilotRejectedEvent=function(e,t,n,r){a({featureName:e,actionType:o.Copilot.FeatureActionType.IsRejected,eventFlags:l,entryPoint:t,interactionId:n,uiLanguage:r})};const o=n(842),r=n(268);var i;!function(e){e.AnalyzeData="AnalyzeData",e.CleanData="CleanData",e.FormulaByExample="FormulaByExample",e.FormulaGeneration="FormulaGeneration",e.CalculatedColumns="CalculatedColumns",e.Commanding="Commanding",e.CopilotChat="CopilotChat",e.CopilotFunction="CopilotFunction",e.ExcelChatHelper="ExcelChatHelper",e.OfficeScripts="OfficeScripts",e.Python="Python",e.Search="Search",e.TableGeneration="Table Generation",e.Answers="Answers",e.FormulaCompletion="FormulaCompletion",e.ChartInsight="ChartInsight",e.InlineNLToFormula="InlineNLToFormula",e.FormulaFix="FormulaFix",e.FormulaExplain="FormulaExplain",e.ExcelAgent="ExcelAgent",e.FormulaUsage="FormulaUsage",e.OnGridChartDesignRecommendations="OnGridChartDesignRecommendations"}(i||(t.TelemetryStandardizedFeature=i={}));const l={dataCategories:o.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:o.EnumObjects.SamplingPolicy.CriticalUsage,diagnosticLevel:o.EnumObjects.DiagnosticLevel.RequiredServiceData},s={dataCategories:o.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:o.EnumObjects.SamplingPolicy.CriticalUsage,diagnosticLevel:o.EnumObjects.DiagnosticLevel.Optional};function a(e){const{featureName:t,actionType:n,eventFlags:i,entryPoint:l,interactionId:s="",uiLanguage:a=""}=e;(0,r.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Voice.Copilot.Chat",eventFlags:i,dataFields:[...o.Copilot.getFields({featureActionType:n,isUserInitiated:!1,featureName:t,entryPoint:l,interactionId:s}),...a?[(0,o.makeStringDataField)("UiLanguage",a)]:[]]})}},470:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryUsageEventKeys=t.TelemetryUsageSource=t.TelemetryUsageActionType=void 0,t.logCopilotUsageEvent=function(e,t,n,i,l,a){const c={eventName:"Office.Voice.ActionAI.Usage",eventFlags:{dataCategories:o.EnumObjects.DataCategories.ProductServicePerformance|o.EnumObjects.DataCategories.ProductServiceUsage,diagnosticLevel:o.EnumObjects.DiagnosticLevel.RequiredServiceData},dataFields:[(0,o.makeStringDataField)(s.FeatureName,e),(0,o.makeStringDataField)(s.ActionType,t),(0,o.makeStringDataField)(s.Source,n),(0,o.makeStringDataField)(s.InteractionId,l??""),(0,o.makeStringDataField)(s.UiLanguage,i??""),...a??[]]};(0,r.getTelemetryLogger)().sendTelemetryEvent(c)};const o=n(842),r=n(268);var i,l,s;!function(e){e.SendPrompt="SendPrompt",e.PromptBoxShown="PromptBoxShown"}(i||(t.TelemetryUsageActionType=i={})),function(e){e.FormulaAutocompletePromptBox="FormulaAutocompletePromptBox"}(l||(t.TelemetryUsageSource=l={})),function(e){e.FeatureName="FeatureName",e.ActionType="ActionType",e.Source="Source",e.InteractionId="InteractionId",e.UiLanguage="UiLanguage",e.Duration="Duration"}(s||(t.TelemetryUsageEventKeys=s={}))},233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(533);o.__exportStar(n(517),t),o.__exportStar(n(381),t),o.__exportStar(n(382),t),o.__exportStar(n(36),t),o.__exportStar(n(470),t)},883:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},958:function(e,t){"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGatesManagerSet=t.isChangeGateEnabled=t.setChangeGatesManager=void 0,t.setChangeGatesManager=e=>{n=e},t.isChangeGateEnabled=e=>!n||n.isChangeGateEnabled(e),t.isChangeGatesManagerSet=()=>!!n},582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(533);o.__exportStar(n(958),t),o.__exportStar(n(883),t)},134:function(e,t){"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){return n()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},53:function(e,t){"use strict";function n(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=n(e),r=n(t);let i=[];for(let e=0;e<=r.length;++e)i[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let n=1;n<=r.length;++n)t[n]=o[e-1]===r[n-1]?i[n-1]:1+Math.min(i[n],i[n-1],t[n-1]);i=t}return i[r.length]}},510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=i,t.getStringFeatureGate=l,t.getBooleanFeatureGate=function(e,t){const n=l(e)?.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){const n=l(e)?.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;const o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const n=l(e)?.trim();if(void 0===n)return t;const o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=n(53),r={};function i(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function l(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return i()[e]??t;const n=i();if(Object.hasOwn(n,e))return n[e]??t;const r=globalThis.__office_online_feature_gates_verbose_log_callback;r(`Failed lookup for FeatureGate ${e}...`);const l=[],s=e.toLowerCase();for(const e of Object.keys(n))(0,o.editDistance)(e.toLowerCase(),s)<=4&&l.push(e);return l.length>0&&r(`Potential candidates found (edit distance <= 4, case-insensitive): [${l.join(", ")}]`),r(`FeatureGate override not found, returning default: ${t}`),t}},462:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(533);o.__exportStar(n(510),t),o.__exportStar(n(753),t),o.__exportStar(n(134),t),o.__exportStar(n(290),t),o.__exportStar(n(662),t),o.__exportStar(n(318),t)},753:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const n=e[t];switch(typeof n){case"boolean":return(0,o.getBooleanFeatureGate)(t,n);case"number":return(0,o.getNumberFeatureGate)(t,n);case"string":return(0,o.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}};const o=n(510)},290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=n(134)},662:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=r,t.overrideTypedChangeGates=function(e,t){return r(t)};const o=n(134);function r(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=r,t.overrideTypedFeatureGates=function(e,t){return r(t)};const o=n(510);function r(e){const t={};for(const n of Object.keys(e))t[n]=e[n]?.toString();const n=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...n(),...t}))),n}},991:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTelemetryLogger=function(e){globalThis[r]=e},t.getTelemetryLogger=function(){var e;return(e=globalThis)[r]??(e[r]=new o.TelemetryLogger)};const o=n(842),r=Symbol.for("otel_util_telemetry_logger")},746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertDataFields=function(e){let t=!0;const n=[];return e.forEach((e=>{const r=e.classification;if(r===o.EnumObjects.DataClassification.SystemMetadata||r===o.EnumObjects.DataClassification.EssentialServiceMetadata){const t={name:e.name,bool:null,string:null,double:null,int64:null,date:null,contract:null};switch(e.dataType){case o.EnumObjects.DataFieldType.Boolean:t.bool=e.value;break;case o.EnumObjects.DataFieldType.Double:t.double=e.value;break;case o.EnumObjects.DataFieldType.Int64:t.int64=e.value;break;case o.EnumObjects.DataFieldType.String:t.string=e.value;break;case o.EnumObjects.DataFieldType.Guid:default:return}n.push(t)}else t=!1})),t?n:[]};const o=n(533).__importStar(n(842))},268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(533);o.__exportStar(n(746),t),o.__exportStar(n(991),t)},533:function(e,t,n){"use strict";n.r(t),n.d(t,{__addDisposableResource:function(){return P},__assign:function(){return i},__asyncDelegator:function(){return b},__asyncGenerator:function(){return v},__asyncValues:function(){return x},__await:function(){return I},__awaiter:function(){return g},__classPrivateFieldGet:function(){return O},__classPrivateFieldIn:function(){return k},__classPrivateFieldSet:function(){return B},__createBinding:function(){return C},__decorate:function(){return s},__disposeResources:function(){return H},__esDecorate:function(){return c},__exportStar:function(){return p},__extends:function(){return r},__generator:function(){return m},__importDefault:function(){return A},__importStar:function(){return M},__makeTemplateObject:function(){return F},__metadata:function(){return f},__param:function(){return a},__propKey:function(){return d},__read:function(){return S},__rest:function(){return l},__runInitializers:function(){return u},__setFunctionName:function(){return h},__spread:function(){return y},__spreadArray:function(){return T},__spreadArrays:function(){return R},__values:function(){return w},default:function(){return L}});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)};function l(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function s(e,t,n,o){var r,i=arguments.length,l=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(i<3?r(l):i>3?r(t,n,l):r(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l}function a(e,t){return function(n,o){t(n,o,e)}}function c(e,t,n,o,r,i){function l(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,a=o.kind,c="getter"===a?"get":"setter"===a?"set":"value",u=!t&&e?o.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),h=!1,f=n.length-1;f>=0;f--){var g={};for(var m in o)g[m]="access"===m?{}:o[m];for(var m in o.access)g.access[m]=o.access[m];g.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(l(e||null))};var C=(0,n[f])("accessor"===a?{get:d.get,set:d.set}:d[c],g);if("accessor"===a){if(void 0===C)continue;if(null===C||"object"!=typeof C)throw new TypeError("Object expected");(s=l(C.get))&&(d.get=s),(s=l(C.set))&&(d.set=s),(s=l(C.init))&&r.unshift(s)}else(s=l(C))&&("field"===a?r.unshift(s):d[c]=s)}u&&Object.defineProperty(u,o.name,d),h=!0}function u(e,t,n){for(var o=arguments.length>2,r=0;r<t.length;r++)n=o?t[r].call(e,n):t[r].call(e);return o?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t,n,o){return new(n||(n=Promise))((function(r,i){function l(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}a((o=o.apply(e,t||[])).next())}))}function m(e,t){var n,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(l=0)),l;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,o=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){l.label=s[1];break}if(6===s[0]&&l.label<r[1]){l.label=r[1],r=s;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(s);break}r[2]&&l.ops.pop(),l.trys.pop();continue}s=t.call(e,l)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var C=Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||C(t,e,n)}function w(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)l.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return l}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function R(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],l=0,s=i.length;l<s;l++,r++)o[r]=i[l];return o}function T(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function I(e){return this instanceof I?(this.v=e,this):new I(e)}function v(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),i=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(e){r[e]&&(o[e]=function(t){return new Promise((function(n,o){i.push([e,t,n,o])>1||s(e,t)}))})}function s(e,t){try{(n=r[e](t)).value instanceof I?Promise.resolve(n.value.v).then(a,c):u(i[0][2],n)}catch(e){u(i[0][3],e)}var n}function a(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:I(e[o](t)),done:!1}:r?r(t):t}:r}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=w(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}function F(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var D=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&C(t,e,n);return D(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function O(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function B(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n}function k(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function P(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose]}if("function"!=typeof o)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:o,async:n})}else n&&e.stack.push({async:!0});return t}var E="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var o=new Error(n);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function H(e){function t(t){e.error=e.hasError?new E(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var o=e.stack.pop();try{var r=o.dispose&&o.dispose.call(o.value);if(o.async)return Promise.resolve(r).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const L={__extends:r,__assign:i,__rest:l,__decorate:s,__param:a,__metadata:f,__awaiter:g,__generator:m,__createBinding:C,__exportStar:p,__values:w,__read:S,__spread:y,__spreadArrays:R,__spreadArray:T,__await:I,__asyncGenerator:v,__asyncDelegator:b,__asyncValues:x,__makeTemplateObject:F,__importStar:M,__importDefault:A,__classPrivateFieldGet:O,__classPrivateFieldSet:B,__classPrivateFieldIn:k,__addDisposableResource:P,__disposeResources:H}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";n.r(o),n.d(o,{gridRenderer:function(){return t},rumShepherd:function(){return e}});var e={};n.r(e),n.d(e,{AppLoadMetricReportEventName:function(){return R},FUNCTIONALLY_READY:function(){return c},RumShepherdFactoryGlobal:function(){return gt},SubComponentInitEventName:function(){return S},SubComponentSetLoadStateEventName:function(){return y},VISUALLY_PERCEIVED:function(){return u},VISUALLY_READY:function(){return a},dispatchRumShepherdEvent:function(){return v},setupDefaultRumShepherd:function(){return ht}});var t={};n.r(t),n.d(t,{CanvasRendererFactory:function(){return _D},CanvasRendererFactoryGlobal:function(){return zD},CanvasRendererGlobals:function(){return KO},CanvasServiceSettings:function(){return St},FontEndPoint:function(){return Rt},FontLoadState:function(){return mt},GridCanvasRenderer:function(){return xx},LoadStatus:function(){return Ct},MessageLevel:function(){return pt},StaticImages:function(){return wt},TableSelectorType:function(){return yt},UnavailabilityToast:function(){return ZO},UnavailabilityToastFactory:function(){return eB},UnavailabilityToastManager:function(){return rB},toastElementId:function(){return QO}});const r="stable-interactivity",i="first-input",l="first-interaction",s="first-idle",a="visually-ready",c="functionally-ready",u="visually-perceived";var d,h;function f(){const e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function g(){const e=window.performance;return e&&e.now?e.now():(new Date).getDate()-f()}function m(){const e=window.performance;return e&&e.now?f()+e.now():(new Date).getDate()}function C(e){return f()+e}(h=d||(d={}))[h.Error=10]="Error",h[h.Warning=15]="Warning",h[h.Important=20]="Important",h[h.Info=50]="Info",h[h.Verbose=100]="Verbose",h[h.Spam=200]="Spam";let p=[];function w(e,t,n,o){const r=`[rum:${Number(g().toFixed())}]${t} ${n?JSON.stringify(n):""}`;p.push({level:e,message:r}),o&&function(){const e={traces:[...p]};p=[],v(T,e)}()}const S="Wac-SubComponentsInit",y="Wac-SubComponentSetLoadState",R="Wac-AppLoadMetricReport",T="Wac-AppLoadTrace",I="Wac-ReportMetricOnDemand",v=(e,t)=>{try{const n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)}catch(e){w(d.Error,"dispatchRumShepherdEvent failed with exception:",e)}};class b{getBooleanSetting(e,t){const n=this._settings[e];if(!n)return t;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return t}}getStringSetting(e,t){return this._settings[e]||t}getIntSetting(e,t){const n=this._settings[e];return n?parseInt(n,10):t}constructor(e){this._settings=e??{}}}let x;const F={getBooleanSetting:(e,t)=>t,getStringSetting:(e,t)=>t,getIntSetting:(e,t)=>t},D=()=>x||(w(d.Error,"getSettingsManager: settingsManager is not initialized"),F);function M(e){return e===a||e===c||e===u}function A(e,t){const n=D(),o=n.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1)&&n.getBooleanSetting("NonReportingComponentFix",!1);for(const n in e){const r=e[n];if(!(r.states[t]?.final||o&&B(r)))return!1}return!0}function O(e,t){return t&&e&&M(t)&&e.states[t]}function B(e){return Object.values(e.subComponents).every((e=>e.nonReporting))}function k(e){return e?{...e}:{}}function P(e){const t=[];for(const n in e){const o=e[n];t.push({id:o.id,rootElementId:o.rootElementId,subComponents:H(o.subComponents)})}return t}function E(e){const t=[];for(const n in e){const o=e[n];t.push({id:o.id,rootElementId:o.rootElementId,subComponents:L(o.subComponents)})}return t}function H(e){const t=[];for(const n in e){const o=e[n];o.nonReporting||t.push({id:o.id,initTime:C(o.initTime),optional:o.optional,unused:o.unused,nonReporting:o.nonReporting,states:N(o.states)})}return t}function L(e){const t=[];for(const n in e){const o=e[n];o.nonReporting&&t.push({id:o.id,initTime:C(o.initTime),optional:o.optional,unused:o.unused,nonReporting:o.nonReporting,states:N(o.states)})}return t}function N(e){const t={};for(const n in e){const o=e[n];o?.time&&(t[n]=C(o.time))}return t}function W(e,t){const n=e.subComponents;for(const e in n){const o=n[e];if(!(o.states[t]||o.unused||o.nonReporting))return!1}return!0}function _(e){let t=Number.POSITIVE_INFINITY;for(const n in e.subComponents){const o=e.subComponents[n];t=Math.min(t,o.initTime)}return t}function z(e,t,n){if(!e||!t)return!1;const o=e.subComponents;for(const e in o)if(!G(o[e],t,n))return!1;return!0}function G(e,t,n){if(!e)return!1;const o=e.states[t];return n?e.optional&&!o?.time||o?.time&&o.promotedFromPreviousState:e.optional||o?.time&&o.promotedFromPreviousState}function V(e,t){return t===a&&O(e,u)}function j(e,t){return{start:e.start,time:t??e.time,error:e.error,monitor:e.monitor,measures:k(e.measures),data:k(e.data)}}function U(e,t,n,o){"then"in e?e.then((e=>{o(e)})).catch((e=>{const r=`Error in invokeMonitor [${n}}]`;w(d.Error,r,e),o({start:t,time:t,monitor:"",error:`${r}: ${e}`})})):o(e)}class ${get timeout(){return this.timeoutInMs}get reason(){return this._reason}set onCancelled(e){this._onCancelled=e}constructor(e){this.timeoutInMs=e,this._reason="",this._cancel=e=>{this._reason||(this._reason=e?"timeout":"cancelled",this._onCancelled&&this._onCancelled())},this.cancel=()=>{this._cancel(!1)},e>0&&window.setTimeout((()=>this._cancel(!0)),e)}}function q(e){return new $(e??0)}class X{get tabHideTime(){return this._firstTabHiddenTime}get metrics(){return this._metrics}startMonitors(e,t){w(d.Verbose,"startMonitors",{appState:e});const n=(e,n)=>{if(w(d.Verbose,"onCompleteWithInputCheck",{metric:e}),n){if(!n.error){const e=this._metrics[i]?this._metrics[i].time:0,t=this._metrics[l]?this._metrics[l].time:0;e>0&&e<n.time&&(0===t||e<=t)&&(n.error="first-input"),t>0&&t<n.time&&(n.error="first-interaction")}t(e,n)}};e===a&&(this.monitorMetric(i,t),this.monitorMetric(l,t),this.monitorMetric(s,n),this.monitorMetric(r,n,12e4))}cancelMonitors(e){if(e!==a)return;w(d.Info,"cancelAppStateMonitors",e);const t=e=>{this._monitoredMetrics[e]?.cancel(),this._monitoredMetrics[e]=void 0,this._metrics[e]=void 0};t(r),t(s)}monitorMetric(e,t,n){if(w(d.Verbose,"monitorMetric",e),this._monitoredMetrics[e])return void w(d.Verbose,"monitorMetric:already-running",e);const o=q(n);this._monitoredMetrics[e]=o;const r=g();U((0,this._shepherdInit.monitors[e])(r,o),r,e,(n=>{w(d.Verbose,"monitorMetric:complete",e),t(e,n)}))}constructor(e){this._metrics={},this._monitoredMetrics={},this._firstTabHiddenTime=0,this._shepherdInit=e,function(e){let t="hidden"===document.visibilityState?0:1/0;e(t),document.addEventListener("visibilitychange",(n=>{t=Math.min(t,n.timeStamp),e(t)}),{once:!0})}((e=>this._firstTabHiddenTime=e))}}let Y=!1;const J=e=>{if(!Y)return;const t=new CustomEvent("Wac-RumShepherd-ComponentUpdate",{detail:e});self.dispatchEvent(t)};function K(e,t,n,o){J({kind:"setComponentState",component:e.id,metric:t,state:n.error?{kind:"error"}:{kind:"ready",time:n.time}}),e.states[t]=o?{...e.states[t]??{},result:j(n),final:W(e,t)}:{result:j(n),monitoring:void 0,final:W(e,t)}}function Q(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function Z(e){return Q()&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}const ee=[];let te,ne=0,oe=0,re=0,ie=0,le=0,se=0;const ae=e=>{for(const t of e){if(t.hadRecentInput||0===t.value)continue;const e=[];t.sources?.forEach((t=>{let n={};var o;t.node&&t.node instanceof HTMLElement&&(n={node:t.node.nodeName,data:Object.keys(t.node.dataset).length>0?t.node.dataset:(o=t.node,o instanceof Element?Object.fromEntries(Array.from(o.attributes,(e=>[e.name,e.value])).filter((([e])=>!e.includes("aria")&&!e.includes("title")))):{})}),n.previousRect=t.previousRect.toJSON(),n.currentRect=t.currentRect.toJSON(),e.push(n)})),ee.push({score:t.value,startTime:t.startTime,sourceData:e}),0===re&&(re=t.startTime),ie=t.startTime,ne+=t.value,oe+=t.value,le+=1,se+=1}},ce=e=>{if(!te)return;const t=e.detail.metric;t===a?ue("TTVR"):t===c&&(ue("TTFR"),window.setTimeout((()=>{window.removeEventListener(R,ce),ue("PostFR"),te?.disconnect(),te=void 0}),5e3))},ue=e=>{te&&(ae(te.takeRecords()),w(d.Important,`CLS_${e}`,{cumulativeLayoutShiftScore:ne,totalCumulativeLayoutShiftScore:oe,firstLayoutShiftTime:re,lastLayoutShiftTime:ie,shiftCount:le,totalShiftCount:se,perFrameLayoutShiftData:JSON.stringify(ee)}),de())},de=()=>{ne=0,re=0,ie=0,le=0,ee.length=0};var he,fe=-1,ge=function(e){addEventListener("pageshow",(function(t){t.persisted&&(fe=t.timeStamp,e(t))}),!0)},me=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Ce=function(){var e=me();return e&&e.activationStart||0},pe=function(e,t){var n=me(),o="navigate";return fe>=0?o="back-forward-cache":n&&(document.prerendering||Ce()>0?o="prerender":document.wasDiscarded?o="restore":n.type&&(o=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:o}},we=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var o=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return o.observe(Object.assign({type:e,buffered:!0},n||{})),o}}catch(e){}},Se=function(e,t,n,o){var r,i;return function(l){t.value>=0&&(l||o)&&((i=t.value-(r||0))||void 0===r)&&(r=t.value,t.delta=i,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},ye=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},Re=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},Te=function(e){var t=!1;return function(){t||(e(),t=!0)}},Ie=-1,ve=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},be=function(e){"hidden"===document.visibilityState&&Ie>-1&&(Ie="visibilitychange"===e.type?e.timeStamp:0,Fe())},xe=function(){addEventListener("visibilitychange",be,!0),addEventListener("prerenderingchange",be,!0)},Fe=function(){removeEventListener("visibilitychange",be,!0),removeEventListener("prerenderingchange",be,!0)},De=function(){return Ie<0&&(Ie=ve(),xe(),ge((function(){setTimeout((function(){Ie=ve(),xe()}),0)}))),{get firstHiddenTime(){return Ie}}},Me=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},Ae=[1800,3e3],Oe=function(e,t){t=t||{},Me((function(){var n,o=De(),r=pe("FCP"),i=we("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(i.disconnect(),e.startTime<o.firstHiddenTime&&(r.value=Math.max(e.startTime-Ce(),0),r.entries.push(e),n(!0)))}))}));i&&(n=Se(e,r,Ae,t.reportAllChanges),ge((function(o){r=pe("FCP"),n=Se(e,r,Ae,t.reportAllChanges),ye((function(){r.value=performance.now()-o.timeStamp,n(!0)}))})))}))},Be=[.1,.25],ke=0,Pe=1/0,Ee=0,He=function(e){e.forEach((function(e){e.interactionId&&(Pe=Math.min(Pe,e.interactionId),Ee=Math.max(Ee,e.interactionId),ke=Ee?(Ee-Pe)/7+1:0)}))},Le=function(){return he?ke:performance.interactionCount||0},Ne=function(){"interactionCount"in performance||he||(he=we("event",He,{type:"event",buffered:!0,durationThreshold:0}))},We=[],_e=new Map,ze=0,Ge=[],Ve=function(e){if(Ge.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=We[We.length-1],n=_e.get(e.interactionId);if(n||We.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var o={id:e.interactionId,latency:e.duration,entries:[e]};_e.set(o.id,o),We.push(o)}We.sort((function(e,t){return t.latency-e.latency})),We.length>10&&We.splice(10).forEach((function(e){return _e.delete(e.id)}))}}},je=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=Te(e),"hidden"===document.visibilityState?e():(n=t(e),Re(e)),n},Ue=[200,500],$e=[2500,4e3],qe={},Xe=[800,1800],Ye=function e(t){document.prerendering?Me((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Je=function(e,t){t=t||{};var n=pe("TTFB"),o=Se(e,n,Xe,t.reportAllChanges);Ye((function(){var r=me();r&&(n.value=Math.max(r.responseStart-Ce(),0),n.entries=[r],o(!0),ge((function(){n=pe("TTFB",0),(o=Se(e,n,Xe,t.reportAllChanges))(!0)})))}))};new Date;const Ke=e=>{e&&w(d.Important,`WebVitals.${e.name}`,{value:e.value,delta:e.delta},!0)},Qe=()=>{!function(e,t){t=t||{},Oe(Te((function(){var n,o=pe("CLS",0),r=0,i=[],l=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=i[0],n=i[i.length-1];r&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(r+=e.value,i.push(e)):(r=e.value,i=[e])}})),r>o.value&&(o.value=r,o.entries=i,n())},s=we("layout-shift",l);s&&(n=Se(e,o,Be,t.reportAllChanges),Re((function(){l(s.takeRecords()),n(!0)})),ge((function(){r=0,o=pe("CLS",0),n=Se(e,o,Be,t.reportAllChanges),ye((function(){return n()}))})),setTimeout(n,0))})))}(Ke),function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},Me((function(){var n;Ne();var o,r=pe("INP"),i=function(e){je((function(){e.forEach(Ve);var t=function(){var e=Math.min(We.length-1,Math.floor((Le()-ze)/50));return We[e]}();t&&t.latency!==r.value&&(r.value=t.latency,r.entries=t.entries,o())}))},l=we("event",i,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});o=Se(e,r,Ue,t.reportAllChanges),l&&(l.observe({type:"first-input",buffered:!0}),Re((function(){i(l.takeRecords()),o(!0)})),ge((function(){ze=Le(),We.length=0,_e.clear(),r=pe("INP"),o=Se(e,r,Ue,t.reportAllChanges)})))})))}(Ke),Oe(Ke),function(e,t){t=t||{},Me((function(){var n,o=De(),r=pe("LCP"),i=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<o.firstHiddenTime&&(r.value=Math.max(e.startTime-Ce(),0),r.entries=[e],n())}))},l=we("largest-contentful-paint",i);if(l){n=Se(e,r,$e,t.reportAllChanges);var s=Te((function(){qe[r.id]||(i(l.takeRecords()),l.disconnect(),qe[r.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return je(s)}),{once:!0,capture:!0})})),Re(s),ge((function(o){r=pe("LCP"),n=Se(e,r,$e,t.reportAllChanges),ye((function(){r.value=performance.now()-o.timeStamp,qe[r.id]=!0,n(!0)}))}))}}))}(Ke),Je(Ke)};class Ze{reportMetricOnDemand(e){w(d.Info,"reportMetricOnDemand",{metric:e}),this._reportMetricInternal(e,!0)}ProcessUnusedComponentFinal(e){for(const t in e.states){const n=t,o=e.states[n];!o.final&&W(e,n)&&(w(d.Verbose,"processSubComponentUnused:unused-final",{component:e.id,state:n}),o.final=!0,this._reportAppStateIfReady(n))}}addSubComponents(e){if(!(e&&e.component&&e.subComponents))return void w(d.Error,"Invalid data",e,this._flushTraceOnErrorEnabled);const t=this._components[e.component];if(!t)return void w(d.Error,"Invalid component",e,this._flushTraceOnErrorEnabled);const n=t.ignoreNewSubComponents;if(function(e){for(const t in e.states)if(e.states[t].final)return!1;return!0}(t)||n){w(d.Verbose,"addSubComponents",{ignore:n,data:e});try{const o=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents];for(let e=0;e<o.length;e+=1)this._addSubComponent(t,o[e],n,!1,!1);if(e.optionalSubComponents)for(let o=0;o<e.optionalSubComponents.length;o+=1)this._addSubComponent(t,e.optionalSubComponents[o],n,!0,!1);if(e.nonReportingSubComponents)for(let o=0;o<e.nonReportingSubComponents.length;o+=1)this._addSubComponent(t,e.nonReportingSubComponents[o],n,!0,!0)}catch(e){w(d.Error,"addSubComponents",e,this._flushTraceOnErrorEnabled)}}else w(d.Error,"Component cannot be modified",e,this._flushTraceOnErrorEnabled)}setSubComponentState(e){const t=g();if(!(e&&e.subComponent&&e.component&&e.state))return void w(d.Error,"Invalid data",e,this._flushTraceOnErrorEnabled);const n=this._components[e.component];if(!n)return void w(d.Error,"Invalid component",e,this._flushTraceOnErrorEnabled);if(n.ignoredSubComponents[e.subComponent])return;n.ignoreNewSubComponents=n.ignoreNewSubComponents||!!e.ignoreNewSubComponents;const o=n.subComponents[e.subComponent];if(!o)return void w(d.Error,"Unexpected sub-component",e,this._flushTraceOnErrorEnabled);if("unused"===e.state)return void this._processSubComponentUnused(n,o,t);const r=e.state;if(!M(r))return void w(d.Error,"Unknown state reported",e,this._flushTraceOnErrorEnabled);if(n.states[r]?.final)return void w(d.Error,"Component state final. Can't set",e,this._flushTraceOnErrorEnabled);if(o.unused||o.states[r])return void w(d.Error,"SubComponent unused or set",e,this._flushTraceOnErrorEnabled);const i=e.promoteStateFrom;i?this._processSubComponentState(n,o,r,t,i):this._processSubComponentState(n,o,r,t)}get components(){return this._components}get metrics(){return this._monitorMetrics.metrics}constructor(e){var t,n;this._components={},this._reportedMetrics={},this._reportVisuallyReadyMetricOnComponentTimeoutEnabled=!1,this._canReportVisuallyReadyOnComponentTimeout=!0,this._canAppStateMetricBeReported=e=>{if(this._reportedMetrics[e])return!1;const t=A(this._components,e);return w(d.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:e,isFinal:t}),t},this._canMonitorMetricBeReported=e=>{if(e===r||e===s){const t=this._monitorMetrics.metrics[e],n=A(this._components,a);return w(d.Verbose,"canMonitorMetricBeReported:si-error:",{metric:e,error:t?.error,vrStateFinal:n}),!!t&&"cancelled"!==t.error&&n}return!0},this._reportMonitorMetricIfReady=e=>{const t=this._reportedMetrics[e],n=this._canMonitorMetricBeReported(e);!t&&n?this._reportMetricInternal(e):w(d.Info,"reportMonitorMetricIfReady:not-ready",{metric:e,isReported:t,canMetricBeReported:n})},this._reportAppStateIfReady=e=>{this._canAppStateMetricBeReported(e)&&this._reportMetricInternal(e)},this._reportMetricInternal=(e,t,n)=>{try{let o,i=this._monitorMetrics.metrics[e];if(!i&&t)i={time:0,start:0,monitor:this._stateMonitor||"",error:void 0,measures:{},data:{}};else if(e===a&&n&&this._reportVisuallyReadyMetricOnComponentTimeoutEnabled)if(i)w(d.Error,"reportMetric:metricData is defined unexpectedly",this._flushTraceOnErrorEnabled);else{let e=this._monitorMetrics.tabHideTime!==1/0?0===this._monitorMetrics.tabHideTime?"tab-hidden":"tab-switch":"timeout";o=e,i={time:0,start:0,monitor:this._stateMonitor||"",error:e,measures:{},data:{}}}else if(this._settingsManager.getBooleanSetting("ReturnOnUndefinedMetricData",!1)&&!i)return void w(d.Error,"reportMetric:metricData is undefined",e);""!==i.monitor&&void 0!==i.monitor||(i.monitor=this._stateMonitor);const l={metric:e,timeOrigin:this._timeOrigin,time:i.time,onDemand:t,error:i.error||(this._monitorMetrics.tabHideTime<i.time?"tab-switch":void 0),monitor:i.monitor,measures:k(i.measures),data:k(i.data),auxMetrics:[],componentsData:P(this._components),nonReportingComponentData:E(this._components)},s=l.measures;if(s.tabsSwitch=this._monitorMetrics.tabHideTime<i.time||n?this._monitorMetrics.tabHideTime:0,s.start=i.start,s.reportedTime=g(),e===r){const e=this._monitorMetrics.metrics[a];s[a]=e?e.time:0;const t=this._monitorMetrics.metrics[c];s[c]=t?t.time:0}if(M(e)){for(const t in this._components){const n=this._components[t];if(!n)continue;const r=n.states[e]?.result;if(!r)continue;s[t]=r.time,l.error=l.error||r.error;const i=this._reportVisuallyReadyMetricOnComponentTimeoutEnabled&&void 0!==o?o:r.error,a={metric:`${e}-${t}`,time:r.time,monitor:r.monitor,error:i,measures:k(r.measures)};a.measures.start=r.start,a.measures.init=_(n),l.auxMetrics.push(a)}const t=this._monitorMetrics.metrics[r];t&&t.error&&"cancelled"!==t.error&&!l.error&&(l.error="si-error")}this._shepherdInit.appLoadMetricReportCallback&&(this._reportedMetrics[e]=!0,w(d.Info,"reportMetric:reporting",e,!0),this._shepherdInit.appLoadMetricReportCallback(l))}catch(t){let n=t;this.fixReportMetricErrorLogEnabled&&(n=`metric:${e}, error:${t.toString()}`),w(d.Error,"reportMetric:error",n,this._flushTraceOnErrorEnabled)}},this.flushRumShepherdState=e=>{w(d.Info,"flushRumShepherdState",{isOnDemandFlush:e},!0);const t={time:m(),allMetricsReported:(n=this._reportedMetrics,!!(n[a]&&n[c]&&n[r]&&n[i]&&n[l]&&n[s])),metrics:this._monitorMetrics.metrics,components:P(this._components),timeOrigin:f()};var n;this._shepherdInit.appLoadStateLoggingCallback(t)},this._processSubComponentState=(e,t,n,o,r)=>{if(O(t,r)){const e=t.states[r];t.states[n]={time:e.time,promotedFromPreviousState:!0}}else t.states[n]={time:o,promotedFromPreviousState:!1};const i=t.states[n];if(J({kind:"setSubComponentState",component:e.id,subComponent:t.id,state:{kind:"ready",metric:n,time:i.time,promoted:i.promotedFromPreviousState}}),w(d.Verbose,"processSubComponentState",{component:e.id,subComponent:t.id,state:n,time:o,promotedFromState:r}),this._settingsManager.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1)&&t.nonReporting)return void w(d.Verbose,"processSubComponentState:nonReporting-subcomponent - skipping",{component:e.id,subComponent:t.id,state:n});if(!function(e,t){const n=e.subComponents;for(const e in n){const o=n[e].states[t];if(!(o?.time||n[e].optional||V(n[e],t)))return!1}return!0}(e,n))return void w(d.Verbose,"processSubComponentState:component-not-ready",{component:e.id,startedBySubcomponent:t.id,state:n});const l=(e,t,n)=>{t?(w(d.Info,"processSubComponentState:complete-appstate-metric",e),this.metrics[e]=j(t,n),this._reportAppStateIfReady(e)):w(d.Info,"processSubComponentState:complete-appstate-metric - no result - not setting the monitor result",e)},s=(e,t)=>{t?(w(d.Info,"processSubComponentState:complete-monitor-metric",e),this.metrics[e]=j(t),this._reportMonitorMetricIfReady(e)):w(d.Info,"processSubComponentState:complete-monitor-metric - no result - not setting the monitor result",e)},c=(e,t)=>{const n=function(e,t,n){let o=0;for(const r in e){const i=e[r].states[t]?.result?.time,l=n&&Object.values(e[r].subComponents).every((e=>e.optional||e.unused)),s=n?l:e[r].allSubComponentsUnused;if(!(i||s||l))return void w(d.Info,"getAppStateTime: No app state time for component",{component:r,state:t});i&&(o=Math.max(o,i))}return o}(this._components,e,this.appStateTimeAllOptionalEnabled);w(d.Verbose,"processSubComponentState:appStateTime",{time:n,state:e}),n&&(l(e,t,n),this._monitorMetrics.startMonitors(e,s))};this.dontCancelMonitorsWhenAllUnused&&e.allSubComponentsUnused||this._monitorMetrics.cancelMonitors(n);const u=this._settingsManager.getBooleanSetting("fixPromotedUnusedCombinedLogicBug",!1),h=this._settingsManager.getBooleanSetting("dontPromoteFromCancelledMonitor",!1),f=O(t,r),m=function(e,t,n){if(n&&e&&e.states[n]){const o=e.states[n];return o?.result&&o.final&&(!t||!o.result.error&&o.result.time>0)}return!1}(e,h,r);if(f){const t=e.states[r];return m?z(e,n,u)?(K(e,n,t.result,h),void c(n,t.result)):u&&e.states[n]?.result?(K(e,n,e.states[n].result,h),void c(n,e.states[n].result)):void 0:void(z(e,n,u)&&t.monitoring&&(w(d.Verbose,"processSubComponentState: detected promotion while previous state is monitoring, marking state to promote later.",{component:e.id,state:n,promotedFromState:r}),t.stateToPromoteWhenFinal=n))}if(e.allSubComponentsUnused){const t={start:0,time:0,monitor:""};return e.states[n]={result:j(t),final:!0},w(d.Verbose,"processSubComponentState:setting component's state timings to 0 since all subComponents are unused",{component:e.id,state:n}),void c(n,t)}void 0!==r&&w(d.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:e.id,subComponent:t.id,promotedFromState:r,state:n,isPromotingAndPromotedStateExists:f,isPreviousStateHasAFinalResult:m});const C=this._shepherdInit.monitors[n];w(d.Verbose,"processSubComponentState:start-monitor",{component:e.id,startedBySubcomponent:t.id,state:n}),function(e,t,n,o,r){const i=e.states[t];if(i?.final)return;i?.monitoring&&i?.monitoring.cancel();const l=g(),s=q(5e3);e.states[t]={monitoring:s,final:W(e,t)},U(n(l,s,e),l,t,o?n=>{r(n),e.states[t]?.monitoring===s&&(e.states[t].monitoring=void 0)}:r)}(e,n,C,h,(o=>{"timeout"===o.error&&n===a&&(this._logComponentMonitorTimeoutVisuallyReady&&w(d.Warning,"processSubComponentState:monitor-timeout",{component:e.id,startedBySubcomponent:t.id,state:n,tabswitchTime:this._monitorMetrics.tabHideTime},this._flushTraceOnErrorEnabled),this._reportVisuallyReadyMetricOnComponentTimeoutEnabled&&this._monitorMetrics.tabHideTime!==1/0&&this._canReportVisuallyReadyOnComponentTimeout&&(this._reportMetricInternal(n,!1,!0),this._canReportVisuallyReadyOnComponentTimeout=!1)),w(d.Verbose,"processSubComponentState:monitor-complete",{component:e.id,startedBySubcomponent:t.id,state:n}),!o||void 0===o?.monitor&&""===o.monitor||(this._stateMonitor=o.monitor);const r=e.states[n].stateToPromoteWhenFinal;K(e,n,o,h),r&&(w(d.Verbose,"processSubComponentState: promotion callback detected state to promote.",{component:e.id,state:n,stateToPromote:r}),K(e,r,o,h)),c(n,o)}))},this._processSubComponentUnused=(e,t,n)=>{w(d.Verbose,"processSubComponentUnused",{subComponent:t.id}),t.unused=!0,J({kind:"setSubComponentState",component:e.id,subComponent:t.id,state:{kind:"unused",time:n}});const o=e.subComponents;let i=!0;for(const e in o)o[e].unused||(i=!1);i?(e.allSubComponentsUnused=!0,this._processSubComponentState(e,t,u,0),w(d.Verbose,"processSubComponentUnused:vp-final",{component:e.id,VISUALLY_PERCEIVED:u}),e.states[u].final=!0,this._reportAppStateIfReady(u),this._processSubComponentState(e,t,a,0),w(d.Verbose,"processSubComponentUnused:vr-final",{component:e.id,VISUALLY_READY:a}),e.states[a].final=!0,this._reportAppStateIfReady(a),this._processSubComponentState(e,t,c,0),w(d.Verbose,"processSubComponentUnused:fr-final",{component:e.id,FUNCTIONALLY_READY:c}),e.states[c].final=!0,this._reportAppStateIfReady(c)):this.ProcessUnusedComponentFinal(e),this._reportMonitorMetricIfReady(r),this._reportMonitorMetricIfReady(s)},this._addSubComponent=(e,t,n,o,r)=>{n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:g(),optional:o,unused:!1,nonReporting:r,states:{}},J({kind:"addSubComponent",component:e.id,subComponent:t,optional:o,nonReporting:r}))},w(d.Info,"initialize"),this._timeOrigin=Number(Number(f()).toFixed()),this._shepherdInit={...e},this._monitorMetrics=new X(this._shepherdInit),this._settingsManager=(t=this._shepherdInit.appSettings,x=new b(t),x),n=this._settingsManager.getBooleanSetting("RumReportComponentUpdateEvents",!1),Y=n;for(const t of e.components)this._components[t.id]={id:t.id,rootElementId:t.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}},J({kind:"init",component:t.id});this.appStateTimeAllOptionalEnabled=this._settingsManager.getBooleanSetting("appStateTimeAllOptionalEnabled",!1),this.dontCancelMonitorsWhenAllUnused=this._settingsManager.getBooleanSetting("dontCancelMonitorsWhenAllUnused",!1),this._logComponentMonitorTimeoutVisuallyReady=this._settingsManager.getBooleanSetting("logComponentMonitorTimeoutVisuallyReady",!1),window.setTimeout((()=>this.flushRumShepherdState(!1)),12e4),Q()&&(te=new PerformanceObserver((e=>{ae(e.getEntries())})),te.observe({type:"layout-shift",buffered:!0}),window.addEventListener(R,ce)),Qe(),this.fixReportMetricErrorLogEnabled=this._settingsManager.getBooleanSetting("fixReportMetricErrorLog",!1),this._flushTraceOnErrorEnabled=this._settingsManager.getBooleanSetting("FlushRumShepardTraceOnError",!1),this._reportVisuallyReadyMetricOnComponentTimeoutEnabled=this._settingsManager.getBooleanSetting("reportVisuallyReadyMetricOnComponentTimeout",!1)}}function et(e,t){return window.requestAnimationFrame?new Promise((n=>{let o;const r=(r=0)=>{cancelAnimationFrame(o),n({start:e,time:r,monitor:"rAF",error:t.reason})};t.onCancelled=r,o=requestAnimationFrame((()=>{r(g())}))})):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function tt(e,t){return new Promise((n=>{let o,r;const i=(i=0)=>{cancelAnimationFrame(o),clearTimeout(r),n({start:e,time:i,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=()=>i(),o=requestAnimationFrame((()=>{r=window.setTimeout((()=>{i(g())}),0)}))}))}const nt="StableInteractivityDetected";function ot(e,t,n=1e3){const o=t||q(12e3);if(!Z("longtask"))return function(e,t){const n=g();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});const o=g();let r=0,i=o,l=0,s=0,a=o;return new Promise((o=>{let c;const u=(t=0)=>{cancelAnimationFrame(c);const i={start:n,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:r,longestTaskDuration:s,longTasksDuration:l}};o(i)};e.onCancelled=u;const d=e=>{let n=e-i;const o=e-a;if(a=e,o>=50&&(n=0,l+=o,r+=1,i=e,s=Math.max(s,o)),n>=t)return u(i),void rt();c=window.requestAnimationFrame(d)};c=window.requestAnimationFrame(d)}))}(o,n);const r=performance.now();let i=0,l=r,s=0,a=0;return new Promise((t=>{let r;const c=()=>{clearTimeout(r),u&&u.disconnect();const n=g()-e,c={start:e,time:l,monitor:"longtask-api",error:o.reason,measures:{longTasksDuration:s,longTasksCount:i,longestTaskDuration:a,monitoredTime:n}};t(c)};o.onCancelled=c;const u=new PerformanceObserver((function(e){e.getEntries().forEach((e=>{i+=1,s+=e.duration;const t=e.startTime+e.duration;l=Math.max(t,l),a=Math.max(a,e.duration)}))}));u.observe({entryTypes:["longtask"]});const d=()=>{const e=performance.now()-l;if(e>=n)c(),rt();else{const t=n-e;r=window.setTimeout(d,t)}};r=window.setTimeout(d,n)}))}function rt(){try{self.dispatchEvent(new CustomEvent(nt))}catch(e){w(d.Error,`${nt} failed with exception: ${e}`)}}function it(e,t){return Z("first-input")?new Promise((n=>{let o;const r=(t,r,i)=>{o&&o.disconnect(),n({start:e,time:t,monitor:"first-input-api",error:i,measures:{fid:r}})};try{t.onCancelled=()=>r(0,0,t.reason);const e=e=>{const t=e.processingStart,n=t-e.startTime;r(t,n)};o=new PerformanceObserver((t=>{t.getEntries().forEach((t=>e(t)))})),o.observe({type:"first-input",buffered:!0})}catch(e){r(0,0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function lt(e,t){const n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],o={passive:!0,capture:!0},r=m();return new Promise((i=>{const l=(n,o,r)=>{a(removeEventListener);const l={start:e,time:n,monitor:"first-interaction",error:t.reason,data:{eventName:o},measures:{delay:r}};i(l)};t.onCancelled=()=>l(0,"",0);const s=e=>{if(e.cancelable){const t=m(),n=e.timeStamp>1e12;let o=(n?m():performance.now())-e.timeStamp;(o<0||o>t-r)&&(o=0),l(n?e.timeStamp-f():e.timeStamp,e.type,o)}},a=e=>{n.forEach((function(t){e(t,s,o)}))};a(addEventListener)}))}function st(e,t){return window.requestIdleCallback?new Promise((n=>{let o;const r=(t,r)=>{window.cancelIdleCallback(o),n({start:e,time:t,monitor:"first-idle",error:r})};try{o=window.requestIdleCallback((e=>r(g(),e.didTimeout?"timeout":"")),{timeout:t.timeout}),t.onCancelled=()=>r(0,t.reason)}catch(e){r(0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}let at=0;const ct=e=>{const t=`report ${e.metric}:${e.time}ms`;w(d.Info,t,e);const n=new CustomEvent(R,{detail:e});self.dispatchEvent(n)},ut=e=>{w(d.Info,`reporting the application load state at epoch time: ${e.time}; with the status of all metrics reported as ${e.allMetricsReported}`,e);const t=new CustomEvent("Wac-AppLoadStateReport",{detail:e});self.dispatchEvent(t)},dt=(e,t,n)=>{if(n){const o=`vr-${n.id}-${at}`;return at+=1,function(e,t,n,o){let r=o?function(e,t,n,o){if(!Z("element"))return;const r="testimg-"+n,i=function(e){const t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.ariaHidden="true",t}(r);if(!i)return;const l=o??document.documentElement;return new Promise((n=>{const o=(t=0,o)=>{s&&s.disconnect(),n({start:e,time:t,monitor:"image-paint-api",error:o})},s=new PerformanceObserver((e=>{const t=e.getEntries();for(const e of t){const t=e;if(t.identifier===r){try{i.hidden=!0,l.removeChild(i)}catch(e){w(d.Error,"measureImagePaintTime",e)}return void o(t.renderTime)}}}));t.onCancelled=()=>o(0,t.reason),s.observe({type:"element",buffered:!0}),l.appendChild(i)}))}(e,t,n,o):void 0;return r||(r=et(e,t)),r}(e,t,o,document.documentElement??void 0)}return et(e,t)};function ht(e,t){const n=new Ze({appLoadMetricReportCallback:ct,appLoadStateLoggingCallback:ut,appSettings:t,monitors:{"visually-ready":dt,"visually-perceived":dt,"functionally-ready":tt,"stable-interactivity":ot,"first-input":it,"first-interaction":lt,"first-idle":st},components:e});window.addEventListener(S,(e=>{const t=e.detail;n.addSubComponents(t)})),window.addEventListener(y,(e=>{const t=e.detail;n.setSubComponentState(t)})),window.addEventListener(I,(e=>{const t=e.detail;n.reportMetricOnDemand(t.metric)}))}class ft{constructor(e){this.rumShepherdDataCollection=[],this.collectRumShepherdAction=e=>{e&&this.rumShepherdDataCollection.push(e)},this.stopRumShepherdDataRetrieverEventListener=()=>{window.removeEventListener("Wac-AppLoadMetricReport",this.eventCallback)},this.eventCallback=e=>{const t=e.detail;"visually-ready"===t.metric&&(this.stopRumShepherdDataRetrieverEventListener(),this.getComponentData(t.auxMetrics),this.shouldCollectSubComponentData&&(this.timeOrigin=t.timeOrigin,this.getSubComponentDataForComponents(t.componentsData)))},this.getSubComponentDataForComponents=e=>{e.forEach((e=>{e.subComponents.forEach((t=>{t.unused||t.nonReporting||(this.collectRumShepherdAction({startTime:0,endTime:t.initTime-this.timeOrigin,rumShepherdDataProps:{component:`${e.id}`,subComponent:`${t.id}`,state:"VRInit"}}),this.collectRumShepherdAction({startTime:t.initTime-this.timeOrigin,endTime:t.states["visually-ready"]-this.timeOrigin,rumShepherdDataProps:{component:`${e.id}`,subComponent:`${t.id}`,state:"VRInitToVR"}}))}))}))},this.getComponentData=e=>{e.forEach((e=>{this.collectRumShepherdAction({startTime:0,endTime:e.measures.init,rumShepherdDataProps:{component:`${e.metric.replace("visually-ready-","")}`,subComponent:"",state:"VRInit"}}),this.collectRumShepherdAction({startTime:e.measures.init,endTime:e.time,rumShepherdDataProps:{component:`${e.metric.replace("visually-ready-","")}`,subComponent:"",state:"VRInitToVR"}})}))},this.retrieveRumShepherdEventsBetweenTimeRange=(e,t)=>this.rumShepherdDataCollection.filter((n=>e<=n.endTime&&t>=n.startTime)),this.shouldCollectSubComponentData=e,window.addEventListener("Wac-AppLoadMetricReport",this.eventCallback)}}const gt=new class{setupDefault(e){if(e)return ht(e),null}setupDefaultWithAppSettings(e,t){if(!e)return;const n={};try{if(t)for(const e of t.keys())if(e){const o=t.get(e);o&&(n[e]=o)}ht(e,n)}catch(e){w(d.Error,"appSettings: map to dictionary conversion error",e)}return null}createAndInitRumShepherdDataRetriever(e){return new ft(e)}};var mt,Ct,pt,wt,St,yt,Rt,Tt,It,vt,bt,xt,Ft,Dt,Mt,At,Ot,Bt,kt,Pt,Et,Ht,Lt,Nt,Wt,_t,zt,Gt,Vt,jt,Ut,$t,qt,Xt,Yt,Jt,Kt,Qt,Zt,en,tn,nn,on,rn,ln,sn,an,cn,un,dn,hn,fn,gn,mn,Cn;function pn(e){return null==e}function wn(e,t){let n;switch(e){case Nt.Default:case Nt.Hyperlink:n=t[t.length+e];break;default:n=t[e]}if(pn(n))throw Error(`RefObject is null or undefined, id: ${e}`);if((n.ID||0)!==e)throw Error("RefIDs are not sorted as expected");return n}!function(e){e[e.NotInitialized=-1]="NotInitialized",e[e.Start=0]="Start",e[e.Loaded=1]="Loaded",e[e.Completed=2]="Completed"}(mt||(mt={})),function(e){e[e.Loaded=0]="Loaded",e[e.Error=1]="Error",e[e.Loading=2]="Loading",e[e.Unloaded=3]="Unloaded",e[e.Missing=4]="Missing",e[e.Undefined=5]="Undefined",e[e.Unexpected=6]="Unexpected"}(Ct||(Ct={})),function(e){e[e.Info=0]="Info",e[e.Monitorable=1]="Monitorable",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(pt||(pt={})),function(e){e[e.EmptyPivotTable=0]="EmptyPivotTable",e[e.RichValueIconDisambig=1]="RichValueIconDisambig",e[e.RichValueIconSync=2]="RichValueIconSync"}(wt||(wt={})),function(e){e[e.CanvasEventHandlersMeasureDurationMs=0]="CanvasEventHandlersMeasureDurationMs",e[e.CanvasEventHandlersTimeoutDurationMs=1]="CanvasEventHandlersTimeoutDurationMs",e[e.CanvasEventHandlersLogTraceCooldownMs=2]="CanvasEventHandlersLogTraceCooldownMs",e[e.PassiveTelemetryManagerExecutionDurationMs=3]="PassiveTelemetryManagerExecutionDurationMs",e[e.PassiveTelemetryManagerMaxUserInactiveTimeMs=4]="PassiveTelemetryManagerMaxUserInactiveTimeMs",e[e.PassiveTelemetryManagerMinLogThrottleTimeMs=5]="PassiveTelemetryManagerMinLogThrottleTimeMs",e[e.FontLoadRetryBaseIntervalMs=6]="FontLoadRetryBaseIntervalMs",e[e.FontLoadRetryMaxIntervalMs=7]="FontLoadRetryMaxIntervalMs",e[e.FontLoadRetries=8]="FontLoadRetries",e[e.TextWidthTolLimitForAutofit=9]="TextWidthTolLimitForAutofit",e[e.TextWidthTolLowerLimitForSpillCell=10]="TextWidthTolLowerLimitForSpillCell",e[e.TextWidthTolUpperLimitForSpillCell=11]="TextWidthTolUpperLimitForSpillCell",e[e.TextWidthCacheSizeLimit=12]="TextWidthCacheSizeLimit"}(St||(St={})),function(e){e[e.Column=0]="Column",e[e.Row=1]="Row",e[e.Table=2]="Table"}(yt||(yt={})),function(e){e[e.Unknown=0]="Unknown",e[e.Static=1]="Static",e[e.Flat=2]="Flat",e[e.Hierarchical=4]="Hierarchical",e[e.Custom=8]="Custom",e[e.Embedded=16]="Embedded",e[e.System=32]="System",e[e.Apple=64]="Apple",e[e.Google=128]="Google",e[e.PreDictionary=256]="PreDictionary"}(Rt||(Rt={})),function(e){e[e.InsertDot=0]="InsertDot",e[e.InsertButton=1]="InsertButton"}(Tt||(Tt={})),function(e){e[e.CellStart=0]="CellStart",e[e.CellEnd=1]="CellEnd"}(It||(It={})),function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(vt||(vt={})),function(e){e[e.None=0]="None",e[e.Checkbox=1]="Checkbox",e[e.Dropdown=2]="Dropdown"}(bt||(bt={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.Median=12]="Median",e[e.AggregationTypeMax=12]="AggregationTypeMax"}(xt||(xt={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(Ft||(Ft={})),function(e){e[e.Invalid=0]="Invalid",e[e.FirstTop10=1]="FirstTop10",e[e.Count=1]="Count",e[e.Percent=2]="Percent",e[e.Sum=3]="Sum",e[e.LastTop10=3]="LastTop10",e[e.CaptionFirst=4]="CaptionFirst",e[e.CaptionEquals=4]="CaptionEquals",e[e.CaptionDoesNotEqual=5]="CaptionDoesNotEqual",e[e.CaptionBeginsWith=6]="CaptionBeginsWith",e[e.CaptionDoesNotBeginWith=7]="CaptionDoesNotBeginWith",e[e.CaptionEndsWith=8]="CaptionEndsWith",e[e.CaptionDoesNotEndWith=9]="CaptionDoesNotEndWith",e[e.CaptionContains=10]="CaptionContains",e[e.CaptionDoesNotContain=11]="CaptionDoesNotContain",e[e.CaptionIsGreaterThan=12]="CaptionIsGreaterThan",e[e.CaptionIsGreaterThanOrEqualTo=13]="CaptionIsGreaterThanOrEqualTo",e[e.CaptionIsLessThan=14]="CaptionIsLessThan",e[e.CaptionIsLessThanOrEqualTo=15]="CaptionIsLessThanOrEqualTo",e[e.CaptionIsBetween=16]="CaptionIsBetween",e[e.CaptionIsNotBetween=17]="CaptionIsNotBetween",e[e.ValueFirst=18]="ValueFirst",e[e.ValueEqual=18]="ValueEqual",e[e.ValueNotEqual=19]="ValueNotEqual",e[e.ValueGreaterThan=20]="ValueGreaterThan",e[e.ValueGreaterThanOrEqual=21]="ValueGreaterThanOrEqual",e[e.ValueLessThan=22]="ValueLessThan",e[e.ValueLessThanOrEqual=23]="ValueLessThanOrEqual",e[e.ValueBetween=24]="ValueBetween",e[e.ValueNotBetween=25]="ValueNotBetween",e[e.DateFirst=26]="DateFirst",e[e.DateEquals=26]="DateEquals",e[e.DateOlderThan=27]="DateOlderThan",e[e.DateNewerThan=28]="DateNewerThan",e[e.DateBetween=29]="DateBetween",e[e.DateTomorrow=30]="DateTomorrow",e[e.DateToday=31]="DateToday",e[e.DateYesterday=32]="DateYesterday",e[e.DateNextWeek=33]="DateNextWeek",e[e.DateThisWeek=34]="DateThisWeek",e[e.DateLastWeek=35]="DateLastWeek",e[e.DateNextMonth=36]="DateNextMonth",e[e.DateThisMonth=37]="DateThisMonth",e[e.DateLastMonth=38]="DateLastMonth",e[e.DateNextQuarter=39]="DateNextQuarter",e[e.DateThisQuarter=40]="DateThisQuarter",e[e.DateLastQuarter=41]="DateLastQuarter",e[e.DateNextYear=42]="DateNextYear",e[e.DateThisYear=43]="DateThisYear",e[e.DateLastYear=44]="DateLastYear",e[e.DateYearToDate=45]="DateYearToDate",e[e.DateAllDatesInPeriodQuarter1=46]="DateAllDatesInPeriodQuarter1",e[e.DateAllDatesInPeriodQuarter2=47]="DateAllDatesInPeriodQuarter2",e[e.DateAllDatesInPeriodQuarter3=48]="DateAllDatesInPeriodQuarter3",e[e.DateAllDatesInPeriodQuarter4=49]="DateAllDatesInPeriodQuarter4",e[e.DateAllDatesInPeriodJanuary=50]="DateAllDatesInPeriodJanuary",e[e.DateAllDatesInPeriodFebruary=51]="DateAllDatesInPeriodFebruary",e[e.DateAllDatesInPeriodMarch=52]="DateAllDatesInPeriodMarch",e[e.DateAllDatesInPeriodApril=53]="DateAllDatesInPeriodApril",e[e.DateAllDatesInPeriodMay=54]="DateAllDatesInPeriodMay",e[e.DateAllDatesInPeriodJune=55]="DateAllDatesInPeriodJune",e[e.DateAllDatesInPeriodJuly=56]="DateAllDatesInPeriodJuly",e[e.DateAllDatesInPeriodAugust=57]="DateAllDatesInPeriodAugust",e[e.DateAllDatesInPeriodSeptember=58]="DateAllDatesInPeriodSeptember",e[e.DateAllDatesInPeriodOctober=59]="DateAllDatesInPeriodOctober",e[e.DateAllDatesInPeriodNovember=60]="DateAllDatesInPeriodNovember",e[e.DateAllDatesInPeriodDecember=61]="DateAllDatesInPeriodDecember",e[e.DateNotEqual=62]="DateNotEqual",e[e.DateOlderOrEqual=63]="DateOlderOrEqual",e[e.DateNewerOrEqual=64]="DateNewerOrEqual",e[e.DateNotBetween=65]="DateNotBetween",e[e.Last=65]="Last"}(Dt||(Dt={})),function(e){e[e.None=0]="None",e[e.SortAscending=1]="SortAscending",e[e.SortDescending=2]="SortDescending",e[e.SortAscendingByValue=3]="SortAscendingByValue",e[e.SortDescendingByValue=4]="SortDescendingByValue"}(Mt||(Mt={})),function(e){e[e.None=0]="None",e[e.Explicit=1]="Explicit",e[e.Implicit=2]="Implicit"}(At||(At={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(Ot||(Ot={})),function(e){e[e.Default=0]="Default",e[e.NamedSheetView=1]="NamedSheetView",e[e.PresentMode=2]="PresentMode"}(Bt||(Bt={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(kt||(kt={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(Pt||(Pt={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(Et||(Et={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(Ht||(Ht={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(Lt||(Lt={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(Nt||(Nt={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(Wt||(Wt={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(_t||(_t={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(zt||(zt={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(Gt||(Gt={})),function(e){e[e.NewVerticalAlignExp=0]="NewVerticalAlignExp",e[e.InCellControls=1]="InCellControls",e[e.FontServiceIntegration=2]="FontServiceIntegration",e[e.TextWidthClientPhase2=3]="TextWidthClientPhase2",e[e.CanvasHitTest=4]="CanvasHitTest",e[e.TextWidthClientNewProcessing=5]="TextWidthClientNewProcessing",e[e.FiltersUXModernization=6]="FiltersUXModernization",e[e.DelayRenderToNextAnimationFrame=9]="DelayRenderToNextAnimationFrame",e[e.ResizeHeaderUXModernization=10]="ResizeHeaderUXModernization",e[e.DoubleBorderFormattingFix=13]="DoubleBorderFormattingFix",e[e.WrapTextCse=14]="WrapTextCse",e[e.RenderResizePill=16]="RenderResizePill",e[e.FormulaViewCellImagesFix=17]="FormulaViewCellImagesFix",e[e.ModernFontPicker=19]="ModernFontPicker",e[e.DoubleBorderMergeCellFix=20]="DoubleBorderMergeCellFix",e[e.DoubleBorderBlockEdgeFix=21]="DoubleBorderBlockEdgeFix",e[e.TextWidthClientPhase1=22]="TextWidthClientPhase1",e[e.TableSelectorsHitTest=23]="TableSelectorsHitTest",e[e.TextOrientationSlice1=25]="TextOrientationSlice1",e[e.ByExamplePreviewMode=26]="ByExamplePreviewMode",e[e.ShowDynamicImageCardOnHover=27]="ShowDynamicImageCardOnHover",e[e.TextOrientationSlice2=28]="TextOrientationSlice2",e[e.TableBordersInHighContrast=29]="TableBordersInHighContrast",e[e.UseOffscreenCanvas=30]="UseOffscreenCanvas",e[e.GlobalStylesSlice1=34]="GlobalStylesSlice1",e[e.NewDefaultTemplate=35]="NewDefaultTemplate",e[e.GlobalStylesSlice2=37]="GlobalStylesSlice2",e[e.GlobalStylesSlice3=39]="GlobalStylesSlice3",e[e.HideColumnSlice1=40]="HideColumnSlice1",e[e.HideColumnMergedCellSlice1=41]="HideColumnMergedCellSlice1",e[e.HideColumnAutoFilterSlice1=42]="HideColumnAutoFilterSlice1",e[e.HideColumnFormulaSlice1=43]="HideColumnFormulaSlice1",e[e.MoveSpillCellBeforeRendering=44]="MoveSpillCellBeforeRendering",e[e.NewThemeFontForHeaderFBarNBox=45]="NewThemeFontForHeaderFBarNBox",e[e.DropdownInCellControl=46]="DropdownInCellControl"}(Vt||(Vt={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(jt||(jt={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(Ut||(Ut={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}($t||($t={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(qt||(qt={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(Xt||(Xt={})),function(e){e[e.None=0]="None",e[e.Major=1]="Major",e[e.Minor=2]="Minor"}(Yt||(Yt={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(Jt||(Jt={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter",e[e.SortAtoZ=30]="SortAtoZ",e[e.SortZtoA=31]="SortZtoA",e[e.SortSmallestToLargest=32]="SortSmallestToLargest",e[e.SortLargestToSmallest=33]="SortLargestToSmallest",e[e.SortOldestToNewest=34]="SortOldestToNewest",e[e.SortNewestToOldest=35]="SortNewestToOldest",e[e.SortByColor=36]="SortByColor",e[e.FilterByColor=37]="FilterByColor",e[e.AnalyzeData=38]="AnalyzeData",e[e.Skeleton=39]="Skeleton"}(Kt||(Kt={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(Qt||(Qt={})),function(e){e[e.ShowCard=0]="ShowCard",e[e.ConvertToText=1]="ConvertToText",e[e.ChangeRichValue=2]="ChangeRichValue",e[e.Refresh=3]="Refresh",e[e.ShowAltTextPane=4]="ShowAltTextPane",e[e.PythonDisplayPlotOverCells=5]="PythonDisplayPlotOverCells"}(Zt||(Zt={})),function(e){e[e.Disambiguation=0]="Disambiguation",e[e.Sync=1]="Sync",e[e.LinkedEntity=2]="LinkedEntity"}(en||(en={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(tn||(tn={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(nn||(nn={})),function(e){e[e.None=0]="None",e[e.ModelCellChanges=2]="ModelCellChanges",e[e.ModelCoreChanges=4]="ModelCoreChanges",e[e.ScaleFactorChange=8]="ScaleFactorChange",e[e.ViewportChange=16]="ViewportChange",e[e.ExternalChanges=32]="ExternalChanges",e[e.NoCanvasCache=64]="NoCanvasCache",e[e.ModelCellPreviewChanges=128]="ModelCellPreviewChanges"}(on||(on={})),function(e){e[e.None=0]="None",e[e.Autofit=1]="Autofit",e[e.Spill=2]="Spill"}(rn||(rn={})),function(e){e[e.Default=-1]="Default",e[e.PartialRowColSelection=0]="PartialRowColSelection",e[e.WholeRowColSelection=1]="WholeRowColSelection",e[e.Hover=2]="Hover",e[e.PartialSelectionAndHover=3]="PartialSelectionAndHover",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover",e[e.NoHeadings=5]="NoHeadings",e[e.PartialRowColSelectionLeftAlignment=6]="PartialRowColSelectionLeftAlignment",e[e.PartialRowColSelectionRightAlignment=7]="PartialRowColSelectionRightAlignment",e[e.WholeRowColSelectionLeftAlignment=8]="WholeRowColSelectionLeftAlignment",e[e.WholeRowColSelectionRightAlignment=9]="WholeRowColSelectionRightAlignment",e[e.HoverLeftAlignment=10]="HoverLeftAlignment",e[e.HoverRightAlignment=11]="HoverRightAlignment",e[e.PartialSelectionAndHoverLeftAlignment=12]="PartialSelectionAndHoverLeftAlignment",e[e.PartialSelectionAndHoverRightAlignment=13]="PartialSelectionAndHoverRightAlignment",e[e.WholeSelectionAndHoverLeftAlignment=14]="WholeSelectionAndHoverLeftAlignment",e[e.WholeSelectionAndHoverRightAlignment=15]="WholeSelectionAndHoverRightAlignment",e[e.LeftAlignment=16]="LeftAlignment",e[e.RightAlignment=17]="RightAlignment"}(ln||(ln={})),function(e){e[e.Default=-1]="Default",e[e.Hover=0]="Hover",e[e.PartialSelection=1]="PartialSelection",e[e.PartialSelectionAndHover=2]="PartialSelectionAndHover",e[e.WholeSelection=3]="WholeSelection",e[e.WholeSelectionAndHover=4]="WholeSelectionAndHover"}(sn||(sn={})),function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.Gray50=2]="Gray50",e[e.Gray75=3]="Gray75",e[e.Gray25=4]="Gray25",e[e.HorzStripe=5]="HorzStripe",e[e.VertStripe=6]="VertStripe",e[e.ReverseDiagStripe=7]="ReverseDiagStripe",e[e.DiagStripe=8]="DiagStripe",e[e.DiagCross=9]="DiagCross",e[e.ThickDiagCross=10]="ThickDiagCross",e[e.ThinHorzStripe=11]="ThinHorzStripe",e[e.ThinVertStripe=12]="ThinVertStripe",e[e.ThinReverseDiagStripe=13]="ThinReverseDiagStripe",e[e.ThinDiagStripe=14]="ThinDiagStripe",e[e.ThinHorzCross=15]="ThinHorzCross",e[e.ThinDiagCross=16]="ThinDiagCross",e[e.Gray125=17]="Gray125",e[e.Gray0625=18]="Gray0625"}(an||(an={})),function(e){e[e.GridBlockModel=0]="GridBlockModel",e[e.HeaderBlockModel=1]="HeaderBlockModel"}(cn||(cn={})),function(e){e[e.Value=0]="Value",e[e.Reference=1]="Reference"}(un||(un={})),function(e){e[e.Partial=1]="Partial",e[e.Full=2]="Full"}(dn||(dn={})),function(e){e[e.None=0]="None",e[e.Delay=1]="Delay",e[e.DoNotDelay=2]="DoNotDelay"}(hn||(hn={})),function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(fn||(fn={})),function(e){e[e.EntireCell=1]="EntireCell",e[e.GutterArea=2]="GutterArea",e[e.CellStartGridlineArea=4]="CellStartGridlineArea",e[e.CellEndGridlineArea=8]="CellEndGridlineArea"}(gn||(gn={})),function(e){e[e.EntireCell=1]="EntireCell"}(mn||(mn={})),function(e){e[e.DebugWatermark=0]="DebugWatermark",e[e.Headers=1]="Headers",e[e.DataCleansing=2]="DataCleansing",e[e.HeaderResize=3]="HeaderResize",e[e.UnhideSkittle=4]="UnhideSkittle",e[e.HeaderDragDropSquares=5]="HeaderDragDropSquares",e[e.HeaderInsert=6]="HeaderInsert",e[e.GeneralCellTooltip=7]="GeneralCellTooltip",e[e.DynamicImage=8]="DynamicImage",e[e.Comments=9]="Comments",e[e.RichError=10]="RichError",e[e.DrillIndicator=11]="DrillIndicator",e[e.Hyperlink=12]="Hyperlink",e[e.ColumnOrRowSelector=13]="ColumnOrRowSelector",e[e.TableSelector=14]="TableSelector",e[e.RichValueIcon=15]="RichValueIcon",e[e.AutoFilter=16]="AutoFilter",e[e.CheckboxIcon=17]="CheckboxIcon",e[e.InCellDropdown=18]="InCellDropdown"}(Cn||(Cn={}));var Sn,yn,Rn=n(462);(yn=Sn||(Sn={}))[yn.TreatZeroAndUndefinedAsEqual=0]="TreatZeroAndUndefinedAsEqual",yn[yn.AdjacentCellsMergeFix=1]="AdjacentCellsMergeFix",yn[yn.FixBoldFontsOnMac=2]="FixBoldFontsOnMac",yn[yn.TableSelectionDragSelection=3]="TableSelectionDragSelection",yn[yn.FixUserContentList=4]="FixUserContentList",yn[yn.FixRotatedTextWidth=5]="FixRotatedTextWidth",yn[yn.ResetContentList=6]="ResetContentList",yn[yn.addTelemetryForStyleIdCrash=7]="addTelemetryForStyleIdCrash",yn[yn.protectIsCellPartiallySelected=8]="protectIsCellPartiallySelected",yn[yn.RichIconFilterScale=9]="RichIconFilterScale",yn[yn.FixCellImageAlignmentWithRichPivotDrill=10]="FixCellImageAlignmentWithRichPivotDrill",yn[yn.UseClippedX=11]="UseClippedX",yn[yn.CellIconBottomPadding=12]="CellIconBottomPadding",yn[yn.FBEFormattedCellsPreviewStyle=13]="FBEFormattedCellsPreviewStyle",yn[yn.HideColMergeCellTelemetry=14]="HideColMergeCellTelemetry",yn[yn.FixHeaderSnappingAutoFilterNone=15]="FixHeaderSnappingAutoFilterNone",yn[yn.EnablingRowColCSEForComplexCellsSlice2=16]="EnablingRowColCSEForComplexCellsSlice2",yn[yn.BlockEdgeBorderThicknessFix=17]="BlockEdgeBorderThicknessFix",yn[yn.UseClippedXCheckbox=18]="UseClippedXCheckbox",yn[yn.FixCopyBlankCellToACellWithCheckbox=19]="FixCopyBlankCellToACellWithCheckbox",yn[yn.HideCommentIndicators=20]="HideCommentIndicators",yn[yn.HideColMergedCellAcrossBlocks=21]="HideColMergedCellAcrossBlocks",yn[yn.EnableMergeCellSupportForFreezePanesCse=22]="EnableMergeCellSupportForFreezePanesCse",yn[yn.CheckboxInCellImageCheck=23]="CheckboxInCellImageCheck",yn[yn.TakeAutoFilterBeforePivotFilter=24]="TakeAutoFilterBeforePivotFilter",yn[yn.MergeCellBorderScenarios=25]="MergeCellBorderScenarios",yn[yn.EnableFreezePanesCSEForMergedEdgeCells=26]="EnableFreezePanesCSEForMergedEdgeCells",yn[yn.DoubleBorderFormattingFix=27]="DoubleBorderFormattingFix",yn[yn.MungedBorderBugFixes=28]="MungedBorderBugFixes",yn[yn.HideDeleteCSEBlockEdgeBorderFix=29]="HideDeleteCSEBlockEdgeBorderFix",yn[yn.GroupRowColBugFix=30]="GroupRowColBugFix",yn[yn.XLYellowFontLoadCheckNew=31]="XLYellowFontLoadCheckNew",yn[yn.AddFontFlickerTelemetry=32]="AddFontFlickerTelemetry",yn[yn.BorderInsertionBugFix=33]="BorderInsertionBugFix",yn[yn.InsertOperationBugFix=34]="InsertOperationBugFix",yn[yn.EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks=35]="EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks",yn[yn.MergeInfoResetBugFix=36]="MergeInfoResetBugFix",yn[yn.MergeInfoOriginRowColMismatchBugFix=37]="MergeInfoOriginRowColMismatchBugFix",yn[yn.InsertCSEForMergeCellSpanningBlocks=38]="InsertCSEForMergeCellSpanningBlocks",yn[yn.CacheIsResizeAllowedValue=39]="CacheIsResizeAllowedValue",yn[yn.AddHorizontalPaddingWithScaleFactor=40]="AddHorizontalPaddingWithScaleFactor",yn[yn.InCellControlCheckboxAlignmentChangeInTextRotaion=41]="InCellControlCheckboxAlignmentChangeInTextRotaion",yn[yn.ModelComparisonIsSpillBlocked=42]="ModelComparisonIsSpillBlocked",yn[yn.CheckboxClickWithCtrl=43]="CheckboxClickWithCtrl",yn[yn.BussinessBarForCheckboxInReadOnly=44]="BussinessBarForCheckboxInReadOnly",yn[yn.ToggleIconCSE=45]="ToggleIconCSE",yn[yn.RichValuesWithFallbackShouldOverrideText=46]="RichValuesWithFallbackShouldOverrideText",yn[yn.OptimizeUnnecessaryHeaderCanvasCalls=47]="OptimizeUnnecessaryHeaderCanvasCalls",yn[yn.HeaderInsert=48]="HeaderInsert",yn[yn.CheckboxFallbackFontIncreaseChecks=49]="CheckboxFallbackFontIncreaseChecks",yn[yn.FixingSortFilterRenderingIssue=50]="FixingSortFilterRenderingIssue",yn[yn.FixingBorderInMergeCellSpanningBlocks=51]="FixingBorderInMergeCellSpanningBlocks",yn[yn.RenderResizePillAcrossBlock=52]="RenderResizePillAcrossBlock",yn[yn.FreezePanesSpillCellFix=53]="FreezePanesSpillCellFix",yn[yn.FreezePanesCseSlice1=54]="FreezePanesCseSlice1",yn[yn.FreezePanesCseSlice2=55]="FreezePanesCseSlice2",yn[yn.SpillCellMaxWidth=56]="SpillCellMaxWidth",yn[yn.ModelCascadeGetStyleIdUsingGlobalStylesFix=57]="ModelCascadeGetStyleIdUsingGlobalStylesFix",yn[yn.ShowCommentOnActiveCellOnTouchDevices=58]="ShowCommentOnActiveCellOnTouchDevices",yn[yn.BidiJsIndexFix=59]="BidiJsIndexFix",yn[yn.BidiJsForReorder=60]="BidiJsForReorder",yn[yn.EmptyPivotZoomRenderingFix=61]="EmptyPivotZoomRenderingFix",yn[yn.ApplyFilterCseEnableForAutofitTolType=62]="ApplyFilterCseEnableForAutofitTolType",yn[yn.SetTransformTelemetry=63]="SetTransformTelemetry",yn[yn.OptimizeRowHeightOverrideProcessing=64]="OptimizeRowHeightOverrideProcessing",yn[yn.AvoidLastVisibleCharIndexHintZero=65]="AvoidLastVisibleCharIndexHintZero",yn[yn.AddHashesTelemetry=66]="AddHashesTelemetry",yn[yn.FontFidelityCorrections=67]="FontFidelityCorrections",yn[yn.WrapTextOptimizationFgToCg=68]="WrapTextOptimizationFgToCg",yn[yn.CompareDwriteHintDrawingTime=69]="CompareDwriteHintDrawingTime",yn[yn.DropdownArrowHighContrastVisibility=70]="DropdownArrowHighContrastVisibility",yn[yn.ArialFontRenderingFix=71]="ArialFontRenderingFix",yn[yn.UnhideRowColumnUXImprovementsSlice1=72]="UnhideRowColumnUXImprovementsSlice1",yn[yn.UseDisplayTextForHashes=73]="UseDisplayTextForHashes",yn[yn.LogUndefinedColWidthCalculation=74]="LogUndefinedColWidthCalculation",yn[yn.LastChangeGateDontDelete=75]="LastChangeGateDontDelete";const Tn=32;let In=Sn.LastChangeGateDontDelete,{changeGatesNamesArray:vn,changeGatesBitMap:bn,cachedChangeGatesBitMap:xn}=function(e,t){const n=new Array(e),o=Math.ceil(e/t);return{changeGatesNamesArray:n,changeGatesBitMap:An(o),cachedChangeGatesBitMap:An(o)}}(In,Tn);function Fn(e){const t=Math.floor(e/Tn),n=1<<e%Tn;return function(e,t,n){Dn(xn,t,n)||((0,Rn.isChangeGateEnabled)(vn[e])&&Mn(bn,t,n),Mn(xn,t,n))}(e,t,n),Dn(bn,t,n)}function Dn(e,t,n){return 0!=(e[t]&n)}function Mn(e,t,n){e[t]|=n}function An(e){return Array.apply(null,new Array(e)).map((()=>0))}vn[Sn.TreatZeroAndUndefinedAsEqual]="OfficeVSO:5010362_TreatZeroAndUndefinedAsEqual",vn[Sn.AdjacentCellsMergeFix]="OfficeVSO:5230472_adjacentCellsMergeFix2",vn[Sn.FixBoldFontsOnMac]="OfficeVSO:7477362_FixBoldFontsOnMacn",vn[Sn.TableSelectionDragSelection]="OfficeVSO:5501896_TableSelectionDragSelection",vn[Sn.FixUserContentList]="OfficeVSO:6006812_FixUserContentList",vn[Sn.FixRotatedTextWidth]="OfficeVSO:6582281_FixRotatedTextWidth",vn[Sn.ResetContentList]="OfficeVSO:7259557_ResetContentList",vn[Sn.addTelemetryForStyleIdCrash]="OfficeVSO:7426943_addTelemetryForStyleIdCrash2",vn[Sn.protectIsCellPartiallySelected]="OfficeVSO:7733119_protectIsCellPartiallySelected",vn[Sn.RichIconFilterScale]="OfficeVSO:7525144_RichIconFilterScale",vn[Sn.FixCellImageAlignmentWithRichPivotDrill]="OfficeVSO:7910214_FixCellImageAlignmentWithRichPivotDrill",vn[Sn.UseClippedX]="OfficeVSO:7868644_InCellControlCheckboxClippingInXLO",vn[Sn.CellIconBottomPadding]="OfficeVSO:7944046_CellIconBottomPadding",vn[Sn.FixHeaderSnappingAutoFilterNone]="OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone",vn[Sn.HideColMergeCellTelemetry]="OfficeVSO:8137545_HideColMergeCellTelemetry",vn[Sn.EnablingRowColCSEForComplexCellsSlice2]="OfficeVSO:8633190_EnablingRowColCSEForComplexCellsSlice2",vn[Sn.BlockEdgeBorderThicknessFix]="OfficeVSO:8612257_BlockEdgeBorderThicknessFix",vn[Sn.UseClippedXCheckbox]="OfficeVSO:8654438_UseClippedXCheckbox",vn[Sn.FixCopyBlankCellToACellWithCheckbox]="OfficeVSO:8689743_FixCopyBlankCellToACellWithCheckbox",vn[Sn.HideCommentIndicators]="OfficeVSO:8608691_HideCommentIndicators",vn[Sn.HideColMergedCellAcrossBlocks]=" OfficeVSO:8776386_HideColMergedCellAcrossBlocksEnabled",vn[Sn.EnableMergeCellSupportForFreezePanesCse]="OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells",vn[Sn.CheckboxInCellImageCheck]="OfficeVSO:8766511_CheckboxInCellImageCheck",vn[Sn.TakeAutoFilterBeforePivotFilter]="OfficeVSO:8812177_TakeAutoFilterBeforePivotFilter",vn[Sn.MergeCellBorderScenarios]="OfficeVSO:8834380_MergeCellBorderScenarios",vn[Sn.EnableFreezePanesCSEForMergedEdgeCells]="OfficeVSO:8864410_EnableFreezePanesCSEForMergedEdgeCells",vn[Sn.DoubleBorderFormattingFix]="OfficeVSO:8875644_DoubleBorderFormattingFix",vn[Sn.MungedBorderBugFixes]="OfficeVSO:9010304_MungedBorderBugFixes",vn[Sn.HideDeleteCSEBlockEdgeBorderFix]="OfficeVSO:9013637_HideDeleteCSEBlockEdgeBorderFix",vn[Sn.XLYellowFontLoadCheckNew]="OfficeVSO:9072398_XLYellowFontLoadCheckNew",vn[Sn.EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks]="OfficeVSO:9198763_EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks",vn[Sn.MergeInfoResetBugFix]="OfficeVSO:9199196_MergeInfoResetBugFix",vn[Sn.MergeInfoOriginRowColMismatchBugFix]="OfficeVSO:9200695_MergeInfoOriginRowColMismatchBugFix",vn[Sn.AddFontFlickerTelemetry]="OfficeVSO:8927459_AddFontFlickerTelemetryV2",vn[Sn.BorderInsertionBugFix]="OfficeVSO:9186234_BorderInsertionBugFix",vn[Sn.InsertOperationBugFix]="OfficeVSO:9189954_InsertOperationBugFix",vn[Sn.AddHorizontalPaddingWithScaleFactor]="OfficeVSO:8830743_AddHorizontalPaddingWithScaleFactorForRichValueIcon",vn[Sn.InsertCSEForMergeCellSpanningBlocks]="OfficeVSO:9214402_InsertCSEForMergeCellSpanningBlocks",vn[Sn.CacheIsResizeAllowedValue]="OfficeVSO:9159241_cacheIsResizeAllowedValue",vn[Sn.InCellControlCheckboxAlignmentChangeInTextRotaion]="OfficeVSO:9024501_InCellControlCheckboxAlignmentChangeInTextRotaion",vn[Sn.ModelComparisonIsSpillBlocked]="OfficeVSO:9422357_ModelComparisonIsSpillBlocked",vn[Sn.CheckboxClickWithCtrl]="OfficeVSO:9476369_CheckboxClickWithCtrl",vn[Sn.BussinessBarForCheckboxInReadOnly]="OfficeVSO:9456703_BussinessBarForCheckboxInReadOnly",vn[Sn.ToggleIconCSE]="OfficeVSO:9365066_ToggleIconCSE",vn[Sn.RichValuesWithFallbackShouldOverrideText]="OfficeVSO:9250060_RichValuesWithFallbackShouldOverrideText",vn[Sn.OptimizeUnnecessaryHeaderCanvasCalls]="OfficeVSO:9566139_OptimizeUnnecessaryHeaderCanvasCalls",vn[Sn.HeaderInsert]="OfficeVSO:9566205_HeaderInsert",vn[Sn.CheckboxFallbackFontIncreaseChecks]="OfficeVSO:9562407_CheckboxFallbackFontIncreaseChecks",vn[Sn.FixingSortFilterRenderingIssue]="OfficeVSO:9519709_FixingSortFilterRenderingIssue",vn[Sn.FixingBorderInMergeCellSpanningBlocks]="OfficeVSO:9593310_FixingBorderInMergeCellSpanningBlocks",vn[Sn.RenderResizePillAcrossBlock]="OfficeVSO:9627926_RenderResizePillAcrossBlock",vn[Sn.FreezePanesSpillCellFix]="OfficeVSO:9674226_FreezePanesSpillCellBugFix",vn[Sn.FreezePanesCseSlice1]="OfficeVSO:9701994_FreezePanesCseSlice1",vn[Sn.FreezePanesCseSlice2]="OfficeVSO:9701995_FreezePanesCseSlice2",vn[Sn.SpillCellMaxWidth]="OfficeVSO:9824933_spillCellMaxWidth",vn[Sn.ModelCascadeGetStyleIdUsingGlobalStylesFix]="OfficeVSO:9795194_ModelCascadeGetStyleIdUsingGlobalStylesFix",vn[Sn.ShowCommentOnActiveCellOnTouchDevices]="OfficeVSO:9965821_ShowCommentOnActiveCellOnTouchDevices",vn[Sn.BidiJsIndexFix]="OfficeVSO:10311419_bidiJsIndexFix",vn[Sn.BidiJsForReorder]="OfficeVSO:10369197_bidijsForReorder",vn[Sn.EmptyPivotZoomRenderingFix]="OfficeVSO:10280727_emptyPivotZoomRenderingFix",vn[Sn.ApplyFilterCseEnableForAutofitTolType]="OfficeVSO:10319179_ApplyFilterCseEnableForAutofitTolType",vn[Sn.SetTransformTelemetry]="OfficeVSO:10330835_SetTransformTelemetry",vn[Sn.OptimizeRowHeightOverrideProcessing]="OfficeVSO:10368532_OptimizeRowHeightOverrideProcessing",vn[Sn.AddHashesTelemetry]="ChangeGate.OfficeVSO:10658554_AddHashesTelemetry",vn[Sn.FontFidelityCorrections]="ChangeGate.OfficeVSO:10667688_FontFidelityCorrections",vn[Sn.WrapTextOptimizationFgToCg]="ChangeGate.OfficeVSO:10769772_WrapTextOpimizationFgToCg",vn[Sn.AvoidLastVisibleCharIndexHintZero]="ChangeGate.OfficeVSO:10846608_AvoidLastVisibleCharIndexHintZero",vn[Sn.CompareDwriteHintDrawingTime]="ChangeGate.OfficeVSO:10795287_CompareDwriteHintDrawingTime",vn[Sn.DropdownArrowHighContrastVisibility]="ChangeGate.OfficeVSO:10826145_DropdownArrowHighContrastVisibility",vn[Sn.ArialFontRenderingFix]="ChangeGate.OfficeVSO:10833850_ArialFontRenderingFix",vn[Sn.UnhideRowColumnUXImprovementsSlice1]="ChangeGate.OfficeVSO:10979685_UnhideRowColumnUXImprovementsSlice1",vn[Sn.UseDisplayTextForHashes]="ChangeGate.OfficeVSO:11058610_UseDisplayTextForHashes",vn[Sn.LogUndefinedColWidthCalculation]="ChangeGate.OfficeVSO:11101585_LogUndefinedColWidthCalculation";const On={Color:"#000000",FontName:"Calibri",FontScheme:2,Size:11,Underline:0,VerticalAlign:0},Bn={VerticalAlignment:2,GlobalFontID:0,ID:-1};class kn{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const Pn=new class{setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}forwardFeedbackCacheLogs(){this.externalLogger.forwardFeedbackCacheLogs?.()}constructor(){this.externalLogger=new kn}};var En,Hn,Ln,Nn;(Hn=En||(En={}))[Hn.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",Hn[Hn.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",Hn[Hn.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",Hn[Hn.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",Hn[Hn.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",Hn[Hn.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",Hn[Hn.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",Hn[Hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",Hn[Hn.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",Hn[Hn.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",Hn[Hn.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",Hn[Hn.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",Hn[Hn.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",Hn[Hn.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",Hn[Hn.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",Hn[Hn.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",Hn[Hn.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",Hn[Hn.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",Hn[Hn.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",Hn[Hn.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",Hn[Hn.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",Hn[Hn.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",Hn[Hn.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",Hn[Hn.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",Hn[Hn.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",Hn[Hn.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",Hn[Hn.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",Hn[Hn.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",Hn[Hn.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",Hn[Hn.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",Hn[Hn.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",Hn[Hn.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",Hn[Hn.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",Hn[Hn.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",Hn[Hn.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",Hn[Hn.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",Hn[Hn.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",Hn[Hn.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",Hn[Hn.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",Hn[Hn.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",Hn[Hn.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",Hn[Hn.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",Hn[Hn.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",Hn[Hn.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",Hn[Hn.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",Hn[Hn.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",Hn[Hn.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",Hn[Hn.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",Hn[Hn.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",Hn[Hn.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",Hn[Hn.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",Hn[Hn.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",Hn[Hn.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",Hn[Hn.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",Hn[Hn.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",Hn[Hn.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",Hn[Hn.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",Hn[Hn.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",Hn[Hn.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",Hn[Hn.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",Hn[Hn.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",Hn[Hn.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",Hn[Hn.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",Hn[Hn.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",Hn[Hn.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",Hn[Hn.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",Hn[Hn.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",Hn[Hn.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",Hn[Hn.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",Hn[Hn.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",Hn[Hn.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",Hn[Hn.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",Hn[Hn.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",Hn[Hn.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",Hn[Hn.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",Hn[Hn.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",Hn[Hn.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",Hn[Hn.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",Hn[Hn.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",Hn[Hn.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",Hn[Hn.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",Hn[Hn.msoulscat_AIHub_CreateModuleLicensing=4013]="msoulscat_AIHub_CreateModuleLicensing",Hn[Hn.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",Hn[Hn.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",Hn[Hn.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",Hn[Hn.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",Hn[Hn.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",Hn[Hn.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video",(Nn=Ln||(Ln={}))[Nn.CellStyle=0]="CellStyle",Nn[Nn.BorderStyle=1]="BorderStyle",Nn[Nn.Font=2]="Font";class Wn{process(e){if(0!==e.length)for(let t=0;t<e.length;t++)if(e[t]){const n=e[t];if(!pn(n.GlobalId))continue;n.ID||(n.ID=0);const o=this.getOrCreateID(n);if(void 0===o)throw new Error("GlobalStyle::Interface::Process: global style ID is undefined");n.GlobalId=o}}getObject(e){if(e<0||e>=this.count)throw new Error(`GlobalStyle::Interface::GetStyle: global style ID ${e} is not valid`);return this.styles[e]}clear(){this.count=0,this.styles.splice(0,this.styles.length),this.keyToGlobalIDMap.clear(),this.initializeDefaultStyles()}disable(e){if(!this.enabled)return;this.enabled=!1;const t=`GlobalStyle::Interface::Disable: ${e} ${new Error(e).stack||""}`;Pn.sendTraceTag(508900295,En.msoulscat_ES_EWAJSGrid,d.Warning,t)}constructor(){this.count=0,this.styles=[],this.keyToGlobalIDMap=new Map,this.enabled=!0}}const _n="|";function zn(e){return[Un(e.Bold),_n,Un(e.Italic),_n,Un(e.StrikeThrough),_n,$n(e.FontName),_n,$n(e.Size),_n,$n(e.Color),_n,$n(e.Underline),_n,$n(e.VerticalAlign),_n,$n(e.FontScheme),_n].join("")}function Gn(e){return[$n(e.BorderLineStyle),_n,$n(e.BorderPosition),_n,$n(e.Weight),_n,(t=e.Color,[$n(t.Red),_n,$n(t.Green),_n,$n(t.Blue)].join(""))].join("");var t}function Vn(e){if(!e)return"0";const t=[$n(e.ShadingStyle)];for(let n=0;n<e.Stops?.length;n++){const o=e.Stops[n];o&&t.push(_n,jn(o))}return t.join("")}function jn(e){return[$n(e.Color),_n,$n(e.Position)].join("")}function Un(e){return e?"1":"0"}function $n(e){return e?e.toString():"0"}class qn extends Wn{initializeDefaultStyles(){qn.DefaultBorderStyleID=this.getOrCreateID({Borders:[],ID:0})}static getInstance(){return qn.instance||(qn.instance=new qn),qn.instance}getOrCreateID(e){const t=function(e){const t=[Un(e.HasDiagBorder),_n];for(let n=0;n<e.Borders?.length;n++){const o=e.Borders[n];o&&t.push(Gn(o),_n)}return t.join("")}(e);let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=function(e,t,n){const o=[];for(let t=0;t<e.Borders.length;t++){const n=e.Borders[t],r={BorderLineStyle:n.BorderLineStyle,BorderPosition:n.BorderPosition,Weight:n.Weight,Color:{Red:n.Color.Red,Blue:n.Color.Blue,Green:n.Color.Green}};o.push(r)}return{Borders:o,GlobalId:e.GlobalId,ID:t||0,RefCount:n||0}}(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}clear(){Pn.sendTraceTag(508941207,En.msoulscat_ES_EWAJSGrid,d.Warning,`GlobalBorderStyles: Total unique style count is ${this.count}`),super.clear(),this.initializeDefaultStyles()}getDefaultBorderStyle(){return this.styles[qn.DefaultBorderStyleID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalBorderStyles:this.forceEnableGlobalBorderStyles}}forceEnableGlobalBorderStyles(){qn.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function Xn(e){return Yn().getObject(e)}function Yn(){return qn.getInstance()}function Jn(){return Yn().isEnabled()}function Kn(e){return Yn().disable(e)}qn.instance=void 0;class Qn extends Wn{initializeDefaultStyles(){Qn.DefaultFontID=this.getOrCreateID(On)}static getInstance(){return Qn.instance||(Qn.instance=new Qn),Qn.instance}getOrCreateID(e){const t=zn(e);let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const l=(o=e,r=e.ID||0,i=e.RefCount||0,{Bold:o.Bold,Color:o.Color,FontName:o.FontName,FontScheme:o.FontScheme,ID:r||0,GlobalId:o.GlobalId,Italic:o.Italic,RefCount:i||0,Size:o.Size,StrikeThrough:o.StrikeThrough,Underline:o.Underline,VerticalAlign:o.VerticalAlign});return this.styles.push(l),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}var o,r,i;return n}clear(){Pn.sendTraceTag(508389603,En.msoulscat_ES_EWAJSGrid,d.Warning,`GlobalFonts: Total unique style count is ${this.count}`),super.clear(),this.initializeDefaultStyles()}getDefaultFont(){return this.styles[Qn.DefaultFontID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalFonts:this.forceEnableGlobalFonts}}forceEnableGlobalFonts(){Qn.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function Zn(e){return eo().getObject(e)}function eo(){return Qn.getInstance()}function to(){return eo().isEnabled()}Qn.instance=void 0;class no extends Wn{initializeDefaultStyles(){no.DefaultCellStyleID=this.getOrCreateID(Bn)}static getInstance(){if(!no.instance)try{return no.instance=new no,no.instance}catch(e){throw new Error(`exception while creating GlobalCellStyles: ${e}`)}return no.instance}getOrCreateID(e){const t=function(e){if(null!==e.GlobalFontID&&void 0!==e.GlobalFontID)try{const t=zn(Zn(e.GlobalFontID));return function(e){return[Un(e.VerticalText),_n,Un(e.ShrinkToFit),_n,$n(e.HorizontalAlignment),_n,$n(e.VerticalAlignment),_n,$n(e.ReadingOrder),_n,$n(e.Orientation||0),_n,$n(e.Indentation||0),_n,$n(e.BackgroundColor),_n,Vn(e.Gradient),_n,Un(e.IsUnlocked),_n,Un(e.IsHidden),_n,$n(e.NamedStyleId||0),_n,$n(e.PatternStyle),_n,$n(e.PatternColor),_n].join("")}(e)+t+"|"}catch(e){io(`${e}`)}else io("GenerateCellStyleKey:: Global font ID is not present")}(e);if(void 0===t)return;let n=this.keyToGlobalIDMap.get(t);if(void 0===n){n=this.count,e.GlobalId=n;const o=function(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||Ht.Automatic,ID:t||0,GlobalId:e.GlobalId,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||Et.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID||0,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}(e,e.ID||0,e.RefCount||0);return this.styles.push(o),this.keyToGlobalIDMap.set(t,this.count),this.count=this.count+1,n}return n}getDefaultCellStyle(){return this.styles[no.DefaultCellStyleID]}isEnabled(){return this.enabled}testExports(){return{forceEnableGlobalCellStyles:this.forceEnableGlobalCellStyles}}forceEnableGlobalCellStyles(){no.getInstance().enabled=!0}constructor(){super(),this.initializeDefaultStyles()}}function oo(){return no.getInstance()}function ro(e){return oo().getObject(e)}function io(e){oo().disable(e),eo().disable("GlobalFontsDisabled: Due to disabling of Global Cell Styles")}function lo(e){eo().disable(e),oo().disable("GlobalCellStyledDisabled: Due to disabling of Global Fonts")}function so(){return oo().isEnabled()&&to()}function ao(e,t){let n;if(Jn()&&!pn(e.GlobalBorderStyleID))try{return Xn(e.GlobalBorderStyleID)}catch(e){n=void 0,Kn(`getBorderStyleByID failed with exception: ${e.message}`)}return void 0===n?wn(e.BorderStyleID||0,t.BorderStyles):n}function co(e,t,n){let o;const r=e.GlobalFontID,i=e.FontID||0,l=so();if(l&&!pn(r))try{o=Zn(r),o||lo("getFontByGlobalID returned null or undefined")}catch(e){o=void 0,lo(`getFontByID failed with exception: ${e.message}`)}if(void 0===o){try{if(l&&!pn(n)){const e=wn(n||0,t.Styles);return wn(e.FontID||0,t.Fonts)}}catch(e){return wn(i||0,t.Fonts)}return wn(i||0,t.Fonts)}return o}function uo(e,t){let n;if(so()&&!pn(e.GlobalCellStyleID))try{return ro(e.GlobalCellStyleID)}catch(e){n=void 0,io(`getCellStyleByID failed with exception: ${e.message}`)}return void 0===n?wn(e.StyleID||0,t.Styles):n}no.instance=void 0;const ho=32;let fo=28,go=30,mo=5,Co=32,po=1<<mo,wo=!1;function So(e){if(e<=0)throw new Error("Input must be positive");if(0==(e&e-1))return Math.log2(e)+1;let t=0,n=e;for(;n>0;)n>>=1,t++;return t}function yo(e,t){if(!pn(t.RenderFlagsArray)){const n=Math.floor(e/ho);if(n<t.RenderFlagsArray.length){const o=e%ho;return 0!=(t.RenderFlagsArray[n]&1<<o)}}return!1}function Ro(e,t,n){if(null==e)throw Error(`${n}.verifyArgumentNotNull: ${t} cannot be null or undefined`)}function To(e){Ro(e,"model","preprocessModelStyles"),Ro(e.Cells,"model.Cells","preprocessModelStyles");const t=so();if(!e.ClientOnlyCache?.isProcessedForGlobalStyles){if(Jn()&&!pn(e.BorderStyles))try{!function(e,t){const n=Yn();n.process(t);for(let o=0;o<e.length;o++){const r=e[o],i=r.BorderStyleID||0;let l;if(l=void 0!==r.GlobalBorderStyleID&&null!==r.GlobalBorderStyleID&&n.getObject(r.GlobalBorderStyleID)?r.GlobalBorderStyleID:Io(i,t),null==l)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalBorderStyles: Local Cell BorderStyleID ${i} not mapped to a Global Border Style ID`);r.GlobalBorderStyleID=l}}(e.Cells,e.BorderStyles)}catch(e){return Kn(`${e}`),lo(`${e}`),void io(`${e}`)}if(t&&!pn(e.Fonts)&&!pn(e.Styles))try{!function(e,t,n){const o=eo();o.process(n);for(let e=0;e<t.length;e++){const r=t[e];if(r){const e=r.FontID||0;let t;if(t=void 0!==r.GlobalFontID&&null!==r.GlobalFontID&&o.getObject(r.GlobalFontID)?r.GlobalFontID:Io(e,n),null==t)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local FontID ${e} not mapped to a Global Font ID`);r.GlobalFontID=t}}for(let t=0;t<e.length;t++){const r=e[t];if(r&&r.TextRuns){const e=r.TextRuns;for(let t=0;t<e.length;t++){const r=e[t];let i;if(i=void 0!==r.GlobalFontID&&null!==r.GlobalFontID&&o.getObject(r.GlobalFontID)?r.GlobalFontID:Io(r.FontID||0,n),null==i)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessModelFontsWithGlobalStyles: Local Cell Text run FontID ${r.FontID} not mapped to a Global Font ID`);r.GlobalFontID=i}}}}(e.Cells,e.Styles,e.Fonts)}catch(e){return Kn(`${e}`),lo(`${e}`),void io(`${e}`)}if(t&&!pn(e.Styles))try{!function(e,t){const n=oo();n.process(t);for(let o=0;o<e.length;o++){const r=e[o],i=r.StyleID||0;let l;if(l=void 0!==r.GlobalCellStyleID&&null!==r.GlobalCellStyleID&&n.getObject(r.GlobalCellStyleID)?r.GlobalCellStyleID:Io(i,t),null==l)throw new Error(`GlobalStyle::GlobalStylesManager::preprocessCellsWithGlobalStyles: Local Cell StyleID ${i} not mapped to a Global Style ID`);r.GlobalCellStyleID=l}}(e.Cells,e.Styles)}catch(e){return Kn(`${e}`),lo(`${e}`),void io(`${e}`)}e.ClientOnlyCache||(e.ClientOnlyCache={}),e.ClientOnlyCache.isProcessedForGlobalStyles=!0}}function Io(e,t){try{return wn(e,t).GlobalId}catch(e){return}}let vo,bo,xo,Fo,Do,Mo;function Ao(e,t){return(e<<mo)+t}function Oo(e){return{row:e>>mo,column:e%po}}function Bo(e,t){if(Fn(Sn.TreatZeroAndUndefinedAsEqual)){if(Ro(e,"Id","helpers.getReferencedObjectToCache"),!pn(t))return wn(e,t)}else if(!pn(t)&&!pn(e))return wn(e,t)}function ko(e){void 0===Fo&&(Fo=Fn(Sn.RichValuesWithFallbackShouldOverrideText));const t=e.ValueType;if(Fo){if(e.RichValueType)return t===Wt.Number||t===Wt.Boolean}else if(e.RichValueType)return!1;return t===Wt.Number||t===Wt.Boolean||t===Wt.Error}function Po(e){return!!function(e){return e.ValueType===Wt.Number}(e)&&!pn(e.NumFmt)&&""!==e.Text}function Eo(e,t,n=void 0,o=void 0){const r=n&&0!==n.length?wn(Nt.Default,n):void 0;return{Col:t,CachedStyle:r,CachedFont:o&&0!==o.length&&r?wn(r.FontID||0,o):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:Nt.Default,BorderStyleID:Nt.DefaultBorder,CachedBorderStyle:{Borders:[],ID:0},Text:"",ValueType:Wt.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}function Ho(e,t,n){let o=[];if(o=o.concat(function(e,t,n){if(!t.Merge&&!t.Spill)return[];const o=[];if(t.Merge)for(let e=0;e<=t.Merge.Rows;e++)for(let n=0;n<=t.Merge.Columns;n++)o.push(Ao(t.Row+e,t.Col+n));if(t.Spill){for(let e=0;e<t.Spill.SpanToEnd;e++)o.push(Ao(t.Row,t.Col+e+1));for(let e=0;e<t.Spill.SpanToStart;e++)o.push(Ao(t.Row,t.Col-e-1));if(t.Spill.SpanToEnd){const r=t.Col+t.Spill.SpanToEnd,i=tr(e,n,fn.End,t.Row,r);i&&o.push(Ao(i.Row,i.Col))}if(t.Spill.SpanToStart){const r=t.Col-t.Spill.SpanToStart,i=tr(e,n,fn.Start,t.Row,r);i&&o.push(Ao(i.Row,i.Col))}}return o}(e,t,n)),0===o.length){const r=tr(e,n,fn.Start,t.Row,t.Col);r&&o.push(Ao(r.Row,r.Col));const i=tr(e,n,fn.End,t.Row,t.Col);i&&o.push(Ao(i.Row,i.Col))}return o}function Lo(e,t){const n=[];for(let o=0;o<t.length;o++){const r=t[o],{row:i,column:l}=Oo(r),{cellBefore:s,cellAfter:a}=or(e,i,l);s&&er(s)&&nr(s,l,fn.End)&&n.push(Ao(s.Row,s.Col)),a&&er(a)&&nr(a,l,fn.Start)&&n.push(Ao(a.Row,a.Col))}return n}function No(e,t,n){const o=[];if(t-1>=0){const r=zo(e,t-1,n);o.push(Ao(r.Row,r.Col))}if(n-1>=0){const r=zo(e,t,n-1);o.push(Ao(r.Row,r.Col))}if(t+1<e.RowNumbers.length){const r=zo(e,t+1,n);o.push(Ao(r.Row,r.Col))}if(n+1<e.ColumnNumbers.length){const r=zo(e,t,n+1);o.push(Ao(r.Row,r.Col))}return o}function Wo(e,t){let n=[];const o=Math.max(0,t.Row-1),r=Math.min(e.RowNumbers.length-1,t.Row+1+(t?.Merge?.Rows||0)),i=Math.max(0,t.Col-1),l=Math.min(e.ColumnNumbers.length-1,t.Col+1+(t.Merge?.Columns||0));for(let t=o;t<=r;t++)hr(e,n,t,i),hr(e,n,t,l);for(let t=i;t<=l;t++)hr(e,n,o,t),hr(e,n,r,t);return n=n.concat(Lo(e.Cells,n)),n}function _o(e){return e.ClientOnlyCache||Vo(e),e.ClientOnlyCache}function zo(e,t,n){return $o(t,n,e)||(Go(e,t,n),Eo(t,n,e.Styles,e.Fonts))}function Go(e,t,n){if(Ro(e.RowNumbers,"RowNumbers","validateCellShouldExistInModelUnsafe"),Ro(e.ColumnNumbers,"ColumnNumbers","validateCellShouldExistInModelUnsafe"),Ro(e.Styles,"Styles","validateCellShouldExistInModelUnsafe"),t<0||n<0||t>=e.RowNumbers.length||n>=e.ColumnNumbers.length)throw Error(`validateCellShouldExistInModelUnsafe: cell requested for a cell which is not in range of the model. rowIndex:  ${t}, RowNumbers.length: ${e.RowNumbers.length},  colIndex:  ${n}, ColumnNumbers.length: ${e.ColumnNumbers.length}`)}function Vo(e){e.ClientOnlyCache||(e.ClientOnlyCache={},e.ClientOnlyCache.DirtyType=on.None),e.ClientOnlyCache.RenderingRegionsHitTestCache||function(e){e.ClientOnlyCache&&(e.ClientOnlyCache.RenderingRegionsHitTestCache={})}(e);const t=e.ClientOnlyCache;if(Uo(e))if(mr())t.DirtyCellsMap=new Map(Array.from(t.DirtyCellsMap).sort((([e],[t])=>rr(e,t))));else{const e=t.DirtyCellsKeys.filter(Yo);t.DirtyCellsKeys=e.sort(rr)}t.CellsToRender=function(e){return Uo(e)?(e.ClientOnlyCache.CellLookup=Ko(e),mr()?function(e,t){const n=[];for(const[o]of t)lr(e,o,n);return n}(e,e.ClientOnlyCache.DirtyCellsMap):sr(e,e.ClientOnlyCache.DirtyCellsKeys)):e.Cells}(e),mr()?t.GridlineOverridingCellsToRender=ar(e,void 0,t.DirtyCellsMap):t.GridlineOverridingCellsToRender=ar(e,t.DirtyCellsKeys,void 0),e.ClientOnlyCache.FallbackFonts={},e.ClientOnlyCache.renderWithOldDefaultFont=!1}function jo(e,t){e.ClientOnlyCache&&e.ClientOnlyCache.RenderingRegionsHitTestCache||Vo(e);return e.ClientOnlyCache.RenderingRegionsHitTestCache[t]||(e.ClientOnlyCache.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}},e.ClientOnlyCache.RenderingRegionsHitTestCache[t])}function Uo(e){const t=_o(e);return mr()?t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsMap&&t.DirtyCellsMap.size>0:t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsKeys&&t.DirtyCellsKeys.length>0}function $o(e,t,n){Ro(n,"model","initCellLookup");const o=_o(n);return o.CellLookup||(o.CellLookup=Ko(n)),o.CellLookup[Ao(e,t)]}function qo(e,t){return Ro(t,"cell","getCellStyle"),Ro(e.Styles,"Styles","getCellStyle"),t.CachedStyle||(t.CachedStyle=uo(t,e)),t.CachedStyle}function Xo(e,t){return ir(e.Row,e.Col,t.Row,t.Col)}function Yo(e,t,n){return n.indexOf(e)===t}function Jo(e,t){return t.Spill?e===fn.Start?t.Spill.SpanToStart:t.Spill.SpanToEnd:0}function Ko(e){Ro(e,"model","initCellLookup"),Ro(e.Cells,"model.Cells","initCellLookup");const t={};for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];if(o)if(t[Ao(o.Row,o.Col)]=o,o.Merge)for(let e=0;e<=o.Merge.Rows;e++)for(let n=0;n<=o.Merge.Columns;n++)t[Ao(o.Row+e,o.Col+n)]=o;else t[Ao(o.Row,o.Col)]=o}return t}function Qo(e){if(!e||0===e.length)return;const t=[];for(let n=0;n<e.length;++n){const o=e[n],r={Outlines:[]};for(let e=0;e<o.Outlines.length;++e){const t={...o.Outlines[e]};r.Outlines.push(t)}t.push(r)}return t}function Zo(e,t){return Ro(t,"cell","getCellBorderStyle"),Ro(e.BorderStyles,"BorderStyles","getCellBorderStyle"),t.CachedBorderStyle?t.CachedBorderStyle:ao(t,e)}function er(e){return e&&!!e.Text&&""!==e.Text}function tr(e,t,n,o,r){let i=t+n;for(;i>=0&&i<e.length;){const t=e[i];if(t.Row!==o)return;if(er(t))return nr(t,r,-n)?t:void 0;i+=n}}function nr(e,t,n){const o=Math.abs(t-e.Col);return!!(e.Spill&&Jo(n,e)>=o)}function or(e,t,n){let o,r;for(let i=0;i<e.length;i++){const l=e[i];if(!(l.Row<t)){if(l.Row>t)break;if(l.Col<n&&(o=l),l.Col>n){r=l;break}}}return{cellBefore:o,cellAfter:r}}function rr(e,t){const n=Oo(e),o=Oo(t);return ir(n.row,n.column,o.row,o.column)}function ir(e,t,n,o){return e===n&&t===o?0:e>n||e===n&&t>o?1:-1}function lr(e,t,n){const o=e.ClientOnlyCache.CellLookup[t],{row:r,column:i}=Oo(t);o&&o.Row===r&&o.Col===i&&n.push(o)}function sr(e,t){const n=[],o=e.ClientOnlyCache;for(let r=0;r<t.length;r++){const i=t[r];if(mr())lr(e,i,n);else{const e=o.CellLookup[i],{row:t,column:r}=Oo(i);e&&e.Row===t&&e.Col===r&&n.push(e)}}return n}function ar(e,t,n){if(!Uo(e))return e.Cells;if(function(e){return Ro(e,"model","modelType"),void 0!==e.IsRow?cn.HeaderBlockModel:cn.GridBlockModel}(e)===cn.HeaderBlockModel)return[];if(mr()){const t=new Set;for(const[o]of n){const n=cr(e,o);t.add(o);for(let e=0;e<n.length;e++)t.add(n[e])}return sr(e,Array.from(t).sort(rr))}const o=[];for(let n=0;n<t.length;n++){const r=t[n],i=cr(e,r);o.push(r);for(let e=0;e<i.length;e++)o.push(i[e])}return sr(e,o.filter(Yo).sort(rr))}function cr(e,t){const n=[],{row:o,column:r}=Oo(t),i=Math.max(0,r-1),l=Math.min(e.ColumnNumbers.length-1,r+1),s=Math.max(0,o-1),a=Math.min(e.RowNumbers.length,o+1);for(let t=s;t<=a;t++)for(let o=i;o<=l;o++){const r=$o(t,o,e);r&&ur(e,r)&&n.push(Ao(r.Row,r.Col))}return n}function ur(e,t){const n=qo(e,t),o=Zo(e,t);return!!n.BackgroundColor||!!n.Gradient||o.Borders.length>0||!!t.HasError||!!n.PatternStyle}function dr(e,t,n){if(mr())for(const[t]of n)e[t]&&(e[t]=[]);else for(let n=0;n<t.length;n++){const o=t[n];e[o]&&(e[o]=[])}}function hr(e,t,n,o){try{Go(e,n,o);const r=zo(e,n,o);t.push(Ao(r.Row,r.Col)),r.Row===n&&r.Col===o||t.push(Ao(n,o))}catch{return}}function fr(){return Fn(Sn.HeaderInsert)}function gr(){return Fn(Sn.RenderResizePillAcrossBlock)}function mr(){return Mo??(Mo=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.PartialHeaderCellRendering",!1)),Mo}class Cr{createCell(e){let t,n,o,r=Wt.None,i=_t.Value,l=Qt.None;return e.Merge&&!e.Merge.IsOrigin||(t=e.Value,r=e.ValueType,n=e.Text,o=e.FormulaInfo?.Formula,i=e.FormulaInfo?e.FormulaInfo.FormulaType:_t.Value,l=e.RichValueType??Qt.None),{col:e.Col,row:e.Row,text:n,formula:o,valueType:r,value:t,ifmt:e.Ifmt||0,formulaType:i,richValueType:l}}addCell(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[Ao(e.row,e.col)]=e,this.keys=null}addHeaders(e,t){this.RowNumbers=e,this.ColumnNumbers=t}getRowNumbers(){return this.RowNumbers}getColumnNumbers(){return this.ColumnNumbers}getCell(e,t){return pn(this.Cells)?null:this.Cells[Ao(e,t)]}reset(){this.index=0,pn(this.keys)&&(this.keys=Object.keys(this.Cells))}getNextCell(){if(pn(this.Cells)||pn(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;const e=this.Cells[this.keys[this.index]];return this.index++,e}constructor(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}}const pr="Aptos Narrow",wr=11,Sr="#616161",yr="#616161",Rr="#0F703B",Tr="#0C5F32",Ir="#FFFFFF",vr="#FFFFFF",br="#FFFFFF",xr="Calibri",Fr="#F5F5F5",Dr="#EBEBEB",Mr="#CAEAD8",Ar="#A0D8B9",Or="#107C41",Br="#0F703B",kr="#DAD8D6",Pr="#333333",Er="#4D4D4D",Hr="#637C6E",Lr="#107C41",Nr="#596D62",Wr="#0F703B",_r="#AAAEB1",zr="#AAAEB1",Gr=43,Vr=30,jr=3,Ur=10,$r=3,qr=65,Xr=26,Yr=[{Color:yr,FontName:pr,Size:wr,ID:sn.Hover,RefCount:1},{Color:Rr,FontName:pr,Size:wr,ID:sn.PartialSelection,RefCount:1},{Color:Tr,FontName:pr,Size:wr,ID:sn.PartialSelectionAndHover,RefCount:1},{Color:Ir,FontName:pr,Size:wr,Bold:!0,ID:sn.WholeSelection,RefCount:1},{Color:vr,FontName:pr,Size:wr,Bold:!0,ID:sn.WholeSelectionAndHover,RefCount:1},{Color:Sr,FontName:pr,Size:wr,ID:sn.Default,RefCount:1}],Jr=[{Color:yr,FontName:xr,Size:wr,ID:sn.Hover,RefCount:1},{Color:Rr,FontName:xr,Size:wr,ID:sn.PartialSelection,RefCount:1},{Color:Tr,FontName:xr,Size:wr,ID:sn.PartialSelectionAndHover,RefCount:1},{Color:Ir,FontName:xr,Size:wr,Bold:!0,ID:sn.WholeSelection,RefCount:1},{Color:vr,FontName:xr,Size:wr,Bold:!0,ID:sn.WholeSelectionAndHover,RefCount:1},{Color:Sr,FontName:xr,Size:wr,ID:sn.Default,RefCount:1}],Kr=[{Color:br,FontName:pr,Size:wr,ID:sn.Hover,RefCount:1},{Color:br,FontName:pr,Size:wr,ID:sn.PartialSelection,RefCount:1},{Color:br,FontName:pr,Size:wr,ID:sn.PartialSelectionAndHover,RefCount:1},{Color:br,FontName:pr,Size:wr,Bold:!0,ID:sn.WholeSelection,RefCount:1},{Color:br,FontName:pr,Size:wr,Bold:!0,ID:sn.WholeSelectionAndHover,RefCount:1},{Color:br,FontName:pr,Size:wr,ID:sn.Default,RefCount:1}],Qr=[{Color:br,FontName:xr,Size:wr,ID:sn.Hover,RefCount:1},{Color:br,FontName:xr,Size:wr,ID:sn.PartialSelection,RefCount:1},{Color:br,FontName:xr,Size:wr,ID:sn.PartialSelectionAndHover,RefCount:1},{Color:br,FontName:xr,Size:wr,Bold:!0,ID:sn.WholeSelection,RefCount:1},{Color:br,FontName:xr,Size:wr,Bold:!0,ID:sn.WholeSelectionAndHover,RefCount:1},{Color:br,FontName:xr,Size:wr,ID:sn.Default,RefCount:1}],Zr=[{ID:ln.PartialRowColSelection,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.PartialSelection,RefCount:1,BackgroundColor:Mr},{ID:ln.WholeRowColSelection,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Or},{ID:ln.Hover,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Dr},{ID:ln.PartialSelectionAndHover,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.PartialSelectionAndHover,RefCount:1,BackgroundColor:Ar},{ID:ln.WholeSelectionAndHover,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Br},{ID:ln.NoHeadings,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:kr},{ID:ln.Default,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1}],ei=[{ID:ln.PartialRowColSelection,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.PartialSelection,RefCount:1,BackgroundColor:Mr},{ID:ln.WholeRowColSelection,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Or},{ID:ln.Hover,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Hover,RefCount:1,BackgroundColor:Dr},{ID:ln.PartialSelectionAndHover,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.PartialSelectionAndHover,RefCount:1,BackgroundColor:Ar},{ID:ln.WholeSelectionAndHover,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Br},{ID:ln.NoHeadings,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1,BackgroundColor:kr},{ID:ln.PartialRowColSelectionLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.PartialSelection,RefCount:1,BackgroundColor:Mr},{ID:ln.PartialRowColSelectionRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.PartialSelection,RefCount:1,BackgroundColor:Mr},{ID:ln.WholeRowColSelectionLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Or},{ID:ln.WholeRowColSelectionRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Or},{ID:ln.HoverLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.Hover,RefCount:1,BackgroundColor:Dr},{ID:ln.HoverRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.Hover,RefCount:1,BackgroundColor:Dr},{ID:ln.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.PartialSelectionAndHover,RefCount:1,BackgroundColor:Ar},{ID:ln.PartialSelectionAndHoverRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.PartialSelectionAndHover,RefCount:1,BackgroundColor:Ar},{ID:ln.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Br},{ID:ln.WholeSelectionAndHoverRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Br},{ID:ln.LeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.Default,RefCount:1},{ID:ln.RightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1},{ID:ln.Default,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1}],ti=[{ID:ln.PartialRowColSelection,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Hr},{ID:ln.WholeRowColSelection,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Lr},{ID:ln.Hover,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Er},{ID:ln.PartialSelectionAndHover,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Nr},{ID:ln.WholeSelectionAndHover,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Wr},{ID:ln.NoHeadings,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:kr},{ID:ln.Default,VerticalAlignment:Lt.Center,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1}],ni=[{ID:ln.PartialRowColSelection,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1,BackgroundColor:Hr},{ID:ln.WholeRowColSelection,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Lr},{ID:ln.Hover,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1,BackgroundColor:Er},{ID:ln.PartialSelectionAndHover,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1,BackgroundColor:Nr},{ID:ln.WholeSelectionAndHover,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Wr},{ID:ln.NoHeadings,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1,BackgroundColor:kr},{ID:ln.PartialRowColSelectionLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.Default,RefCount:1,BackgroundColor:Hr},{ID:ln.PartialRowColSelectionRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Hr},{ID:ln.WholeRowColSelectionLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Lr},{ID:ln.WholeRowColSelectionRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelection,RefCount:1,BackgroundColor:Lr},{ID:ln.HoverLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.Default,RefCount:1,BackgroundColor:Er},{ID:ln.HoverRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Er},{ID:ln.PartialSelectionAndHoverLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.Default,RefCount:1,BackgroundColor:Nr},{ID:ln.PartialSelectionAndHoverRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1,BackgroundColor:Nr},{ID:ln.WholeSelectionAndHoverLeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Wr},{ID:ln.WholeSelectionAndHoverRightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.WholeSelectionAndHover,RefCount:1,BackgroundColor:Wr},{ID:ln.LeftAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Left,FontID:sn.Default,RefCount:1},{ID:ln.RightAlignment,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Right,FontID:sn.Default,RefCount:1},{ID:ln.Default,VerticalAlignment:Lt.Bottom,HorizontalAlignment:Ht.Center,FontID:sn.Default,RefCount:1}],oi=new Set([ln.PartialRowColSelection,ln.PartialRowColSelectionLeftAlignment,ln.PartialRowColSelectionRightAlignment,ln.PartialSelectionAndHover,ln.PartialSelectionAndHoverLeftAlignment,ln.PartialSelectionAndHoverRightAlignment]),ri=new Set([ln.WholeRowColSelection,ln.WholeRowColSelectionLeftAlignment,ln.WholeRowColSelectionRightAlignment,ln.WholeSelectionAndHover,ln.WholeSelectionAndHoverLeftAlignment,ln.WholeSelectionAndHoverRightAlignment]),ii=new Set([ln.Hover,ln.HoverLeftAlignment,ln.HoverRightAlignment,ln.PartialSelectionAndHover,ln.PartialSelectionAndHoverLeftAlignment,ln.PartialSelectionAndHoverRightAlignment,ln.WholeSelectionAndHover,ln.WholeSelectionAndHoverLeftAlignment,ln.WholeSelectionAndHoverRightAlignment]);function li(e){if(e)for(const t of e)t&&(t.GlobalId=void 0)}function si(e){return(Math.max(jr,e)-jr)*Ur+Gr}function ai(e,t,n,o,r){const i=!o||r?0:1,l=r?"":function(e,t){return t?e.toString():function(e){let t=e-1;const n=[];for(;t>=0;)n.unshift(String.fromCharCode(qr+t%Xr)),t=Math.floor(t/Xr)-1;return n.join("")}(e)}(t,n);return{Row:n?e:i,Col:n?i:e,StyleID:ln.Default,BorderStyleID:ln.Default,HorizontalAlignmentSet:!1,ValueType:Wt.String,Text:l}}function ci(e,t){let n;switch(e){case Bt.Default:n=Zr;break;case Bt.NamedSheetView:n=ti;break;case Bt.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}return n.map((e=>({...e,HorizontalAlignment:t&&e.HorizontalAlignment===Ht.Left?Ht.Right:t&&e.HorizontalAlignment===Ht.Right?Ht.Left:e.HorizontalAlignment})))}function ui(e,t,n){const o=t?e.RowNumbers:e.ColumnNumbers;e.Cells=[];const r=n>0,i=[];for(let n=0;n<o.length;n++){const l=ai(n,o[n],t,r,!1);if(e.Cells.push(l),r){const e=ai(n,o[n],t,r,!0);i.push(e)}}r&&e.Cells.push(...i)}function di(e,t,n){let o;switch(t){case Bt.Default:return o=ci(Bt.Default,e.IsRtl),n?o:ei;case Bt.NamedSheetView:return o=ci(Bt.NamedSheetView,e.IsRtl),n?o:ni;case Bt.PresentMode:default:throw Error("headerBlockModelCreator.getModelStyles: unsupported ViewMode")}}function hi(e,t){const n=yo(Vt.NewDefaultTemplate,e)&&yo(Vt.NewThemeFontForHeaderFBarNBox,e)&&document.fonts.check(`11pt ${pr}`);switch(t){case Bt.Default:return n?Yr:Jr;case Bt.NamedSheetView:return n?Kr:Qr;case Bt.PresentMode:default:throw Error("headerBlockModelCreator.getModelFonts: unsupported ViewMode")}}function fi(e){return Ro(e,"array","headerBlockModel.duplicateArray"),[...e]}function gi(e){return e?{...e}:e}function mi(e,t,n){return t?e.BlockHeight:Vr+n}function Ci(e,t,n){return t?function(e,t){const n=e.length-1;return e[n]?si(e[n].toString().length)+t:(Pn.sendTraceTag(508966366,En.msoulscat_ES_EWAJSGrid,d.Warning,`HeaderBlockModelCreator.getRowHeaderWidth: rowNumbers[lastRowIndex] is undefined, rowNumbers.length: ${e.length}, lastRowIndex: ${n}, rowNumbers: ${e}`),0)}(e.RowNumbers,n):e.BlockWidth}const pi={GridBlockModel:["ColMetadata","FixedColumns","IsBitwiseFixedRows","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","IsRow","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","ClientOnlyCache","AdjacentBlocksHiddensInfo","RichValueTypes","HasTable","HasOutline","IsEmptyBlocksSupported","EmptyBlocksFallbackReasonBitFlag","AreStylesProcessed"],Cell:["StyleID","GlobalCellStyleID","Ifmt","IfmtStamped","BorderStyleID","GlobalBorderStyleID","HorizontalAlignmentSet","Spill","ShrunkSize","RichValueType","RichValueFieldsIndexes","DynamicArrayInfo","ValueType","SrvDx","SrvDy","TolType","PythonInformation","RichValueCommands","HasRichValue","BitwiseBorderPosition","IsHashedValue","IsCellSnapped","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","CachedIndent","DisplayFormula","PreviewText","PreviewNumFmt","PreviewCellStyle","RetainTextOnPreview","ShowSkeleton","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],HeaderCell:["ShowResizePill","ResizePillLocation","InsertButtons","IsHovered","DataCleansingIcon"],InsertButtons:["Start","End"],InsertButton:["Type"],AutoFilter:["Menu","CommandData"],PivotFilter:["IsPivotPageField","CommandData","IsHeaderSnapped"],ReferencedObject:["ID","RefCount","GlobalId"],CellStyle:["IsPattern","NamedStyleId","FontID","GlobalFontID","IsUnlocked","IsHidden"],SpillInformation:["IsSpillingOutsideOfBlock"],FormulaInformation:["Formula","FormulaType","IsArrayRoot"],DynamicArrayInformation:["IsAnchor","Range"],MergeInformation:["IsOrigin","WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],BorderStyle:["HasDiagBorder"],Font:["FontScheme"],TextRun:["FontID","GlobalFontID","EndIndex","IsSpecialCharTextRun"],RangeInformation:["RangeType"],PivotTableRangeInformation:["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","AutoRefresh","SupportsAutoRefresh","UseExpandedGeometry","ExpandedGeometryRange","FilterAreaRowCount","FilterAreaColCount","FilterCount","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],Hyperlink:["IsHyperlinkChecked"],DynamicImageInformation:["AltText"],Sparklines:["Ranges"],LinkedEntityInformation:["Domain"],PivotTableCellInformation:["ShouldShowExpandCollapseMenu","SourceIndex","ConfirmRequired","CanShowDetails"]},wi={Font:["Color"]},Si={ColMetadata:["ColMetadata"],RowOutlinesInformation:["OutlinesLevel"],ColumnOutlinesInformation:["OutlinesLevel"],PermissionSet:["PermissionSet"],Cells:["Cell"],Styles:["CellStyle","ReferencedObject"],Fonts:["Font","ReferencedObject"],BorderStyles:["BorderStyle","ReferencedObject"],PageBreaks:["PageBreaksInformation"],PrintAreas:["SharedRange"],PivotTables:["PivotTableRangeInformation","RangeInformation","SharedRange"],Sparklines:["Sparklines","DynamicImages"],InCellImages:["InCellImages","DynamicImages"],AllRichValueFields:["RichValueField"],AdjacentBlocksHiddensInfo:["AdjacentBlocksHiddensInfo"],Spill:["SpillInformation"],Merge:["MergeInformation"],NumFmt:["NumberFormatInformation"],WrapText:["WrapTextInformation"],AutoFilter:["AutoFilter"],PivotFilter:["PivotFilter"],TextRuns:["TextRun"],CondFormat:["ConditionalFormattingInformation"],PhonInfo:["PhoneticInformation"],Comment:["CommentData"],FormulaInfo:["FormulaInformation"],DynamicArrayInfo:["DynamicArrayInformation"],Hyperlink:["Hyperlink"],Sparkline:["SparklineInformation","DynamicImageInformation"],InCellImage:["InCellImageInformation","DynamicImageInformation"],LinkedEntity:["LinkedEntityInformation"],RichValueIcon:["RichValueIconInformation"],PivotTable:["PivotTableCellInformation"],InCellControlOptions:["InCellControlOptions"],PythonInformation:["PythonFormulaInformation"],CachedStyle:["CellStyle","ReferencedObject"],CachedFont:["Font","ReferencedObject"],CachedBorderStyle:["BorderStyle","ReferencedObject"],CachedDisplayTextRuns:["TextRun"],PreviewNumFmt:["NumberFormatInformation"],PreviewCellStyle:["CellStyle","ReferencedObject"],InsertButtons:["InsertButtons"],Start:["InsertButton"],End:["InsertButton"],Menu:["AutoFilterMenu"],RenderingContext:["AutoFilterRenderingContext"],Cell:["SharedSheetCell"],Icon:["ConditionalFormattingIcon"],DataBar:["DataBarInformation"],PhoneticTextRuns:["PhoneticRun"],Sections:["MenuSection"],MenuItems:["MenuItem"],SubMenu:["AutoFilterMenu"],Gradient:["GradientFill"],Range:["SharedRange"],PillProperties:["PillProperties"],Borders:["Border"],Color:["RGBColor"],Stops:["ColorStop"],Row:["RowColBreak"],Col:["RowColBreak"],ColumnHeaderRange:["RangeInformation","SharedRange"],RowHeaderRange:["RangeInformation","SharedRange"],RowAreaFields:["PivotTableFieldInfo"],ColumnAreaFields:["PivotTableFieldInfo"],ValueAreaFields:["PivotTableFieldInfo"],PageAreaFields:["PivotTableFieldInfo"],SlicerConnections:["PivotTableSlicerConnectionInfo"],ExpandedGeometryRange:["RangeInformation","SharedRange"],InternalLink:["InternalLink","SharedRange"],Outlines:["Outline"],Ranges:["SparklineRangeInformation","RangeInformation","SharedRange"],Domain:["LinkedEntityServiceDomainId"],CachedFormattedText:["FormattedText"],PreviewCellsRange:["SharedRange"]},yi={Cell:["Text","CachedDisplayText","PreviewText","Value","UserInput","OriginalText"],AutoFilter:["CommandData"],PivotFilter:["CommandData"],PhoneticInformation:["Text"],MenuItem:["CommandData","Label"],FormulaInformation:["Formula"],NumberFormatInformation:["Start","End","Separator"],FormattedText:["Text"],Font:["FontName"],PivotTableFieldInfo:["Caption"],Hyperlink:["Text","Tooltip"],InternalLink:["ObjectName","SheetName"],DynamicImages:["ImageUrl"],SharedSheetCell:["SheetName"],ColMetadata:["Text"]},Ri={GridBlockModel:["BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers","RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","IsRtl","AdjacentBlocksHiddensInfo"],Cell:["Col","Row","Text","CachedStyle","CachedFont"],HeaderCell:["InsertButtons"],InsertButtons:["Start","End"],InsertButton:["Type"],CellStyle:["BackgroundColor"],Font:["Color"],Outline:["StartIndex","ButtonIndex","IsExpanded","IsButtonHidden","IsNonDefaultDirection"],OutlinesLevel:["Outlines"],AdjacentBlocksHiddensInfo:["IsFirstRowOfNextBlockHidden","IsFirstColOfNextBlockHidden","IsLastRowOfPrevBlockHidden","IsLastColOfPrevBlockHidden"]},Ti="d",Ii="w",vi=new RegExp('[^=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*$\\s'+Ti+"]","gm"),bi=new RegExp("[0-9]","gm");let xi=!1,Fi=[];function Di(e,t){if(Fn(Sn.FixUserContentList)&&!xi){Fi=[];for(const e in yi)Fi=Fi.concat(yi[e]);xi=!0}return e&&t?(e.CachedStyle=Bo(e.StyleID||0,t.Styles),e.CachedBorderStyle=Bo(e.BorderStyleID||0,t.BorderStyles),e.CachedFont=Bo(e.CachedStyle.FontID||0,t.Fonts),Fi?JSON.stringify(e,(n=Fi,(e,t)=>t&&n&&n.indexOf(e)>-1?Mi(t):t)):JSON.stringify(e)):"";var n}function Mi(e){return e.toLowerCase().replace(Ti,Ii).replace(bi,Ti).replace(vi,Ii)}Fi=yi.Cell.concat(yi.GridBlockModel).concat(yi.CellStyle).concat(yi.Font).concat(yi.BorderStyle).concat(yi.AutoFilter).concat(yi.PivotFilter).concat(yi.MenuItem).concat(yi.FormulaInformation).concat(yi.NumberFormatInformation).concat(yi.InCellControlType).concat(yi.InCellControlOptions);class Ai{static get instance(){return Ai.staticInstance||(Ai.staticInstance=new Ai)}constructor(){this.propertiesToAddConfiguration=null}}let Oi=!1,Bi=!1;function ki(){if((0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListConfigFromSetting",!1)&&(Ai.instance.propertiesToAddConfiguration?function(e){const t={};for(const n in e){t[n]={};for(const o of e[n])t[n][o]=!0}Pi(t)}(Ai.instance.propertiesToAddConfiguration):Pn.sendTraceTag(505173218,En.msoulscat_ES_EWAJSGrid,d.Verbose,"GridModelIgnoreList propertiesToAddConfiguration was not set.")),!(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFromConfiguration",!1))return function(){if(!Bi){const e=new Set(["RowOutlinesInformation","ColumnOutlinesInformation","MaxRowOutlineLevelInSheet","MaxColOutlineLevelInSheet","ShowHeaders","AdjacentBlocksHiddensInfo"]),t=new Set(["InsertButtons"]),n=new Set(["Start","End"]),o=new Set(["Type","Offset"]),r=pi.GridBlockModel.filter((t=>!e.has(t))),i=pi.HeaderCell.filter((e=>!t.has(e))),l=pi.InsertButtons.filter((e=>!n.has(e))),s=pi.InsertButton.filter((e=>!o.has(e)));r.push("RibbonCommands"),(0,Rn.isChangeGateEnabled)("OfficeVSO:9939455_addIsCanvasHeadersSupportedToIgnoreList")&&r.push("IsCanvasHeadersSupported"),(0,Rn.isChangeGateEnabled)("OfficeVSO:9711525_addFilterTitlesToIgnoreList")&&(pi.AutoFilter.push("Title"),pi.PivotFilter.push("Title")),r.push("UniqueId"),pi.GridBlockModel=r,pi.HeaderCell=i,pi.InsertButtons=l,pi.InsertButton=s,Bi=!0}return pi}();if(!Oi){const e=function(){const e=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.IgnoreListFix",!1);return{propertiesToAdd:{GridBlockModel:{RibbonCommands:!0,IsCanvasHeadersSupported:(0,Rn.isChangeGateEnabled)("OfficeVSO:9939455_addIsCanvasHeadersSupportedToIgnoreList"),UniqueId:!0},AutoFilter:{Title:(0,Rn.isChangeGateEnabled)("OfficeVSO:9711525_addFilterTitlesToIgnoreList")},PivotFilter:{Title:(0,Rn.isChangeGateEnabled)("OfficeVSO:9711525_addFilterTitlesToIgnoreList")}},propertiesToRemove:{GridBlockModel:{RowOutlinesInformation:!e,ColumnOutlinesInformation:!e,MaxRowOutlineLevelInSheet:!e,MaxColOutlineLevelInSheet:!e,ShowHeaders:!e,AdjacentBlocksHiddensInfo:!e},HeaderCell:{InsertButtons:!e},InsertButtons:{Start:!e,End:!e},InsertButton:{Type:!e,Offset:!e}}}}();if(e.propertiesToRemove)for(const t in e.propertiesToRemove)pi[t]&&(pi[t]=pi[t].filter((n=>!e.propertiesToRemove[t][n])));e.propertiesToAdd&&Pi(e.propertiesToAdd),Oi=!0}return pi}function Pi(e){for(const t in e){pi[t]||(pi[t]=[]);for(const n in e[t])!pi[t].includes(n)&&e[t][n]&&pi[t].push(n)}}const Ei="w",Hi="d",Li=new RegExp(Hi,"gm"),Ni=new RegExp("[0-9]","gm"),Wi=new RegExp("[^=\\@\\[\\]\\.\\\\/%#\\-\\+,;\\(\\):?\"&<>'!{}~\\^\\*\\u0024\\u0080\\u00a2\\u00a3\\u00a4\\u00a5\\u20a0\\u20a1\\u20a2\\u20a3\\u20a4\\u20a5\\u20a6\\u20a7\\u20a8\\u20a9\\u20aa\\u20ab\\u20ac\\u20ad\\u20ae\\u20af\\u20b0\\u20b1\\u20b2\\u20b3\\u20b4\\u20b5\\u20b6\\u20b7\\u20b8\\u20b9\\s\\ua0c2"+Hi+"]","gm");var _i;function zi(e){return null==e?null:function(e){let t=e;return t=t.toLowerCase().replace(Li,Ei),t=t.replace(Ni,Hi),t.replace(Wi,Ei)}(e)}!function(e){e[e.invalid=-1]="invalid",e[e.asciiStart=0]="asciiStart",e[e.space=32]="space",e[e.exclamation=33]="exclamation",e[e.doubleQuote=34]="doubleQuote",e[e.hash=35]="hash",e[e.dollarSign=36]="dollarSign",e[e.ampersand=38]="ampersand",e[e.singleQuote=39]="singleQuote",e[e.openParen=40]="openParen",e[e.closeParen=41]="closeParen",e[e.asterisk=42]="asterisk",e[e.plus=43]="plus",e[e.comma=44]="comma",e[e.minus=45]="minus",e[e.period=46]="period",e[e.slash=47]="slash",e[e.zero=48]="zero",e[e.one=49]="one",e[e.two=50]="two",e[e.three=51]="three",e[e.four=52]="four",e[e.five=53]="five",e[e.six=54]="six",e[e.seven=55]="seven",e[e.eight=56]="eight",e[e.nine=57]="nine",e[e.colon=58]="colon",e[e.semiColon=59]="semiColon",e[e.lessThan=60]="lessThan",e[e.equals=61]="equals",e[e.greaterThan=62]="greaterThan",e[e.questionMark=63]="questionMark",e[e.at=64]="at",e[e.upperCaseA=65]="upperCaseA",e[e.upperCaseZ=90]="upperCaseZ",e[e.openSquareBracket=91]="openSquareBracket",e[e.closeSquareBracket=93]="closeSquareBracket",e[e.backSlash=92]="backSlash",e[e.caret=94]="caret",e[e.underscore=95]="underscore",e[e.lowerCaseA=97]="lowerCaseA",e[e.lowerCaseZ=122]="lowerCaseZ",e[e.asciiEnd=127]="asciiEnd",e[e.latin1SuppStart=128]="latin1SuppStart",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.latin1SuppEnd=255]="latin1SuppEnd",e[e.latinExtendedAStart=256]="latinExtendedAStart",e[e.latinExtendedAEnd=383]="latinExtendedAEnd",e[e.greekCopticStart=880]="greekCopticStart",e[e.greekCopticEnd=1023]="greekCopticEnd",e[e.cyrillicStart=1024]="cyrillicStart",e[e.cyrillicNonLetterStart=1154]="cyrillicNonLetterStart",e[e.cyrillicNonLetterEnd=1161]="cyrillicNonLetterEnd",e[e.cyrillicEnd=1279]="cyrillicEnd",e[e.rtlStart=1425]="rtlStart",e[e.rtlEnd=2047]="rtlEnd",e[e.fullWidthCharCodeOffset=65248]="fullWidthCharCodeOffset"}(_i||(_i={}));const Gi="",Vi=["rand(","now(","today(","randbetween(","offset(","cell(","indirect(","info(","sheet(","sheets(","formulatext(","randarray("],ji=-1;let Ui,$i;function qi(e,t,n,o,r,i,l,s,a){so()&&Jn()?(il(e,n),il(t,o),ll(e,n),ll(t,o),rl(e,n),rl(t,o)):(e.CachedStyle=Bo(e.StyleID||0,n.Styles),t.CachedStyle=Bo(t.StyleID||0,o.Styles),e.CachedFont=Bo(e.CachedStyle.FontID||0,n.Fonts),t.CachedFont=Bo(t.CachedStyle.FontID||0,o.Fonts),e.CachedBorderStyle=Bo(e.BorderStyleID||0,n.BorderStyles),t.CachedBorderStyle=Bo(t.BorderStyleID||0,o.BorderStyles));const c=i(e,t);let u;if(Ki(e.TextRuns,n.Fonts),Ki(t.TextRuns,o.Fonts),u=al()?Yi(e,t,c,r,l,void 0,a):Yi(e,t,c,r,l),void 0===Ui&&(Ui=Fn(Sn.ModelComparisonIsSpillBlocked)),Ui&&!s&&u.isEqual&&e&&t&&e.Spill&&t.Spill&&!!e.Spill.IsSpillBlocked!=!!t.Spill.IsSpillBlocked&&(u={isEqual:!1,message:`areCellsEqual: simple object comparison failure. PropertyName = Spill.IsSpillCellBlocked, cell1 Value = ${e.Spill.IsSpillBlocked}, cell2 Value = ${t.Spill.IsSpillBlocked}`}),!u.isEqual){u.message+=`\nareCellsEqual: cell1.Row = ${e.Row}, cell1.Col = ${e.Col}, cell2.Row = ${t.Row}, cell2.Col = ${t.Col}`;const n=Vi.some((n=>e.FormulaInfo?.Formula?.toLowerCase().includes(n)||t.FormulaInfo?.Formula?.toLowerCase().includes(n)));u.message+=`\nformulaType : Cell1 = ${e.FormulaInfo?.FormulaType}, Cell2 = ${t.FormulaInfo?.FormulaType}\nifmt : Cell1 = ${e.Ifmt||0}, Cell2 = ${t.Ifmt||0}\nisVolatile: ${n}`,Fn(Sn.AddHashesTelemetry)&&t.IsHashedValue&&(u.message+=`\nIsHashedValue: Cell2 = ${t.IsHashedValue}`)}return u}function Xi(e,t,n,o,r,i){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:`areArraysEqual: arrays length are different. length1: ${e.length}, length2: ${t.length}`};for(let l=0;l<e.length;l++){const s=Yi(e[l],t[l],n,o,r,i);if(!s.isEqual)return s.message+=`\nareArraysEqual: array objects are different. index: ${l}`,s}return{isEqual:!0}}function Yi(e,t,n,o,r,i,l){const{shouldContinue:s,result:a}=function(e,t,n){return e===t||pn(e)&&pn(t)?{shouldContinue:!1,result:{isEqual:!0}}:null==e||null==t?{shouldContinue:!1,result:{isEqual:!1,message:`areObjectsEqual: one object is null, o1 = ${!e}, o2 = ${!t}`}}:e!=e?{shouldContinue:!1,result:{isEqual:e!=e,message:"${callerMethod}: NaN comparison"}}:{shouldContinue:!0,result:{isEqual:!0}}}(e,t);if(!s)return a;const c=function(e,t){if(!e||!t)return e||t;const n=t.filter((t=>-1===e.indexOf(t)));return e.push(...n),e}(o(e,n),o(t,n));if(0===c.length)return el(e)&&el(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(let n=0;n<c.length;n++){const s=c[n],a=e[s],u=t[s],d=typeof a,h=typeof u;if(!pn(a)||!pn(u)){if(d!==h){if(Zi(a)&&Zi(u))continue;return{isEqual:!1,message:`areObjectsEqual: object types are different. propName = ${s} type1 = ${d}, type2 = ${h}`}}switch(d){case"string":if(a!==u){if(!i||-1===i.indexOf(s))return al()&&l?{isEqual:!1,message:`areObjectsEqual: simple types comparison, propertyName = ${s} , anonymizedNew = ${zi(a)} , anonymizedOld = ${zi(u)}, lengthNew = ${a.length}, lengthOld = ${u.length}`}:{isEqual:!1,message:`areObjectsEqual: simple types comparison, propertyName = ${s}`};if(a.toUpperCase()!==u.toUpperCase())return{isEqual:!1,message:`areObjectsEqual: ignore case comparison, propertyName = ${s}`}}break;case"undefined":case"boolean":case"number":if(a!==u)return al()&&l?{isEqual:!1,message:`areObjectsEqual: simple types comparison, propertyName = ${s} , anonymizedNew = ${zi(a)} , anonymizedOld = ${zi(u)}`}:{isEqual:!1,message:`areObjectsEqual: simple types comparison, propertyName = ${s}`};break;case"object":if(a instanceof Array){if(!(u instanceof Array))return{isEqual:!1,message:`areObjectsEqual: array 2 is not an array, propertyName = ${s}`};const e=Qi(s,r),t=e.ignoreCaseProps,n=Xi(a,u,e.filterByProps,o,r,t);if(!n.isEqual)return n.message+=`\nareObjectsEqual: arrays mismatch, propertyName = ${s}`,n}else{const e=Qi(s,r),t=e.ignoreCaseProps,n=Yi(a,u,e.filterByProps,o,r,t);if(!n.isEqual)return n.message+=`\nareObjectsEqual: objects mismatch, propertyName = ${s}`,n}break;default:return{isEqual:!1,message:`areObjectsEqual: unexpected type: ${d}, propertyName = ${s}`}}}}return{isEqual:!0}}function Ji(e,t,n,o,r,i,l,s){const a=e.Cells,c=t.Cells;let u=0;if(a===c)return{isEqual:!0,canDiffRender:!0};const d=a.length,h=c.length;let f=0,g=0;const m=Eo(ji,ji,e.Styles,e.Fonts);let C=[],p=!0,w="";for(;f<d||g<h;){let S,y;const R=f,T=g;({cell1:S,cell2:y,index1:f,index2:g}=ol(m,f,g,d,c,h,a));const I=qi(S,y,e,t,o,r,i,l,s),v=S?.Row===ji?y?.Row:S.Row,b=S?.Col===ji?y?.Col:S.Col;if(!I.isEqual){p&&(p=!1,w+=I.message+"\n"),C.push(Ao(v,b));const r=ki().ReferencedObject;if(!Yi(S.CachedBorderStyle,y.CachedBorderStyle,r,o,i).isEqual||!Yi(S.HasError,y.HasError,void 0,o,i).isEqual){let n=[];Fn(Sn.AdjacentCellsMergeFix)?(S.Row!==ji&&(n=Wo(e,S)),y.Row!==ji&&(n=n.concat(Wo(t,y)))):n=No(t,v,b),C=C.concat(n),C=C.concat(Lo(a,n)),C=C.concat(Lo(c,n))}if(void 0!==n&&(u++,u>=n))return{isEqual:p,canDiffRender:!1,changedCellsKeys:void 0,message:`${w} \n maxAllowedDiffRenderCells reached`};S!==m&&(C=C.concat(Ho(a,S,R))),y!==m&&(C=C.concat(Ho(c,y,T)))}}return{isEqual:p,canDiffRender:!0,changedCellsKeys:C.filter(Yo),message:w}}function Ki(e,t){if(e&&0!==e.length&&t)for(let n=0;n<e.length;n++){const o=e[n];to()?o.CachedFont=sl(o.GlobalFontID,o.FontID,t):o.CachedFont=Bo(o.FontID||0,t)}}function Qi(e,t){const n={filterByProps:void 0,ignoreCaseProps:void 0},o=Si[e];if(!o)return n;const r=[],i=new Set;for(let e=0;e<o.length;e++)t[o[e]]?.forEach((e=>i.add(e))),r.push(...wi[o[e]]??[]);return n.filterByProps=i,n.ignoreCaseProps=r,n}function Zi(e){return Fn(Sn.TreatZeroAndUndefinedAsEqual)?null==e||e===Gi||!1===e||0===e:null==e||e===Gi||!1===e}function el(e){if("object"==typeof e&&e.constructor===Object){for(const t in e)return!1;return!0}return!1}function tl(e,t){if(e.length<1)return 0;if(t<e[0])return 0;const n=e.length-1;if(t>e[n])return n;for(let n=0;n<e.length;n++)if(t===e[n])return n;return-1}function nl(e,t,n,o,r){const i=[];if(Zi(i))return[];for(let l=0;l<e.Cells.length;l++){const s=e.Cells[l];s.Row>=t&&s.Row<=n&&s.Col>=o&&s.Col<=r&&i.push(s)}return i}function ol(e,t,n,o,r,i,l){let s=e,a=e,c=t,u=n;return c>=o?(a=r[u],u++):u>=i||l[c].Row<r[u].Row||l[c].Row===r[u].Row&&l[c].Col<r[u].Col?(s=l[c],c++):l[c].Row!==r[u].Row||l[c].Col!==r[u].Col?(a=r[u],u++):(s=l[c],a=r[u],c++,u++),{cell1:s,cell2:a,index1:c,index2:u}}function rl(e,t){try{if(!pn(e.GlobalBorderStyleID))return void(e.CachedBorderStyle=Xn(e.GlobalBorderStyleID||0));e.CachedBorderStyle=Bo(e.BorderStyleID||0,t.BorderStyles)}catch(n){e.CachedBorderStyle=Bo(e.BorderStyleID||0,t.BorderStyles),Kn(`${n}`)}}function il(e,t){try{if(!pn(e.GlobalCellStyleID))return void(e.CachedStyle=ro(e.GlobalCellStyleID));e.CachedStyle=Bo(e.StyleID||0,t.Styles)}catch(n){e.CachedStyle=Bo(e.StyleID||0,t.Styles),io(`${n}`)}}function ll(e,t){try{e.CachedFont=sl(e.CachedStyle?.GlobalFontID,e.CachedStyle?.FontID,t.Fonts)}catch(n){e.CachedFont=Bo(e.CachedStyle?.FontID||0,t.Fonts),lo(`${n}`)}}function sl(e,t,n){return pn(e)?Bo(t||0,n):Zn(e)}function al(){return void 0===$i&&($i=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.BlockFailureMessageTelemetryForDag5e",!1)),$i}let cl,ul,dl,hl,fl,gl,ml,Cl,pl,wl,Sl,yl,Rl,Tl,Il,vl,bl,xl,Fl,Dl,Ml=!1;function Al(e,t,n,o,r,i){kl();const l=Yi(e,t,vl,Ol,cl);if(!l.isEqual)return{isEqual:l.isEqual,message:l.message,canDiffRender:!1,changedCellsKeys:void 0};Ro(e.RowNumbers,"model1.RowNumbers","comparePartialGridBlockModels"),Ro(t.RowNumbers,"model2.RowNumbers","comparePartialGridBlockModels");const s=tl(e.RowNumbers,n),a=tl(e.RowNumbers,o),c=function(e,t,n,o){!function(e,t){Ro(e.RowOffsets,"model1.RowOffsets","validateRowArgs"),Ro(t.RowOffsets,"model2.RowOffsets","validateRowArgs"),Ro(e.RowHeights,"model1.RowHeights","validateRowArgs"),Ro(t.RowHeights,"model2.RowHeights","validateRowArgs"),Ro(e.RowNumbers,"model1.RowNumbers","validateRowArgs"),Ro(t.RowNumbers,"model2.RowNumbers","validateRowArgs")}(e,t);for(let r=n;r<=o;r++){if(e.RowHeights[r]!==t.RowHeights[r])return{isEqual:!1,message:"Mismatch in RowHeights, index = "+r+" model1 value = "+e.RowHeights[r]+" model2 value = "+t.RowHeights[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowNumbers[r]!==t.RowNumbers[r])return{isEqual:!1,message:"Mismatch in RowNumbers, index = "+r+" model1 value = "+e.RowNumbers[r]+" model2 value = "+t.RowNumbers[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.RowOffsets[r]!==t.RowOffsets[r])return{isEqual:!1,message:"Mismatch in RowOffsets, index = "+r+" model1 value = "+e.RowOffsets[r]+" model2 value = "+t.RowOffsets[r],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}}(e,t,s,a);if(!c.isEqual)return c;Ro(e.ColumnNumbers,"model1.ColumnNumbers","comparePartialGridBlockModels"),Ro(t.ColumnNumbers,"model2.ColumnNumbers","comparePartialGridBlockModels");const u=tl(e.ColumnNumbers,r),d=tl(e.ColumnNumbers,i),h=function(e,t,n,o){!function(e,t){Ro(e.ColumnNumbers,"model1.ColumnNumbers","validateColumnArgs"),Ro(t.ColumnNumbers,"model2.ColumnNumbers","validateColumnArgs"),Ro(e.ColumnWidths,"model1.ColumnWidths","validateColumnArgs"),Ro(t.ColumnWidths,"model2.ColumnWidths","validateColumnArgs"),Ro(e.ColumnOffsets,"model1.ColumnOffsets","validateColumnArgs"),Ro(t.ColumnOffsets,"model2.ColumnOffsets","validateColumnArgs")}(e,t);for(let r=n;r<=o;r++){if(e.ColumnWidths[r]!==t.ColumnWidths[r])return{isEqual:!1,message:"Mismatch in ColumnWidths, index = "+r+" model1 value = "+e.ColumnWidths[r]+" model2 value = "+t.ColumnWidths[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnOffsets[r]!==t.ColumnOffsets[r])return{isEqual:!1,message:"Mismatch in ColumnOffsets, index = "+r+" model1 value = "+e.ColumnOffsets[r]+" model2 value = "+t.ColumnOffsets[r],canDiffRender:!1,changedCellsKeys:void 0};if(e.ColumnNumbers[r]!==t.ColumnNumbers[r])return{isEqual:!1,message:"Mismatch in ColumnNumbers, index = "+r+" model1 value = "+e.ColumnNumbers[r]+" model2 value = "+t.ColumnNumbers[r],canDiffRender:!1,changedCellsKeys:void 0}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:""}}(e,t,u,d);return h.isEqual?function(e,t,n,o,r,i,l,s,a,c){const u=nl(e,n,o,r,i),d=nl(t,n,o,r,i),h=u.length,f=d.length;let g=0,m=0;const C=Eo(ji,ji,e.Styles,e.Fonts);for(;g<h||m<f;){let n,o;({cell1:n,cell2:o,index1:g,index2:m}=ol(C,g,m,h,d,f,u));const r=qi(n,o,e,t,l,s,a,undefined);if(!r.isEqual)return{isEqual:r.isEqual,canDiffRender:!0,changedCellsKeys:[],message:r.message}}return{isEqual:!0,canDiffRender:!0,changedCellsKeys:[],message:Gi}}(e,t,s,a,u,d,Ol,Bl,cl):h}function Ol(e,t){if(kl(),"object"!=typeof e)return[];const n=Object.getOwnPropertyNames(e);return t?t instanceof Set?n.filter((e=>!t.has(e))):n.filter((e=>-1===t.indexOf(e))):n}function Bl(e,t){kl();const n=Po(e)&&Po(t),o=t.DisplayFormula;let r;return r=n?o?bl:xl:o?Fl:Dl,r}function kl(){Ml||(cl=ki(),ul=cl.GridBlockModel.concat(["Cells"]).concat(cl.RangeInformation).concat(cl.PivotTableRangeInformation).concat(cl.DynamicImageInformation).concat(cl.Sparklines),dl=cl.Cell.concat(["Row","Col"]),hl=dl.concat(["Text"]),fl=dl.concat(["FormulaInfo"]),gl=hl.concat(["FormulaInfo"]),ml=cl.ReferencedObject,Cl=cl.CellStyle.concat(ml),pl=Cl.concat(cl.AutoFilter).concat(cl.FormulaInformation).concat(cl.MergeInformation).concat(cl.TextRun).concat(cl.Hyperlink).concat(cl.LinkedEntityInformation).concat(cl.PivotTableCellInformation),wl=cl.TextRun,Sl=[],yl=[],Rl=[],Tl=wl.concat(["Fonts"]),Il=new Set(ul),vl=new Set([...ul,"BlockWidth","BlockHeight","RowOffsets","ColumnOffsets","RowHeights","ColumnWidths","RowNumbers","ColumnNumbers"]),bl=new Set([...hl,...pl]),xl=new Set([...gl,...pl]),Fl=new Set([...dl,...pl]),Dl=new Set([...fl,...pl]),Ml=!0)}const Pl=Ri.GridBlockModel;function El(e,t){return pn(t)?[]:t instanceof Array?t:Array.from(t)}function Hl(e,t){return Ri.Cell.concat(Ri.HeaderCell)}function Ll(e,t,n){const o=e.ColumnNumbers[n.Col],r=e.RowNumbers[n.Row];return t.FirstColumn<=o&&t.LastColumn>=o&&t.FirstRow<=r&&t.LastRow>=r}const Nl="#E0E0E0",Wl="#A0D8B9",_l="#525252",zl="#BDBDBD",Gl="#BDBDBD",Vl="#BDBDBD",jl="#969696",Ul="#FFFFFF",$l="#666666",ql="#FFFFFF",Xl="#B3B3B3",Yl="#FFFFFF",Jl="#9e9e9e",Kl=.4,Ql=1,Zl=9,es=-1,ts=1,ns=2,os=2,rs="#ffffff",is="#000000",ls="#66706F",ss={text:"",width:0,underlineWidth:0},as={Text:"",Fonts:[],TextRuns:[]},cs={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},us="",ds=" ",hs="",fs="\n",gs="\r\n",ms=1,Cs=2,ps=[],ws=[1,1],Ss=[2,2],ys=[6,2],Rs=[9,3,3,3],Ts=[9,3,3,3,3,3],Is=[9,3],vs=1,bs={Red:255,Green:0,Blue:0},xs="#000000",Fs={Borders:[{BorderLineStyle:Ut.Dashed,BorderPosition:$t.Top,Color:bs,Weight:2},{BorderLineStyle:Ut.Dashed,BorderPosition:$t.Bottom,Color:bs,Weight:2},{BorderLineStyle:Ut.Dashed,BorderPosition:$t.Left,Color:bs,Weight:2},{BorderLineStyle:Ut.Dashed,BorderPosition:$t.Right,Color:bs,Weight:2}],ID:Nt.FormulaError,RefCount:0},Ds=3584,Ms=3711,As=-90,Os=90,Bs=4,ks="left",Ps="right",Es=Math.PI/2,Hs=2,Ls=3.14,Ns=.5,Ws="XLYellow",_s=.1,zs=11,Gs=17,Vs=2,js=20,Us=40;function $s(e){return null==e}const qs="alphabetic",Xs=1,Ys="calibri",Js=2,Ks=1.33333333333333;function Qs(e){if(Ro(e.Text,"cell.Text","updateNumFmt"),Ro(e.NumFmt,"cell.NumFmt","updateNumFmt"),!$s(e.NumFmt.End)&&!$s(e.NumFmt.Separator)){const t=function(e,t){let n=0;for(let o=0;o<e.length&&e[o]===t;o++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),n=function(e,t){let n=0;for(let o=e.length-1;o>0&&e[o]===t;o++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),o=function(e,t,n){const o=e.length-t,r=e.substring(0,o),i=r.lastIndexOf(n);return-1===i?r:r.substr(i+1)}(e.Text,n,e.NumFmt.Separator);e.NumFmt.End=function(e,t,n,o){return t.repeat(n)+e+t.repeat(o)}(o,e.NumFmt.Separator,t,n),e?.Text?.endsWith(e.NumFmt?.Separator+e.NumFmt.End)&&e?.Text?.startsWith(e.NumFmt?.Start||"")||(e.NumFmt=void 0)}}function Zs(e){return!0===e.CachedStyle?.VerticalText&&!e.DisplayFormula&&!e.PreviewText}function ea(e){if(Zs(e))switch(e.CachedStyle.VerticalAlignment){case Lt.Justify:case Lt.Distributed:return!0}return!1}function ta(e){if(Zs(e))switch(e.CachedStyle?.HorizontalAlignment){case Ht.Justify:case Ht.JustifyDistributed:case Ht.Distributed:return!0}return!1}var na,oa;!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(na||(na={})),function(e){e[e.Sparkline=0]="Sparkline",e[e.InCellImage=1]="InCellImage"}(oa||(oa={}));const ra={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},ia="STATIC",la={};function sa(e,t){return aa(ca(e),t,void 0,void 0)}function aa(e,t,n,o){let r=fa(e);if(r||(r={blockIdentifiers:[t],status:na.Initialized,version:n,url:o},ga(e,r),o))switch(r.status){case na.Loaded:return r.image;case na.LoadFailed:return;case na.Loading:return void da(t,r);case na.Initialized:return da(t,r),void(r.url&&ha(r));default:throw Error(`getOrLoadImageByKey: unexpected image statue: ${r.status}`)}}function ca(e){return ia+e}function ua(e,t){return e+t}function da(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function ha(e){if(!e.url)throw Error("image url is not set, unexpected call");const t=new Image;t.onload=function(){e.status=na.Loaded,Ro(ra.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),ra.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=na.LoadFailed,Ro(ra.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),ra.onImageLoadFailureCallback(`image failed to load, URL: ${e.url}, registeredModelsCount: ${e.blockIdentifiers.length}, registeredModelsCount: ${e.blockIdentifiers}`),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=na.Loading}function fa(e){return la[e]}function ga(e,t){la[e]=t}function ma(e){la[e]=void 0}function Ca(e,t,n){if(null==e)throw Error(`${n}.verifyArgumentNotNull: ${t} cannot be null or undefined`)}const pa=2,wa=5;let Sa,ya,Ra,Ta,Ia;function va(e,t,n){if(null==e)throw Error(`${n}.assertArgumentNotNull: ${t} cannot be null or undefined`)}function ba(e,t){return e-t}function xa(e,t,n,o,r){let i=t,l=t+n-1;for(;i<=l;){const t=i+(l-i>>1),n=r(e instanceof Array?e[t]:e.item(t),o);if(0===n)return t;n<0?i=t+1:l=t-1}return~i}function Fa(e,t,n){Ca(t,"cell",n),t.CachedStyle||qo(e,t),t.CachedFont||Ea(t,e),t?.TextRuns&&t.TextRuns.forEach((t=>{t.CachedFont||(t.CachedFont=co(t,e,void 0))}))}function Da(e,t){return((e.BitwiseBorderPosition||0)&1<<t)==1<<t}function Ma(e,t){const n=e.CachedBorderStyle;if(!n||!n.Borders)return!1;for(const e of n.Borders)if(e.BorderPosition===t)return!0;return!1}function Aa(e,t){throw Error(`${t}: ${e}`)}function Oa(e){return e/2}function Ba(e,t,n){if(Ca(e.Styles,"styles","helpers.initCellCachedObjects"),Ca(e.Fonts,"fonts","helpers.initCellCachedObjects"),t.CachedStyle=uo(t,e),$s(e.BorderStyles)||(t.CachedBorderStyle=ao(t,e)),t.CachedFont=co(t.CachedStyle,e,t.StyleID||0),t.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},t.CachedIndent=t.CachedStyle.Indentation,!$s(t.TextRuns))for(let n=0;n<t.TextRuns.length;n++){const o=t.TextRuns[n];o.CachedFont=co(o,e,void 0)}t.CachedDisplayText=void 0,t.CachedDisplayTextRuns=void 0,n&&t.Text&&(t.CachedDisplayText=Ua(t,e))}function ka(e,t){const n=_o(e);mr()?(n.DirtyCellsMap||(n.DirtyCellsMap=new Map),n.DirtyCellsMap.set(Ao(t.Row,t.Col),mn.EntireCell)):(n.DirtyCellsKeys||(n.DirtyCellsKeys=[]),n.DirtyCellsKeys.push(Ao(t.Row,t.Col)));const o=Ha(t,e.Cells),r=Ho(e.Cells,t,o);if(mr())for(const e of r)n.DirtyCellsMap.set(e,mn.EntireCell);else n.DirtyCellsKeys=n.DirtyCellsKeys.concat(r)}function Pa(e,t){if(Ca(t,"model","getColumnWidth"),Ca(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error(`getColumnWidth: column width requested for a cell which is not in range of the model. colIndex: ${e}, columnWidths.length: ${t.ColumnWidths.length}`);return t.ColumnWidths[e]}function Ea(e,t){if(Ca(e,"cell","getCellFont"),Ca(t.Styles,"Styles","getCellFont"),Ca(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){const n=qo(t,e);e.CachedFont=co(n,t,e?.StyleID||0)}return e.CachedFont}function Ha(e,t){let n=xa(t,0,t.length,e,Xo);return n<0&&(n=~n),n}function La(e,t,n){return t===$t.Bottom?Da(e,$t.Bottom)&&Da(n,$t.Top):t===$t.Top&&Da(e,$t.Top)&&Da(n,$t.Bottom)}function Na(e,t,n){return t===$t.Right?Da(e,$t.Right)&&Da(n,$t.Left):t===$t.Left&&Da(e,$t.Left)&&Da(n,$t.Right)}function Wa(e,t,n){const o=t[e].StartIndex;let r=n.length;return e<t.length-1&&(r=t[e+1].StartIndex),n.substring(o,r)}function _a(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0}function za(e,t){return $s(e)?Ga(t)?t:rs:Qa(e.BackgroundColor)}function Ga(e){return!$s(e)}function Va(e){return!$s(e.highContrastScheme)}function ja(e,t,n){if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:t.CachedDisplayTextRuns??t.TextRuns,Fonts:n.Fonts}}function Ua(e,t){if(Ec(e.PreviewText))return e.PreviewText;if(e.DisplayFormula)return e.FormulaInfo.Formula;if(Zs(e)&&e.Text&&e.OriginalText&&(n=e.Text,/^(#)+$/.test(n)))return e.OriginalText;var n;if(!ic(e))return e.Text;if($s(e.CachedDisplayText))if(!$s(e.Text)&&$s(e.WrapText)&&e.Text.indexOf(fs)>=0){const n=ja(e.Text,e,t);!$s(n)&&n.Text.indexOf(fs)>=0&&(e.CachedDisplayTextRuns=function(e){const t=e.TextRuns,n=[],o=e.Text;Xa(t,o);let r=0;for(let i=0;i<t.length;i++){const l=t[i];Ca(l.EndIndex,"EndIndex","getAdjustedTextRuns"),Ca(l.StartIndex,"StartIndex ","getAdjustedTextRuns");let s=l.StartIndex,a=l.EndIndex;r!==s&&(a+=r-s,s=r);for(let t=l.StartIndex;t<l.EndIndex;t++)o.charAt(t)!==fs||e.WrapText||a--;n.push({StartIndex:s,EndIndex:a,FontID:l.FontID,GlobalFontID:l.GlobalFontID,CachedFont:l.CachedFont}),r=a}return n}(e)),e.CachedDisplayText=function(e){return-1!==e.indexOf(gs)||-1!==e.indexOf(fs)?e.replace(/\r\n|\n/g,""):e}(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function $a(e,t,n){t.Text=n,ic(t)&&(rc(t)&&(t.CachedDisplayText=void 0),t.CachedDisplayText=Ua(t,e)),Po(t)?Qs(t):t.NumFmt=void 0}function qa(e,t){return!(!t||!e.FormulaInfo?.Formula)&&(e.FormulaInfo.FormulaType===_t.Formula||e.FormulaInfo.FormulaType===_t.ArrayFormula&&e.FormulaInfo.IsArrayRoot)}function Xa(e,t){if(void 0===e[0]?.EndIndex)for(let n=0;n<e.length;n++){const o=e[n],r=n<e.length-1?e[n+1].StartIndex:t.length;o.EndIndex=r}}function Ya(e){return void 0!==e}function Ja(e,t){return Ca(e,"model","getModelRowIndex"),Ca(e.RowNumbers,"RowNumbers","getModelRowIndex"),xa(e.RowNumbers,0,e.RowNumbers.length,t,ba)}function Ka(e,t){return Ca(e,"model","getModelColumnIndex"),Ca(e.ColumnNumbers,"ColumnNumbers","getModelColumnIndex"),xa(e.ColumnNumbers,0,e.ColumnNumbers.length,t,ba)}function Qa(e){let t=Number(e).toString(16);for(;t.length<6;)t="0"+t;return"#"+t}function Za(e,t,n,o){return!(t<n||o<e)}function ec(e,t){const n=Za(e.FirstColumn,e.LastColumn,t.FirstColumn,t.LastColumn),o=Za(e.FirstRow,e.LastRow,t.FirstRow,t.LastRow);return n&&o}function tc(e,t){return eu()?tu(t.x,e.x,e.x+e.width)&&tu(t.y,e.y,e.y+e.height):Za(t.x,t.x,e.x,e.x+e.width)&&Za(t.y,t.y,e.y,e.y+e.height)}function nc(e){return e.ClientOnlyCache?.PreviewCellsSettings?.PreviewCellsRange??e.ClientOnlyCache?.PreviewCellsRange}function oc(e,t){if(t&&0!==t.length&&void 0!==e)for(let n=0;n<t.length;n++){const o=t[n];for(let t=o.FirstColumn;t<=o.LastColumn;t++)o.OriginPTWidth=o.OriginPTWidth+e.getColWidthOverrideDiff(t+1)}}function rc(e){return!$s(e.Text)&&$s(e.WrapText)&&e.Text.indexOf(fs)>=0&&e.Text!==e.CachedDisplayText}function ic(e){const t=e.ValueType===Wt.Number,n=ko(e),o=rc(e),r=e.CachedStyle?.HorizontalAlignment===Ht.Fill;return t||o||r||n}function lc(e,t){switch(t){case oa.Sparkline:return e.Sparkline;case oa.InCellImage:return e.InCellImage;default:throw Error(`getDynamicImageInformationFromCell: unsupported image type = ${t}`)}}function sc(){return"undefined"!=typeof OffscreenCanvas}function ac(e,t,n){const o=t.Merge;if(o.SpansBlocks){o.HeightAdjustedForDrawing=Math.round(o.Height*n),o.WidthAdjustedForDrawing=Math.round(o.Width*n),o.OriginDeltaXAdjustedForDrawing=Math.round(o.OriginDeltaX*n),o.OriginDeltaYAdjustedForDrawing=Math.round(o.OriginDeltaY*n);const r=e.RowOffsets[t.Row]-o.OriginDeltaY;o.SpansNextBlockVertically=r+o.Height>e.BlockHeight;const i=e.ColumnOffsets[t.Col]-o.OriginDeltaX;o.SpansNextBlockHorizontally=i+o.Width>e.BlockWidth}}function cc(e){const{startOffsetX:t,startOffsetY:n}=e;return(t<<10)+n}function uc(e,t,n,o){const r=dc(t,n,o);if(e.Fonts){const n=co(t,e,void 0);n.RefCount=gc(n.RefCount||0)}return r}function dc(e,t,n){return{BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment||Ht.Automatic,ID:t||0,NamedStyleId:e.NamedStyleId||0,RefCount:n||0,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation||0,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder||Et.Context,FontID:e.FontID||0,GlobalFontID:e.GlobalFontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient,Orientation:e.Orientation||0,VerticalText:e.VerticalText||!1,PatternStyle:e.PatternStyle||0,PatternColor:e.PatternColor}}function hc(e,t,n){const o=[];for(let t=0;t<e.Borders.length;t++){const n=e.Borders[t],r={BorderLineStyle:n.BorderLineStyle,BorderPosition:n.BorderPosition,Weight:n.Weight,Color:{Red:n.Color.Red,Blue:n.Color.Blue,Green:n.Color.Green}};o.push(r)}return{Borders:o,ID:t||0,RefCount:n||0}}function fc(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,FontScheme:e.FontScheme,ID:t||0,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign,GlobalId:e.GlobalId}}function gc(e){return $s(e)?1:e+1}function mc(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX}function Cc(e,t,n){Ca(e,"renderingRegion","validateRenderingRegion");const o=t.RowOffsets[e.startRow],r=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],i=t.ColumnOffsets[e.startColumn],l=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(o>e.startOffsetY||r<e.endOffsetY)throw Error(`validateRenderingRegion: Invalid renderingRegion. startOffsetY= ${e.startOffsetY}, endOffsetY = ${e.endOffsetY}, firstRowStartOffset= ${o}, lastRowEndOffset= ${r}, modelHeight= ${t.BlockHeight}, rowHeights= ${t.RowHeights}, rowOffsets= ${t.RowOffsets}, startRow = ${e.startRow}, endRow = ${e.endRow}, isRTL = ${t.IsRtl}, DPR: ${n.devicePixelRatio}, zoom: ${n.zoom}`);if(i>e.startOffsetX||l<e.endOffsetX)throw Error(`validateRenderingRegion: Invalid renderingRegion. startOffsetX= ${e.startOffsetX}, endOffsetX = ${e.endOffsetX}, firstColumnStartOffset= ${i}, lastColumnEndOffset= ${l}, modelWidth= ${t.BlockWidth}, colWidths= ${t.ColumnWidths}, colOffsets= ${t.ColumnOffsets}, startColumn = ${e.startColumn}, endColumn = ${e.endColumn}, isRTL = ${t.IsRtl}, DPR: ${n.devicePixelRatio}, zoom: ${n.zoom}`)}function pc(e,t){if(0===e.startOffsetX&&0===e.startOffsetY&&e.endOffsetX===t.BlockWidth&&e.endOffsetY===t.BlockHeight)return!0;if(mr())for(const[n]of t.ClientOnlyCache.DirtyCellsMap){const{row:t,column:o}=Oo(n),r=Za(o,o,e.startColumn,e.endColumn),i=Za(t,t,e.startRow,e.endRow);if(r&&i)return!0}else{const n=t.ClientOnlyCache.DirtyCellsKeys;for(let t=0;t<n.length;t++){const o=n[t],{row:r,column:i}=Oo(o),l=Za(i,i,e.startColumn,e.endColumn),s=Za(r,r,e.startRow,e.endRow);if(l&&s)return!0}}return!1}function wc(e,t){if(e)for(const n in e){const o=e[n];for(let e=0;e<o.length;e++)t(o[e])}}function Sc(e,t,n){if(!(t>=0&&t<=e.length))throw Error(`addNewValueToArray: Index ${t} is out of range`);e.splice(t,0,n)}function yc(e,t){if(!(t>=0&&t<e.length))throw Error(`addNewValueToArray: Index ${t} is out of range`);e.splice(t,1)}function Rc(e,t){const n=[];for(let o=0;o<e.length;o++){const r=e[o];n[o]=Ic(r,t[r.FontID||0])}return n}function Tc(e,t){for(let n=0;n<e.length;n++)e[n].GlobalFontID=Io(e[n].FontID,t)}function Ic(e,t){return{FontID:t??(e.FontID||0),GlobalFontID:e.GlobalFontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}}function vc(e,t){bc(e,t,1,t.Spill.SpanToEnd),bc(e,t,-1,t.Spill.SpanToStart)}function bc(e,t,n,o){const r=1===n?o+1:o;for(let o=1===n?1:0;o<r;o++){const r=$o(t.Row,t.Col+n*o,e);if(r){const t=Zo(e,r);t&&t.Borders&&t.Borders.length>0&&Bc(r,t,e)}}}function xc(e,t,n){if(yo(Vt.MoveSpillCellBeforeRendering,t))Oc(e,n,t);else{Ca(e,"cell","setBorders"),Ca(n,"BorderStyle","setBorders");const o=Zo(t,e),r=Ac(t)+1;n.ID=r,o.RefCount=Math.max(0,(o.RefCount||0)-1),t.BorderStyles.splice(r,0,n),e.BorderStyleID=r,e.CachedBorderStyle=n}}function Fc(e,t){if(Ca(e,"cell","attachCellToModel"),Ca(t.Cells,"this.model.Cells","attachCellToModel"),$o(e.Row,e.Col,t))return;const n=_o(t),o=Ha(e,t.Cells);t.Cells.splice(o,0,e),n.CellLookup[Ao(e.Row,e.Col)]=e;const r=qo(t,e);if(Ca(r,"style","attachCellToModel"),r.RefCount=gc(r.RefCount||0),t.BorderStyles){const n=Zo(t,e);Ca(n,"borderStyle","attachCellToModel"),n.RefCount=gc(n.RefCount||0),e.CachedBorderStyle=n}}function Dc(e,t,n,o){const r=Zo(t,e);if(!r)return;let i=!1;for(let e=0;e<r.Borders.length;e++)if(r.Borders[e].BorderPosition===o){i=!0;break}i||(Uc(e,t),Zo(t,e).Borders.push(n),qc(e,t))}function Mc(e,t,n){Ca(e,"cell","removeBorderFromCell");const o=Zo(t,e);if(!o||!o.Borders||0===o.Borders.length)return;let r=!1;for(let e=0;e<o.Borders.length;e++){const t=o.Borders[e];t&&t.BorderPosition===n&&(r=!0)}if(!r)return;Uc(e,t);const i=Zo(t,e);for(let e=0;e<i.Borders.length;e++){const t=i.Borders[e];if(t&&t.BorderPosition===n){i.Borders.splice(e,1);break}}qc(e,t)}function Ac(e){return e.BorderStyles.length-1}function Oc(e,t,n){Ca(e,"cell","setBorders"),Ca(t,"BorderStyle","setBorders");const o=Zo(n,e),r=Ac(n)+1;t.ID=r,o.RefCount=Math.max(0,(o.RefCount||0)-1),n.BorderStyles.splice(r,0,t),e.BorderStyleID=r,e.CachedBorderStyle=t}function Bc(e,t,n){const o=hc(t,t.ID||0,1);if(o&&o.Borders){const t=o.Borders.length;for(let r=0;r<t;r++){const t=o.Borders[r];t&&t.BorderPosition===$t.Left&&(o.Borders.splice(r),Jn()?Xc(e,n,o,!0):Oc(e,o,n))}}}function kc(){return window?.navigator?.userAgent.indexOf("Macintosh")>=0}function Pc(){if(window&&window.navigator){const e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1}function Ec(e){return null!=e}function Hc(e){return e.Styles.length-pa-1}function Lc(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n>=Ds&&n<=Ms)return!0}return!1}function Nc(e,t){return t>fo||0!=(e&1<<t)}function Wc(e,t){return void 0===e.serverHeight?Math.abs(t-e.clientHeight)<=wa:e.serverHeight===t}function _c(e,t){return void 0===e.serverHeight||e.serverHeight===t}function zc(e,t){const n=Hc(e)+1,o=uc(e,uo(t,e),n,1);return o.HorizontalAlignment=Ht.Center,o.VerticalAlignment=Lt.Center,e.Styles.splice(n,0,o),{refErrorStyle:o,refErrorGlobalId:oo().getOrCreateID(o)}}function Gc(e,t,n){e.HorizontalAlignmentSet=!1,e.CachedStyle=t,e.GlobalCellStyleID=n,e.StyleID=t.ID}function Vc(e,t,n){let o=!1;if(e.Merge){const r=e.Row+e.Merge.Rows,i=t.RowNumbers[r],l=e.Col+e.Merge.Columns;o=n(i,t.ColumnNumbers[l])}return o}function jc(e){let t=0;for(let n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function Uc(e,t){const n=Zo(t,e);if(Jn())$c(e,t,hc(n,0,1),!1);else{if((n.ID||0)!==Nt.DefaultBorder&&(n.RefCount||0)<=1)return;xc(e,t,hc(n,0,1))}}function $c(e,t,n,o){if(yo(Vt.MoveSpillCellBeforeRendering,t))Xc(e,t,n,o);else{Ca(e,"cell","setBordersNew"),Ca(n,"BorderStyle","setBordersNew");const r=Zo(t,e),i=Ac(t)+1;n.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),t.BorderStyles.splice(i,0,n),e.BorderStyleID=i,o?(e.GlobalBorderStyleID=Yn().getOrCreateID(n),e.CachedBorderStyle=ao(e,t)):e.CachedBorderStyle=n}}function qc(e,t){const n=Zo(t,e);e.GlobalBorderStyleID=Yn().getOrCreateID(n),e.CachedBorderStyle=ao(e,t)}function Xc(e,t,n,o){Ca(e,"cell","setBorders"),Ca(n,"BorderStyle","setBorders");const r=Zo(t,e),i=Ac(t)+1;n.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),t.BorderStyles.splice(i,0,n),e.BorderStyleID=i,o?(e.GlobalBorderStyleID=Yn().getOrCreateID(n),e.CachedBorderStyle=ao(e,t)):e.CachedBorderStyle=n}function Yc(e,t,n){return t===$t.Right?$o(e.Row,e.Col+1,n):t===$t.Bottom?$o(e.Row+1,e.Col,n):t===$t.Left?$o(e.Row,e.Col-1,n):t===$t.Top?$o(e.Row-1,e.Col,n):null}function Jc(e){return e===$t.Right?$t.Left:e===$t.Bottom?$t.Top:e===$t.Left?$t.Right:e===$t.Top?$t.Bottom:null}function Kc(e){return e===$t.Top||e===$t.Bottom}function Qc(e){return e===$t.Left||e===$t.Right}function Zc(){return Ta??(Ta=Fn(Sn.OptimizeUnnecessaryHeaderCanvasCalls)),Ta}function eu(){return void 0===Ia&&(Ia=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.HitRegionsEndExclusive",!1)),Ia}function tu(e,t,n){return!(e<t||n<=e)}const nu={},ou={},ru={},iu=1.1,lu=2e3;let su,au,cu;function uu(e){return $s(nu[e])?(nu[e]=Math.max(Math.round(e),1),nu[e]):nu[e]}function du(e,t){if(e<0||e>t.length-1)throw`getColWidthFromOffsets:: invalid colIndex ${e}`;return t[e+1]-t[e]}function hu(e,t){if(e<0||e>t.length-1)throw`getRowHeightFromOffsets:: invalid colIndex ${e}`;return t[e+1]-t[e]}function fu(e,t){return Math.round(e*t)}function gu(e,t,n,o,r){let i=0;n&&(i=n+Xs);const l=t+i+o+r;return Math.max(0,e-ts-l)}function mu(e,t){return Math.max(0,e-ts-t)}function Cu(e){return e-ts}function pu(e,t){t&&(e.save(),e.strokeStyle="transparent",function(e,t,n,o,r){e.beginPath(),e.rect(t,n,o,r),e.stroke(),e.clip()}(e,t.x,t.y,t.width,t.height))}function wu(e,t){t&&e.restore()}function Su(e,t,n,o,r){e.moveTo(t,n),e.lineTo(o,r)}function yu(e){if(""===e)return{Red:0,Green:0,Blue:0};const t="#"===e[0]?e.substr(1):e,n=parseInt(t,16);return{Red:n>>16&255,Green:n>>8&255,Blue:255&n}}function Ru(e,t){let n=e.Row,o=e.Row,r=e.Col,i=e.Col;e.Merge?(o+=e.Merge.Rows,i+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(r=0),e.Merge.OriginDeltaY&&(n=0))):e.Spill&&(r-=e.Spill.SpanToStart,i+=e.Spill.SpanToEnd);const l=Za(r,i,t.startColumn,t.endColumn),s=Za(n,o,t.startRow,t.endRow);return l&&s}function Tu(e,t){return e||!t}function Iu(e,t){const n=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,o=n[n.length-1];return t.IsRtl?o-n[e+1]:n[e]}function vu(e){const t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647}function bu(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}function xu(e,t){const n=e.CachedStyle.BackgroundColor;return $s(t.HeaderPartialSelectionFontColor)||n!==Mr&&n!==Ar?$s(e.Hyperlink)?(r=t.TextColor,ru[r]||(ru[r]=Qa(r)),ru[r]):(o=t.LinkColor,ou[o]||(ou[o]=Qa(o)),ou[o]):t.HeaderPartialSelectionFontColor;var o,r}function Fu(e,t){const n=document.createElement("div");return n.style.visibility="hidden",n.style.direction=e.BaseDir,n.style.position="absolute",n.style.width=Math.max(lu,t*iu)+"px",n}function Du(e,t,n){const o=Cu(e)-t-n;return Math.max(0,o)}function Mu(e,t){const n=e.RowHeights,o=e.ColumnWidths,r=e.RowOffsets,i=e.ColumnOffsets;Ro(n,"rowHeights","initializeOffsetsForDrawing"),Ro(o,"colWidths","initializeOffsetsForDrawing"),Ro(r,"rowOffsets","initializeOffsetsForDrawing"),Ro(i,"colOffsets","initializeOffsetsForDrawing");const l=_o(e);l.RowOffsetsAdjustedForDrawing=[];for(let e=0;e<r.length;e++){const n=r[e];l.RowOffsetsAdjustedForDrawing.push(Math.round(n*t))}l.ColOffsetsAdjustedForDrawing=[];for(let e=0;e<i.length;e++){const n=i[e];l.ColOffsetsAdjustedForDrawing.push(Math.round(n*t))}l.RowOffsetsAdjustedForDrawing.push(fu(e.BlockHeight,t)),l.ColOffsetsAdjustedForDrawing.push(fu(e.BlockWidth,t))}function Au(e){return!!e.ClientOnlyCache&&!!e.ClientOnlyCache.RowOffsetsAdjustedForDrawing&&!!e.ClientOnlyCache.ColOffsetsAdjustedForDrawing}function Ou(e,t){return t?2===e.ColumnOffsets.length:2===e.RowOffsets.length}function Bu(e,t){return t.isFormulaView&&e.FormulaInfo?.FormulaType===_t.ArrayFormula&&!e.FormulaInfo.IsArrayRoot}function ku(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}function Pu(){return su||(su=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.TextRenderRefactor",!1)),su}function Eu(){return void 0===cu&&(cu=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.CLExpBlockedSpillTextHint",!1)),cu}function Hu(e){return e?oi.has(e.StyleID||0):(Pn.sendTraceTag(509097937,En.msoulscat_ES_EWAJSGrid,d.Error,"isCellPartiallySelected: cell is not defined"),!1)}function Lu(e){return e?ri.has(e.StyleID||0):(Pn.sendTraceTag(508059907,En.msoulscat_ES_EWAJSGrid,d.Error,"isCellWhollySelected: cell is not defined"),!1)}function Nu(e,t,n){return n?e.RowNumbers[t]:e.ColumnNumbers[t]}function Wu(e){return zu(zs,e)}function _u(e){return Wu(e)+1}function zu(e,t){return Math.round(e*t)}const Gu=1,Vu=Oa(Gu);function ju(e,t){Ro(e,"ctx","drawRectangle"),Ro(t,"drawingContext","drawRectangle");const{innerColor:n,outerColor:o,left:r,bottom:i,height:l,width:s}=t;o&&function(e,t,n,o,r,i){e.strokeStyle=i,e.beginPath(),e.rect(t,n,o,r),e.stroke()}(e,r+Vu,i-l-Vu,s,l,o),n&&function(e,t,n,o,r,i){e.fillStyle=i,e.beginPath(),e.fillRect(t,n,o,r),e.fill()}(e,r+Gu,i-l,s-Gu,l-Gu,n)}function Uu(e,t){Ro(e,"ctx","drawRoundRectangle"),Ro(t,"drawingContext","drawRoundRectangle");const{innerColor:n,outerColor:o,left:r,bottom:i,height:l,width:s,radius:a}=t;if(0===a.length||a.length>4)throw new Error(`Invalid radius array length: ${a.length}`);let c=[];switch(a.length){case 1:c=[a[0],a[0],a[0],a[0]];break;case 2:c=[a[0],a[1],a[0],a[1]];break;case 3:c=[a[0],a[1],a[2],a[1]];break;case 4:c=a}const u=r+Vu,d=i-l-Vu,h=u+s,f=d+l;e.beginPath(),e.roundRect?e.roundRect(u,d,s,l,c):(e.moveTo(u+c[0],d),e.lineTo(h-c[1],d),e.quadraticCurveTo(h,d,h,d+c[1]),e.lineTo(h,f-c[2]),e.quadraticCurveTo(h,f,h-c[2],f),e.lineTo(u+c[3],f),e.quadraticCurveTo(u,f,u,f-c[3]),e.lineTo(u,d+c[0]),e.quadraticCurveTo(u,d,u+c[0],d)),e.closePath(),n&&(e.fillStyle=n,e.fill()),o&&(e.strokeStyle=o,e.stroke())}function $u(e,t){if(!(e.RowOffsets&&e.ColumnOffsets&&e.RowHeights&&e.ColumnWidths))throw`drawGridLines:: one or more elements is null: RowOffset: ${!e.RowOffsets}, ColumnOffsets: ${!e.ColumnOffsets}, RowHeights: ${!e.RowHeights}, ColumnWidths: ${!e.ColumnWidths}`;if(e.RowOffsets.length!==e.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(e.ColumnOffsets.length!==e.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";return!(!e.ShowGridLines||t.scaleFactor<Kl||!Tu(Va(t),Ga(e.BackgroundColor)))}function qu(e,t,n){let o=Math.round(e*t)-ts/2;if(n&&Pc()){const e=window?window.devicePixelRatio:-1;2===e&&t===e/2&&(o-=1)}return o}function Xu(e,t,n,o){const r=e+t-n;return Math.min(r,o)}function Yu(e,t,n){const o=Math.max(e-t,0);return Math.min(o,n)}function Ju(e,t,n,o,r,i){const l=i.startRow,s=i.endRow;for(let i=l;i<=s;i++){const l=Xu(t[i],hu(i,t),o,r);Su(e,0,l,n,l)}}function Ku(e,t,n,o,r,i){const l=i.startColumn,s=i.endColumn;for(let i=l;i<=s;i++){const l=Xu(t[i],du(i,t),o,r);Su(e,l,0,l,n)}}function Qu(e,t,n,o){return $s(t.highContrastScheme)?$s(e.GridLineColor)?n&&t.viewMode===Bt.NamedSheetView?o?Vl:_l:o?Gl:Nl:e.GridLineColor:`${Qa(t.highContrastScheme.TextColor)}`}function Zu(e){return e.viewMode===Bt.NamedSheetView?zl:Wl}function ed(e,t,n,o,r,i,l,s,a,c){Uu(e,{outerColor:a,innerColor:c,left:r[i]-l,bottom:o,width:t,height:n,radius:[s,0,0,0]})}function td(e,t,n,o,r,i,l,s,a,c){const u=Math.max(s-l,0);Uu(e,{outerColor:a,innerColor:c,left:r[i+1]-ns-u,bottom:o,width:t,height:n,radius:[0,s,0,0]})}function nd(e,t,n,o,r,i,l,s,a,c){const u=Math.max(s-l,0);Uu(e,{outerColor:a,innerColor:c,left:o,bottom:r[i]+1+u,width:t,height:n,radius:[s,0,0,0]})}function od(e,t,n,o,r,i,l,s,a,c){Uu(e,{outerColor:a,innerColor:c,left:o,bottom:r[i+1]+l-1,width:t,height:n,radius:[0,0,0,s]})}function rd(e,t){e.lineWidth=ts,e.setLineDash(function(e){return $s(e.GridLineColor)?ps:ws}(t))}const id=1,ld=409,sd=11,ad="Calibri",cd=`${sd}pt ${ad}`,ud="aptos narrow",dd=1.06,hd=1,fd=new Set(["angsananew","aptosnarrow","aptosdisplay","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho","xlyellow","aharoni","aptos","aptosmono","aptosserif","","batangche","","dengxian","","","dotumche","","","","",""," ","","","_hkscs","ms ","ms ","ms p","ms p","opensans","","-extb","roboto","","","",""]),gd=2;let md,Cd;function pd(e,t,n,o,r,i){Ca(md,"externalCallbacks","handleRibbonCommand"),md.handleRibbonCommandCallback(e,t,n,o,r,i)}function wd(e,t,n){Ca(md,"externalCallbacks","showFloatingCommentCallback"),md.showOrCloseFloatingCommentCallback(e,t,n)}function Sd(e,t,n,o){Ca(md,"externalCallbacks","invokeRibbonCommandWithCellReference"),md.invokeRibbonCommandWithCellReferenceCallback(e,t,n,o)}function yd(e,t,n,o){Ca(md,"externalCallbacks","tableSelectorsCallback"),md.tableSelectorsCallback(e,t,n,o)}function Rd(e,t,n,o,r){Ca(md,"externalCallbacks","onHeaderUnhideRowColCallback"),md.onHeaderUnhideRowColCallback(e,t,n,o,r)}const Td={};function Id(e,t){if(!md)return t;if(!$s(Td[e]))return Td[e];const n=md.getServiceSetting(e);return Td[e]=n,$s(n)?t:n}function vd(){return md.shouldHitTestHandleEvent()}function bd(e,t,n,o){return Ca(md,"externalCallbacks","showOrHideHyperlinkFloatie"),md.showOrHideHyperlinkFloatie(e,t,n,o)}function xd(e){return Ca(md,"externalCallbacks","isResizeAllowed"),md.isResizeAllowed(e)}function Fd(){return Ca(md,"externalCallbacks","isHeaderDragAllowed"),md.isHeaderDragAllowed()}function Dd(e,t,n){return Ca(md,"externalCallbacks","isHeaderInsertAllowed"),md.isHeaderInsertAllowed(e,t,n)}function Md(e){return Od()&&"function"==typeof md.getFontFamilyEndPoint?md.getFontFamilyEndPoint(e):Fn(Sn.FontFidelityCorrections)?256:0}function Ad(){return md.isEditingOrInComponentRangePicker()}function Od(){return!$s(md)}function Bd(){return md.isStandardZoomCssSupportedByBrowser()}function kd(){return void 0===Cd&&(Cd=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.HoverTelemetry",!1)),Cd||!1}function Pd(e,t){return Ca(md,"externalCallbacks","isCellAlreadySelected"),md.isCellAlreadySelected(e,t)}let Ed="";const Hd=2500;let Ld,Nd=[],Wd=[];const _d=function(){if(Ld)return Ld;Ld=!1,window.performance&&"function"==typeof window.performance.now&&(Ld=!0);try{window.performance.now()}catch(e){Ld=!1}return Ld}()?window.performance:void 0;function zd(e,t){return{succeeded:e,message:t,performance:Nd,counters:Wd,messageLevel:Kd()}}function Gd(e,t,n,o){const r=_d?_d.now():-1;if(t(),_d){const t=_d.now()-r;n&&Nd[e]?(Nd[e]+=t,o&&Wd[e]++):(Nd[e]=t,o&&(Wd[e]=1))}}var Vd;function jd(){Ed="",Xd=void 0}function Ud(e){qd(e,1)}function $d(e){qd(e,0)}function qd(e,t){var n;e&&""!==e&&(Ed=(Ed+"; "+e).substring(0,Hd),(n=t)>Kd()&&(Xd=n))}let Xd,Yd,Jd;function Kd(){return void 0===Xd?0:Xd}function Qd(e){return 2*e/3}!function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderInternalDurationMs=3]="RenderInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs",e[e.DrawAutoFiltersMs=28]="DrawAutoFiltersMs",e[e.RegisterHitRegionsMs=29]="RegisterHitRegionsMs",e[e.DrawInCellImagesMs=30]="DrawInCellImagesMs",e[e.DrawRichErrorMs=31]="DrawRichErrorMs",e[e.DrawCommentsMs=32]="DrawCommentsMs",e[e.DrawRichValueIcons=33]="DrawRichValueIcons",e[e.DrawPhoneticTextDurationMs=34]="DrawPhoneticTextDurationMs",e[e.HyperlinkEventRegistrationMs=35]="HyperlinkEventRegistrationMs",e[e.CellTooltipRegistrationMs=36]="CellTooltipRegistrationMs",e[e.RegisterTableSelectorsMs=37]="RegisterTableSelectorsMs",e[e.DrawPreviewCellsModeOverlayMs=38]="DrawPreviewCellsModeOverlayMs",e[e.DrawSkeletonCellsMs=39]="DrawSkeletonCellsMs",e[e.RegisterHeaderHitRegionsToModelMs=40]="RegisterHeaderHitRegionsToModelMs",e[e.DrawTableBordersMs=41]="DrawTableBordersMs",e[e.DrawHiddenRowColDurationMs=42]="DrawHiddenRowColDurationMs",e[e.DrawOutlines=43]="DrawOutlines",e[e.DrawPatternMs=44]="DrawPatternMs",e[e.DrawAutoFiltersForHeaderSnappingMs=45]="DrawAutoFiltersForHeaderSnappingMs",e[e.DrawInCellControls=46]="DrawInCellControls",e[e.DrawRowColDragAndDropSixSquaresDurationMs=47]="DrawRowColDragAndDropSixSquaresDurationMs",e[e.DrawResizePillDurationMs=48]="DrawResizePillDurationMs",e[e.ClearColumnHeaderGutterAreaDurationMs=49]="ClearColumnHeaderGutterAreaDurationMs",e[e.DrawHeaderCellTextDurationMs=50]="DrawHeaderCellTextDurationMs",e[e.DrawSingleCellTextDurationMs=51]="DrawSingleCellTextDurationMs",e[e.DrawInsertDotAndInsertButton=52]="DrawInsertDotAndInsertButton",e[e.DrawTextTextLineHeight=53]="DrawTextTextLineHeight",e[e.DrawTextTextMaxWidth=54]="DrawTextTextMaxWidth",e[e.DrawTextUpdateCellContext=55]="DrawTextUpdateCellContext",e[e.DrawDataCleansingHeaderIcon=56]="DrawDataCleansingHeaderIcon",e[e.DrawWrapTextDurationMs=57]="DrawWrapTextDurationMs",e[e.DrawSpillCellTextDurationMs=58]="DrawSpillCellTextDurationMs",e[e.DrawFillTextClippedDurationMs=59]="DrawFillTextClippedDurationMs",e[e.DrawFillTextUnClippedDurationMs=60]="DrawFillTextUnClippedDurationMs",e[e.InitializeCachedObjectDurationMs=61]="InitializeCachedObjectDurationMs",e[e.UpdateCellsBeforeDurationMs=62]="UpdateCellsBeforeDurationMs",e[e.BreakToLinesDurationMs=63]="BreakToLinesDurationMs",e[e.InitializeBidiJsDurationMs=64]="InitializeBidiJsDurationMs",e[e.SetTransformDurationMs=65]="SetTransformDurationMs",e[e.DrawSpillCellClippedDurationMs=66]="DrawSpillCellClippedDurationMs"}(Vd||(Vd={}));class Zd{dispose(){this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.setWidth(0),this.setHeight(0),this.renderingRegion&&(this.renderingRegion.isRendered=!1)}appendToParent(e){e&&(e.appendChild(this.canvas),this.parentElement=e)}getContext2d(e){return this.offscreenCanvas?this.offscreenCanvas.getContext("2d",this.ctxOptions):this.canvas.getContext("2d",this.ctxOptions)}getWidth(){return this.offscreenCanvas?this.offscreenCanvas.width:this.canvas.width}setWidth(e){this.offscreenCanvas?this.offscreenCanvas.width=e:this.canvas.width=e}getHeight(){return this.offscreenCanvas?this.offscreenCanvas.height:this.canvas.height}setHeight(e){this.offscreenCanvas?this.offscreenCanvas.height=e:this.canvas.height=e}getStyle(){return this.canvas.style}setClassName(e){this.canvas.className=e??""}updatePosition(e,t,n,o){if(this.canvas){const r=e+"px",i=t+"px",l=this.canvas.style;if(n||(o?l.right!==r:l.left!==r)||l.top!==i)return o?l.right=r:l.left=r,l.top=i,!0}return!1}setDimensions(e,t,n){const o=Math.round(e*n),r=Math.round(t*n);this.setStyleDimensions(o,r,n),this.setWidth(o),this.setHeight(r)}setRenderingRegion(e){e&&(this.renderingRegion=e)}getRenderingRegion(){return this.renderingRegion}setStyleDimensions(e,t,n){this.canvas.style.width=e/n+"px",this.canvas.style.height=t/n+"px"}constructor(e,t){this.renderingRegion=void 0,this.canvas=document.createElement("canvas"),this.parentElement=null;const n=!!t&&sc();if(this.ctxOptions={alpha:!e},n)try{this.offscreenCanvas=this.canvas.transferControlToOffscreen()}catch(e){$d("RenderingCanvasElement.ctor:: OffscreenCanvas failed."),this.offscreenCanvas=void 0}else this.offscreenCanvas=void 0}}let eh=!1;const th={};const nh=new Map;let oh,rh=0;function ih(e){const t=nh.get(e);if(t&&t.fontNameCannonized)return t.fontNameCannonized;const n=function(e){const t=nh.get(e);if(t&&t.fontNameCannoizedNoLowercase)return t.fontNameCannoizedNoLowercase;let n=e;const o=e.indexOf("(Body)");o>0&&(n=e.substring(0,o).trim());const r=n.replace(/[\""]/g,""),i=nh.get(e)||{};return nh.set(e,{...i,fontNameCannoizedNoLowercase:r}),r}(e).toLowerCase(),o=nh.get(e)||{};return nh.set(e,{...o,fontNameCannonized:n}),n}function lh(e,t){try{if(!sh()&&document.fonts.check(e))return!0;const n=t&&"arial"===ih(t);return!(sh()&&n||!sh()||!document.fonts.check(e))}catch(e){return $d("Error in documentFontsCheck"),!1}finally{rh++}}function sh(){return void 0===oh&&(oh=Fn(Sn.ArialFontRenderingFix)),!!oh}const ah={},ch={totalCount:0,unknown:0,static:0,flat:0,hierarchical:0,system:0,apple:0,google:0},uh=new Set;let dh=!1,hh=!1;function fh(e){let t="Custom Font";return mh(e)&&(t=gh(e)),t}function gh(e){return`Sanitized_${e}`}function mh(e){const t=e.replace(/\s/g,"").toLowerCase();return fd.has(t)}function Ch(e){const t=Md(e);return Sh(e,t),0!==t}function ph(e){return 0!=(64&e)}function wh(e){return 0!=(128&e)}function Sh(e,t){const n=e.toLowerCase();if(!uh.has(n))switch(uh.add(n),ch.totalCount+=1,ph(t)&&(ch.apple+=1),wh(t)&&(ch.google+=1),t){case 0:ch.unknown+=1;break;case 1:ch.static+=1;break;case 2:ch.flat+=1;break;case 4:ch.hierarchical+=1;break;case 32:ch.system+=1}}function yh(e,t){return Rh(e.CachedFont,function(e){if(xh(e))return e.ShrunkSize}(e),t)}function Rh(e,t,n){const o=!!e.Bold,r=vh(o,!!e.Italic);let i=t??e.Size??sd;return Th(e)&&(i=Qd(i)),Ih(n,r,i,e.FontName,o)}function Th(e){return!$s(e.VerticalAlign)&&e.VerticalAlign!==Xt.None}function Ih(e,t,n,o,r=!1){let i=ih(o),l=o;e.ClientOnlyCache&&e.ClientOnlyCache.FallbackFonts&&e.ClientOnlyCache.FallbackFonts[bh(i,n)]&&(i=Ys),function(e){return!dh&&e===ud}(i)&&(e.ClientOnlyCache?.renderWithOldDefaultFont?(i=Ys,l=Ys):!dh&&lh(`${n}pt "${i}"`,i)?(dh=!0,hh&&setTimeout((()=>{Pn.sendTraceTag(507053218,En.msoulscat_ES_EWAJSGrid,d.Info,"getFontCssString: Was using fallback for Aptos Narrow, but now it is loaded.")}),200)):(i=Ys,l=Ys,e.ClientOnlyCache.renderWithOldDefaultFont=!0,hh=!0));const s=function(e,t){if(t&&Pc())return e;if(eh||(Yd=new Zd(!1,!0),Yd.setWidth(1),Yd.setHeight(1),Jd=Yd.getContext2d(),eh=!0),!Jd)return e;let n=th[e];return n||(Jd.font=e,n=Jd.font,th[e]=n,n)}(`${t} ${n}pt "${i}"`,r);return ah[s]=l,s}function vh(e,t){let n="";return n=e&&t?"bold italic":e?"bold":t?"italic":"normal",n}function bh(e,t){return`${t}pt ${ih(e)}`}function xh(e){return!(Ec(e.PreviewText)||e.DisplayFormula||!e.CachedStyle.ShrinkToFit||e.WrapText)}function Fh(e){return Dh(e,e.CachedFont,!0)}function Dh(e,t,n){const o=xh(e);let r=o?e.ShrunkSize:t.Size;return(!n&&Th(t)||Th(t)&&!n)&&(r=Qd(r)),r<0&&$d(`\n      actual font size < 0.\n      doesCellHaveShrinkToFit: ${o},\n      cell.ShrunkSize: ${e.ShrunkSize},\n      Font:\n        size: ${t.Size};\n        fontName: ${fh(t.FontName)};\n        refCount: ${t.RefCount||0};\n      cell.CachedStyle:\n        isHidden: ${!!e.CachedStyle?.IsHidden};\n        shrinkToFit: ${!!e.CachedStyle?.ShrinkToFit};\n      cell.Ifmt: ${e.Ifmt||0};\n      cell.WrapText: ${e.WrapText};\n    `),r}function Mh(e){return!(!e||!e.StrikeThrough&&!e.Underline&&!e.VerticalAlign)}function Ah(e,t){let n=Math.round(e);if(n<id&&e>0&&(n=id),n>ld&&(n=ld),n<0)throw Error(`TextLayout.approximateValue: ${n} in Excel must be between 1pt and 409pt`);let o=t[n];if(o)return o;let r=n;for(;r>id&&!t[r];)r--;let i=n;for(;i<ld&&!t[i];)i++;return o=function(e,t,n,o,r){const i=(n-o)/(r-o)*(e-t);return Math.round(t+i)}(t[i],t[r],n,r,i),t[n]=o,o}const Oh={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},Bh={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},kh={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},Ph={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},Eh={1:0,3:0,4:0,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90};function Hh(e,t,n){var o;return(o=n)&&(o.StrikeThrough||o.Underline||o.VerticalAlign)?function(e){return yo(Vt.TextOrientationSlice2,e)}(e)&&Lh(e,t):Lh(e,t)}function Lh(e,t){return function(e){return yo(Vt.TextOrientationSlice1,e)}(e)&&(o=t,!!o?.Orientation)&&(n=t?.HorizontalAlignment,!(n===Ht.Fill||n===Ht.CenterAcrossSelection));var n,o}function Nh(e,t){(t>Os||t<As)&&Aa("Orientation is not in the defined range","getOrientationInCanvas");const n=-1*t;return e?-1*n:n}function Wh(e,t,n,o){e.save(),e.textAlign=o<0?ks:Ps,e.translate(t,n),e.rotate(o)}function _h(e,t,n){return e*Math.abs(Math.cos(n))+t}function zh(e,t,n){return e*Math.abs(Math.sin(n))+t*Math.abs(Math.cos(n))}function Gh(e,t,n,o,r,i,l){switch(e){case Lt.Top:return i+o+t;case Lt.Center:return l-(r-o)/2;case Lt.Bottom:case Lt.Justify:case Lt.Distributed:default:return l-(t-(n?es:0))}}function Vh(e,t){const n=!!e.WrapText||xh(e);let o=Bh;switch(e.CachedStyle.VerticalAlignment){case Lt.Center:return n?Ah(t,o):0;case Lt.Top:return e.CachedFont.Italic&&(o=Oh),Ah(t,o);case Lt.Justify:case Lt.Distributed:case Lt.Bottom:default:return Ah(t,o)}}function jh(e){return e*Math.PI/180}function Uh(e){return e.CachedStyle?.HorizontalAlignment===Ht.CenterAcrossSelection}function $h(e){switch(e.CachedStyle?.HorizontalAlignment){case Ht.Justify:case Ht.JustifyDistributed:case Ht.Distributed:return!0}return!1}function qh(e){return e>Ht.Right}function Xh(e,t,n=!0){if(t.DisplayFormula)return Ht.Left;if(Ec(t.PreviewText)&&t.PreviewCellStyle?.HorizontalAlignment)return t.PreviewCellStyle.HorizontalAlignment;const o=t.CachedStyle?.HorizontalAlignment||Ht.Automatic;if(t.PivotTable?.HasExpandCollapseIndicator&&!$s(t.Spill)&&o!==Ht.CenterAcrossSelection)return e.IsRtl?Ht.Right:Ht.Left;if(Hh(e,t.CachedStyle,t.CachedFont)&&(n||!Fn(Sn.InCellControlCheckboxAlignmentChangeInTextRotaion)))return Nh(e.IsRtl,t.CachedStyle?.Orientation)<0?Ht.Left:Ht.Right;switch(o){case Ht.Fill:return e.IsRtl?Ht.Right:Ht.Left;case Ht.JustifyDistributed:case Ht.Justify:case Ht.Distributed:case Ht.Automatic:return Zs(t)?Ht.Left:function(e,t){const n=t.CachedStyle?.HorizontalAlignment||Ht.Automatic;if(t.PivotTable?.HasExpandCollapseIndicator&&(n===Ht.Distributed||n===Ht.Fill))return e.IsRtl?Ht.Right:Ht.Left;switch(t.CachedStyle?.ReadingOrder||Et.Context){case Et.LeftToRight:return Ht.Left;case Et.RightToLeft:return Ht.Right;case Et.Context:const e=t.Text;if(!$s(e)&&""!==e)return vu(e[0])?Ht.Right:Ht.Left}return Ht.Left}(e,t)}return o}function Yh(e,t,n,o){let r=0;const i=Xh(e,t);switch(i){case Ht.Left:r=n;break;case Ht.Right:r=n-o;break;case Ht.Center:case Ht.CenterAcrossSelection:r=n-o/2;break;default:throw Error(`unexpected context alignment ${i}`)}return r}function Jh(e,t,n){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=n,e.stroke()}function Kh(e,t,n,o){e.beginPath(),e.moveTo(o[0].x,o[0].y);for(let t=1;t<o.length;t++)e.lineTo(o[t].x,o[t].y);Jh(e,t,n)}function Qh(e,t){const n=t.CondFormat?.Icon;if(n){if(n.IconOnly){const n=Xh(e,t);return n===Ht.Left||n===Ht.Automatic}return!0}return!1}function Zh(e,t,n){return Ca(t,"cell","getCellWidth"),Ca(e,"model","getCellWidth"),Ca(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&Ca(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),xf(e,t,n,!1)}function ef(e,t,n){return Ca(t,"cell","getCellHeight"),Ca(e,"model","getCellHeight"),Ca(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&Ca(e.RowOffsets,"model.RowOffsets","getCellHeight"),bf(e,t,n,!1)}function tf(e,t,n){return Ca(t,"cell","getCellWidth"),Ca(e,"model","getCellWidth"),Ca(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&Ca(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),Ff(e,t,n,!1,!1,!1)}function nf(e,t,n){let o=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(o-=t.Merge.OriginDeltaX),e.IsRtl?n-o:o+Zh(e,t,!1)-ts}function of(e,t){return rf(e,t)+ef(e,t,!1)}function rf(e,t){return vf(e,t,!1,!1)}function lf(e,t){return Ca(e,"model","getCellWidthAdjustedForDrawing"),Ca(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),Ca(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),Ca(t,"cell","getCellWidthAdjustedForDrawing"),xf(e,t,!1,!0)}function sf(e,t){return Ca(e,"model","getCellHeightAdjustedForDrawing"),Ca(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),Ca(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),Ca(t,"cell","getCellHeightAdjustedForDrawing"),bf(e,t,!1,!0)}function af(e,t,n,o){return Ca(e,"model","getCellWidthAdjustedForDrawing"),Ca(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),Ca(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),Ca(t,"cell","getCellWidthAdjustedForDrawing"),Ff(e,t,void 0,n,!0,o)}function cf(e,t){return!e.IsRtl||t.RichValueIcon?af(e,t,!1,!1):uf(e,t,!1)-pf(t,e)+ts}function uf(e,t,n){const o=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=o.length-1,i=t.Col;if(!e.IsRtl||n)return af(e,t,n,!1)+lf(e,t)-ts;const l=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return o[r]+l-o[i]}function df(e,t){return gf(e,t,!1)+sf(e,t)}function hf(e,t){return gf(e,t,!1)+sf(e,t)/2}function ff(e,t,n){return(uf(e,t,n)+af(e,t,n,!1))/2}function gf(e,t,n){return vf(e,t,!0,n)}function mf(e){return!$s(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)}function Cf(e,t){const n=t.ColumnOffsets[If(e)],o=Tf(e,t),r=t.ColumnOffsets[o];return t.ColumnWidths[o]+Math.abs(r-n)}function pf(e,t){const n=Mf(t,If(e),!0),o=Tf(e,t),r=Mf(t,o,!0);return du(o,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Math.abs(r-n)}function wf(e,t,n,o){const r=function(e,t,n,o){return(Rf(e,t)?n:0)+(e.IsRtl?0:o)}(t,e,n,o),i=t.ColumnOffsets[If(e)]+r;if(t.IsRtl){const n=Tf(e,t),o=t.ColumnOffsets[n],i=t.ColumnWidths[n];return t.BlockWidth-o-i+r+ts}return i}function Sf(e,t,n){return{x:af(e,t,n,!1)-ts,y:gf(e,t,!1)-ts,width:lf(e,t)+ts,height:sf(e,t)+ts}}function yf(e,t,n){const o=t.Spill&&n;let r=o?cf(e,t):af(e,t,!1,!1);return r=e.IsRtl?r-ts:r,{x:r,y:gf(e,t,!1),width:o?pf(t,e):lf(e,t),height:sf(e,t)}}function Rf(e,t){return!!Qh(e,t)||!!t.RichValueIcon||!$s(t.LinkedEntity?.IconWidth)&&!e.IsRtl}function Tf(e,t){return Ca(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}function If(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function vf(e,t,n,o){let r=Df(e,t.Row,n);return t.Merge&&t.Merge.SpansBlocks&&!o&&(r-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,n)),r}function bf(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,o);const r=Df(e,t.Row,o),i=function(e,t,n){const o=t.Row+t.Merge.Rows;return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[o+1]:e.RowOffsets[o]+e.RowHeights[o]}(e,t,o);return i-r}return function(e,t,n){return n?hu(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing):e.RowHeights[t.Row]}(e,t,o)}function xf(e,t,n,o){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,o);const r=Mf(e,t.Col,o),i=function(e,t,n){const o=t.Col+t.Merge.Columns;return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[o+1]:e.ColumnOffsets[o]+e.ColumnWidths[o]}(e,t,o);return i-r}return function(e,t,n){return n?du(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):Pa(t.Col,e)}(e,t,o)}function Ff(e,t,n,o,r,i){let l=Mf(e,t.Col,r);return t.Merge&&t.Merge.SpansBlocks&&!i&&(l-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,r)),!e.IsRtl||o?l:(r?uf(e,t,o):n-l)-xf(e,t,!1,r)+ts}function Df(e,t,n){return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function Mf(e,t,n){return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}let Af;function Of(){return void 0===Af&&(Af=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.SkeletonRectFillOnce",!1)),Af}function Bf(e,t,n,o,r,i){const l=Math.min(o/4,16),s=Math.min(r/4,8),a=t+o/2-l/2,c=n+r/2-s/2;i?e.rect(a,c,l,s):e.fillRect(a,c,l,s)}function kf(e,t,n,o,r,i){const l={eventType:i,callback:r,zIndex:o,region:Wf(n)};Nf(e,t.CellHitRegions,l)}function Pf(e,t,n,o,r,i=(()=>!0)){const l={cursorType:o,zIndex:r,region:Wf(n),shouldChangeCursor:i};Nf(e,t.CellCursorHitRegions,l)}function Ef(e,t,n,o,r){const i={tooltipText:o,zIndex:r,region:Wf(n)};Nf(e,t.CellTooltipHitRegions,i)}function Hf(e,t,n,o,r){const i={zIndex:o,eventType:"mouseenter",callback:r,region:Wf(n)};Nf(e,t.CellHitRegions,i)}function Lf(e,t,n,o,r){const i={zIndex:o,eventType:"mouseleave",callback:r,region:Wf(n)};Nf(e,t.CellHitRegions,i)}function Nf(e,t,n){const o=function(e,t){const n=Ao(t.Row,t.Col);let o=e[n];return o||(e[n]=[],o=e[n]),o}(t,e);o.push(n)}function Wf(e){const t=e.scaleFactor,n=e.rect,o=n.x/t,r=n.y/t,i=n.width/t,l=n.height/t,s=e.renderingRegion,a=o-(e.isRtl?e.blockWidth-s.endOffsetX:s.startOffsetX),c=r-s.startOffsetY;return{x:e.isMirrored?s.endOffsetX-o-i:a,y:c,width:i,height:l}}const _f={red:{color:"Red",infoString:"Full render"},blue:{color:"Blue",infoString:"Full render from PLT cache"},green:{color:"Green",infoString:"Partial Rendering (Rendering only changed cells)"}};function zf(e,t,n){const{CellHitRegions:o,CellCursorHitRegions:r,CellTooltipHitRegions:i,CellLongPressHitRegions:l}=jo(e,cc(n));[o,r,i,l].forEach((e=>{e&&Object.values(e).forEach((e=>{for(let t=0;t<e.length;t++){const n=e[t],o=n.region,{x:r,y:i,width:l,height:s}=o;n.eventType,n.tooltipText,n.cursorType,n.onStart}}))}))}let Gf,Vf=!0;const jf=document.createElement("div"),Uf=document.createElement("img"),$f=document.createElement("img");jf.innerText=".",jf.style.visibility="hidden",Uf.style.height="0px",$f.style.height="0px",jf.appendChild(Uf),jf.appendChild($f),document?.body&&document.body.appendChild(jf),new Set;let qf={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"1pt calibri":{fontSize:1,fontMetrics:{height:1,baseline:0,middle:.3125}},"2pt calibri":{fontSize:2,fontMetrics:{height:3,baseline:.7407407760620117,middle:1.3541667461395264}},"3pt calibri":{fontSize:3,fontMetrics:{height:4,baseline:.7407407760620117,middle:1.6666667461395264}},"4pt calibri":{fontSize:4,fontMetrics:{height:7,baseline:1.4814815521240234,middle:2.719907522201538}},"5pt calibri":{fontSize:5,fontMetrics:{height:8,baseline:1.4814815521240234,middle:3.032407760620117}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"17pt calibri":{fontSize:17,fontMetrics:{height:27,baseline:5.925926208496094,middle:11.192131042480469}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"19pt calibri":{fontSize:19,fontMetrics:{height:31,baseline:6.666666030883789,middle:12.546297073364258}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"21pt calibri":{fontSize:21,fontMetrics:{height:34,baseline:7.407405853271484,middle:13.91203498840332}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"23pt calibri":{fontSize:23,fontMetrics:{height:37,baseline:8.148151397705078,middle:15.266206741333008}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"25pt calibri":{fontSize:25,fontMetrics:{height:41,baseline:8.88888931274414,middle:16.63194465637207}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"27pt calibri":{fontSize:27,fontMetrics:{height:44,baseline:9.629631042480469,middle:17.98611068725586}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"29pt calibri":{fontSize:29,fontMetrics:{height:47,baseline:10.370368957519531,middle:19.351852416992188}},"30pt calibri":{fontSize:30,fontMetrics:{height:48,baseline:10.370372772216797,middle:19.652780532836914}},"31pt calibri":{fontSize:31,fontMetrics:{height:50,baseline:11.11111068725586,middle:20.70602035522461}},"32pt calibri":{fontSize:32,fontMetrics:{height:52,baseline:11.11111068725586,middle:21.018518447875977}},"33pt calibri":{fontSize:33,fontMetrics:{height:54,baseline:11.851852416992188,middle:22.06018829345703}},"34pt calibri":{fontSize:34,fontMetrics:{height:55,baseline:11.851852416992188,middle:22.37268829345703}},"35pt calibri":{fontSize:35,fontMetrics:{height:57,baseline:12.592594146728516,middle:23.425926208496094}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"37pt calibri":{fontSize:37,fontMetrics:{height:60,baseline:13.333335876464844,middle:24.791667938232422}},"38pt calibri":{fontSize:38,fontMetrics:{height:61,baseline:13.333335876464844,middle:25.104167938232422}},"39pt calibri":{fontSize:39,fontMetrics:{height:64,baseline:14.444446563720703,middle:26.510421752929688}},"40pt calibri":{fontSize:40,fontMetrics:{height:65,baseline:14.074073791503906,middle:26.458335876464844}},"41pt calibri":{fontSize:41,fontMetrics:{height:67,baseline:14.444446563720703,middle:27.135421752929688}},"42pt calibri":{fontSize:42,fontMetrics:{height:68,baseline:14.814811706542969,middle:27.812496185302734}},"43pt calibri":{fontSize:43,fontMetrics:{height:70,baseline:15.555553436279297,middle:28.871524810791016}},"44pt calibri":{fontSize:44,fontMetrics:{height:71,baseline:15.555557250976562,middle:29.18402862548828}},"45pt calibri":{fontSize:45,fontMetrics:{height:73,baseline:16.296295166015625,middle:30.21990966796875}},"46pt calibri":{fontSize:46,fontMetrics:{height:76,baseline:16.666664123535156,middle:30.90277862548828}},"47pt calibri":{fontSize:47,fontMetrics:{height:77,baseline:16.666667938232422,middle:31.215282440185547}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"49pt calibri":{fontSize:49,fontMetrics:{height:80,baseline:17.777774810791016,middle:32.951385498046875}},"50pt calibri":{fontSize:50,fontMetrics:{height:81,baseline:17.77777862548828,middle:33.24652862548828}},"51pt calibri":{fontSize:51,fontMetrics:{height:83,baseline:18.518516540527344,middle:34.30555725097656}},"52pt calibri":{fontSize:52,fontMetrics:{height:84,baseline:18.888893127441406,middle:34.982643127441406}},"53pt calibri":{fontSize:53,fontMetrics:{height:87,baseline:18.888893127441406,middle:35.295143127441406}},"54pt calibri":{fontSize:54,fontMetrics:{height:88,baseline:18.888885498046875,middle:35.607635498046875}},"55pt calibri":{fontSize:55,fontMetrics:{height:90,baseline:20,middle:37.02546310424805}},"56pt calibri":{fontSize:56,fontMetrics:{height:91,baseline:20,middle:37.32638931274414}},"57pt calibri":{fontSize:57,fontMetrics:{height:92,baseline:20,middle:37.638893127441406}},"58pt calibri":{fontSize:58,fontMetrics:{height:94,baseline:21.111114501953125,middle:39.062503814697266}},"59pt calibri":{fontSize:59,fontMetrics:{height:96,baseline:21.111106872558594,middle:39.375}},"60pt calibri":{fontSize:60,fontMetrics:{height:98,baseline:21.111114501953125,middle:39.687503814697266}},"61pt calibri":{fontSize:61,fontMetrics:{height:100,baseline:22.22222900390625,middle:41.111114501953125}},"62pt calibri":{fontSize:62,fontMetrics:{height:101,baseline:22.22222137451172,middle:41.40625}},"63pt calibri":{fontSize:63,fontMetrics:{height:102,baseline:22.22222900390625,middle:41.718753814697266}},"64pt calibri":{fontSize:64,fontMetrics:{height:104,baseline:23.333335876464844,middle:43.142364501953125}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"66pt calibri":{fontSize:66,fontMetrics:{height:107,baseline:23.333335876464844,middle:43.767364501953125}},"67pt calibri":{fontSize:67,fontMetrics:{height:110,baseline:24.44445037841797,middle:45.19097900390625}},"68pt calibri":{fontSize:68,fontMetrics:{height:111,baseline:24.444442749023438,middle:45.50347137451172}},"69pt calibri":{fontSize:69,fontMetrics:{height:112,baseline:24.44445037841797,middle:45.798614501953125}},"70pt calibri":{fontSize:70,fontMetrics:{height:114,baseline:25.555557250976562,middle:47.22222137451172}},"71pt calibri":{fontSize:71,fontMetrics:{height:116,baseline:25.55554962158203,middle:47.53472137451172}},"72pt calibri":{fontSize:72,fontMetrics:{height:117,baseline:25.925926208496094,middle:48.21759033203125}},"85pt calibri":{fontSize:85,fontMetrics:{height:138,baseline:30,middle:56.31945037841797}},"98pt calibri":{fontSize:98,fontMetrics:{height:160,baseline:35.55554962158203,middle:65.88541412353516}},"100pt calibri":{fontSize:100,fontMetrics:{height:162,baseline:35.55555725097656,middle:66.51620483398438}},"111pt calibri":{fontSize:111,fontMetrics:{height:181,baseline:40,middle:74.35763549804688}},"124pt calibri":{fontSize:124,fontMetrics:{height:202,baseline:44.44444274902344,middle:82.82986450195312}},"137pt calibri":{fontSize:137,fontMetrics:{height:223,baseline:48.888885498046875,middle:91.30209350585938}},"150pt calibri":{fontSize:150,fontMetrics:{height:243,baseline:53.33332824707031,middle:99.77430725097656}},"163pt calibri":{fontSize:163,fontMetrics:{height:266,baseline:58.88890075683594,middle:109.34028625488281}},"176pt calibri":{fontSize:176,fontMetrics:{height:287,baseline:63.333343505859375,middle:117.81251525878906}},"189pt calibri":{fontSize:189,fontMetrics:{height:308,baseline:67.77778625488281,middle:126.28474426269531}},"202pt calibri":{fontSize:202,fontMetrics:{height:329,baseline:72.22222900390625,middle:134.7569580078125}},"215pt calibri":{fontSize:215,fontMetrics:{height:350,baseline:76.66668701171875,middle:143.22918701171875}},"228pt calibri":{fontSize:228,fontMetrics:{height:371,baseline:81.11111450195312,middle:151.70138549804688}},"241pt calibri":{fontSize:241,fontMetrics:{height:392,baseline:86.66665649414062,middle:161.26736450195312}},"254pt calibri":{fontSize:254,fontMetrics:{height:413,baseline:91.11111450195312,middle:169.7395782470703}},"267pt calibri":{fontSize:267,fontMetrics:{height:434,baseline:95.5555419921875,middle:178.2117919921875}},"280pt calibri":{fontSize:280,fontMetrics:{height:456,baseline:100,middle:186.68402099609375}},"293pt calibri":{fontSize:293,fontMetrics:{height:477,baseline:104.4444580078125,middle:195.13888549804688}},"306pt calibri":{fontSize:306,fontMetrics:{height:499,baseline:110,middle:204.72222900390625}},"319pt calibri":{fontSize:319,fontMetrics:{height:519,baseline:114.4444580078125,middle:213.1944580078125}},"332pt calibri":{fontSize:332,fontMetrics:{height:540,baseline:118.88885498046875,middle:221.66665649414062}},"345pt calibri":{fontSize:345,fontMetrics:{height:561,baseline:123.33334350585938,middle:230.138916015625}},"358pt calibri":{fontSize:358,fontMetrics:{height:582,baseline:127.77777099609375,middle:238.61111450195312}},"371pt calibri":{fontSize:371,fontMetrics:{height:604,baseline:133.33331298828125,middle:248.17709350585938}},"384pt calibri":{fontSize:384,fontMetrics:{height:626,baseline:137.77780151367188,middle:256.6493225097656}},"397pt calibri":{fontSize:397,fontMetrics:{height:647,baseline:142.22222900390625,middle:265.12152099609375}},"409pt calibri":{fontSize:409,fontMetrics:{height:666,baseline:146.66668701171875,middle:273.2812805175781}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function Xf(e,t,n){Vf&&(function(){const e={"8pt aptos narrow":{fontSize:8,fontMetrics:{height:13,baseline:3,middle:5.640625}},"9pt aptos narrow":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.984375}},"10pt aptos narrow":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.3125}},"11pt aptos narrow":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.640625}},"12pt aptos narrow":{fontSize:12,fontMetrics:{height:20,baseline:5,middle:8.96875}},"14pt aptos narrow":{fontSize:14,fontMetrics:{height:23,baseline:5,middle:9.625}},"16pt aptos narrow":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:11.296875}},"18pt aptos narrow":{fontSize:18,fontMetrics:{height:30,baseline:7,middle:12.953125}},"20pt aptos narrow":{fontSize:20,fontMetrics:{height:33,baseline:8,middle:14.609375}},"24pt aptos narrow":{fontSize:24,fontMetrics:{height:39,baseline:9,middle:16.9375}},"26pt aptos narrow":{fontSize:26,fontMetrics:{height:43,baseline:10,middle:18.59375}},"28pt aptos narrow":{fontSize:28,fontMetrics:{height:46,baseline:11,middle:20.265625}},"36pt aptos narrow":{fontSize:36,fontMetrics:{height:59,baseline:14,middle:25.90625}},"48pt aptos narrow":{fontSize:48,fontMetrics:{height:78,baseline:18,middle:33.875}},"72pt aptos narrow":{fontSize:72,fontMetrics:{height:117,baseline:27,middle:50.8125}}};void 0===Gf&&(Gf=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.EnhancedFontMetrics",!1)),qf=Gf?{...qf,...e,"10pt aptos":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.171875}},"11pt aptos":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.484375}},"12pt aptos":{fontSize:12,fontMetrics:{height:20,baseline:5,middle:8.8125}},"9pt aptos display":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.859375}},"10pt aptos display":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.171875}},"11pt aptos display":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.484375}},"12pt aptos display":{fontSize:12,fontMetrics:{height:20,baseline:5,middle:8.8125}},"10pt calibri light":{fontSize:10,fontMetrics:{height:17,baseline:4,middle:7.078125}},"11pt calibri light":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.390625}},"9pt segoe ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6}},"11pt segoe ui":{fontSize:11,fontMetrics:{height:20,baseline:4,middle:7.671875}},"12pt segoe ui":{fontSize:12,fontMetrics:{height:21,baseline:4,middle:8}},"9pt tahoma":{fontSize:9,fontMetrics:{height:14,baseline:2,middle:5.265625}},"12pt tahoma":{fontSize:12,fontMetrics:{height:19,baseline:3,middle:7.359375}},"14pt tahoma":{fontSize:14,fontMetrics:{height:23,baseline:4,middle:9.09375}},"10pt roboto":{fontSize:10,fontMetrics:{height:16,baseline:3,middle:6.515625}},"11pt roboto":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.875}},"10pt cambria":{fontSize:10,fontMetrics:{height:16,baseline:3,middle:6}},"11pt cambria":{fontSize:11,fontMetrics:{height:17,baseline:3,middle:6.421875}},"12pt cambria":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.5}},"11pt arial black":{fontSize:11,fontMetrics:{height:21,baseline:5,middle:8.796875}},"11pt angsana new":{fontSize:11,fontMetrics:{height:20,baseline:6,middle:8.078125}},"10pt century gothic":{fontSize:10,fontMetrics:{height:16,baseline:3,middle:6.546875}},"11pt ":{fontSize:11,fontMetrics:{height:15,baseline:3,middle:6.640625}},"11pt ":{fontSize:11,fontMetrics:{height:17,baseline:3,middle:6.5}}}:{...qf,...e}}(),Vf=!1);const o=bh(e,t),r=qf[o];if(r)return Zf(r.fontMetrics);try{return Zf(Qf(e,t))}catch(r){$d(`FontName:${fh(e)}, FontSize:${t} is trying to fallback to calibri ${r}`),n.ClientOnlyCache.FallbackFonts[o]=!0;try{return tg(t)}catch{const e=Math.max(Math.round(t),1);try{return tg(e)}catch{let t=13*Math.round((e-72)/13)+72;return t=Math.min(t,409),tg(t)}}throw r}}function Yf(e){const t=Object.getOwnPropertyNames(qf),n=e.toLowerCase();for(let e=0;e<t.length;e++){const o=t[e];if(o.indexOf(n)>=0){const e=qf[o].fontSize;try{Qf(n,e)}catch(t){Qf(Ys,e)}}}}function Jf(e){let t=-1,n=-1,o=-1;const r=Uf,i=$f;return jf.style.font=e,r.style.verticalAlign="baseline",i.style.verticalAlign="middle",Gd(Vd.GetFontMetrics,(()=>{t=jf.clientHeight,n=Kf(r),o=Kf(i)}),!0),{height:t,baseline:n,middle:o}}function Kf(e){if(!jf||!e)throw Error(`getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: ${jf}, baselineLocator: ${e}`);try{const t=jf.getBoundingClientRect(),n=e.getBoundingClientRect();return t.bottom-n.bottom}catch(e){return $d("Error in getFontBaselineHeight: "+e),0}}function Qf(e,t){const n=bh(e,t);if(t>=0&&t<1)return qf[n]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},qf[n].fontMetrics;let o;try{o=Jf(n)}catch(o){return eg(t,e,n,`Exception in getFontMetrics, error:${o}`)}return 0===o.height&&t>=1?eg(t,e,n,"fontMetricsDivHeight == 0."):(qf[n]={fontSize:t,fontMetrics:o},o)}function Zf(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function eg(e,t,n,o){const r=null!==jf.parentNode?"Has Parent":"Parent is null",i=window.getComputedStyle(jf).getPropertyValue("display");jf.style.display="block",document?.body&&document.body.appendChild(jf);const l=Jf(n),s=window.getComputedStyle(jf),a=s.getPropertyValue("display"),c=s.getPropertyValue("height"),u=jf.getBoundingClientRect();if(0!==l.height)return qf[n]={fontSize:e,fontMetrics:l},l;jf.style.overflow="hidden";const d=Jf(n);if(0!==d.height)return qf[n]={fontSize:e,fontMetrics:l},d;const h=`\n       ${o}\n       Font name: ${fh(t)} }, font size: ${e}.\n       fontMetricsDiv ${r}. fontMetricsDivDisplayMode: ${i}.\n       After another appendChild:\n       FontMetricsDivHeight2: ${l.height} (getFontMetricsDivHeight), fontMetricsDivDisplayMode: ${a} (getComputedStyle),\n       fontBoundingClientRect.height: ${u.height} }, top:${u.top} }, bottom:${u.bottom}.\n       css.height: ${s.height} }, css.line-height: ${s.lineHeight} }, computedHeight: ${c}.\n       FontMetricsDiv.scrollWidth: ${jf.scrollWidth} }, fontMetricsDiv.scrollHeight: ${jf.scrollHeight}`;if($d(h),!mh(t)){const t=`${Math.round(e)}pt calibri`;if(qf[t])return qf[t].fontMetrics}throw Error(h)}function tg(e){const t=qf[bh(Ys,e)];return Zf(t?t.fontMetrics:Qf(Ys,e))}const ng=function(){var e=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},o={};n.L=1,o[1]="L",Object.keys(t).forEach((function(e,t){n[e]=1<<t+1,o[n[e]]=e})),Object.freeze(n);var r=n.LRI|n.RLI|n.FSI,i=n.L|n.R|n.AL,l=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,s=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,a=n.S|n.WS|n.B|r|n.PDI|s,c=null;function u(e){return function(){if(!c){c=new Map;var e=function(e){if(t.hasOwnProperty(e)){var o=0;t[e].split(",").forEach((function(t){var r=t.split("+"),i=r[0],l=r[1];i=parseInt(i,36),l=l?parseInt(l,36):0,c.set(o+=i,n[e]);for(var s=0;s<l;s++)c.set(++o,n[e])}))}};for(var o in t)e(o)}}(),c.get(e.codePointAt(0))||n.L}var d,h,f,g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(e,t){var n,o=0,r=new Map,i=t&&new Map;return e.split(",").forEach((function e(l){if(-1!==l.indexOf("+"))for(var s=+l;s--;)e(n);else{n=l;var a=l.split(">"),c=a[0],u=a[1];c=String.fromCodePoint(o+=parseInt(c,36)),u=String.fromCodePoint(o+=parseInt(u,36)),r.set(c,u),t&&i.set(u,c)}})),{map:r,reverseMap:i}}function C(){if(!d){var e=m(g.pairs,!0),t=e.map,n=e.reverseMap;d=t,h=n,f=m(g.canonical,!1).map}}function p(e){return C(),d.get(e)||null}function w(e){return C(),h.get(e)||null}function S(e){return C(),f.get(e)||null}var y,R=n.L,T=n.R,I=n.EN,v=n.ES,b=n.ET,x=n.AN,F=n.CS,D=n.B,M=n.S,A=n.ON,O=n.BN,B=n.NSM,k=n.AL,P=n.LRO,E=n.RLO,H=n.LRE,L=n.RLE,N=n.PDF,W=n.LRI,_=n.RLI,z=n.FSI,G=n.PDI;function V(e){return function(){if(!y){var e=m("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),t=e.map;e.reverseMap.forEach((function(e,n){t.set(n,e)})),y=t}}(),y.get(e)||null}function j(e,t,n,o){var r=e.length;n=Math.max(0,null==n?0:+n),o=Math.min(r-1,null==o?r-1:+o);var i=[];return t.paragraphs.forEach((function(r){var l=Math.max(n,r.start),s=Math.min(o,r.end);if(l<s){for(var c=t.levels.slice(l,s+1),d=s;d>=l&&u(e[d])&a;d--)c[d]=r.level;for(var h=r.level,f=1/0,g=0;g<c.length;g++){var m=c[g];m>h&&(h=m),m<f&&(f=1|m)}for(var C=h;C>=f;C--)for(var p=0;p<c.length;p++)if(c[p]>=C){for(var w=p;p+1<c.length&&c[p+1]>=C;)p++;p>w&&i.push([w+l,p+l])}}})),i}function U(e,t,n,o){for(var r=j(e,t,n,o),i=[],l=0;l<e.length;l++)i[l]=l;return r.forEach((function(e){for(var t=e[0],n=e[1],o=i.slice(t,n+1),r=o.length;r--;)i[n-r]=o[r]})),i}return e.closingToOpeningBracket=w,e.getBidiCharType=u,e.getBidiCharTypeName=function(e){return o[u(e)]},e.getCanonicalBracket=S,e.getEmbeddingLevels=function(e,t){for(var n=new Uint32Array(e.length),o=0;o<e.length;o++)n[o]=u(e[o]);var c=new Map;function d(e,t){var o=n[e];n[e]=t,c.set(o,c.get(o)-1),o&l&&c.set(l,c.get(l)-1),c.set(t,(c.get(t)||0)+1),t&l&&c.set(l,(c.get(l)||0)+1)}for(var h=new Uint8Array(e.length),f=new Map,g=[],m=null,C=0;C<e.length;C++)m||g.push(m={start:C,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:zt(C,!1)}),n[C]&D&&(m.end=C,m=null);for(var y=L|H|E|P|r|G|N|D,V=function(e){return e+(1&e?1:2)},j=function(e){return e+(1&e?2:1)},U=0;U<g.length;U++){var $=[{_level:(m=g[U]).level,_override:0,_isolate:0}],q=void 0,X=0,Y=0,J=0;c.clear();for(var K=m.start;K<=m.end;K++){var Q=n[K];if(q=$[$.length-1],c.set(Q,(c.get(Q)||0)+1),Q&l&&c.set(l,(c.get(l)||0)+1),Q&y)if(Q&(L|H)){h[K]=q._level;var Z=(Q===L?j:V)(q._level);Z<=125&&!X&&!Y?$.push({_level:Z,_override:0,_isolate:0}):X||Y++}else if(Q&(E|P)){h[K]=q._level;var ee=(Q===E?j:V)(q._level);ee<=125&&!X&&!Y?$.push({_level:ee,_override:Q&E?T:R,_isolate:0}):X||Y++}else if(Q&r){Q&z&&(Q=1===zt(K+1,!0)?_:W),h[K]=q._level,q._override&&d(K,q._override);var te=(Q===_?j:V)(q._level);te<=125&&0===X&&0===Y?(J++,$.push({_level:te,_override:0,_isolate:1,_isolInitIndex:K})):X++}else if(Q&G){if(X>0)X--;else if(J>0){for(Y=0;!$[$.length-1]._isolate;)$.pop();var ne=$[$.length-1]._isolInitIndex;null!=ne&&(f.set(ne,K),f.set(K,ne)),$.pop(),J--}q=$[$.length-1],h[K]=q._level,q._override&&d(K,q._override)}else Q&N?(0===X&&(Y>0?Y--:!q._isolate&&$.length>1&&($.pop(),q=$[$.length-1])),h[K]=q._level):Q&D&&(h[K]=m.level);else h[K]=q._level,q._override&&Q!==O&&d(K,q._override)}for(var oe=[],re=null,ie=m.start;ie<=m.end;ie++){var le=n[ie];if(!(le&s)){var se=h[ie],ae=le&r,ce=le===G;re&&se===re._level?(re._end=ie,re._endsWithIsolInit=ae):oe.push(re={_start:ie,_end:ie,_level:se,_startsWithPDI:ce,_endsWithIsolInit:ae})}}for(var ue=[],de=0;de<oe.length;de++){var he=oe[de];if(!he._startsWithPDI||he._startsWithPDI&&!f.has(he._start)){for(var fe=[re=he],ge=void 0;re&&re._endsWithIsolInit&&null!=(ge=f.get(re._end));)for(var me=de+1;me<oe.length;me++)if(oe[me]._start===ge){fe.push(re=oe[me]);break}for(var Ce=[],pe=0;pe<fe.length;pe++)for(var we=fe[pe],Se=we._start;Se<=we._end;Se++)Ce.push(Se);for(var ye=h[Ce[0]],Re=m.level,Te=Ce[0]-1;Te>=0;Te--)if(!(n[Te]&s)){Re=h[Te];break}var Ie=Ce[Ce.length-1],ve=h[Ie],be=m.level;if(!(n[Ie]&r))for(var xe=Ie+1;xe<=m.end;xe++)if(!(n[xe]&s)){be=h[xe];break}ue.push({_seqIndices:Ce,_sosType:Math.max(Re,ye)%2?T:R,_eosType:Math.max(be,ve)%2?T:R})}}for(var Fe=0;Fe<ue.length;Fe++){var De=ue[Fe],Me=De._seqIndices,Ae=De._sosType,Oe=De._eosType,Be=1&h[Me[0]]?T:R;if(c.get(B))for(var ke=0;ke<Me.length;ke++){var Pe=Me[ke];if(n[Pe]&B){for(var Ee=Ae,He=ke-1;He>=0;He--)if(!(n[Me[He]]&s)){Ee=n[Me[He]];break}d(Pe,Ee&(r|G)?A:Ee)}}if(c.get(I))for(var Le=0;Le<Me.length;Le++){var Ne=Me[Le];if(n[Ne]&I)for(var We=Le-1;We>=-1;We--){var _e=-1===We?Ae:n[Me[We]];if(_e&i){_e===k&&d(Ne,x);break}}}if(c.get(k))for(var ze=0;ze<Me.length;ze++){var Ge=Me[ze];n[Ge]&k&&d(Ge,T)}if(c.get(v)||c.get(F))for(var Ve=1;Ve<Me.length-1;Ve++){var je=Me[Ve];if(n[je]&(v|F)){for(var Ue=0,$e=0,qe=Ve-1;qe>=0&&(Ue=n[Me[qe]])&s;qe--);for(var Xe=Ve+1;Xe<Me.length&&($e=n[Me[Xe]])&s;Xe++);Ue===$e&&(n[je]===v?Ue===I:Ue&(I|x))&&d(je,Ue)}}if(c.get(I))for(var Ye=0;Ye<Me.length;Ye++){var Je=Me[Ye];if(n[Je]&I){for(var Ke=Ye-1;Ke>=0&&n[Me[Ke]]&(b|s);Ke--)d(Me[Ke],I);for(Ye++;Ye<Me.length&&n[Me[Ye]]&(b|s|I);Ye++)n[Me[Ye]]!==I&&d(Me[Ye],I)}}if(c.get(b)||c.get(v)||c.get(F))for(var Qe=0;Qe<Me.length;Qe++){var Ze=Me[Qe];if(n[Ze]&(b|v|F)){d(Ze,A);for(var et=Qe-1;et>=0&&n[Me[et]]&s;et--)d(Me[et],A);for(var tt=Qe+1;tt<Me.length&&n[Me[tt]]&s;tt++)d(Me[tt],A)}}if(c.get(I))for(var nt=0,ot=Ae;nt<Me.length;nt++){var rt=Me[nt],it=n[rt];it&I?ot===R&&d(rt,R):it&i&&(ot=it)}if(c.get(l)){for(var lt=T|I|x,st=lt|R,at=[],ct=[],ut=0;ut<Me.length;ut++)if(n[Me[ut]]&l){var dt=e[Me[ut]],ht=void 0;if(null!==p(dt)){if(!(ct.length<63))break;ct.push({char:dt,seqIndex:ut})}else if(null!==(ht=w(dt)))for(var ft=ct.length-1;ft>=0;ft--){var gt=ct[ft].char;if(gt===ht||gt===w(S(dt))||p(S(gt))===dt){at.push([ct[ft].seqIndex,ut]),ct.length=ft;break}}}at.sort((function(e,t){return e[0]-t[0]}));for(var mt=0;mt<at.length;mt++){for(var Ct=at[mt],pt=Ct[0],wt=Ct[1],St=!1,yt=0,Rt=pt+1;Rt<wt;Rt++){var Tt=Me[Rt];if(n[Tt]&st){St=!0;var It=n[Tt]&lt?T:R;if(It===Be){yt=It;break}}}if(St&&!yt){yt=Ae;for(var vt=pt-1;vt>=0;vt--){var bt=Me[vt];if(n[bt]&st){var xt=n[bt]&lt?T:R;yt=xt!==Be?xt:Be;break}}}if(yt){if(n[Me[pt]]=n[Me[wt]]=yt,yt!==Be)for(var Ft=pt+1;Ft<Me.length;Ft++)if(!(n[Me[Ft]]&s)){u(e[Me[Ft]])&B&&(n[Me[Ft]]=yt);break}if(yt!==Be)for(var Dt=wt+1;Dt<Me.length;Dt++)if(!(n[Me[Dt]]&s)){u(e[Me[Dt]])&B&&(n[Me[Dt]]=yt);break}}}for(var Mt=0;Mt<Me.length;Mt++)if(n[Me[Mt]]&l){for(var At=Mt,Ot=Mt,Bt=Ae,kt=Mt-1;kt>=0;kt--){if(!(n[Me[kt]]&s)){Bt=n[Me[kt]]&lt?T:R;break}At=kt}for(var Pt=Oe,Et=Mt+1;Et<Me.length;Et++){if(!(n[Me[Et]]&(l|s))){Pt=n[Me[Et]]&lt?T:R;break}Ot=Et}for(var Ht=At;Ht<=Ot;Ht++)n[Me[Ht]]=Bt===Pt?Bt:Be;Mt=Ot}}}for(var Lt=m.start;Lt<=m.end;Lt++){var Nt=h[Lt],Wt=n[Lt];if(1&Nt?Wt&(R|I|x)&&h[Lt]++:Wt&T?h[Lt]++:Wt&(x|I)&&(h[Lt]+=2),Wt&s&&(h[Lt]=0===Lt?m.level:h[Lt-1]),Lt===m.end||u(e[Lt])&(M|D))for(var _t=Lt;_t>=0&&u(e[_t])&a;_t--)h[_t]=m.level}}return{levels:h,paragraphs:g};function zt(t,o){for(var i=t;i<e.length;i++){var l=n[i];if(l&(T|k))return 1;if(l&(D|R)||o&&l===G)return 0;if(l&r){var s=Gt(i);i=-1===s?e.length:s}}return 0}function Gt(t){for(var o=1,i=t+1;i<e.length;i++){var l=n[i];if(l&D)break;if(l&G){if(0==--o)return i}else l&r&&o++}return-1}},e.getMirroredCharacter=V,e.getMirroredCharactersMap=function(e,t,n,o){var r=e.length;n=Math.max(0,null==n?0:+n),o=Math.min(r-1,null==o?r-1:+o);for(var i=new Map,l=n;l<=o;l++)if(1&t[l]){var s=V(e[l]);null!==s&&i.set(l,s)}return i},e.getReorderSegments=j,e.getReorderedIndices=U,e.getReorderedString=function(e,t,n,o){var r=U(e,t,n,o),i=[].concat(e);return r.forEach((function(n,o){i[o]=(1&t.levels[n]?V(e[n]):null)||e[n]})),i.join("")},e.openingToClosingBracket=p,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return e};let og,rg,ig;function lg(){return void 0===og&&(og=Fn(Sn.BidiJsForReorder)),og}function sg(){ig||(ig=ng())}const ag="rid";function cg(e,t){let n=!1,o=!1;for(let t=0;t<e.length&&(vu(e[t])?n=!0:o=!0,!o||!n);t++);const r=function(e,t){if(!e)return"ltr";switch(t){case Et.LeftToRight:return"ltr";case Et.RightToLeft:return"rtl";case Et.Context:return vu(e[0])?"rtl":"ltr"}}(e,t);return{HasLtr:o,HasRtl:n,HasBidi:o&&n,BaseDir:r}}function ug(e,t,n,o,r){if(!n.HasRtl||n.HasLtr)if(!r&&lg())try{!function(e,t,n){const o=function(e,t){const n=(ig||Gd(Vd.InitializeBidiJsDurationMs,(()=>{sg()})),ig),o=e.length-1,r=n.getEmbeddingLevels(e,t),i=n.getReorderSegments(e,r,0,o),l=[];for(let t=0;t<e.length;t++)l[t]=t;for(let e=0;e<i.length;e++){const t=i[e][0],n=i[e][1];if(r.levels[t]%2==1){const e=l.slice(t,n+1);for(let t=e.length;t--;)l[n-t]=e[t]}}for(let e=0;e<i.length;e++){const t=i[e][0],n=i[e][1];if(r.levels[t]%2==0){const e=l.slice(t,n+1);for(let t=e.length;t--;)l[n-t]=e[t]}}return l}(n,e.BaseDir);!function(e,t,n){for(let o=0;o<t.length;o++){const r=t[o].StartIndex;if(!(Fn(Sn.BidiJsIndexFix)&&r>n.length-1)){if(null==r||r>e.length-1||r<0){const i=r<n.length?bu(n[r]):void 0,l=Wa(o,t,n).length;throw new Error(`bidiOrderBasedOnReorderedIndices: invalid index, index value: ${r}, run index: ${o}, indices length: ${e.length}, run length: ${t.length}, isCharSpecial : ${i}, run length: ${l}`)}t[o].Order=e[r]}}t.sort(((e,t)=>e.Order-t.Order))}(o,t,n)}(n,e,t)}catch(r){Pn.sendTraceTag(505788194,En.msoulscat_ES_EWAJSGrid,d.Warning,`Exception in reorderTextRunsBasedOnJs: ${r}`),Cg(n,o,e,t)}else Cg(n,o,e,t);else e.reverse()}function dg(e,t){const n=[gg(e,0)];if(1===t.length)return n;let o;for(let r=0;r<t.length;r++)if(bu(t[r])){hg(r,o)&&n.push(mg(e,r));const i=r+1;fg(i,t.length)&&n.push(gg(e,i)),o=r}return n}function hg(e,t){return e>0&&!(e-1===t)}function fg(e,t){return e<t}function gg(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function mg(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}function Cg(e,t,n,o){const r=Fu(e,t);for(let e=0;e<n.length;e++){const t=Wa(e,n,o),i=document.createElement("span");i.innerText=t,i.setAttribute(ag,e.toString()),r.appendChild(i)}document.body.appendChild(r);for(let e=0;e<r.children.length;e++){const t=r.children[e],o=t.getAttribute(ag);if(!o)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");const i=t.getBoundingClientRect().left;n[parseInt(o,10)].OffsetX=i}n.sort(((e,t)=>e.OffsetX-t.OffsetX)),document.body.removeChild(r)}const pg="#969696",wg=2,Sg=32,yg=19,Rg=Sg+yg,Tg=.75,Ig=Rg+yg+24,vg=184/164,bg=9,xg=3,Fg=0,Dg=2,Mg=1;let Ag;function Og(){return Ag||(Ag=md.getRibbonCommandsMapping()),Ag}function Bg(e,t,n,o,r,i,l){const s=uu(r*o),a=lf(t,n)-s,c=sf(t,n)-s;let u=e;return l&&(u*=o),i&&(u*=r),Math.ceil(Math.max(Math.min(u,a,c),0))}function kg(e,t,n,o){return{isMirrored:o,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n.x,y:n.y,width:n.width,height:n.height},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}function Pg(e,t,n,o){const{commentRow:r,commentColumn:i}=function(e,t){let n=e.RowNumbers[t.Row]-1,o=e.ColumnNumbers[t.Col]-1;const r=t.Merge?.OriginRow||0,i=t.Merge?.OriginColumn||0;return r&&i&&(n=r,o=i),{commentRow:n,commentColumn:o}}(e,t);return n?l=>{if(t.HasIgnorableError){const n=Og().CardViewHideTemporaryCard;Eg(e,t,n,!0)(l)}var s,a;return Hg(e,t,!1,!0)(l),"touchstart"===l.type?(s=r,a=i,Ca(md,"externalCallbacks","showFloatingCommentOnTouchCallback"),md.showFloatingCommentOnTouchCallback(s,a)):wd(r,i,n),o}:l=>(Hg(e,t,!0,!0)(l),wd(r,i,n),o)}function Eg(e,t,n,o){const r=e.RowNumbers[t.Row],i=e.ColumnNumbers[t.Col];return l=>{const s=Og().CardViewShowTemporaryErrorCard,a=n===s;return t.Comment&&a&&Pg(e,t,!1,!1)(l),Sd(l,n,r,i),o}}function Hg(e,t,n,o){const r=e.RowNumbers[t.Row],i=e.ColumnNumbers[t.Col];return e=>{if(!$s(lc(t,oa.InCellImage))){const t=Og();Sd(e,n?t.CardViewShowTemporaryDataCard:t.CardViewHideTemporaryCard,r,i)}return o}}const Lg=1,Ng=1,Wg=2,_g=1,zg="gray",Gg="white",Vg="#858585",jg="#10893c",Ug=16,$g=2,qg=3,Xg=[{x:5,y:6},{x:8,y:9},{x:11,y:6}],Yg=[{x:3,y:9},{x:5,y:11},{x:7,y:9}],Jg={x:8,y:3},Kg=[Jg,{x:8,y:5},{x:10,y:6},{x:10,y:10},{x:12,y:10},{x:12,y:6},{x:14,y:5},{x:14,y:3},Jg],Qg=8,Zg={x:4,y:3},em={x:11,y:3};function tm(e,t,n,o){return Bg(Ug,e,t,n,o,!1,!0)}function nm(e,t,n,o){const r=tm(e,t,1,n);if(Fn(Sn.RichIconFilterScale)&&t.RichValueIcon&&!t.PivotTable){const e=(Wg+Dg)/o;return Math.round(r/n+e)}return Math.round(t.PivotTable&&t.RichValueIcon?(r/n+Wg)*o:r/n+Wg*o)}function om(e,t,n,o){return Fn(Sn.FixingSortFilterRenderingIssue)&&function(e,t){return Boolean(t.AutoFilter&&lm(e,t.CachedStyle))}(e,t)||function(e){const t=(e.CachedStyle?.HorizontalAlignment||Ht.Automatic)>3;return Boolean(e.AutoFilter&&t)}(t)?nm(e,t,n,o):0}function rm(e,t){return(t.AutoFilter||t.PivotFilter?.DisplayFilter&&t.RichValueIcon)&&lm(e,t.CachedStyle)}function im(e,t){return t.Autofilter&&lm(e,t.CachedStyle)}function lm(e,t){return t?.HorizontalAlignment===Ht.Right&&!e.IsRtl||t?.HorizontalAlignment===Ht.Left&&e.IsRtl}function sm(e,t,n,o,r){const i=uu(r*o),l=sf(e,t)-2*i>n?Math.round(Lg*o):0;switch(t.CachedStyle?.VerticalAlignment){case Lt.Top:return gf(e,t,!1)+l+i+n;case Lt.Center:return df(e,t)-Math.round(sf(e,t)/2)+Math.round(n/2);case Lt.Bottom:default:return df(e,t)-l-i}}function am(e,t,n,o,r){const i=uu(r*o),l=lf(e,t)-2*i>n?Math.round(Ng*o):0;return e.IsRtl?af(e,t,!1,!1)+i:uf(e,t,!1)-n-i-l}function cm(e,t){return Math.floor(Ah(e,Ph)*t)}function um(e,t){return Math.floor(Ah(e,Eh)*t)}function dm(e,t){return t===Lt.Bottom&&(e.Underline===qt.Single||e.Underline===qt.Double)}function hm(e,t,n){return e<t?t:e>n?n:e}function fm(e,t,n,o,r){if(t.CondFormat?.Icon)return cm(n,1)+um(n,1)+ts;if(t.RichValueIcon){const n=function(e,t){if(t.PivotTable)return!1;const n=!!t.RichValueIcon&&!!t.AutoFilter;return e.IsRtl&&n&&!lm(e,t.CachedStyle)}(e,t)?nm(e,t,o,r):0;return t.RichValueIcon.Width+Mg+n}return 0}function gm(e){return e.PivotTable?.HasExpandCollapseIndicator?bg+xg:0}function mm(e){return e?bg+xg:0}function Cm(e,t){const n=Xh(e,t);switch(n){case Ht.Left:case Ht.CenterAcrossSelection:case Ht.Center:return!e.IsRtl;case Ht.Right:return e.IsRtl;case Ht.Automatic:default:throw Error(`shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: ${n}`)}}function pm(e){const t=Fn(Sn.UseDisplayTextForHashes)?e.CachedDisplayText:e.Text;if(!t)return!1;const n=t.split("#").length-1;return e.CachedIsTextWidthExceedsCellWidth||n===t.length&&e.ValueType===Wt.Number}function wm(e,t=1){return Math.round(e*t*Ks)}function Sm(e,t,n){Ro(e,"model","getPivotTableTopAdjustedForDrawing"),Ro(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");const o=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return Ro(o,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),Ro(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),n&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing?o[Ja(e,Tm(t,n))]:o[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing}function ym(e,t,n){Ro(e,"model","getPivotTableLeftAdjustedForDrawing"),Ro(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");const o=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return Ro(o,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),Ro(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),n||!e.IsRtl?o[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:o[o.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-o[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing}function Rm(e,t,n,o){return Ro(e,"model","isPivotIntersectsRenderingRegion"),Ro(t,"pivotTable","isPivotIntersectsRenderingRegion"),Ro(n,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<n.startRow)&&(!((t.IsEmptyPivot?t.FirstRowIndex:Ja(e,Tm(t,o)))>n.endRow)&&!(Fn(Sn.EmptyPivotZoomRenderingFix)?t.FirstColIndex>n.endColumn||t.LastColIndex<n.startColumn:t.FirstColIndex<n.startColumn||t.LastColIndex>n.endColumn))}function Tm(e,t){if(!t)return e.FirstRow;const n=e.ColumnHeaderRange;return $s(n)||n.FirstColumn===n.LastColumn||n.FirstRow===n.LastRow?e.RowHeaderRange.FirstRow:e.ColumnHeaderRange.FirstRow}function Im(e,t,n){if(!e.CondFormat?.Icon?.IconOnly)return!0;const o=e.CachedFont.Size,r=um(o,n),i=cm(o,n),l=gm(e)*n;switch(e.CondFormat.Icon.CFIconHorizontalAlignment){case Ht.Left:case Ht.Right:return t-i-r-l>0;case Ht.Center:return t/2-i/2-l>0;default:return!0}}function vm(e,t,n){const o=za(t.highContrastScheme,n);e.strokeStyle=o,e.lineWidth=ts,e.setLineDash(ps)}function bm(e,t,n,o,r){let i=e.Col,l=e.Col;const s=n.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(l+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(l=s.length-1)):e.Spill&&(i-=e.Spill.SpanToStart,l+=e.Spill.SpanToEnd),i=Math.max(0,i),l=Math.min(n.ColumnNumbers.length,l);const a=sf(n,e),c=gf(n,e,!1),u=a-ts;for(let e=i;e<l;e++){const n=Xu(s[e],du(e,s),o,r);Su(t,n,c,n,c+u)}}function xm(e,t,n,o,r){let i=e.Row,l=e.Row+e.Merge.Rows;const s=n.ClientOnlyCache.RowOffsetsAdjustedForDrawing;i=Math.max(0,i),l=Math.min(n.RowNumbers.length,l),e.Merge.SpansNextBlockVertically&&(l=s.length-1);const a=af(n,e,n.IsRtl,!1),c=lf(n,e)-ts;for(let e=i;e<l;e++){const n=Xu(s[e],hu(e,s),o,r);Su(t,a,n,a+c,n)}}const Fm={},Dm={};var Mm,Am;function Om(e){Ca(e,"model","validateModel"),Ca(e.RowOffsets,"model.RowOffsets","validateModel"),Ca(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),Ca(e.RowHeights,"model.RowHeights","validateModel"),Ca(e.ColumnWidths,"model.ColumnWidths","validateModel")}function Bm(e,t){return{BorderLineStyle:Ut.Thin,Color:t,Weight:ms,BorderPosition:e}}function km(e,t,n,o){let r=n.CachedStyle?.BackgroundColor?yu(n.CachedStyle?.BackgroundColor):o;if(r===o)switch(t.BorderPosition){case $t.Top:{const t=Pm(n,Mm.Top,e);r=t?yu(t):o;break}case $t.Left:{const t=Pm(n,Mm.Left,e);r=t?yu(t):o;break}}if(yo(Vt.DoubleBorderMergeCellFix,e)&&Gm(e,n,t.BorderPosition)){const{BorderPosition:i}=t,l=i===$t.Right||i===$t.Bottom,s=i===$t.Top||i===$t.Left;l||s&&function(e,t,n){if(t.Merge)return!1;switch(n){case $t.Top:{const n=$o(t.Row-1,t.Col,e);return!!n?.Merge}case $t.Left:{const n=$o(t.Row,t.Col-1,e);return!!n?.Merge}}return!1}(e,n,t.BorderPosition)?r=function(e,t,n,o){const r=Pm(e,new Map([[$t.Top,Mm.Top],[$t.Left,Mm.Left],[$t.Right,Mm.Right],[$t.Bottom,Mm.Bottom]]).get(t),n);return r?yu(r):o}(n,t.BorderPosition,e,o):s&&n.Merge&&(r=n.CachedStyle?.BackgroundColor?yu(n.CachedStyle?.BackgroundColor):o)}return r}function Pm(e,t,n){let o;switch(t){case Mm.Top:e.Row>0&&(o=$o(e.Row-1,e.Col,n));break;case Mm.Left:e.Col>0&&(o=$o(e.Row,e.Col-1,n));break;case Mm.Bottom:e.Row<n.RowNumbers.length&&(o=$o(e.Row+1,e.Col,n));break;case Mm.Right:e.Col<n.ColumnNumbers.length&&(o=$o(e.Row,e.Col+1,n))}return o?.CachedStyle?.BackgroundColor}function Em(e,t,n,o,r,i){const l=Nm(e,t,n.BorderPosition,o),s=Um(n);s in i||(r.push(n),i[s]=[]),i[s].push(l)}function Hm(e,t,n,o,r){let i=[],l="",s=ms;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=ms}(e),e.beginPath();for(let d=0;d<t.length;d++){const h=t[d],f=r||jm(h.Color),g=$m(h.BorderLineStyle),m=s!==h.Weight*o,C=l!==f,p=!(a=i,c=g,u=[],kl(),Xi(a,c,u,Ol,cl)).isEqual;(m||C||p)&&(e.stroke(),e.beginPath(),m&&(s=h.Weight*o,e.lineWidth=s),C&&(l=f,e.strokeStyle=f),p&&(e.setLineDash(g),i=g));const w=n[Um(h)];for(let t=0;t<w.length;t++){const n=w[t];Lm(e,h.Weight,n,o)}}var a,c,u;e.stroke()}function Lm(e,t,n,o){!function(e){return e.Y1===e.Y2}(n)?Su(e,Vm(n.X1,t,o),n.Y1-o,Vm(n.X2,t,o),n.Y2):Su(e,n.X1-o,Vm(n.Y1,t,o),n.X2,Vm(n.Y2,t,o))}function Nm(e,t,n,o){if(!e.IsRtl){const r=Fn(Sn.BlockEdgeBorderThicknessFix)&&Jm(t,e)||Gm(e,t,n)?ts:o;return Wm(n,{X:af(e,t,!1,!1),Y:gf(e,t,!1)},{X:uf(e,t,!1)+r,Y:df(e,t)})}const r=Fn(Sn.BlockEdgeBorderThicknessFix)&&Jm(t,e)||Gm(e,t,n)?o-ts:0,i=Wm(n,{X:uf(e,t,!1)+o,Y:gf(e,t,!1)},{X:af(e,t,!1,!1)+r,Y:df(e,t)});if(n===$t.Top||n===$t.Bottom){const e=i.X2;i.X2=i.X1,i.X1=e}return i}function Wm(e,t,n){switch(e){case $t.Top:return{X1:t.X,Y1:t.Y,X2:n.X,Y2:t.Y};case $t.Bottom:return{X1:t.X,Y1:n.Y,X2:n.X,Y2:n.Y};case $t.Right:return{X1:n.X,Y1:t.Y,X2:n.X,Y2:n.Y};case $t.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:n.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function _m(e){switch(e){case Ut.Thin:case Ut.Medium:case Ut.Hair:case Ut.Thick:return!0;default:return!1}}function zm(e,t,n){return!!Jm(n,t)||!!Gm(t,n,e)||(n.HasError?Xm(e):e===$t.Top||e===$t.Left)}function Gm(e,t,n){return!(!t.Merge&&!function(e,t,n){Ca(n,"model","isCellAdjacentToMergedCell");const o=function(e,t,n){return[$o(e-1,t,n),$o(e+1,t,n),$o(e,t-1,n),$o(e,t+1,n)]}(e,t,n);for(let e=0;e<o.length;e++)if(o[e]&&o[e].Merge)return!0;return!1}(t.Row,t.Col,e))&&Xm(n)}function Vm(e,t,n){const o=Oa(n);return t===Cs&&n%2==1?e:e-o}function jm(e){const t=e.Red+"_"+e.Green+"_"+e.Blue;let n=Fm[t];return $s(n)?(n=`rgb(${e.Red},${e.Green},${e.Blue})`,Fm[t]=n,n):n}function Um(e){return`${jm(e.Color)}-${e.Weight}-${e.BorderLineStyle}`}function $m(e){let t=Dm[e];if(!$s(t))return t;switch(e){case Ut.Dotted:t=Ss;break;case Ut.DashDot:case Ut.MediumDashDot:t=Rs;break;case Ut.DashDotDot:case Ut.MediumDashDotDot:t=Ts;break;case Ut.MediumDashed:t=Is;break;case Ut.SlantDashDot:case Ut.Dashed:t=ys;break;default:t=[]}return Dm[e]=t,t}function qm(e){return e.HasError?Fs:e.CachedBorderStyle}function Xm(e){return e<=$t.Right}function Ym(e,t){const n=e.Col===t.endColumn+1&&e.Row>=t.startRow&&e.Row<=t.endRow,o=e.Row===t.endRow+1&&e.Col>=t.startColumn&&e.Col<=t.endColumn;return n||o}function Jm(e,t){return e.Row===t.RowNumbers.length-1||e.Col===t.ColumnNumbers.length-1}!function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom"}(Mm||(Mm={})),function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(Am||(Am={}));const Km=0|Am.Control|Am.CR|Am.LF,Qm=0|Am.L|Am.V|Am.LV|Am.LVT,Zm=0|Am.V|Am.LV,eC=0|Am.V|Am.T,tC=0|Am.LVT|Am.T;function nC(e,t){return!(e===Am.CR&&t===Am.LF||!oC(Km,e)&&!oC(Km,t)&&(e===Am.L&&oC(Qm,t)||oC(Zm,e)&&oC(eC,t)||oC(tC,e)&&t===Am.T||e===Am.Regional_Indicator&&t===Am.Regional_Indicator||t===Am.Extend||t===Am.ZWJ||t===Am.SpacingMark||e===Am.Prepend))}function oC(e,t){return 0!=(e&t)}function rC(e){return 8205===e?Am.ZWJ:13===e?Am.CR:10===e?Am.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?Am.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?Am.Extend:function(e){return 127462<=e&&e<=127487}(e)?Am.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?Am.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?Am.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?Am.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?Am.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?Am.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?Am.LV:Am.Other}function iC(e){if(!e)return[];const t=[];let n=0,o=e.charCodeAt(n),r=rC(e.codePointAt(n)),i=Am.Other;for(let l=1;l<e.length;l++){const s=e.charCodeAt(l);l>=1&&ku(o,s)||(i=rC(e.codePointAt(l)),nC(r,i)&&(t.push(e.substring(n,l)),n=l),r=i,o=s)}return n<=e.length-1&&t.push(e.substring(n)),t}var lC,sC;function aC(e){switch(e){case Lt.Justify:case Lt.Distributed:return!0}return!1}function cC(e,t,n,o,r,i,l){if(l)return Lt.Bottom;switch(e){case Lt.Top:case Lt.Bottom:case Lt.Center:return e;case Lt.Justify:case Lt.Distributed:return function(e,t,n,o,r,i){switch(t){case lC.WrapText:return function(e,t,n,o,r){if(1===r||t<o)switch(e){case Lt.Justify:return Lt.Top;case Lt.Distributed:return Lt.Center}if(t<n&&t>=o)switch(e){case Lt.Justify:case Lt.Distributed:return Lt.Top}return e}(e,n,o,r,i);case lC.CFIcon:return function(e){switch(e){case Lt.Justify:return Lt.Top;case Lt.Distributed:default:return Lt.Center}}(e)}}(e,t,n,o,r,i)}}function uC(e,t,n){return(e-t)/(n-1)}!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(lC||(lC={})),function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(sC||(sC={}));const dC=new Set(["aptos","aptos narrow","aptos display"]),hC=new Set,fC=new Set,gC=new Set,mC=new Set,CC={},pC=new Set;let wC;function SC(){return void 0!==document.fonts}function yC(){return document.fonts.ready}function RC(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function TC(e,t){e.style.fontFamily=t}function IC(e,t){const n=t.CachedFont?.FontName;return!!RC(t.CachedFont?.FontName)&&lh(yh(t,e),n)}function vC(e,t){if("function"!=typeof document.fonts.values)return!1;const n=document.fonts.values();let o=n.next();for(;!o.done;){if(o.value&&o.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case sC.Loaded:if("loaded"===o.value.status)return!0;break;case sC.Failed:if("error"===o.value.status)return!0}o=n.next()}return!1}function bC(e){if("function"!=typeof document.fonts.values)return;const t=document.fonts.values();let n=t.next();for(;!n.done;){if(n.value&&n.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())return n.value.status;n=t.next()}}function xC(e,t){switch(e){case 0:return!1;case 1:return 0===t;case 2:return 0===t||1===t;default:return!0}}function FC(e){switch(e){case sC.Loaded:return 0;case sC.Failed:return 1;case sC.Pending:return 2;default:return 6}}function DC(e){switch(e){case"loaded":return 0;case"error":return 1;case"loading":return 2;case"unloaded":return 3;default:return 6}}function MC(e,t=!0){return t&&(e=ih(e)),CC[e]}function AC(e,t,n=!0){n&&(e=ih(e)),void 0===wC&&(wC=Fn(Sn.AddFontFlickerTelemetry)),!!wC&&!(!Od()||"function"!=typeof md.isTrackingFontLoadTelemetry)&&md.isTrackingFontLoadTelemetry()&&CC[e]===sC.Pending&&t===sC.Loaded&&mC.add(e),CC[e]=t}function OC(e,t=!0){return t&&(e=ih(e)),null!==CC[e]&&void 0!==CC[e]}function BC(e){return pC.has(e)}function kC(e){pC.add(e)}function PC(e){return lh("11pt "+e,e)}function EC(e){SC()&&!OC(e)&&RC(e)&&PC(e)&&AC(e,sC.Loaded,!1)}let HC=!0;const LC={},NC={},WC={};let _C={},zC=0,GC=0,VC=0;function jC(e,t,n,o){if(!t)return 0;if(o){GC++;const o=e.font,r=ah[o],i=!!r&&MC(r)!==sC.Pending;let l=_C[o];if(l){const e=l[t];if(e)return e}else l={};const s=ZC(e,t,n);return i&&(l[t]=s,_C[o]=l,zC++),zC===Id(12,200)&&(Pn.sendTraceTag(544310413,En.msoulscat_ES_EWAJSGrid,d.Info,`measureTextWidth: Cache Reset, {"cacheHits"=${VC}, "totalCalls"=${GC}}`),zC=0,_C={},VC=0,GC=0),s}return ZC(e,t,n)}function UC(e,t,n,o,r){if(r)return Lt.Bottom;const i=t.CachedStyle,l=i.VerticalAlignment;return t.WrapText||t.Merge||i.VerticalText||!(n>o)||Hh(e,i,t.CachedFont)||aC(l)?l:Lt.Center}function $C(e,t,n,o){const r=vp(e,t,n,o),i=Rf(e,t)?r:0,l=gm(t),s=Cm(e,t)?l:0,a=e.IsRtl?ts:0,c=tf(e,t,e.BlockWidth)+i+s;let u=Zh(e,t,!1)-r-l;return u=Math.max(0,u),c+u/2-a}function qC(e){return e*Zl}function XC(e,t,n,o){return xp(t,e,QC(t,e,n,o))}function YC(e,t){return xp(e,t,0)}function JC(e,t,n,o,r,i,l){return{x:t+(e.IsRtl&&!l?0:i),y:n,width:Cu(o)-i,height:r}}function KC(e,t,n,o,r,i,l,s=0){const a=bp(t,r),c=Xh(e,t);let u=Bh;switch(c){case Ht.Automatic:case Ht.Left:return a+Ah(n,u)+l+s;case Ht.Right:return o&&(u=Oh),a+Ah(n,u)+l+s;case Ht.Center:case Ht.CenterAcrossSelection:return i?Ah(n,u):0;default:throw Error(`getTextHorizontalPosition: unsupported horizontalAlignment: ${c}`)}}function QC(e,t,n,o){let r=function(e,t,n,o){return function(e,t){const n=Qh(e,t),o=!!t.LinkedEntity?.IconWidth||!!t.RichValueIcon;if((n||o)&&!Hh(e,t.CachedStyle,t.CachedFont)){const n=Rf(e,t),o=Xh(e,t);switch(o){case Ht.Right:return!n;case Ht.Automatic:case Ht.Left:return n;case Ht.Center:case Ht.CenterAcrossSelection:return!0;default:throw Error(`unexpected context alignment ${o}`)}}return!1}(e,t)?vp(e,t,n,o):0}(e,t,n,o);return Cm(e,t)&&(r+=gm(t)),r+=rm(e,t)?nm(e,t,n,o):0,r}function ZC(e,t,n){if(!t)return 0;if(n&&HC){try{const n=t.replace(/^\s+|\s+$/g,""),o=e.measureText(n);if(!$s(o.actualBoundingBoxLeft)&&!$s(o.actualBoundingBoxRight)){const r=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),i=t.length-n.length;let l=0;return i>0&&(l=i*e.measureText(" ").width),r+l}}catch{}HC=!1}return Fp(e,t)}function ep(e,t,n){const o=function(e,t,n){return Xf(n,t,e).height}(e,t,n);return Math.ceil(o*dd)}function tp(e,t,n,o,r,i){const l=e.TextRuns,s=l?yp(t,e.TextRuns):e.CachedFont,a=l?s.Size:Fh(e),c=rf(t,e),u=of(t,e),d=np(t,e)?es:0;let h,f;if(Th(s))if(i)h=i;else{const e=Xf(s.FontName,a,t),n=dm(s,r);h=function(e,t,n){switch(t){case Xt.Subscript:return e.baseline/2+ip(n);case Xt.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(e,l?Xt.None:s.VerticalAlign||0,n)}else h=i||Xf(s.FontName,a,t).baseline;switch(r){case Lt.Bottom:case Lt.Justify:case Lt.Distributed:f=d+ap(u,h);break;case Lt.Top:f=sp(c,n,h);break;case Lt.Center:f=lp(u,o,n,h);break;default:throw Error(`getTextVerticalPosition: unsupported verticalAlignment: ${r}`)}return{absoluteY:f,lastTextLineAlphabeticBaselineOffset:h}}function np(e,t){return function(e,t){Ca(e,"cell","cellHasBottomDoubleBorder");const n=$o(e.Row+1,e.Col,t);if($s(n)||$s(n.CachedBorderStyle)||$s(n.CachedBorderStyle.Borders))return!1;const o=n.CachedBorderStyle.Borders;for(let e=0;e<o.length;e++){const t=o[e];if(t.BorderPosition===$t.Top&&t.BorderLineStyle===Ut.Double)return!0}return!1}(t,e)||function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size}(t)}function op(e,t,n,o,r,i){const l=ep(e,o,r),s=Xf(r,o,e).baseline;switch(i){case Lt.Center:case Lt.Justify:case Lt.Distributed:return lp(t,n,l,s);case Lt.Bottom:return ap(t,s);case Lt.Top:return sp(t-n,l,s)}}function rp(e,t,n,o){const r=Xf(n.FontName,o,e);return t-(r.middle-r.baseline)}function ip(e){return e?gd:0}function lp(e,t,n,o){return ap(e-(t+ts-n)/2,o)}function sp(e,t,n){return ap(e+t,n)}function ap(e,t){return e-hd-t}function cp(e){return Ah(e,kh)}function up(e,t,n){const o=Xh(e,t),r=XC(t,e,n.zoom,n.devicePixelRatio);switch(o){case Ht.Right:return nf(e,t,e.BlockWidth)-r;case Ht.Center:return $C(e,t,n.zoom,n.devicePixelRatio);case Ht.Automatic:case Ht.Left:return tf(e,t,e.BlockWidth)+r;case Ht.CenterAcrossSelection:return function(e,t,n,o){if(t.Spill){const r=vp(e,t,n,o),i=gm(t),l=e.IsRtl?ts:0,s=Cf(t,e)-r-i;return wf(t,e,r,i)+s/2-l}return $C(e,t,n,o)}(e,t,n.zoom,n.devicePixelRatio);default:throw Error(`getTextHorizontalPosition: unsupported horizontalAlignment: ${o}`)}}function dp(e,t,n){const{width:o,textRunsDrawingInformation:r}=fp(e,t,n);return n.CachedDrawingLayout.CellTextLayout.Width=o,n.CachedDrawingLayout.TextRunDrawingInformation=r,o}function hp(e,t,n){return fp(e,t,n).width}function fp(e,t,n){n.CachedDrawingLayout||(n.CachedDrawingLayout={CellTextLayout:{}}),n.CachedDisplayText||$a(t,n,n.Text);const o=!n.DisplayFormula&&n.TextRuns;if(n.CachedDrawingLayout.CellTextLayout.Width){if(o&&!n.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:n.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:n.CachedDrawingLayout.TextRunDrawingInformation}}const r=Ua(n,t);if(o){const o=wp(n),i=mp(e,n.TextRuns,lg()?r:n.Text,t,o);return{width:i.totalSize,textRunsDrawingInformation:i.textRunsDrawingInformation}}return{width:jC(e,r,!0,yo(Vt.TextWidthClientPhase1,t))}}function gp(e,t,n){const o=jC(e,n.CachedDisplayText,!1,yo(Vt.TextWidthClientPhase1,t));n.CachedDrawingLayout.CellTextLayout.Width=o}function mp(e,t,n,o,r){const i=e.textAlign;e.textAlign="left";const l=Cp(e,o,n,!1,r,t);return e.textAlign=i,l}function Cp(e,t,n,o,r,i){const l=[],s=function(e,t,n){return void 0!==e&&e.HasBidi?function(e,t){const n=[];for(let o=0;o<e.length;o++){const r=dg(e[o],Wa(o,e,t));n.push(...r)}return n}(t,n):t}(r,i,n);let a=0;const c=yo(Vt.TextWidthClientPhase1,t);for(let r=0;r<s.length;r++){const i=s[r],u={FontID:i.FontID||0,GlobalFontID:i.GlobalFontID,StartIndex:i.StartIndex},d=Wa(r,s,n),h=i.CachedFont,f=Rh(h,void 0,t);if(o){const e=ep(t,h.Size,h.FontName),n=pp(e,d);u.HeightPx=n,u.WidthPx=e,a+=n}else{e.font=f;const t=jC(e,d,r===s.length-1,c);u.Underline=h.Underline,u.WidthPx=t,a+=t}u.Strikethrough=h.StrikeThrough,u.Text=d,u.FontCss=f,l[r]={...u,...i}}return{textRunsDrawingInformation:l,totalSize:a}}function pp(e,t){return e*iC(t).length}function wp(e){Ca(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");const t=e.CachedDrawingLayout.BidiContext;if(t)return t;const n=cg(e.Text,e.CachedStyle.ReadingOrder||Et.Context);return e.CachedDrawingLayout.BidiContext=n,n}function Sp(e,t){Ca(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),Ca(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),Ca(e.CachedFont,"CachedFont","getTextLineHeight");const n=!!e.TextRuns;if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;let o;n&&(o=yp(t,e.TextRuns));const r=n?o.Size:Dh(e,e.CachedFont,!0),i=n?o.FontName:e.CachedFont.FontName;$s(i)&&$d(`\n    isRichText: ${n},\n    fontSize: ${r}\n    `);const l=ep(t,r,i);return e.CachedDrawingLayout.CellTextLayout.LineHeight=l,l}function yp(e,t){let n;for(let o=0;o<t.length;o++){const r=t[o],i=r.CachedFont&&r.CachedFont.GlobalId===r.GlobalFontID?r.CachedFont:co(r,e,void 0);(!n||n.Size<i.Size)&&(n=i)}if(!n)throw"getLargestFont: Largest fonts is supposed to be defined";return n}function Rp(e,t){const n=yp(e,t.TextRuns);return ep(e,n.Size,n.FontName)}function Tp(e,t){const n=yp(e,t.TextRuns);return Xf(n.FontName,n.Size,e)}function Ip(e,t,n,o){Ca(o,"numFmt","getNumFmtSeparatorWidth"),Ca(o.Separator,"separator","getNumFmtSeparatorWidth");const r=o.Separator,i=yh(n,t)+r,l=LC[i];if($s(l)||0===l){const t=Fp(e,r);return LC[i]=t,t}return LC[i]}function vp(e,t,n,o){return Ec(t.PreviewText)||(t.LinkedEntity?.IconWidth||t.RichValueIcon)&&(t.DisplayFormula||Fn(Sn.ToggleIconCSE)&&e.HideDataTypeIcons)?0:fm(e,t,Fh(t),n,o)}function bp(e,t){return Zs(e)?0:qC(t)}function xp(e,t,n){const o=t.CachedIndent||0,r=Fh(t),i=!$s(t.WrapText)||xh(t),l=Zs(t)?Sp(t,e)/2:0,s=function(e){return e.IsRow?Vs:0}(e);return KC(e,t,r,t.CachedFont.Italic,o,i,n,s)+l}function Fp(e,t){return e.measureText(t).width}function Dp(e,t,n,o){let r=NC[o];if(r||(NC[o]=Fp(e,"#"),r=NC[o]),n.CachedFont.Italic&&!WC[o]){const n=jC(e,"#",!0,yo(Vt.TextWidthClientPhase1,t));WC[o]=n-r}}function Mp(e,t,n,o,r){const i=n.CachedFont.Underline,l=n.CachedFont.StrikeThrough;(i||l)&&""!==n.CachedDisplayText&&(r.textWidth=dp(e,t,n),Ap(t,n,o,r,n.CachedFont))}function Ap(e,t,n,o,r,i){if(Ca(t,"cell","CacheUnderlineLayout"),Ca(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),Ca(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),Ca(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),r.Underline!==qt.None&&!Zs(t)){const l={underline:r.Underline},s=Pp(e,t,n,o,l,r,!1,i),a=t.CachedDrawingLayout.UnderlineRuns;if(s&&a.push(s),Ep(l)){const s=Pp(e,t,n,o,{underline:l.underline===qt.DoubleAccounting?qt.SingleAccounting:qt.Single},r,!0,i);s&&a.push(s)}}if(r.StrikeThrough){const i=Pp(e,t,n,o,{strikethrough:!0},r,!1,void 0);i&&t.CachedDrawingLayout.StrikethroughRuns.push(i)}}function Op(e,t,n){const o=n.CachedDrawingLayout.TextOrientationLayout,r=n.CachedDrawingLayout.UnderlineRuns,i=n.CachedDrawingLayout.StrikethroughRuns,l=t.highContrastScheme?xu(n,t.highContrastScheme):void 0,s=o?.clipRect;let a;s&&(a={x:s.x*t.scaleFactor,y:s.y*t.scaleFactor,width:s.width*t.scaleFactor,height:s.height*t.scaleFactor}),pu(e,a),Wh(e,o.TranslateX*t.scaleFactor,o.TranslateY*t.scaleFactor,o.Angle),e.beginPath(),Bp(e,void 0,void 0,l,r,i),e.stroke(),e.restore(),wu(e,a)}function Bp(e,t,n,o,r,i){for(const l of[r,i])if(l&&l.length>0){if(!t||!n){const r=l[0],i=o??r.Color;t=i,n=r.LineWidth,e.strokeStyle=i,e.lineWidth=r.LineWidth}for(let r=0;r<l.length;r++){const i=l[r],s=o??i.Color,a=t!==s,c=n!==i.LineWidth;(a||c)&&(t=s,n=i.LineWidth,e.stroke(),e.strokeStyle=s,e.lineWidth=i.LineWidth,e.beginPath()),Wp(e,i)}}return{lineColor:t,lineWidth:n}}function kp(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function Pp(e,t,n,o,r,i,l,s){const{scaleFactor:a}=n,c=l||o.partOfMixedUnderlineSequence&&r.underline===qt.Single,u=Dh(t,i,!1),d=function(e,t,n,o,r,i,l,s){const{textPositionX:a,textWidth:c}=o,{scaleFactor:u}=n;let d,h,f;if(r.underline===qt.SingleAccounting||r.underline===qt.DoubleAccounting){const o=XC(t,e,n.zoom,n.devicePixelRatio);d=tf(e,t,e.BlockWidth)+o,h=nf(e,t,e.BlockWidth)-o}else{const n=!$s(t.TextRuns)||$h(t);({startX:d,endX:h}=function(e,t,n,o,r){let i,l,s=r?Ht.Left:Xh(e,t);switch(Zs(t)&&(s=Ht.Center),s){case Ht.Automatic:case Ht.Left:i=n,l=n+o;break;case Ht.Right:i=n-o,l=n;break;case Ht.CenterAcrossSelection:case Ht.Center:i=n-o/2,l=n+o/2;break;default:i=n,l=n+o}return{startX:i,endX:l}}(e,t,a,c,n))}f=r.strikethrough?function(e,t,n,o,r){const{textPositionY:i}=n;Ca(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");const l=cp(r.Size);return rp(e,i,r,o)-l/2}(e,t,o,i,l):function(e,t,n,o){const{textPositionY:r}=t;Ca(e.CachedFont,"cell.CachedFont","calculateUnderlineY");return r+2*(o??cp(n))}(t,o,i,s),d=Math.round(d*u),h=Math.round(h*u),f=Math.round(f*u);return{startX:d,endX:h,Y:f}}(e,t,n,o,r,u,i,s),h=d.startX,f=d.endX;let g=d.Y;const m=function(e,t,n){const o=(n??cp(t))*e;return Math.max(Math.floor(o),1)}(a,u,s),C=Math.round(vs*m);Ep(r)&&(g+=C);const p=Hh(e,t.CachedStyle,t.CachedFont);return c&&(g=g-m*(p?Ls:Hs)+C),p?{StartX:h,EndX:f,Y:g,LineWidth:m,Color:i.Color}:function(e,t,n,o,r,i,l,s,a){const{clipRect:c}=o,{scaleFactor:u}=n,d=function(e,t,n,o,r,i,l,s){return function(e,t,n,o){const r=gf(e,t,!1);return o<=r&&o+n<=r}(e,t,r,i)||Lp(e,t,r,i)||function(e,t,n,o){const{clipRect:r}=e,{scaleFactor:i}=t,l=r?(r.x+r.width)*i:0;let s=!1;return r&&(s=n>=l&&o>=l),s}(o,n,l,s)||function(e,t,n,o){const{clipRect:r}=e,{scaleFactor:i}=t,l=r?r.x*i:0;let s=!1;return r&&(s=n<=l&&o<=l),s}(o,n,l,s)}(e,t,n,o,r,i,l,s);if(!d||o.containSubscript&&Lp(e,t,r,i)){if(c){const e=Math.round(c.x*u),t=Np(l,s,e,Math.round(c.width*u)+e);l=t.start,s=t.end}if(function(e,t,n,o){const r=o+n,i=gf(e,t,!1)+ts,l=df(e,t)-ts;return o<=i||r>=l}(e,t,r,i)&&(!o.containSubscript||!Lp(e,t,r,i))){const n=Np(i,i+r,gf(e,t,!1),df(e,t)-ts);i=n.start,r=n.end-i}return{StartX:l,EndX:s,Y:i,LineWidth:r,Color:a.Color}}}(e,t,n,o,m,g,h,f,i)}function Ep(e){return e.underline===qt.Double||e.underline===qt.DoubleAccounting}function Hp(e,t){return e[t].StartX===e[t+1].StartX}function Lp(e,t,n,o){const r=df(e,t);return o>=r&&o+n>=r}function Np(e,t,n,o){const r=Math.min(e,t),i=Math.max(e,t),l=Math.min(n,o),s=Math.max(n,o);return{start:Math.max(r,l),end:Math.min(i,s)}}function Wp(e,t){if(0===t.LineWidth)return;const n=t.Y+Oa(t.LineWidth);!function(e,t,n,o){e.moveTo(t,o),e.lineTo(n,o)}(e,t.StartX,t.EndX,n)}var _p,zp;!function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(_p||(_p={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(zp||(zp={}));const Gp="textLineId",Vp="textTokenId";function jp(e,t,n,o=0){if(e.isProcessingLastLine&&e.breakType===_p.Justify){const n=function(e,t,n=0){let o="",r=0;for(let n=0;n<e.length;n++)o+=e[n].text,r+=e[n].width,n!==e.length-1&&(o+=ds,r+=t);return{Start:{Offset:n,Text:o,Width:r},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,o);return e.lineDirection===zp.Vertical&&(n.Start.Offset=e.maxWidth-n.Start.Width),n}if(e.lineDirection===zp.Vertical&&function(e){if(e.length>=2){const t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){let r=o,i=0,l=t[i];const s={Start:{Offset:r,Text:l.text,Width:l.width},SpaceWidthBetweenWords:n};let a=Math.floor(n/e.singleSpaceWidth);a<1&&(a=1);const c=function(e,t,n,o){return e.lineDirection===zp.Vertical&&o>3&&n-t*e.singleSpaceWidth>=0?Math.floor((n-t*e.singleSpaceWidth)*(o-3)/2):0}(e,a,n,t.length);r+=l.width+n+c,i++,(void 0===a||isNaN(a)||a===1/0)&&($d(`getJustifyDistributedLine: Invalid count variable. numberOfSpaces: ${a}, spaceWidthBetweenTokens: ${n}, singleSpaceWidth: ${e.singleSpaceWidth} `),a=1);let u="";const d=r;let h=0;for(;i<t.length-1;i++)l=t[i],u+=l.text,h+=l.width,i!==t.length-2&&(u+=ds.repeat(a),h+=e.singleSpaceWidth*a);if(""!==u&&(s.Middle={Offset:d,Text:u,Width:h}),t.length>1){const e=t[t.length-1],o=$s(s.Middle)?r:d+h+n+c;s.End={Offset:o,Text:e.text,Width:e.width}}return s}}function Up(e,t){const n=e;if(n.length<=1)return 0;if(t.breakType===_p.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;let o=0;for(let e=0;e<n.length;e++)o+=n[e].width;const r=(t.maxWidth-o)/(n.length-1);return r<t.singleSpaceWidth?t.singleSpaceWidth:r}function $p(e,t,n,o){if(!n.HasRtl||n.HasLtr)!function(e,t,n,o){const r=Fu(n,o);for(let o=0;o<e.textLines.length;o++){const i=e.textLines[o],l=e.tokensPerLine[o],s=cg(i.text,t);if(n.HasBidi)if(s.HasRtl&&!s.HasLtr)l.tokens.reverse();else{const e=document.createElement("div");e.setAttribute(Gp,o.toString());for(let t=0;t<l.tokens.length;t++){const n=l.tokens[t].text,o=document.createElement("span");o.innerText=n,o.setAttribute(Vp,t.toString()),e.appendChild(o)}r.appendChild(e)}}document.body.appendChild(r);for(let t=0;t<r.children.length;t++){const n=r.children[t],o=n.getAttribute(Gp);if(!o)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");const i=parseInt(o,10),l=e.tokensPerLine[i].tokens;for(let e=0;e<n.children.length;e++){const t=n.children[e],o=t.getAttribute(Vp);if(!o)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");const r=t.getBoundingClientRect().left;l[parseInt(o,10)].OffsetX=r}l.sort(((e,t)=>e.OffsetX-t.OffsetX))}document.body.removeChild(r)}(e,t,n,o);else for(let t=0;t<e.tokensPerLine.length;t++)e.tokensPerLine[t].tokens.reverse()}function qp(e,t,n){return e?t[t.length-1-n]:t[n]}function Xp(e,t){return e.isProcessingLastLine&&e.breakType===_p.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function Yp(e,t,n,o,r,i,l){const s=[];let a=0,c=!1;for(let u=0;u<n.length;u++){const d=n[u];if(Kp(d,o,r))if(Qp(d,o,r))s.push(d),a+=d.width;else{const n=Zp(e,t,d,o,r,i,l);c=i?c||!d.text.startsWith(n.text):ew(d.text)?!d.text.startsWith(n.text):!d.text.endsWith(n.text),s.push(n),a+=n.width}}return{currentTextTokens:s,currentTokenWidthPx:a,combinePartialTokens:c}}function Jp(e){if(e.Start&&e.End){const t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords};let n=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,n=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=n,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),n=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:n+t.SpaceWidthBetweenWords},t}return e}function Kp(e,t,n){return e.start<n&&e.start+e.text.length>t}function Qp(e,t,n){return t<=e.start&&e.start+e.text.length<=n}function Zp(e,t,n,o,r,i,l){const s=n.start<o?o-n.start:0,a=s+r-(o>n.start?o:n.start),c=n.text.substring(s,a);return{text:c,start:n.start>o?n.start:o,width:i?pp(l,c):jC(e,c,!0,yo(Vt.TextWidthClientPhase1,t)),containsThaiCharacters:n.containsThaiCharacters}}function ew(e){return!!e&&cg(e,Et.LeftToRight).HasRtl}function tw(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function nw(e,t,n){return e===zp.Vertical?n:t.measureText(" ").width}function ow(e){return qC(e)}function rw(e,t,n,o,r,i,l,s,a){iw(e,t,n,o,i,r,void 0,l,!0===n.CachedFont.StrikeThrough,n.CachedFont,s,a)}function iw(e,t,n,o,r,i,l,s,a,c,u,d){const h=e.textAlign;"center"!==h&&(e.textAlign="center");const{graphemes:f,maxFontHeight:g,adjustedOffsetY:m}=aw(t,n,o,l,r,d);!function(e,t,n,o,r,i,l,s,a,c,u){let d=i;for(let i=o.length-1;i>=0;i--){const h=o[i];" "!==h&&(e.fillText(h,r,d),lw(e,t,n,r,d,h,s,a,c,u)),d-=l}}(e,t,n,f,i,m,g,s,a,c,u),"center"!==h&&(e.textAlign=h)}function lw(e,t,n,o,r,i,l,s,a,c){s&&Zs(n)&&Ap(t,n,l,{textPositionX:o,textPositionY:r,textWidth:jC(e,i,!0,yo(Vt.TextWidthClientPhase1,t)),clipRect:c},a)}function sw(e,t,n,o,r){const i=function(e,t,n,o){const r=ow(t);switch(e){case Lt.Top:return n+o+r;case Lt.Center:return n+o/2;case Lt.Bottom:default:return n-r}}(e,t,n,o);return r&&e===Lt.Distributed&&r<=0?i-r:i}function aw(e,t,n,o,r,i){const l=iC(n),s=o||Sp(t,e),a=function(e,t){return(e.length-1)*t}(l,s);return{graphemes:l,maxFontHeight:s,adjustedOffsetY:sw(t.CachedStyle.VerticalAlignment,t.CachedStyle?.Indentation||0,r,a,i),textHeight:a}}function cw(e,t,n,o,r,i,l,s,a,c){if(Ca(o,"cell","fillRichTextFormat"),Ca(n,"model","fillRichTextFormat"),Ca(r,"formattedText","fillRichTextFormat"),Ca(r.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0===r.Text.length)return;const u=r.TextRuns;Ca(u[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");const d=function(e,t){return!!t&&(ea(e)?!(t.breakType===_p.Justify&&t.isProcessingLastLine):$h(e))}(o,c),{totalTextRunHeight:h,totalTextRunWidth:f,largestFont:g,preparedRuns:m}=function(e,t,n,o,r,i,l,s,a){const c=wp(n),u=Zs(n),d=function(e,t,n,o,r){let i,l;const s=t.Fonts;if(n.WrapText){const s=mp(e,o,r,t,wp(n));l=s.totalSize,i=s.textRunsDrawingInformation}else l=dp(e,t,n),i=n.CachedDrawingLayout.TextRunDrawingInformation;if(!i||!o)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";return{totalTextRunWidth:l,largestFont:Iw(i,s),preparedRuns:i}}(e,t,n,r,i);let h=0,f=d.totalTextRunWidth;const g=d.largestFont,m=d.preparedRuns;return!u&&c.HasRtl&&Gd(Vd.ReorderBidiTextRuns,(()=>{const e=!!(lg()&&(void 0===rg&&(rg=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.BidiJsTextOrderingTest",!1)),rg)&&n.CachedStyle?.BackgroundColor);ug(m,i,c,f,e)}),!0),u&&(h=function(e,t){let n=0;for(let o=0;o<t.length;o++){const r=t[o],i=r.CachedFont,l=ep(e,i?.Size,i?.FontName),s=pp(l,r.Text);r.MaxGlyphHeightPx=l,r.HeightPx=s,n+=s}return n}(t,m)),n.CachedStyle.ShrinkToFit&&(u?h=function(e,t,n,o){const r=ef(e,t,!1);return o<r?o:function(e,t,n,o){let r=0;for(let n=0;n<t.length;n++){const i=t[n],l=i.CachedFont;gw(e,i,Math.floor(l.Size*o)),r+=i.HeightPx}for(;r<n;){r=0;for(let n=0;n<t.length;n++){const o=t[n];o.ShrunkSize<ld&&gw(e,o,o.ShrunkSize+1),r+=o.HeightPx}}for(;r>n;){r=0;for(let n=0;n<t.length;n++){const o=t[n];o.ShrunkSize>id&&gw(e,o,o.ShrunkSize-1),r+=o.HeightPx}}return r}(e,n,r,r/o)}(t,n,m,h):f=function(e,t,n,o,r){const i=Zh(e,t,!1),l=t.CachedStyle.Indentation||0,s=rm(e,t)?nm(e,t,n.zoom,n.devicePixelRatio):0,a=KC(e,t,o[0].CachedFont.Size,t.CachedFont.Italic,l||0,!0,s),c=gu(i,a,vp(e,t,n.zoom,n.devicePixelRatio),gm(t),0);if(r<c)return r;const u=c/(r+a);let d=0;for(let t=0;t<o.length;t++){const n=o[t];fw(n,u,e),d+=n.WidthPx}return d}(t,n,o,m,f)),function(e){let t=0;for(;t<e.length;)if(e[t].Underline===qt.None)t++;else{const{maxFontSize:n,sequenceEndRunIndex:o,hasMixedUnderlineTypes:r}=mw(e,t),i=cp(n);for(;t<=o;t++)e[t].UnderlineWidth=i,e[t].HasMixedUnderline=r}}(m),!l||$s(s)||$s(a)||function(e,t,n,o,r,i){if(0===r.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0===o.length)return;i&&(n.maxWidth=n.maxWidth-2*ts);const l=Xp(n,o);if(1===r.length){const t=e.font;let s=t;const a=r[0],c=a.FontCss;s!==c&&(e.font=c,s=c);const u=tw(n);u.singleSpaceWidth=nw(n.lineDirection,e,a.MaxGlyphHeightPx);let d=jp(u,o,Up(o,n),l);i||!ew(a.Text)||$s(d)||(d=Jp(d)),a.JustifyDistributedLine=d,a.WidthPx=function(e,t){let n=0;return t&&e.breakType===_p.Justify?(n+=t?.Start.Width,t?.Middle&&(n+=t?.Middle.Width),t?.End&&(n+=t?.End.Width),n):e.maxWidth}(n,d),s!==t&&(e.font=t)}else!function(e,t,n,o,r,i,l=0){const s=Up(n,o),a=function(e){let t=e[0].start;for(let n=1;n<e.length;n++)e[n].start<t&&(t=e[n].start);return t}(n),c=e.font;let u=c,d=l;for(let l=0;l<r.length;l++){const c=qp(i,r,l),h=c.FontCss;u!==h&&(e.font=h,u=h);const f=tw(o);f.singleSpaceWidth=nw(o.lineDirection,e,c.MaxGlyphHeightPx);const g=c.StartIndex+a,m=g+(void 0!==c.Text?c.Text.length:0),{currentTextTokens:C,currentTokenWidthPx:p,combinePartialTokens:w}=Yp(e,t,n,g,m,i,c.MaxGlyphHeightPx);if(0!==C.length){let e=jp(f,C,s,d);i||$s(e)||ew(c.Text)&&(e=Jp(e)),c.JustifyDistributedLine=e,i&&o.lineDirection===zp.Vertical?c.HeightPx=p+s*(C.length-1):c.WidthPx=p+s*(C.length-1),w||c.IsSpecialCharTextRun?d+=p+s*(C.length-1):d+=p+s*C.length}}u!==c&&(e.font=c)}(e,t,o,n,r,i,l)}(e,t,a,s,m,u),{totalTextRunHeight:h,totalTextRunWidth:f,largestFont:g,preparedRuns:m}}(e,n,o,t,u,r.Text,d,a,c);Ca(qo(n,o),"cellStyle","fillRichTextFormat");const C=c?.maxWidth;!function(e,t,n,o,r,i,l,s,a,c,u,d,h){const f=e.textAlign,g=e.textBaseline,m=e.font,C=e.fillStyle,p=Zs(o);let w=s;p&&(w=function(e,t,n,o,r,i,l){if(!i&&t.CachedStyle?.VerticalAlignment===Lt.Justify){const r=Iw(n,e.Fonts),i=Xf(r.FontName,r.Size,e).baseline;return of(e,t)-hd-i-(l-o)}return r}(n,o,a,c,w,u,h)),w=function(e,t,n,o,r,i,l){return t?function(e,t,n,o){const r=e.CachedStyle.VerticalAlignment,i=o[o.length-1].HeightPx||0;switch(r){case Lt.Top:return t+n-i;case Lt.Justify:case Lt.Distributed:case Lt.Bottom:return t;case Lt.Center:return t+(n-i)/2}}(n,o,r,i):function(e,t,n,o){const r=n.CachedStyle.VerticalAlignment,i=ep(e,t.Size,t.FontName),l=Xf(t.FontName,t.Size,e).baseline;Ca(l,"textBaselineAdjustY","adjustYForVerticalAlignment");const s=o-l;return r===Lt.Center?s+(i-l)/2:s}(e,l,n,o)}(n,p,o,w,c,a,i);let S=p?l:pw(n,o,l,u,r,h),y=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=xu(o,t.highContrastScheme));for(let r=0;r<a.length;r++){const i=qp(p,a,r);Ca(i.CachedFont,"run.CachedFont","drawTextRuns");const l=i.CachedFont,c=l.VerticalAlign;let f=0,g=!1;p||o.WrapText||({subSuperOffsetY:f,isFontVerticalAlignment:g,hasVerticalAlignedFont:y}=Sw(o,c,l,s,Xf(l.FontName,l.Size,n),y)),e.font=i.FontCss,t.highContrastScheme||(e.fillStyle=i.CachedFont.Color),({offsetX:S,offsetY:w}=yw(e,n,o,t,S,ww(s,f,w,p,g),i,a,r,d,c,p,u,h))}y&&!$s(o.CachedDrawingLayout?.UnderlineRuns)&&function(e,t,n){if($s(n)||n.length<=0)return;const o=function(e,t,n){let o=-1,r=-1,i=0,l=!1;for(let e=0;e<n.length;e++)if(!(e>0&&Hp(n,e-1)))if(e<n.length-1&&Hp(n,e)){const{top:t,bottom:s}=kp([n[e],n[e+1]]);t.Y>o&&(o=t.Y),s.Y>r&&(r=s.Y,i=Math.max(s.LineWidth,1),l=!0)}else n[e].Y>o&&(o=n[e].Y,l||(i=Math.max(n[e].LineWidth,1)));return Lp(e,t,i,r)&&(r=df(e,t)-i,o=r-2*i),o-r<2*i&&(o=r-2*i),{closestToBottomUnderline:o,closestToBottomDoubleUnderline:r,closestToBottomUnderlineWidth:i}}(e,t,n);for(let e=0;e<n.length;e++)if(!(e>0&&n[e].StartX===n[e-1].StartX)){if(e<n.length-1&&n[e].StartX===n[e+1].StartX){const{top:t,bottom:r}=kp([n[e],n[e+1]]);t.Y=o.closestToBottomUnderline,r.Y=o.closestToBottomDoubleUnderline,n[e+1].LineWidth=o.closestToBottomUnderlineWidth}else n[e].Y=o.closestToBottomUnderline;n[e].LineWidth=o.closestToBottomUnderlineWidth}}(n,o,o.CachedDrawingLayout.UnderlineRuns),e.textAlign=f,e.textBaseline=g,e.font=m,e.fillStyle=C}(e,t,n,o,f,g,i,l,m,h,d,s,C)}function uw(e,t,n){if(Ca(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return as;const o=e.Text.substring(t,n);if(0===o.length)return{Text:o,Fonts:e.Fonts,TextRuns:[]};const r=e.TextRuns;if(Ca(r,"formattedText.runs","substringFormattedText"),0===r.length)throw Error("Invalid param: formattedText runs.length === 0");Xa(r,e.Text);const i=e.Text.length,l={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:i,text:e.Text},s=hw(t,r,l),a=n&&n<e.Text.length?hw(n-1,r,l):r.length-1,c=[],u=r[s];c.push({StartIndex:0,FontID:u.FontID||0,GlobalFontID:u.GlobalFontID||0,CachedFont:u.CachedFont});for(let e=s+1;e<=a;e++){const n=r[e],o=n.StartIndex-t;c.push({StartIndex:o,FontID:n.FontID||0,GlobalFontID:n.GlobalFontID||0,CachedFont:n.CachedFont})}return{Text:o,Fonts:e.Fonts,TextRuns:c}}function dw(e,t){return e>=t.StartIndex&&e<t.EndIndex}function hw(e,t,n){const o=[];for(let n=0;n<t.length;n++){const r=t[n];if(dw(e,r))return n;r&&o.push({index:n,startIndex:r.StartIndex,endIndex:r.EndIndex})}const{text:r,formattedTextLength:i,isCarriageReturnExists:l}=n,s=iC(r);throw Error(`Failed to find text run index for textOffsetIndex: ${e}, runs.length: ${t.length}, runsIndices: ${JSON.stringify(o)}, formattedTextLength: ${i}, isCarriageReturnExists:${l}, isGraphemeExists: ${r?.length!==s.length} `)}function fw(e,t,n){const o=e.CachedFont;e.ShrunkSize=o.Size*t,e.FontCss=Rh(o,e.ShrunkSize,n),e.WidthPx=e.WidthPx*t}function gw(e,t,n){const o=t.CachedFont;t.ShrunkSize=n;const r=ep(e,t.ShrunkSize,o?.FontName),i=pp(r,t.Text);t.FontCss=Rh(o,t.ShrunkSize,e),t.MaxGlyphHeightPx=r,t.HeightPx=i}function mw(e,t){let n=0,o=t,r=!1,i=!1;for(let l=t;l<e.length;l++){const t=e[l];if(t.Underline===qt.None)break;t.Underline===qt.Single?r=!0:t.Underline===qt.Double&&(i=!0);const s=t.CachedFont;n=Math.max(n,t.ShrunkSize||s.Size),o=l}return{maxFontSize:n,sequenceEndRunIndex:o,hasMixedUnderlineTypes:r&&i}}function Cw(e,t,n){return mp(e,t.TextRuns,t.Text,n).totalSize}function pw(e,t,n,o,r,i){return Yh(e,t,n,o&&!$s(i)?i:r)}function ww(e,t,n,o,r){return o?n:r?t:e}function Sw(e,t,n,o,r,i){let l=i,s=0,a=!1;return a=t===Xt.Subscript||t===Xt.Superscript,a&&(s=function(e,t,n,o,r,i){return i?function(e,t,n,o){switch(e){case Xt.Subscript:const r=ip(o);return n+t.baseline/2-r;case Xt.Superscript:return n-2*(t.middle-t.baseline);default:throw Error(`getYPositionForFontVerticalAlignmentRtf: Font vertical alignment ${e} is unexpected here`)}}(t,r,o,dm(n,e.CachedStyle.VerticalAlignment)):0}(e,t||Xt.None,n,o,r,a),l=!0),{subSuperOffsetY:s,hasVerticalAlignedFont:l,isFontVerticalAlignment:a}}function yw(e,t,n,o,r,i,l,s,a,c,u,d,h,f){let g=i,m=r;return h?function(e,t,n,o,r,i,l,s,a,c,u){if(!n.JustifyDistributedLine)return;let d=t+(a?0:n.JustifyDistributedLine.Start.Offset);const h=d,f=!0===n.Strikethrough;Rw(e,r,i,n.JustifyDistributedLine.Start,t,o,a,n.MaxGlyphHeightPx,l,f,s,c,u),d=t+(a?0:n.JustifyDistributedLine.Start.Offset+n.JustifyDistributedLine.Start.Width),n.JustifyDistributedLine?.Middle&&(Rw(e,r,i,n.JustifyDistributedLine.Middle,t,o,a,n.MaxGlyphHeightPx,l,f,s,c,u),d=t+(a?0:n.JustifyDistributedLine.Middle.Offset+n.JustifyDistributedLine.Middle.Width)),n.JustifyDistributedLine?.End&&(Rw(e,r,i,n.JustifyDistributedLine.End,t,o,a,n.MaxGlyphHeightPx,l,f,s,c,u),d=t+(a?0:n.JustifyDistributedLine.End.Offset+n.JustifyDistributedLine.End.Width)),a||n.Underline===qt.None&&!n.Strikethrough||Ap(r,i,l,{clipRect:c,textPositionX:h,textPositionY:o,textWidth:d-h,partOfMixedUnderlineSequence:n.HasMixedUnderline},s,n.UnderlineWidth)}(e,r,l,i,t,n,o,l.CachedFont,d,c,f):(Tw(e,t,n,l.Text,r,i,d,l.MaxGlyphHeightPx,o,!0===l.Strikethrough,l.CachedFont,c),d||l.Underline===qt.None&&!l.Strikethrough||Ap(t,n,o,{clipRect:c,textPositionX:r,textPositionY:i,textWidth:l.WidthPx,containSubscript:u===Xt.Subscript,partOfMixedUnderlineSequence:l.HasMixedUnderline},l.CachedFont,l.UnderlineWidth),d?g=function(e,t,n,o,r){const i=r+1<o.length?qp(!0,o,r+1).HeightPx:0;switch(e){case Lt.Top:return t-i;case Lt.Center:return t-(n.HeightPx+i)/2;case Lt.Bottom:case Lt.Justify:case Lt.Distributed:return t-n.HeightPx}}(n.CachedStyle.VerticalAlignment,i,l,s,a):m+=l.WidthPx),{offsetX:m,offsetY:g}}function Rw(e,t,n,o,r,i,l,s,a,c,u,d,h){let f=r,g=i;l?g-=o.Offset:f+=o.Offset,Tw(e,t,n,o.Text,f,g,l,s,a,c,u,d,h)}function Tw(e,t,n,o,r,i,l,s,a,c,u,d,h){l?function(e,t,n,o,r,i,l,s,a,c,u,d){iw(e,t,n,o,i,r,l,s,a,c,u,d)}(e,t,n,o,r,i,s,a,c,u,d,h):e.fillText(o,r,i)}function Iw(e,t){let n=0,o=t[0];for(let t=0;t<e.length;t++){const r=e[t].CachedFont;n=Math.max(n,r.Size),o.Size<n&&(o=r)}return o}function vw(e,t,n,o,r,i,l,s){r>0&&(e.fillText(t,n,o,r),Mp(e,l,i,s,{textPositionX:n,textPositionY:o}))}function bw(e,t,n,o,r,i,l,s,a,c){if(pu(e,i),!c&&Zs(l))rw(e,s,l,n,o,r,t,i);else if(!c||a||l.DisplayFormula||Ec(l.PreviewText)){const a=!$s(s.IsRow);Eu()&&!a?function(e,t,n,o,r,i,l,s){let a=o,c=!0,u=-1;let h;Gd(Vd.DrawSpillCellClippedDurationMs,(()=>{h=function(e,t,n,o,r){const i=e.Spill?.LastVisibleCharIndexHint,l=!!n,s=e.CachedStyle?.HorizontalAlignment===Ht.CenterAcrossSelection||e.CachedStyle?.HorizontalAlignment===Ht.Center;if(void 0===i||(Fn(Sn.AvoidLastVisibleCharIndexHintZero)?i<=0:i<0))return{lastVisibleCharIndexHint:i,hasRichText:l,isHorizontalAlignmentCenter:s,canOptimize:!1,isDisplayTextWithFactorLongerThanFullText:!1,hasCustomFont:!1,hasRichValueIcon:!1,hasConditionalFormatting:!1,isRotatedTextDrawingNeeded:!1,hadBidiText:!1,hasSpecialChar:!1};const a=i+5>=o.length,c=e.CachedFont?.FontName,u=!(c&&mh(c)),d=!!e.RichValueIcon,h=!!e.CondFormat,f=Hh(t,e.CachedStyle,e.CachedFont),g=e.CachedDrawingLayout?.BidiContext?.HasBidi??!1,m=Array.from(o).length!==o.length;return{lastVisibleCharIndexHint:i,canOptimize:!(a||n||u||d||h||f||g||m||s),isDisplayTextWithFactorLongerThanFullText:a,hasCustomFont:u,hasRichValueIcon:d,hasConditionalFormatting:h,isRotatedTextDrawingNeeded:f,hadBidiText:g,hasSpecialChar:m,hasRichText:l,isHorizontalAlignmentCenter:s}}(e,t,s,o),h.canOptimize&&(a=function(e,t,n){return[...e].slice(0,n).join("")}(o,0,Math.min(e.Spill.LastVisibleCharIndexHint+5,o.length)),u=jC(n,a,!1,!1),u>l.width&&(o=a,c=!1)),n.fillText(o,r,i)})),function(e,t,n,o,r,i,l,s){const a={cell:{col:e.Col,row:e.Row},optimization:{canOptimize:s.canOptimize,fallback:i,lastVisibleCharIndexHint:void 0!==e.Spill?.LastVisibleCharIndexHint?e.Spill?.LastVisibleCharIndexHint:null,hitFactor:5},measurements:{clipRectWidth:o.width,substringTextWidth:r,textLengthDelta:t.length-n.length,fontSize:e.CachedFont?.Size},blockingReasons:{richText:s.hasRichText,rotatedText:s.isRotatedTextDrawingNeeded,customFont:s.hasCustomFont,richValueIcon:s.hasRichValueIcon,conditionalFormatting:s.hasConditionalFormatting,bidiText:s.hadBidiText,specialCharacters:s.hasSpecialChar,isHorizontalAlignmentCenter:s.isHorizontalAlignmentCenter,invalidLastVisibleCharIndexHint:void 0===s.lastVisibleCharIndexHint||s.lastVisibleCharIndexHint<0,displayTextWithFactorLongerThanFullText:s.isDisplayTextWithFactorLongerThanFullText}};Pn.sendTraceTag(504707073,En.msoulscat_ES_EWAJSGrid,d.Info,JSON.stringify(a))}(e,o,a,l,u,c,0,h)}(l,s,e,n,o,r,i,c):!Fn(Sn.CompareDwriteHintDrawingTime)||Eu()||a?e.fillText(n,o,r):Gd(Vd.DrawSpillCellClippedDurationMs,(()=>{e.fillText(n,o,r)})),Mp(e,s,l,t,{textPositionX:o,textPositionY:r,clipRect:i})}else cw(e,t,s,l,c,o,r,i);wu(e,i)}var xw;!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(xw||(xw={}));const Fw="1".charCodeAt(0);function Dw(e,t,n,o,r,i,l,s){return l?o?function(e,t,n,o,r,i,l){return r?{textRunsDrawingInformation:[],totalSize:i*n.length}:Cp(e,o,n,!0,void 0,t)}(e,o.TextRuns,o.Text,t,i,r).totalSize:pp(s,n):o?Cw(e,o,t):function(e,t,n,o,r){return r?o*n.length:yo(Vt.TextWidthClientPhase1,t)?jC(e,n,!1,!0):e.measureText(n).width}(e,t,n,r,i)}function Mw(e){switch(e){case hs:case ds:return xw.Space;case fs:return xw.HardBreak;case gs:return xw.HardBreakCRLF}return xw.Word}function Aw(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?gs:e[t]}function Ow(e,t){return t===xw.HardBreakCRLF?e+2:e+1}function Bw(e,t,n){return!(!t||n!==xw.Word||e>t.length-1)&&t.charCodeAt(e)===Fw}class kw{get width(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=Cw(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth}get value(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue}get formattedValue(){return this.wordFormattedText&&(this.cachedFormattedValue=uw(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue}constructor(e,t,n,o,r){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=n,this.wordFormattedText=r,this.model=o}}class Pw{item(e){let t=this.cachedItems[e];if(!t){const n=ku(this.word.charCodeAt(e),this.word.charCodeAt(e+1))?e+2:e+1;t=new kw(this.ctx,this.word,n,this.model,this.formattedText),this.cachedItems[e]=t}return t}constructor(e,t,n,o){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=o,this.model=n}}function Ew(e,t,n,o,r){if(0===t.length)return;const i=new Pw(e,t,o,r),l={width:n,value:"IGNORED"};let s=xa(i,0,t.length,l,((e,t)=>e.width-t.width));s<0&&(s=~s,0!==s&&(s-=1));const a=i.item(s);return{width:a.width,value:a.value,remaining:t.substring(a.value.length),formattedRemaining:r?uw(r,a.value.length):void 0}}function Hw(e,t,n,o,r,i,l,s,a){if(Ca(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};const c=Zs(l),u=c?Sp(l,i):0,d=function(e,t,n,o,r,i,l,s){const a=[];let c=0;const u=n,d=s?.BreakOp;for(;c<t.length;){const n=Mw(Aw(t,c));let s=Ow(c,n),h=Aw(t,s),f=Mw(h);for(;s<t.length&&n===f&&!Bw(s,d,n);)s=Ow(s,n),h=Aw(t,s),f=Mw(h);const g=s-c,m=t.substring(c,s),C=l?uw(l,c,s):void 0;let p=0;switch(n){case xw.Word:case xw.Space:p=Dw(e,o,m,C,u,n===xw.Space,r,i);break;case xw.HardBreak:case xw.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}a.push({start:c,len:g,value:m,type:n,width:p}),c=s}return a}(e,t,r,i,c,u,s,a),h={text:t,tokens:d,maxWidth:n,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(f=o,f===_p.Justify||f===_p.Distributed),containsThaiCharacters:!1,isVerticalText:c,textLineHeight:u};var f;for(let t=0;t<d.length;t++){const o=d[t];if(Vw(d,t),Qw(o))Ww(h,o,t);else if(Jw(o,n)){if(o.type===xw.Space&&!jw(d,t)){zw(h,o,t);continue}Lw(h,o)}else Nw(h,o,t,e,i,s)}if(void 0!==h.lastFittingToken&&function(e){Zw(e),e.isSingleCharTooWide=Yw(e.text,e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(h),h.isBreakTypeJustifyOrDistributed&&h.textLines.length!==h.tokensPerLine.length)throw new Error(`breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = ${h.tokensPerLine.length}, textLineLength = ${h.textLines.length}, MaxWidth = ${n}, Text = ${Mi(h.text)}`);return h.isBreakTypeJustifyOrDistributed&&a?.BreakOp&&h.containsThaiCharacters&&(h.tokensPerLine=function(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n];o.containsThaiCharacters?t.push(eS(o.tokens)):t.push(o)}return t}(h.tokensPerLine)),{textLines:h.textLines,tokensPerLine:h.tokensPerLine,requireClipping:h.isSingleCharTooWide}}function Lw(e,t){e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth&&(Zw(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width),e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function Nw(e,t,n,o,r,i){if(t.type===xw.Space)return void Gw(e,t,n);void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),Zw(e));const l=i?uw(i,t.start,t.start+t.len):void 0,s=e.isVerticalText?function(e,t,n){const o=[],r=iC(e);let i=n,l=r[0];for(let e=1;e<r.length;e++)i+n>t?(o.push({value:l,size:i}),i=n,l=r[e]):(i+=n,l+=r[e]);return l&&i>0&&o.push({value:l,size:i}),o}(t.value,e.maxWidth,e.textLineHeight):function(e,t,n,o,r){const i=[];let l=Ew(e,t,n,o,r);for(;l;)i.push({value:l.value,size:l.width}),l=Ew(e,l.remaining,n,o,l.formattedRemaining);return i}(o,t.value,e.maxWidth,r,l);let a=t.start;for(let t=0;t<s.length-1;t++){const n=s[t],o={text:n.value,width:n.size,underlineWidth:n.size,startIndex:a,endIndex:a+n.value.length};if(a+=n.value.length,e.textLines.push(o),e.isBreakTypeJustifyOrDistributed){const t=Lc(n.value);e.tokensPerLine.push({tokens:[{text:n.value,width:n.size,start:a,containsThaiCharacters:t}],containsThaiCharacters:t}),tS(e,t)}e.isSingleCharTooWide=Yw(o.text,o.width,o.text.length,e.maxWidth,e.isSingleCharTooWide)}const c=function(e,t){const n=e[e.length-1],o=t.start+t.len-n.value.length,r=n.size;return{start:o,len:n.value.length,value:n.value,type:xw.Word,width:r}}(s,t);e.lastFittingToken=c,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(c),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}function Ww(e,t,n){void 0!==e.lastFittingToken&&Zw(e);let o=function(e){switch(e.type){case xw.HardBreak:return e.len;case xw.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==n&&n!==e.tokens.length-1&&o--;for(let n=0;n<o;n++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(cs),e.textLines.push(_w(n,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function _w(e,t){const n=t.start+e,o=n+function(e){return e.type===xw.HardBreakCRLF?gs.length:fs.length}(t);return{text:"",width:0,underlineWidth:0,startIndex:n,endIndex:o}}function zw(e,t,n){if(Kw(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,n){return Xw(e.tokens,n),!!Uw(e,n)&&(n===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||qw(e,t,n))}(e,t,n)?e.curLineWidth+t.width>e.maxWidth||qw(e,t,n)?Gw(e,t,n):(e.curLineWidth+=t.width,e.lastFittingToken=t):$w(e,t)}function Gw(e,t,n){Kw(t);const o=t.width/t.len,r=e.maxWidth-e.curLineWidth;if(r<0)return;const i=Math.floor(r/o);t.width=o*i,e.curLineWidth+=t.width,e.lastFittingToken=t,(jw(e.tokens,n)||Uw(e,n))&&$w(e,t)}function Vw(e,t){if(Xw(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function jw(e,t){return Xw(e,t),Vw(e,t),0===t&&e[t].type===xw.Space}function Uw(e,t){const n=e.tokens;return Xw(n,t),t>0&&n[t].type===xw.Space&&Qw(n[t-1])&&void 0===e.lastFittingToken}function $w(e,t){if(t.type!==xw.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";const n={...ss},o=t.start+t.len;n.underlineWidth=t.width,n.startIndex=t.start,n.endIndex=o,e.textLines.push(n),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(cs),e.curLineStart=o,e.curLineWidth=0,e.lastFittingToken=void 0}function qw(e,t,n){if(Kw(t),n>=e.tokens.length-1)return!1;const o=e.tokens[n+1];return e.curLineWidth+t.width+o.width>e.maxWidth}function Xw(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function Yw(e,t,n,o,r){if(r)return!0;if(t>o){if(1===n||2===n&&ku(e.charCodeAt(0),e.charCodeAt(1)))return!0;throw"breakTextToLines - non single char line is too wide!"}return r}function Jw(e,t){return e.width<t}function Kw(e){if(e.type!==xw.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function Qw(e){return e.type===xw.HardBreak||e.type===xw.HardBreakCRLF}function Zw(e,t=0){Ca(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");const n=e.curLineWidth-t;let o=n;if(e.lastFittingToken.type===xw.Space&&(o-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){const t=function(e){const t=[];let n=!1;for(let o=0;o<e.length;o++){const r=e[o],i=Lc(r.value);t.push({text:r.value,width:r.width,start:r.start,containsThaiCharacters:i}),i&&!n&&(n=!0)}return{tokens:t,containsThaiCharacters:n}}(e.unprocessedTokens);e.tokensPerLine.push(t),tS(e,t.containsThaiCharacters),e.unprocessedTokens=[]}const{text:r,start:i,end:l}=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";const t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e);e.textLines.push({text:r,underlineWidth:n,width:o,startIndex:i,endIndex:l})}function eS(e){const t={tokens:[],containsThaiCharacters:!0};let n;for(let i=0;i<e.length;i++){const l=e[i];Lc(l.text)?n?(r=l,n={text:(o=n).text+r.text,width:o.width+r.width,start:o.start,containsThaiCharacters:o.containsThaiCharacters||r.containsThaiCharacters}):n=l:(n&&(t.tokens.push(n),n=void 0),t.tokens.push(l))}var o,r;return n&&t.tokens.push(n),t}function tS(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}function nS(e,t,n,o,r,i,l,s,a,c,u,d,h){c?cw(e,t,n,o,c,l,s,u,d,h):Zs(o)?rw(e,n,o,i,l,s,t,u,a):r?e.fillText(i,l,s):e.fillText(i,l,s,a)}function oS(e,t,n){e.CachedStyle?.ReadingOrder!==Et.RightToLeft&&n.HasLtr&&!n.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())}function rS(e,t,n,o,r,i){const l=function(e,t,n,o,r){if(1===r&&ta(t)){const o=XC(t,e,n.zoom,n.devicePixelRatio);switch(t.CachedStyle?.HorizontalAlignment||Ht.Automatic){case Ht.Distributed:return $C(e,t,n.zoom,n.devicePixelRatio);case Ht.Justify:case Ht.JustifyDistributed:return tf(e,t,e.BlockWidth)+o}}return o}(e,t,n,o,i);return function(e,t,n,o,r){switch(Xh(e,t)){case Ht.Right:return n-o*(r-1);case Ht.CenterAcrossSelection:case Ht.Center:return n-o*(r-1)/2;default:case Ht.Left:return n}}(e,t,l,r,i)}function iS(e,t,n,o,r){if(!ta(t)||1===o)return 0;const i=function(e,t){return e.IsRtl&&t.PivotTable?.HasExpandCollapseIndicator?gm(t):0}(e,t),l=n,s=nf(e,t,e.BlockWidth)-YC(e,t)-i-l-r*(o-1);return s<0?0:s/(o-1)}function lS(e,t,n,o,r){let i=n-function(e,t,n){const o=Fh(t),r=!$s(t.WrapText)||xh(t);let i=0;return Fn(Sn.FixingSortFilterRenderingIssue)||(i=rm(e,t)?nm(e,t,n.zoom,n.devicePixelRatio):0),KC(e,t,o,t.CachedFont.Italic,0,r,i)}(o,e,r);return t===_p.Distributed&&(i-=qC(e.CachedStyle.Indentation||0)),i}function sS(e){return Zs(e)?function(e){switch(e){case Lt.Justify:return _p.Justify;case Lt.Distributed:return _p.Distributed;default:return _p.Wrap}}(e.CachedStyle.VerticalAlignment):function(e){switch(e){case Ht.Justify:return _p.Justify;case Ht.JustifyDistributed:case Ht.Distributed:return _p.Distributed;default:return _p.Wrap}}(e.CachedStyle?.HorizontalAlignment||Ht.Automatic)}function aS(e,t,n,o,r,i,l,s,a,c,u,d,h,f,g,m){const C=r.tokensPerLine[i].tokens,p=s.lineDirection===zp.Horizontal?Yh(n,o,l,u):c;if(d)return void nS(e,t,n,o,a,f,l,c,u,d,h,C,s);const w=Xp(s,C),S=jp(s,C,Up(C,s),w);if(!S)return;const{textPortionOffsetX:y,textPortionOffsetY:R}=cS(s,S.Start,l,c,p);if(nS(e,t,n,o,a,S.Start.Text,y,R,u,d,h),S.Middle){const{textPortionOffsetX:r,textPortionOffsetY:i}=cS(s,S.Middle,l,c,p);nS(e,t,n,o,a,S.Middle.Text,r,i,u,d,h)}if(S.End){const{textPortionOffsetX:r,textPortionOffsetY:i}=cS(s,S.End,l,c,p);nS(e,t,n,o,a,S.End.Text,r,i,u,d,h)}if(!m&&s.lineDirection!==zp.Vertical){const e=r.textLines[i],a=function(e,t,n,o,r){switch(e){case _p.Justify:return o?t.underlineWidth:n;case _p.Distributed:return o&&1===r?t.underlineWidth:n;case _p.Wrap:default:return t.underlineWidth}}(s.breakType,e,s.maxWidth,s.isProcessingLastLine,C.length);Ap(n,o,t,{textPositionX:s.lineDirection===zp.Horizontal?p+w:l,textPositionY:g,textWidth:a,clipRect:h},o.CachedFont)}}function cS(e,t,n,o,r){let i=n,l=o;return e.lineDirection===zp.Horizontal?i=r+t.Offset:e.lineDirection===zp.Vertical&&(l=r-t.Offset),{textPortionOffsetX:i,textPortionOffsetY:l}}const uS="Yu Gothic",dS=6,hS="ltr",fS="start",gS=14;function mS(e,t){return{fontColor:e?Qa(e.TextColor):is,fontProperties:"",direction:CS(t),textBaseline:"bottom",textAlign:"start"}}function CS(e){return e?"rtl":"ltr"}function pS(e,t,n){return!!t||n||Uh(e)||Zs(e)||!!e.DisplayFormula||Ec(e.PreviewText)}function wS(e){return!e.DisplayFormula&&!Ec(e.PreviewText)&&!!e.Spill}function SS(e){return!e.DisplayFormula&&!Ec(e.PreviewText)&&!!e.WrapText&&function(e){return!!Zs(e)||($h(e)||aC(e.CachedStyle.VerticalAlignment)?!(e.CachedIsTextWidthExceedsCellWidth&&e.ValueType===Wt.Number):!(e.ValueType===Wt.Number))}(e)&&!(e.CachedStyle?.HorizontalAlignment===Ht.Fill)}function yS(e,t,n,o,r){const i=n+o-r;return Zs(t)?function(e,t,n){const o=function(e,t,n,o,r,i){const l=aw(e,t,n,void 0,r,i);return{adjustedOffsetY:l.adjustedOffsetY,textHeight:l.textHeight}}(e,t,t.Text,0,n,ef(e,t,!0));return o.adjustedOffsetY-o.textHeight}(e,t,i):Hh(e,t.CachedStyle,t.CachedFont)?o-r:i}function RS(e,t){if(!e.PhoneticTextRuns)return e.Text?e.Text:"";let n="",o=0;for(let r=0;r<e.PhoneticTextRuns.length;r++){const i=e.PhoneticTextRuns[r];o<i.BaseStartIndex&&(n+=t.substring(o,i.BaseStartIndex)),n+=e.Text.substring(i.PhoneticStartIndex,i.PhoneticStartIndex+i.PhoneticLength),o=i.BaseStartIndex+i.BaseTextLength}return o<t.length&&(n+=t.substring(o)),n}function TS(e,t,n,o,r,i){if(!n.PhonInfo||!n.PhonInfo.Text)return;if(function(e){return e.TextRuns||e.WrapText||Zs(e)}(n)||n.PhonInfo&&!n.PhonInfo.PhoneticTextRuns){let l=i;l||(n.TextRuns?(e.save(),l=dp(e,t,n),e.restore()):l=dp(e,t,n));const s=vS(t,n,l,r),a=RS(n.PhonInfo,n.Text);return e.fillText(a,s,o),void Ud("drawPhoneticText: Row:"+n.Row.toString()+" Col:"+n.Col.toString())}const{phoneticTextRuns:l,textRuns:s}=function(e){const t=[],n=[];if(!e.PhonInfo||!e.PhonInfo.PhoneticTextRuns)return{phoneticTextRuns:t,textRuns:n};let o=0;for(let r=0;r<e.PhonInfo.PhoneticTextRuns.length;r++){const i=e.PhonInfo.PhoneticTextRuns[r];if(o<i.BaseStartIndex){const r={FontID:e.CachedFont?.ID??0,StartIndex:o,EndIndex:i.BaseStartIndex,IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};n.push(r),t.push({BaseStartIndex:o,PhoneticStartIndex:0,BaseTextLength:i.BaseStartIndex-o,PhoneticLength:0})}const l={FontID:e.CachedFont?.ID??0,StartIndex:i.BaseStartIndex,EndIndex:i.BaseStartIndex+(i.BaseTextLength??0),IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};n.push(l),t.push(i),o=i.BaseStartIndex+i.BaseTextLength}return{phoneticTextRuns:t,textRuns:n}}(n);e.save();const a=mp(e,s,n.Text,t,void 0);e.restore();let c=vS(t,n,a.totalSize,r);for(let t=0;t<l.length;t++){const r=l[t];if(a.textRunsDrawingInformation[t]){if(0!==r.PhoneticLength){const t=n.PhonInfo.Text.substr(r.PhoneticStartIndex,r.PhoneticLength);e.fillText(t,c,o)}c+=a.textRunsDrawingInformation[t].WidthPx??0}}}function IS(e,t,n){const o=vh(!1,!1);e.font=Ih(t,o,dS,uS);const r=mS(n,t.IsRtl);e.fillStyle=r.fontColor,e.direction=hS,e.textAlign=fS}function vS(e,t,n,o){if(Hh(e,t.CachedStyle,t.CachedFont))return t.CachedDrawingLayout.TextOrientationLayout.Angle>0?-n:0;if(Zs(t)||t.WrapText){const n=XC(t,e,o.zoom,o.devicePixelRatio);return tf(e,t,e.BlockWidth)+n}return pw(e,t,up(e,t,o),!1,n,void 0)}function bS(e,t){return!(!t||!Ru(t,e.renderingRegion)||SS(t)||Ec(t.PreviewText)||t.ShowSkeleton||!t.Text||!t.PhonInfo||t.PhonInfo.Text===us)}function xS(e,t,n,o){const r=function(e,t){const n=Sp(t,e),o=gS,r=ef(e,t,!0),i=UC(e,t,n,r,!!t.DisplayFormula),{absoluteY:l,lastTextLineAlphabeticBaselineOffset:s}=tp(t,e,n+o,r,i,void 0);return yS(e,t,l,s,n)}(t,o),i=function(e,t,n,o){const r=wS(t),i=SS(t),l=Zh(e,t,!0),s=ef(e,t,!0),a=rf(e,t),c=function(e,t,n,o,r,i,l,s){const a=tf(e,t,e.BlockWidth),c=rf(e,t),u=void 0!==t.CondFormat?.Icon;if(t.Merge||n)return JC(e,a,c,r,i,l,u);if(o){const n=gm(t),o=Du(Cf(t,e),l,n);return{x:wf(t,e,l,n),y:s,width:o,height:i}}return JC(e,a,c,r,i,l,u)}(e,t,i,r,l,s,vp(e,t,n,o),a);return c}(t,o,n.zoom,n.devicePixelRatio);pu(e,i),function(e,t,n){if(Hh(t,n.CachedStyle,n.CachedFont)){const t=n.CachedDrawingLayout.TextOrientationLayout;Wh(e,t.TranslateX,t.TranslateY,t.Angle),e.textAlign="left"}}(e,t,o),TS(e,t,o,r,n),function(e,t,n){Hh(t,n.CachedStyle,n.CachedFont)&&(e.restore(),e.textAlign=fS)}(e,t,o),wu(e,i)}function FS(e,t,n,o,r){return e?tp(t,n,o,r,t.CachedStyle.VerticalAlignment,void 0).absoluteY:0}function DS(e,t,n,o){const r=[];let i=[],l=[];i=[0],l=[0];let s=0;if(n)for(let o=0;o<t.length;o++){const a=t[t.length-1-o],c=uw(n,a.startIndex,a.endIndex);r[o]=c;const u=Tp(e,c);l[o]=u.baseline;const d=Rp(e,c);i[o+1]=i[o]+d,s+=d}else i=function(e,t){const n=[];for(let o=0;o<e;o++)n.push(o*t);return n}(t.length,o),s=o*t.length;return{rowsBottomY:i,rowsAlphabeticY:l,textHeight:s,formattedLines:r}}function MS(e,t){t&&pu(e,t)}function AS(e,t){wu(e,t)}function OS(e,t,n,o,r,i,l,s){let a=s?e+t-n-o:e-n;return l&&(a-=r*i),a}function BS(e,t,n,o){return e&&t<n*o}function kS(e,t,n,o){return e&&!t.HasRtl?0===n:n===o-1}function PS(e){return Pu()?jC(e,ds,!0,!0):e.measureText(ds).width}function ES(e,t,n,o){const r=jh(Nh(e.IsRtl,o.Orientation||0));return Fn(Sn.FixRotatedTextWidth)?t*Math.abs(Math.cos(r))+n*Math.abs(Math.sin(r)):_h(t,n,r)}function HS(e,t,n,o){const r=function(e,t,n){Ca(n,"cell","getNumFmtSeparatorWidth");const o=yh(n,t);return Dp(e,t,n,o),NC[o]}(e,o,t);r<0&&$d("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+r+" MeasuredWidth: "+fh(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);const i=WS(e,o,t,n,r,!0);let l="";return l+="#".repeat(i),l}function LS(e,t,n,o,r,i){let l=o.Start||"";try{l+=o.Separator.repeat(r),l+=o.End||""}catch(r){return $d("buildNumFmtText:: Invalid separatorCount."+NS(e,t,n,o,i)),o.Start||""+o.End||""}return l}function NS(e,t,n,o,r){const i=RC(n.CachedFont?.FontName),l=!!i&&lh(yh(n,t));return Mi(o.Separator)+" CachedWidth: "+r+" MeasuredWidth: "+e.measureText(o.Separator).width+", IsSpace: "+(" "===o.Separator)+", FontName:"+fh(n.CachedFont.FontName)+", FontSize:"+n.CachedFont.Size+", Length: "+o.Separator.length+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return e instanceof CanvasRenderingContext2D?document.contains(e.canvas):"Offscreen"}catch{return!1}}(e)+", isFontValid: "+i+", FontLoadCheck: "+l}function WS(e,t,n,o,r,i){let l=0;if(n.CachedFont.Italic&&i){const i=function(e,t,n){Ca(n,"cell","getOverhangHashWidth");const o=yh(n,t);return Dp(e,t,n,o),WC[o]}(e,t,n);l=Math.max(Math.floor((o-i)/r),0)}else l=Math.max(Math.floor(o/r),0);return($s(l)||isNaN(l)||l===1/0)&&($d(`calculateSeparatorCountInMaxWidth: Invalid count variable. hashCount: ${l}, cellWidth: ${o}, hashWidth: ${r} `),l=0),l}const _S="cursor",zS="tooltip",GS="longpress",VS="pointermove",jS="pointerleave",US="pointerdown",$S="pointerup",qS={x:-1,y:-1},XS="unset",YS="pointer",JS="default",KS="grab",QS="click",ZS="dblclick",ey=e=>{var t;return t=e,Ca(md,"externalCallbacks","setLastInputMethod"),md.setLastInputMethod(t),!1},ty=()=>!1,ny=()=>!0;function oy(e,t){const n=e.ClientOnlyCache?.RowOffsetsAdjustedForDrawing;if(n)return n[t]}function ry(e,t){const n=e.ClientOnlyCache?.RowOffsetsAdjustedForDrawing;if(n)return n[t+1]}function iy(e,t){const n=e.ClientOnlyCache?.ColOffsetsAdjustedForDrawing;if(n)return e.IsRtl?n[n.length-1]-n[t]:n[t]}function ly(e,t){const n=e.ClientOnlyCache?.ColOffsetsAdjustedForDrawing;if(n)return e.IsRtl?n[n.length-1]-n[t+1]:n[t+1]}function sy(e,t,n,o){return{start:Math.max(e,n),end:Math.min(t,o)}}function ay(e,t,n){return function(e,t,n){const{start:o,end:r}=sy(t.FirstColumn,t.LastColumn,e.FirstColumn,e.LastColumn);return Za((o-1)%go,(r-1)%go,n.startColumn,n.endColumn)}(e,t,n)&&function(e,t,n){const{start:o,end:r}=sy(t.FirstRow,t.LastRow,e.FirstRow,e.LastRow);return Za((o-1)%fo,(r-1)%fo,n.startRow,n.endRow)}(e,t,n)}let cy=!1,uy=!1;function dy(e,t){return!$s(e.Hyperlink)&&!!Ru(e,t.renderingRegion)}function hy(e,t,n,o){const r=function(e,t,n,o){const{leftX:r,width:i}=function(e,t,n,o){if(fy(n))return{leftX:af(t,n,!1,!1),width:lf(t,n)};const r=dp(e,t,n),i=function(e,t,n,o){const r=up(e,t,n),i=t.CachedStyle?.HorizontalAlignment||Ht.Automatic;switch(i){case Ht.Right:return r-o;case Ht.Center:return r-o/2;case Ht.Automatic:case Ht.Left:return r;default:throw Error(`getHyperlinkBoundsOnTextRectLeftX: unsupported horizontalAlignment for hyperlinks on text rect: ${i}`)}}(t,n,o,r),l=r*o.scaleFactor,s=i*o.scaleFactor;if(n.Spill?.IsSpillBlocked){const e=t.IsRtl?Tf(n,t):If(n),o=t.IsRtl?If(n):Tf(n,t),r=t.IsRtl?ly(t,e):iy(t,e),i=t.IsRtl?iy(t,o):ly(t,o);if(r&&i){const e=Math.max(r,s);return{leftX:e,width:Math.min(i,s+l)-e}}}return{leftX:s,width:l}}(e,t,n,o),{topY:l,height:s}=function(e,t,n){if(fy(t)){const n=sf(e,t);return{topY:gf(e,t,!1),height:n}}const o=Sp(t,e)*n.scaleFactor,r=function(e,t,n){const o=t.CachedStyle?.VerticalAlignment;switch(o){case Lt.Bottom:return df(e,t)-n-ts;case Lt.Center:return hf(e,t)-n/2;case Lt.Top:return gf(e,t,!1);default:throw Error(`getHyperlinkBoundsOnTextRectTopY: unsupported verticalAlignment: ${o}`)}}(e,t,o);let i=o;const l=t.CachedDrawingLayout?.UnderlineRuns;return l&&l.length>0&&(i=l[0].Y+l[0].LineWidth-r),{topY:Math.max(r,gf(e,t,!1)),height:Math.min(i,sf(e,t))}}(t,n,o);return{x:r,y:l,width:i,height:s}}(e,t,n,o);!function(e,t,n,o){const r=kg(e,n,o,!1),i=jo(e,cc(n.renderingRegion)),l=()=>(Ca(md,"externalCallbacks","inRangePicker"),!md.inRangePicker());let s=!1;Hf(t,i,r,Cn.Hyperlink,(n=>{if(l()){const{row:o,col:r}=my(e,t);bd&&bd(o,r,!0,n.clientX)}return!1})),Lf(t,i,r,Cn.Hyperlink,(n=>{const{row:o,col:r}=my(e,t);return bd&&bd(o,r,!1,n.clientX),!1})),Pf(t,i,r,"pointer",Cn.Hyperlink,(e=>gy(e)||Pd(t.Row+1,t.Col+1))),kf(t,i,r,Cn.Hyperlink,(()=>{const{row:n,col:o}=my(e,t);return s=Pd(n,o),!1}),"pointerdown"),kf(t,i,r,Cn.Hyperlink,(e=>{if(l()&&!cy){const n=gy(e),o=s||n,r=e.button,i=r&&2===r,l=e.pointerType;o&&!(i||l&&"mouse"!==l)&&function(e,t){if(t.Hyperlink?.IsValidHyperlink){if(t.Hyperlink?.IsHyperlinkExternal)n=e,o=t.Hyperlink?.Text,Ca(md,"externalCallbacks","followHyperlink"),md.followHyperlinkCallback(n,o);else if(t.Hyperlink.InternalLink){const n=t.Hyperlink.InternalLink;!function(e,t,n,o,r,i,l){Ca(md,"externalCallbacks","handleGoTo"),md.handleGoToCallback(e,t,n,o,r,i,l)}(e,n.ObjectName,n.SheetName,n.FirstRow,n.FirstColumn,n.LastRow,n.LastColumn)}}else md.invalidHyperlinkCallback();var n,o}(e,t)}return s=!1,cy=!0,setTimeout((()=>{cy=!1}),500),!1}),"click"),function(e,t,n,o,r,i){const l={zIndex:o,region:Wf(n),onStart:r,onEnd:i};Nf(e,t.CellLongPressHitRegions,l)}(t,i,r,Cn.Hyperlink,(()=>{uy=!0}),(()=>{uy&&(cy=!0),uy=!1})),kf(t,i,r,Cn.Hyperlink,ty,"touchend")}(t,n,o,r)}function fy(e){const t=e.CachedStyle;if($s(t))throw Error("shouldHyperlinkEventsBeRegisteredOnFullCell: cell.CachedStyle is null");return!!(e.WrapText||t.ShrinkToFit||t.Indentation||t.VerticalText||function(e){return!!e?.Orientation}(t)||aC(t.VerticalAlignment)||qh(t.HorizontalAlignment)||e.ValueType===Wt.Number||e.TextRuns||e.LinkedEntity?.IconWidth||e.RichValueIcon||e.HasIgnorableError||$s(e.Text))}function gy(e){const t=!!e.metaKey&&e.metaKey,n=!!e.ctrlKey&&e.ctrlKey;return kc()?t:n}function my(e,t){let n=e.RowNumbers[t.Row],o=e.ColumnNumbers[t.Col];const r=t.Merge?.OriginRow||0,i=t.Merge?.OriginColumn||0;return r&&i&&(n=r+1,o=i+1),{row:n,col:o}}function Cy(e,t,n,o,r,i,l,s){const a=function(e,t){switch(e){case Ht.Distributed:case Ht.Justify:case Ht.Automatic:case Ht.JustifyDistributed:return t?Ht.Right:Ht.Left;case Ht.Left:case Ht.Right:case Ht.Center:return e;case Ht.CenterAcrossSelection:case Ht.Fill:default:throw Error(`getEffectiveHorizontalAlignmentForRotatedText: Unsupported horizontal alignment ${e}`)}}(t.CachedStyle?.HorizontalAlignment,e.IsRtl),c=QC(e,t,l,s),u=function(e,t){return e.Underline?function(e){return Math.abs(e)===Es}(t)?2*ts:ts:0}(t.CachedFont,i);return function(e,t,n,o,r,i,l,s,a){const c=s<0;switch(e){case Ht.Left:return c?t+o*Math.abs(Math.sin(s))+r:t+l-o+r+i;case Ht.Right:return c?n-l-r-i+o:n-o*Math.abs(Math.sin(s))-r;case Ht.Center:return c?t+(a-l)/2+o:n-(a-l)/2-o;default:throw Error(`getRotatedTextHorizontalPosition: unsupported horizontalAlignment: ${e}`)}}(a,tf(e,t,e.BlockWidth),nf(e,t,e.BlockWidth),r,c,u,o,i,n)}function py(e,t,n,o,r){Ca(e.CachedDrawingLayout,"CachedDrawingLayout","cacheOrientationLayout");const i={TranslateX:t,TranslateY:n,Angle:o,clipRect:r};e.CachedDrawingLayout.TextOrientationLayout=i}const wy=1,Sy=.6,yy=57944,Ry=57945,Ty=9744,Iy=9745,vy=16,by="#575757",xy=1,Fy=2,Dy=4,My=8,Ay=4,Oy=4,By=1,ky=1;function Py(e,t,n,o,r,i){const l=function(e,t,n,o,r,i){return Hy(e,t,n,r,i)||Ey(e,t,o,r)}(e,t,n,o,r,i),s=t.Spill&&i;if(l)return{x:s?cf(e,t):af(e,t,!1,!1),y:gf(e,t,!1),width:s?pf(t,e)-ts:lf(e,t)-ts,height:sf(e,t)-ts}}function Ey(e,t,n,o){return n>=df(e,t)-ts||n-o<=gf(e,t,!1)}function Hy(e,t,n,o,r){const i=e.IsRtl,l=t.Spill&&(r||t.PivotTable?.HasExpandCollapseIndicator);return n<=(l?cf(e,t):af(e,t,i,!1))||n+o>=(l?function(e,t){return!t.Spill&&e.IsRtl?uf(e,t,!1):af(e,t,!1,!1)+pf(t,e)-ts}(e,t):uf(e,t,!1)-ts)}function Ly(e,t){if(!t||t.length<2)return;const n=t[0];e.moveTo(n.x,n.y);for(let n=1;n<t.length;n++){const o=t[n];e.lineTo(o.x,o.y)}}function Ny(e,t,n,o){const{x:r,y:i,width:l,height:s}=o,a=ts*n.scaleFactor,c=af(e,t,!1,!1),u=uf(e,t,!1),d=gf(e,t,!1),h=df(e,t)-a,f=Wy(r,c,u),g=Wy(i,d,h);let m=r+l;m=Wy(m,c,u);const C=m-(Fn(Sn.UseClippedXCheckbox)?f:r);let p=i+s;return p=Wy(p,d,h),{x:f,y:g,width:C,height:p-g}}function Wy(e,t,n){return e>n?n:e<t?t:e}var _y;!function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(_y||(_y={}));const zy=[[_y.ColoredArrowDown,_y.ColoredArrowRight,_y.ColoredArrowUp],[_y.GrayArrowDown,_y.GrayArrowRight,_y.GrayArrowUp],[_y.FlagLow,_y.FlagMedium,_y.FlagHigh],[_y.CircleLow,_y.CircleMedium,_y.CircleHigh],[_y.TrafficLow,_y.TrafficMedium,_y.TrafficHigh],[_y.SignLow,_y.SignMedium,_y.CircleHigh],[_y.CircleSymbolLow,_y.CircleSymbolMedium,_y.CircleSymbolHigh],[_y.SymbolLow,_y.SymbolMedium,_y.SymbolHigh],[_y.ColoredArrowDown,_y.ColoredArrowDownRight,_y.ColoredArrowUpRight,_y.ColoredArrowUp],[_y.GrayArrowDown,_y.GrayArrowDownRight,_y.GrayArrowUpRight,_y.GrayArrowUp],[_y.FourCircleLow,_y.FourCircleMedium1,_y.FourCircleMedium2,_y.FourCircleHigh],[_y.SignalBarLow,_y.SignalBarMedium1,_y.SignalBarMedium2,_y.SignalBarHigh],[_y.FourCircleLow,_y.CircleLow,_y.CircleMedium,_y.CircleHigh],[_y.ColoredArrowDown,_y.ColoredArrowDownRight,_y.ColoredArrowRight,_y.ColoredArrowUpRight,_y.ColoredArrowUp],[_y.GrayArrowDown,_y.GrayArrowDownRight,_y.GrayArrowRight,_y.GrayArrowUpRight,_y.GrayArrowUp],[_y.SignalBarEmpty,_y.SignalBarLow,_y.SignalBarMedium1,_y.SignalBarMedium2,_y.SignalBarHigh],[_y.CircleEmpty,_y.Circle25,_y.CircleHalf,_y.Circle75,_y.CircleFilled],[_y.StarLow,_y.StarMedium,_y.StarHigh],[_y.TriangleLow,_y.TriangleMedium,_y.TriangleHigh],[_y.QuadrantEmpty,_y.Quadrant25,_y.QuadrantHalf,_y.Quadrant75,_y.QuadrantFull]],Gy=2,Vy=1,jy=3,Uy=Math.PI/5,$y=Math.sin(Uy),qy=Math.sin(2*Uy),Xy=Math.cos(Uy),Yy=Math.cos(2*Uy),Jy=.4,Ky=1.5*Math.PI,Qy=0,Zy=.5*Math.PI,eR=Math.PI,tR=2*Math.PI,nR=.375,oR=.5625,rR=.9375,iR=.125,lR=.8125,sR=.3125,aR=.34375,cR=.1875,uR=.53125,dR=0,hR=.4,fR=.575,gR=.87,mR=.22,CR=.775,pR=.37,wR=.91,SR=.4,yR=.24,RR=.55,TR=.09,IR=.8125,vR=.1875,bR=.5,xR=.6875,FR=.3125,DR=.25,MR=.25,AR=.375,OR=.125,BR=.6,kR=2,PR=.4,ER=.325,HR=.625,LR=2,NR=.18,WR=.62,_R=.875,zR=.875,GR=.875,VR=.13,jR=Math.PI/4,UR=.305,$R=1-UR,qR=.5,XR=.325,YR=1-XR,JR=.125,KR=Math.tan(Math.PI/4),QR=.4,ZR=.55,eT=.7,tT=.05*Math.PI,nT=.25*Math.PI,oT=.45*Math.PI;function rT(e,t){const n=e.RowHeights[t.Row]-ts;return UC(e,t,Sp(t,e),n,t.DisplayFormula)}function iT(e,t,n,o){const r=cC(rT(e,t),lC.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),i=sT(e,t,n,o,r),l=t.CondFormat?.Icon?.IconOnly,s=df(e,t)-jy,a=gf(e,t,!1)+jy+o;switch(r){case Lt.Bottom:return l?s:hm(i,a,s);case Lt.Top:return l?a:hm(i,a,s);case Lt.Center:return l||aT(e,t,i,o)?Math.floor(hf(e,t)+o/2):i;default:throw Error(`getIconVerticalPosition: Vertical alignment ${r} is not supported in CF Icon!`)}}function lT(e,t,n,o,r){return t.CondFormat?.Icon?.IconOnly?function(e,t,n,o,r){const i=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(i){case Ht.Right:const l=um(o,r)+function(e,t,n,o){return t.PivotTable&&t.PivotTable.HasExpandCollapseIndicator&&Im(t,lf(e,t),o)&&n===Ht.Right?(gm(t)+Js)*o:0}(e,t,i,r)+n;return Math.floor(uf(e,t,!1)-l);case Ht.Fill:case Ht.Justify:case Ht.CenterAcrossSelection:case Ht.Distributed:case Ht.JustifyDistributed:case Ht.Automatic:case Ht.Left:return Math.floor(af(e,t,!1,!1)+um(o,r));case Ht.Center:return Math.floor(ff(e,t,!1)-n/2);default:throw Error(`getIconLeftOnlyPosition: unsupported horizontalAlignment: ${i}`)}}(e,t,n,o,r):(Uh(t)&&t.Spill?cf(e,t):af(e,t,!1,!1))+um(o,r)}function sT(e,t,n,o,r){const i=rp(e,tp(t,e,Sp(t,e),ef(e,t,!1),r,void 0).absoluteY,t.CachedFont,Fh(t))*n+.5*o;return Math.round(i)}function aT(e,t,n,o){return df(e,t)-jy<n||gf(e,t,!1)+jy>n+o}let cT;function uT(e,t,n,o){Ro(e,"ctx","drawInCellCheckboxControl"),Ro(t,"model","drawInCellCheckboxControl"),Ro(o,"context","drawInCellCheckboxControl"),Ro(n,"cell","drawInCellCheckboxControl"),hT(n)?gT(e,t,n,o,!1):fT(n)&&gT(e,t,n,o,!0)}function dT(e){return hT(e)||fT(e)}function hT(e){return!!e.Text&&e.ValueType===Wt.Boolean&&void 0!==e.Value}function fT(e){return!e.Text&&!e.CachedDisplayText&&e.InCellControlOptions?.Type===bt.Checkbox}function gT(e,t,n,o,r){const i=n.CachedFont?.Size??vy,l=wm(i,o.scaleFactor),s=function(e,t,n,o,r){const i=function(e,t,n,o,r){let i=Xh(e,t,!1);const l=um(o,r);switch(t.HorizontalAlignmentSet||(i=Ht.Center),i){case Ht.Fill:case Ht.Justify:case Ht.CenterAcrossSelection:case Ht.Distributed:case Ht.JustifyDistributed:case Ht.Automatic:case Ht.Left:return Math.floor(af(e,t,!1,!1)+l);case Ht.Right:return Math.floor(uf(e,t,!1)-n-l);case Ht.Center:return Math.floor(ff(e,t,!1)-n/2);default:throw Error(`getCheckboxIconHorizontalPosition: Horizontal alignment ${i} is not supported for checkbox icon!`)}}(e,t,r,o,n.scaleFactor),l=Fn(Sn.CellIconBottomPadding)?Math.round(r*_s):0,s=iT(e,t,n.scaleFactor,r);let a=s-r-l;return e.RowOffsets[t.Row+1]-s>a-e.RowOffsets[t.Row]&&(a+=l),{x:i,y:a,width:r,height:r}}(t,n,o,i,l),a=Py(t,n,s.x,s.y,l,!1);pu(e,a),function(e,t,n,o,r,i){!function(e,t,n,o,r){const i=e.globalAlpha,l=e.textAlign,s=e.textBaseline;e.textAlign="left",e.textBaseline="alphabetic",function(e,t,n,o){const r=n.highContrastScheme;e.fillStyle=r?Qa(r.TextColor):t.CachedFont?.Color??is,e.font=`${o.width}px ${Ws}`}(e,t,n,o);const a="1"===t.Value||"true"===t.Value,c=Fn(Sn.CheckboxFallbackFontIncreaseChecks)?String.fromCharCode(function(e){return vC(Ws,sC.Loaded)||MC(Ws)===sC.Loaded||document.fonts.check("11pt "+Ws)?e?Ry:yy:e?Iy:Ty}(a)):String.fromCharCode(function(e){const t=Fn(Sn.XLYellowFontLoadCheckNew);return t&&!vC(Ws,sC.Loaded)?e?Iy:Ty:t||MC(Ws)===sC.Loaded?e?Ry:yy:e?Iy:Ty}(a)??yy),{x:u,y:d,height:h}=o,f=d+h;e.globalAlpha=r,e.fillText(c,u,f),e.globalAlpha=i,e.textAlign=l,e.textBaseline=s}(e,n,o,r,i?Sy:wy);n.FormulaInfo?.FormulaType===_t.ArrayFormula||n.FormulaInfo?.FormulaType===_t.Formula||function(e,t,n,o,r){const i=o.y+o.height;let l;l=kg(e,n,Hy(e,t,o.x,o.width,!1)||Ey(e,t,i,o.width)?Ny(e,t,n,o):o,!1);const s=cT.inCellControlCheckboxTooltip?cT.inCellControlCheckboxTooltip:void 0;!function(e,t,n,o,r,i){let l;l=Fn(Sn.BussinessBarForCheckboxInReadOnly)?e=>!Ad()&&md.isSessionInEditMode():e=>!Ad(),Pf(e,t,n,YS,o,l),kf(e,t,n,o,i,QS),kf(e,t,n,o,i,ZS),r&&Ef(e,t,n,r,o)}(t,jo(e,cc(n.renderingRegion)),l,Cn.CheckboxIcon,s,r)}(t,n,o,r,(e=>{const t=Og().ToggleInCellControlCheckbox;return Fn(Sn.CheckboxClickWithCtrl)&&e.ctrlKey||pd(e,t,"",void 0,n.Row,n.Col),!0}))}(e,t,n,o,s,r),wu(e,a)}function mT(e,t,n,o){const r=n.scaleFactor,i=af(e,t,!1,!1),l=uf(e,t,!1),s=gf(e,t,!1),a=df(e,t)-s,c=xy*r,u=My*r,d=dp(o,e,t),h=t.CachedStyle?.HorizontalAlignment??Ht.Left,f=t.CachedStyle?.VerticalAlignment??Lt.Bottom,g=l-u-Oy*r,m=g-c-(i+c),C=0===d?m:d*r,{pillLeft:p,pillRight:w}=function(e,t,n,o,r,i,l){const s=o+2*(Dy*i),a=Math.ceil(Math.min(s,l));if(a<=0)return{pillLeft:0,pillRight:0};switch(e){case Ht.Left:return CT(t,a,n,r);case Ht.Right:return function(e,t,n,o){const r=o-n;return{pillLeft:Math.max(e+n,r-t),pillRight:r}}(t,a,n,r);case Ht.Center:return function(e,t,n,o){const r=e+n,i=o-n,l=(r+i)/2,s=Math.max(r,l-t/2);return{pillLeft:s,pillRight:Math.min(i,s+t)}}(t,a,n,r);default:return CT(t,a,n,r)}}(h,i,c,C,g,r,m),S=(Sp(t,e)+(t.PhonInfo?gS:0))*r,y=By*r,R=Math.min(a-Fy*r,S+2*y),{pillTop:T}=function(e,t,n,o,r){const i=ky*r;let l;switch(o){case Lt.Top:return l=e+i,{pillTop:l,pillBottom:l+n};case Lt.Center:return l=e+(t-n)/2,{pillTop:l,pillBottom:l+n};case Lt.Bottom:default:return l=e+t-n-i,{pillTop:l,pillBottom:l+n}}}(s,a,R,f,r),I={pillLeft:p,pillTop:T,pillWidth:w-p,pillHeight:R,radius:R/2,chevronLeft:g};return t.CachedDrawingLayout||(t.CachedDrawingLayout={}),t.CachedDrawingLayout.DropdownPillDimensions=I,I}function CT(e,t,n,o){const r=e+n;return{pillLeft:r,pillRight:Math.min(r+t,o-n)}}function pT(e,t,n,o,r){Ro(e,"ctx","drawInCellDropdownControl"),Ro(t,"model","drawInCellDropdownControl"),Ro(o,"context","drawInCellDropdownControl"),Ro(n,"cell","drawInCellDropdownControl"),function(e,t,n,o,r){const i=function(e){const t=e.CachedDrawingLayout?.DropdownPillDimensions;if(t)return t;throw Error("Dropdown pill dimensions not found in cache. Dimensions must be precalculated during preprocessing.")}(n),l=o.scaleFactor;e.roundRect?.(i.pillLeft,i.pillTop,i.pillWidth,i.pillHeight,[i.radius]);const s=i.chevronLeft,a=i.pillTop+i.radius,c=Ay*l,u=My*l;r.push({x:s,y:a,width:u,height:c}),function(e,t,n,o){const r=kg(e,n,o,!1),i=jo(e,cc(n.renderingRegion));Pf(t,i,r,YS,Cn.InCellDropdown),kf(t,i,r,Cn.InCellDropdown,(n=>(function(e,t,n){Ca(md,"externalCallbacks","showInCellDropdown"),md.showInCellDropdown(e,t,n)}?.(e.RowNumbers[t.Row],e.ColumnNumbers[t.Col],n),!0)),QS)}(t,n,o,{x:s,y:a,width:u,height:c})}(e,t,n,o,r)}function wT(e,t,n){Ro(e,"ctx","drawInCellControls"),Ro(t,"model","drawInCellControls"),Ro(n,"context","drawInCellControls");const o=yo(Vt.DropdownInCellControl,t),r=t.ClientOnlyCache.CellsToRender,i=[];for(let l=0;l<r.length;l++){const s=r[l];if(ST(s,n))switch(s.InCellControlOptions?.Type){case bt.Checkbox:uT(e,t,s,n);break;case bt.Dropdown:o&&i.push(s)}}o&&function(e,t,n,o){if(0===o.length)return;const r=[],i=n.highContrastScheme;e.beginPath();for(let i=0;i<o.length;i++)pT(e,t,o[i],n,r);if(i){const t=Qa(i.TextColor);e.strokeStyle=t,e.lineWidth=1,e.stroke()}else e.fillStyle="#DFDFDF",e.fill();if(Fn(Sn.DropdownArrowHighContrastVisibility)){const t=i?Qa(i.TextColor):by;e.fillStyle=t,e.strokeStyle=t,e.lineWidth=1.5,e.lineCap="round",e.lineJoin="round"}else e.fillStyle=by;e.beginPath();for(let t=0;t<r.length;t++){const n=r[t];e.moveTo(n.x,n.y),e.lineTo(Math.round(n.x+n.width/2),n.y+n.height),e.lineTo(n.x+n.width,n.y)}e.stroke()}(e,t,n,i)}function ST(e,t){if(null==e)return!1;if(e.DisplayFormula)return!1;if(t&&!Ru(e,t.renderingRegion))return!1;if(!e.InCellControlOptions)return!1;if(t&&Bu(e,t))return!1;if(Fn(Sn.CheckboxInCellImageCheck)&&e.InCellImage)return!1;switch(e.InCellControlOptions.Type){case bt.Checkbox:return dT(e);case bt.Dropdown:return!0}return!1}function yT(e,t){if(t.save(),t.beginPath(),mr())for(const[n]of e.ClientOnlyCache.DirtyCellsMap){const o=TT(e,n);o&&RT(t,o)}else for(let n=0;n<e.ClientOnlyCache.DirtyCellsKeys.length;n++){const o=TT(e,e.ClientOnlyCache.DirtyCellsKeys[n]);o&&RT(t,o)}t.strokeStyle="transparent",t.stroke(),t.clip()}function RT(e,t){const{x:n,y:o,width:r,height:i}=t;e.moveTo(n,o),e.lineTo(n+r,o),e.lineTo(n+r,o+i),e.lineTo(n,o+i),e.lineTo(n,o)}function TT(e,t){const{row:n,column:o}=Oo(t),r=Iu(o,e);return{x:e.IsRtl?r:r-ts,y:e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]-ts,width:du(o,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+ts,height:hu(n,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing)+ts}}function IT(e,t,n,o){if(!mr()||!t.isDifferentialRendering)return!0;const r=Ao(n.Row,n.Col),i=e.ClientOnlyCache.DirtyCellsMap.get(r);if(!i)throw new Error(`isCellAreaDirty: Checking dirty area "${o}" for a cell that is not dirty`);return 0!=(i&o)}function vT(e,t,n){Pu()?function(e,t,n){Ca(e,"ctx","drawCellsText"),Ca(t,"model","drawCellsText"),Ca(n,"context","drawCellsText"),Ca(t.RowOffsets,"model.RowOffsets","drawCellsText"),Ca(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),Ca(t.RowHeights,"model.RowHeights","drawCellsText"),Ca(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),Ca(t.Styles,"model.Styles","drawCellsText");const o=Zc(),r=t.ClientOnlyCache.CellsToRender,i=t.BlockWidth,l=[];let s,a=o?void 0:DT(e,n.highContrastScheme,t);const c=[];for(let e=0;e<r.length;e++){const o=r[e];OT(o,t,n)&&c.push(o)}const u=new Map;for(let e=0;e<c.length;e++){const n=c[e],o=yh(n,t);u.has(o)?u.get(o).push(n):u.set(o,[n])}let d=-1;for(const r of u.keys()){const c=u.get(r)||[];for(let r=0;r<c.length;r++){const u=c[r],h=t.RowHeights[u.Row]-ts,f=t.RowOffsets[u.Row];if(u.Row!==d&&(o&&-1===d?a=DT(e,n.highContrastScheme,t):-1!==d&&(wu(e,s),a=DT(e,n.highContrastScheme,t)),s={x:0,y:f,width:i,height:h},pu(e,s),d=u.Row),mf(u))l.push(u);else if(AT(t,u)){const o=t.IsRow?53:Us;Gd(Vd.DrawHeaderCellTextDurationMs,(()=>{xT(e,t,u,n,h,o,a)}),!0,!0)}else Gd(Vd.DrawSingleCellTextDurationMs,(()=>{bT(e,t,n,u,a,f,h)}),!0,!0)}}wu(e,s),a=mS(n.highContrastScheme,t.IsRtl);for(let o=0;o<l.length;o++){const r=l[o],i=ef(t,r,!1)-ts,s=rf(t,r);bT(e,t,n,r,a,s,i)}}(e,t,n):function(e,t,n){Ca(e,"ctx","drawCellsText"),Ca(t,"model","drawCellsText"),Ca(n,"context","drawCellsText"),Ca(t.RowOffsets,"model.RowOffsets","drawCellsText"),Ca(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),Ca(t.RowHeights,"model.RowHeights","drawCellsText"),Ca(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),Ca(t.Styles,"model.Styles","drawCellsText");const o=Zc(),r=t.ClientOnlyCache.CellsToRender,i=t.BlockWidth,l=[];let s,a=o?void 0:DT(e,n.highContrastScheme,t),c=-1;for(let u=0;u<r.length;u++){const d=r[u];if(!OT(d,t,n))continue;const h=t.RowHeights[d.Row]-ts,f=t.RowOffsets[d.Row];if(d.Row!==c&&(o&&-1===c?a=DT(e,n.highContrastScheme,t):-1!==c&&(a=MT(n.highContrastScheme,t.IsRtl,e,s)),s={x:0,y:f,width:i,height:h},pu(e,s),c=d.Row),mf(d))l.push(d);else if(AT(t,d)){const o=t.IsRow?53:Us;Gd(Vd.DrawHeaderCellTextDurationMs,(()=>{xT(e,t,d,n,h,o,a)}),!0,!0)}else Gd(Vd.DrawSingleCellTextDurationMs,(()=>{bT(e,t,n,d,a,f,h)}),!0,!0)}wu(e,s),a=mS(n.highContrastScheme,t.IsRtl);for(let o=0;o<l.length;o++){const r=l[o],i=ef(t,r,!1)-ts,s=rf(t,r);bT(e,t,n,r,a,s,i)}}(e,t,n),function(e,t,n){Gd(Vd.HyperlinkEventRegistrationMs,(()=>function(e,t,n){Ro(e,"ctx","registerHyperlinkEventHandlers"),Ro(t,"model","registerHyperlinkEventHandlers"),Ro(n,"context","registerHyperlinkEventHandlers");const o=t.ClientOnlyCache.CellsToRender;let r="";for(let i=0;i<o.length;i++){const l=o[i];if(!dy(l,n))continue;const s=yh(l,t);r!==s&&(r=s,e.font=s),hy(e,t,l,n)}}(e,t,n)))}(e,t,n)}function bT(e,t,n,o,r,i,l){const{zoom:s,devicePixelRatio:a}=n;let c=-1;Gd(Vd.DrawTextTextLineHeight,(()=>{c=Sp(o,t)}),!0,!0);const u=UC(t,o,c,l,o.DisplayFormula),d=o.CachedStyle?.HorizontalAlignment===Ht.Fill,h=Zh(t,o,!1),f=vp(t,o,s,a);let g=0;const m=Pu()?o.CachedDisplayText||o.Text:"";Gd(Vd.DrawTextTextMaxWidth,(()=>{g=gu(h,YC(t,o),f,mm(o.PivotTable?.HasExpandCollapseIndicator),om(t,o,s,a))}),!0,!0),FT(t,o,e,g,d,r,n),o.PreviewNumFmt&&function(e,t,n,o){if(Ca(n,"cell","updatePreviewTextFormatting"),Ca(n.CachedFont,"cell.CachedFont","updatePreviewTextFormatting"),Ca(t,"model","updatePreviewTextFormatting"),$s(n.PreviewNumFmt)||$s(n.PreviewNumFmt.Separator)||""===n.PreviewNumFmt.Separator)return;const r=yo(Vt.TextWidthClientPhase1,t),i=jC(e,n.PreviewNumFmt.Start,!0,r),l=jC(e,n.PreviewNumFmt.End,!0,r),s=Ip(e,t,n,n.PreviewNumFmt);if(0===s){if(!IC(t,n))return;return void $d("updatePreviewTextFormatting:: Invalid SeparatorWidth."+NS(e,t,n,n.PreviewNumFmt,s))}const a=WS(e,t,n,o-i-l,s,"#"===n.PreviewNumFmt?.Separator);n.PreviewText=LS(e,t,n,n.PreviewNumFmt,a,s)}(e,t,o,g),(Pu()?m!==o.CachedDisplayText&&o.CachedIndent!==o.CachedStyle?.Indentation:o.CachedIndent!==o.CachedStyle?.Indentation)&&(g=gu(h,YC(t,o),f,mm(o.PivotTable?.HasExpandCollapseIndicator),om(t,o,s,a)));const C=o.PhonInfo?gS:0,p=Ua(o,t),w=ja(p,o,t),S=wS(o),y=SS(o),R=function(e,t,n,o,r,i,l,s,a,c,u,d,h){const f=tf(e,t,e.BlockWidth),g=rf(e,t),m=!!t.CondFormat?.Icon||!!t.RichValueIcon;return h&&yo(Vt.DropdownInCellControl,e)&&t?.InCellControlOptions?.Type===bt.Dropdown?function(e,t,n){const o=e.CachedDrawingLayout?.DropdownPillDimensions;if(!o)throw new Error("DropdownPillDimensions not found in CachedDrawingLayout");const r=t.scaleFactor;return{x:o.pillLeft/r,y:o.pillTop/r,width:o.pillWidth/r,height:o.pillHeight/r}}(t,h):t.Merge||i?function(e,t,n,o,r,i,l,s,a,c,u,d){if(t.Merge&&(mf(t)||r||dp(n,e,t)>=o||Zs(t))||d)return JC(e,s,a,i,l,c,u)}(e,t,n,o,r,s,a,f,g,c,m,i):l?function(e,t,n,o,r,i,l){const s=Cf(t,e);if(t.Spill.IsSpillBlocked||n||t.CachedStyle?.HorizontalAlignment===Ht.CenterAcrossSelection||r){const n=gm(t),r=Du(s,o,n);return{x:wf(t,e,o,n),y:i,width:r,height:l}}}(e,t,r,c,d,u,a):pS(t,r,d)?JC(e,f,g,s,a,c,m):void 0}(t,o,e,g,w,y,S,h,l,f,i,d,n);Hh(t,o.CachedStyle,o.CachedFont)?function(e,t,n,o,r,i,l,s,a,c,u){const d=jh(Nh(t.IsRtl,n.CachedStyle?.Orientation)),h=Dh(n,c?yp(t,c.TextRuns):n.CachedFont,!0);SS(n)?function(e,t,n,o,r,i,l,s,a,c,u,d,h){const{zoom:f,devicePixelRatio:g}=o,m=Vh(n,i),C=a-ts-Bs*m,p=C/s,w=Math.atan(p);let S=0;if(S=Math.abs(l)>=w?Math.round(C/Math.abs(Math.sin(l))):Math.round(s/Math.abs(Math.cos(l))),S<=0)return;const y=jC(e,ds,!1,!0),R=n.WrapText,T=Hw(e,r,S,_p.Wrap,y,t,n,d,R).textLines,{textLinesHeight:I,linesAlphabeticOffset:v,formattedLines:b}=function(e,t,n,o,r,i){const l=[],s=[],a=[];let c=0;if(i){for(let t=0;t<n.length;t++){const o=n[t],u=uw(i,o.startIndex,o.endIndex);l[t]=u;const d=Tp(e,u);a[t]=d.baseline,c=Rp(e,u),s[t]=c+r}return{textLinesHeight:s,linesAlphabeticOffset:a,formattedLines:l}}const u=t.CachedFont,d=Fh(t),h=Xf(u.FontName,d,e).baseline;for(let e=0;e<n.length;e++)s.push(o+r),a.push(h);return{textLinesHeight:s,linesAlphabeticOffset:a,formattedLines:l}}(t,n,T,c,u,d),x=function(e,t,n,o,r,i,l,s,a){const c=function(e,t,n){const o=e.length;if(1===o)return _h(e[0].width,t[0],n);if(o>1){const o=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n));let i=e[0].width*o,l=0;for(let n=1;n<e.length;n++)l+=t[n]/r,i=Math.max(i,l+e[n].width*o);return i+t[0]}return 0}(n,o,l);return Cy(e,t,i,c,o[0]-r[0],l,s,a)}(t,n,T,I,v,s,l,f,g),F=function(e,t,n,o,r,i,l,s,a){const c=function(e){let t=0,n=0;for(let o=0;o<e.length;o++)e[o].width>n&&(n=e[o].width,t=o);return t}(n),u=zh(n[c].width,o[c],l),d=rf(e,t),h=of(e,t);return Gh(t.CachedStyle.VerticalAlignment,s,a,u,i,d,h)-r[c]*Math.abs(Math.cos(l))}(t,n,T,I,v,a,l,m,np(t,n)),D=e.textAlign,M=e.textBaseline;pu(e,h),Wh(e,x,F,l),py(n,x,F,l,h);let A=0,O=0;const B=Math.abs(Math.cos(l))/Math.abs(Math.sin(l));for(let r=0;r<T.length;r++)r>0&&(O=O+v[r-1]+I[r]-v[r],A=O*B*(l<0?1:-1)),nS(e,o,t,n,!0,T[r].text,A,O,s,b[r],h),d||Ap(t,n,o,{textPositionX:A,textPositionY:O,textWidth:T[r].underlineWidth,clipRect:h},n.CachedFont);const k=!$s(n.PhonInfo);try{if(k&&T.length>0){IS(e,t,o.highContrastScheme);const r=-(I[0]-u-v[0]);e.textAlign="left",TS(e,t,n,r,o,T[0].width),n.PhonInfo?.Text!==us&&Ud("drawWrapText: RotatedPhoneticRendered")}}catch(e){throw Ud("drawWrapText: Error in drawing rotated phonetic: "+e),e}e.restore(),e.textAlign=D,e.textBaseline=M,wu(e,h)}(e,t,n,o,r,h,d,i,l,s,a,c,u):function(e,t,n,o,r,i,l,s,a,c,u,d){const{zoom:h,devicePixelRatio:f}=o,g=dp(e,t,n),m=Xf(n.CachedFont?.FontName,i,t).baseline,C=function(e,t,n,o,r,i,l,s,a){return Cy(e,t,o,_h(n,r,l),r-i,l,s,a)}(t,n,g,s,c,m,l,h,f),p=function(e,t,n,o,r,i,l,s,a){const c=Vh(t,o),u=zh(r,i,s),d=rf(e,t),h=of(e,t);return Gh(t.CachedStyle?.VerticalAlignment,c,a,u,n,d,h)-l*Math.abs(Math.cos(s))}(t,n,a,i,g,c,m,l,np(t,n));pu(e,d),Wh(e,C,p,l),py(n,C,p,l,d),u&&!n.DisplayFormula?cw(e,o,t,n,u,0,0,d):(e.fillText(r,0,0),Ap(t,n,o,{textPositionX:0,textPositionY:0,textWidth:g,clipRect:d},n.CachedFont)),e.restore(),wu(e,d)}(e,t,n,o,r,h,d,i,l,s+a,c,u)}(e,t,o,n,p,g,l,c,C,w,R):function(e,t,n,o,r,i,l,s,a,c,u,d,h,f,g,m,C){const p=yo(Vt.DropdownInCellControl,t)&&n?.InCellControlOptions?.Type===bt.Dropdown,w=p?function(e,t,n,o){const r=t.CachedDrawingLayout?.DropdownPillDimensions;if(!r)throw new Error("DropdownPillDimensions not found in CachedDrawingLayout");const i=n.scaleFactor,l=r.pillLeft/i,s=r.pillWidth/i,a=r.radius/2/i,c=t.CachedStyle?.HorizontalAlignment;return c===Ht.Left?l+a:c===Ht.Right?l+s-a:c===Ht.Center?l+s/2:o(e,t,n)}(t,n,o,up):up(t,n,o),S=tp(n,t,s+a,r,d,void 0).absoluteY;if(f){Ca(C,"clipRect","drawSingleCellText");const a=Cu(i),c=mf(n);Gd(Vd.DrawWrapTextDurationMs,(()=>{!function(e,t,n,o,r,i,l,s,a,c,u,d,h){void 0===au&&(au=Fn(Sn.WrapTextOptimizationFgToCg)),au?function(e,t,n,o,r,i,l,s,a,c,u,d,h){const f=Zs(o),g=sS(o),m=f?mu(c,ow(o.CachedStyle?.Indentation||0)):c;if(m<=0||l<=0)return;const C=lS(o,g,f?m:l,n,t),p=f?d:PS(e),w=o.WrapText;let S={requireClipping:!1,textLines:[],tokensPerLine:[]};Gd(Vd.BreakToLinesDurationMs,(()=>{S=Hw(e,r,C,g,p,n,o,h,w)}),!0,!0);const y=wp(o);f&&oS(o,S,y);const R=S.textLines,{rowsBottomY:T,rowsAlphabeticY:I,textHeight:v,formattedLines:b}=DS(n,R,h,d),x=!$s(o.PhonInfo),F=f?o.CachedStyle.VerticalAlignment:cC(o.CachedStyle.VerticalAlignment,lC.WrapText,c,v,d,R.length,o.DisplayFormula),D=x?gS:0,M=I[0],A=tp(o,n,v+D,c,F,M),O=A.absoluteY,B=function(e,t,n,o,r,i,l){const s={startIndex:0,endIndex:o.length-1};if(l||t<=e||r)return s;const a=Math.floor(e/n)+1;let c=0,u=o.length-1;switch(i){case Lt.Bottom:c=0,u=Math.min(a-1,o.length-1);break;case Lt.Center:const e=Math.max(o.length-a,0),t=Math.floor(e/2);c=t,u=o.length-t-1;break;default:c=Math.max(0,o.length-a),u=o.length-1}return{startIndex:c,endIndex:u}}(c,v,d,R,f,F,h),k=S.requireClipping||u||x||BS(f,a,d,R.length);let P;k&&(P=s),MS(e,P);const E=e.textAlign,H=e.textBaseline;let L=!1;$h(o)&&!f&&(e.textAlign="left",e.textBaseline="alphabetic",L=!0,y.HasRtl&&$p(S,o.CachedStyle?.ReadingOrder||Et.Context,y,C));const N=f?ea(o):aC(F),W=N&&R.length>1&&!f?uC(c,v,R.length):0;let _=f?rS(n,o,t,i,d,R.length):i,z=0;ta(o)&&(z=iS(n,o,_,R.length,d));const G=FS(f,o,n,d,c),V=B.endIndex-B.startIndex+1;for(let r=0;r<V;r++){const i=B.startIndex+r,a=R.length-1-i,u=R[a],m=u.text;f&&r>0&&(_+=d+z);const w=f?G:OS(O,M,T[i],I[i],W,i,N,!$s(h));if(g===_p.Wrap)nS(e,t,n,o,k,m,_,w,l,b[i],s),h||f||Ap(n,o,t,{textPositionX:_,textPositionY:w,textWidth:u.underlineWidth,clipRect:s},o.CachedFont);else{const r={breakType:g,singleSpaceWidth:p,maxWidth:C,isProcessingLastLine:kS(f,y,a,R.length),isCompleteTextVisible:v<c,lineDirection:f?zp.Vertical:zp.Horizontal};aS(e,t,n,o,S,a,_,r,k,w,C,b[i],s,m,w,!$s(h))}}try{if(x){IS(e,n,t.highContrastScheme);const r=yS(n,o,O,A.lastTextLineAlphabeticBaselineOffset,v);TS(e,n,o,r,t),o.PhonInfo?.Text!==us&&Ud("drawWrapText: PhoneticRendered")}}catch(e){throw Ud("drawWrapText: Error in drawing phonetic: "+e),e}L&&(e.textAlign=E,e.textBaseline=H),AS(e,P)}(e,t,n,o,r,i,l,s,a,c,u,d,h):function(e,t,n,o,r,i,l,s,a,c,u,d,h){const f=Zs(o),g=sS(o),m=f?mu(c,ow(o.CachedStyle?.Indentation||0)):c;if(m<=0||l<=0)return;const C=lS(o,g,f?m:l,n,t),p=f?d:PS(e),w=o.WrapText;let S={requireClipping:!1,textLines:[],tokensPerLine:[]};Gd(Vd.BreakToLinesDurationMs,(()=>{S=Hw(e,r,C,g,p,n,o,h,w)}),!0,!0);const y=wp(o);f&&oS(o,S,y);const R=S.textLines,{rowsBottomY:T,rowsAlphabeticY:I,textHeight:v,formattedLines:b}=DS(n,R,h,d),x=!$s(o.PhonInfo),F=S.requireClipping||u||x||BS(f,a,d,R.length);let D;F&&(D=s);const M=e.textAlign,A=e.textBaseline;let O=!1;$h(o)&&!f&&(e.textAlign="left",e.textBaseline="alphabetic",O=!0,y.HasRtl&&$p(S,o.CachedStyle?.ReadingOrder||Et.Context,y,C));const B=x?gS:0,k=f?o.CachedStyle.VerticalAlignment:cC(o.CachedStyle.VerticalAlignment,lC.WrapText,c,v,d,R.length,o.DisplayFormula),P=f?ea(o):aC(k),E=P&&R.length>1&&!f?uC(c,v,R.length):0;MS(e,D);const H=I[0],L=tp(o,n,v+B,c,k,H),N=L.absoluteY;let W=f?rS(n,o,t,i,d,R.length):i,_=0;ta(o)&&(_=iS(n,o,W,R.length,d));const z=FS(f,o,n,d,c);for(let r=0;r<R.length;r++){const i=R.length-1-r,a=R[i],u=a.text;f&&r>0&&(W+=d+_);const m=f?z:OS(N,H,T[r],I[r],E,r,P,!$s(h));if(g===_p.Wrap)nS(e,t,n,o,F,u,W,m,l,b[r],s),h||f||Ap(n,o,t,{textPositionX:W,textPositionY:m,textWidth:a.underlineWidth,clipRect:s},o.CachedFont);else{const l={breakType:g,singleSpaceWidth:p,maxWidth:C,isProcessingLastLine:kS(f,y,i,R.length),isCompleteTextVisible:v<c,lineDirection:f?zp.Vertical:zp.Horizontal};aS(e,t,n,o,S,i,W,l,F,m,C,b[r],s,u,m,!$s(h))}}try{if(x){IS(e,n,t.highContrastScheme);const r=yS(n,o,N,L.lastTextLineAlphabeticBaselineOffset,v);TS(e,n,o,r,t),o.PhonInfo?.Text!==us&&Ud("drawWrapText: PhoneticRendered")}}catch(e){throw Ud("drawWrapText: Error in drawing phonetic: "+e),e}O&&(e.textAlign=M,e.textBaseline=A),AS(e,D)}(e,t,n,o,r,i,l,s,a,c,u,d,h)}(e,o,t,n,u,w,l,C,a,r,c,s,m)}),!0,!0)}else n.Merge?function(e,t,n,o,r,i,l,s,a,c){c?bw(e,t,i,l,s,c,o,n,o.CachedStyle?.HorizontalAlignment===Ht.Fill,r):vw(e,i,l,s,a,o,n,t)}(e,o,t,n,m,u,w,S,l,C):h?Gd(Vd.DrawSpillCellTextDurationMs,(()=>{!function(e,t,n,o,r,i,l,s,a,c,u){Ca(o.Spill,"cell.Spill","spillCells.drawSpillCellText");const d=Cf(o,n);s?bw(e,t,r,i,l,s,o,n,a,u):vw(e,r,i,l,gu(d,YC(n,o),c,gm(o),0),o,n,t)}(e,o,t,n,u,w,S,C,g,c,m)}),!0,!0):p||pS(n,m,g)?(Ca(C,"clipRect","drawSingleCellText"),Gd(Vd.DrawFillTextClippedDurationMs,(()=>{bw(e,o,u,w,S,C,n,t,g,m)}),!0,!0)):Gd(Vd.DrawFillTextUnClippedDurationMs,(()=>{vw(e,u,w,S,l,n,t,o)}),!0,!0)}(e,t,o,n,l,h,g,c,C,f,p,u,S,y,d,w,R)}function xT(e,t,n,o,r,i,l){const s=n.CachedStyle.VerticalAlignment,a=up(t,n,o),c=tp(n,t,js,r,s,void 0).absoluteY;FT(t,n,e,i,!1,l,o),vw(e,n.Text,a,c,i,n,t,o)}function FT(e,t,n,o,r,i,l){Gd(Vd.DrawTextUpdateCellContext,(()=>{!function(e,t,n,o,r){const i=function(e,t){if(Zs(t))return"center";const n=Xh(e,t);switch(n){case Ht.Right:return"right";case Ht.CenterAcrossSelection:case Ht.Center:return"center";case Ht.Left:return"left";default:throw Error(`getTextAlignment: unsupported horizontalAlignment: ${n}`)}}(o,n);t.textAlign!==i&&(t.textAlign=i,e.textAlign=i);const l=qs;l!==t.textBaseline&&(e.textBaseline=l,t.textBaseline=l);const s=yh(n,o);t.fontProperties===s&&e.font===s||(t.fontProperties=s,e.font=s);const a=function(e,t,n){return t?xu(e,t):e.PreviewText&&n.ClientOnlyCache.PreviewCellsSettings?.RetainCellTextOnPreview&&!e.RetainTextOnPreview?ls:e.HasError?xs:e.CachedFont.Color}(n,r,o);t.fontColor!==a&&(t.fontColor=a,e.fillStyle=a);const c=function(e,t){switch(e){case Et.RightToLeft:return"rtl";case Et.LeftToRight:return"ltr";case Et.Context:return CS(t);default:throw Error(`getCanvasDirection: unsupported readingOrder: ${e}`)}}(n.CachedStyle.ReadingOrder||Et.Context,o.IsRtl);c!==t.direction&&(t.direction=c,e.direction=c)}(n,i,t,e,l.highContrastScheme)}),!0,!0),ko(t)&&function(e,t,n,o,r,i){Ca(n,"cell","updateNumberFormattingInformation"),Ca(n.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),Ca(t,"model","updateNumberFormattingInformation");const l=yo(Vt.TextWidthClientPhase1,t);if(yo(Vt.TextWidthClientPhase1,t)){const e=n.TolType!==rn.Autofit,t=n.ValueType!==Wt.Error&&n.ValueType!==Wt.Boolean,o=Fn(Sn.FixingSortFilterRenderingIssue)&&n.AutoFilter;if(e&&t&&!o)return}if(Zs(n))return;if(!$s(n.NumFmt)&&!$s(n.NumFmt.Separator)&&""!==n.NumFmt.Separator){const r=jC(e,n.NumFmt?.Start,!0,l),i=jC(e,n.NumFmt?.End,!0,l);if(r+i>o&&!xh(n))_a(n,HS(e,n,o,t)),gp(e,t,n);else{const l=Ip(e,t,n,n.NumFmt);if(!SC())return;const s=IC(t,n);if(0===l&&!s)return;if(0===l)return void $d("updateNumberFormattingInformation:: Invalid SeparatorWidth."+NS(e,t,n,n.NumFmt,l));const a=WS(e,t,n,o-r-i,l,"#"===n.NumFmt?.Separator);_a(n,LS(e,t,n,n.NumFmt,a,l))}return}let s=Math.round(dp(e,t,n));if(Hh(t,n.CachedStyle,n.CachedFont)&&Fn(Sn.FixRotatedTextWidth)&&(s=ES(t,s,Sp(n,t),n.CachedStyle)),s>o&&!xh(n)){n.CachedIndent=0;const l=n.CachedStyle?.Indentation?function(e,t,n,o){const r=Zh(e,t,!1),i=vp(e,t,n,o);return gu(r,YC(e,t),i,mm(t.PivotTable?.HasExpandCollapseIndicator),om(e,t,n,o))}(t,n,r,i):o,s=HS(e,n,l,t);s!==n.CachedDisplayText&&(n.CachedIsTextWidthExceedsCellWidth=!0,_a(n,s),gp(e,t,n))}}(n,e,t,o,l.zoom,l.devicePixelRatio),r&&function(e,t,n,o){const r=n.Text;if(r){const i=function(e,t,n){const{zoom:o,devicePixelRatio:r}=n;return gu(t.Spill?Cf(t,e):Zh(e,t,!1),XC(t,e,o,r),vp(e,t,o,r),gm(t),om(e,t,o,r))}(t,n,o),l=jC(e,r,!1,yo(Vt.TextWidthClientPhase1,t));let s=Math.floor(i/l);s<1&&(s=1),(void 0===s||isNaN(s)||s===1/0)&&($d(`updateCachedDisplayTextForFill: Invalid count variable. repeatCount: ${s}, maxTextWidth: ${i}, textWidth: ${l} `),s=1),_a(n,r.repeat(s))}}(n,e,t,l)}function DT(e,t,n){const o=mS(t,n.IsRtl);return e.direction=o.direction,e.fillStyle=o.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){Array.isArray(e.getLineDash())&&0!==e.getLineDash().length&&e.setLineDash([])}(e),o}function MT(e,t,n,o){return wu(n,o),mS(e,t)}function AT(e,t){return!$s(e.IsRow)&&(!!e.IsRow||!t.IsCellSnapped&&Pa(t.Col,e)>Us)}function OT(e,t,n){if(!e)return!1;if(!IT(t,n,e,mn.EntireCell))return!1;if(Bu(e,n))return!1;if(yo(Vt.InCellControls,t)&&ST(e)&&(!yo(Vt.DropdownInCellControl,t)||e?.InCellControlOptions?.Type!==bt.Dropdown))return!1;if(!(e.Text||e.PreviewText||e.PreviewNumFmt)){if(!yo(Vt.FormulaViewCellImagesFix,t))return!1;if(!n.isFormulaView||!e.FormulaInfo)return!1}return!(0===e.ShrunkSize||0===e.CachedFont?.Size||!Ru(e,n.renderingRegion)||e.CondFormat&&e.CondFormat?.Icon&&e.CondFormat?.Icon?.IconOnly||e.ShowSkeleton)}function BT(e,t,n,o){Ca(n,"cell.CachedStyle.Gradient.Stops","createGradientFill");const r=function(e,t){const{x:n,y:o,width:r,height:i}=t;switch(e){case kt.Vertical:case kt.Center:case kt.TopRightCorner:return{x0:n,y0:0,x1:n+r,y1:0};case kt.ReversedVertical:case kt.TopLeftCorner:return{x0:n+r,y0:0,x1:n,y1:0};case kt.Horizontal:case kt.BottomRightCorner:case kt.BottomLeftCorner:return{x0:0,y0:o,x1:0,y1:o+i};case kt.ReversedHorizontal:return{x0:0,y0:o+i,x1:0,y1:o};case kt.DiagonalUp:case kt.DiagonalDown:case kt.ReversedDiagonalUp:case kt.ReversedDiagonalDown:return function(e,t){const n=t.width*t.width,o=t.height*t.height,r=n+o,i=t.x+t.width/2,l=t.y+t.height/2;let s=t.width*o/r,a=n*t.height/r;switch(e){case kt.DiagonalUp:break;case kt.DiagonalDown:s=-s;break;case kt.ReversedDiagonalUp:a=-a;break;case kt.ReversedDiagonalDown:s=-s,a=-a;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:i-s,y0:l-a,x1:i+s,y1:l+a}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,o),i=e.createLinearGradient(r.x0,r.y0,r.x1,r.y1);for(let e=0;e<n.length;e++)i.addColorStop(n[e].Position,n[e].Color);return i}function kT(e,t,n,o,r,i){const l=Sf(t,n,!1);if(o===ET.Gradient)return function(e,t,n,o){let r=BT(e,t.ShadingStyle,t.Stops,n);return r!==o&&(e.fillStyle=r),e.fillRect(n.x,n.y,n.width,n.height),function(e){switch(e){case kt.TopLeftCorner:case kt.TopRightCorner:case kt.BottomLeftCorner:case kt.BottomRightCorner:case kt.Center:return!0;default:return!1}}(t.ShadingStyle)&&(r=e.fillStyle=BT(e,function(e){switch(e){case kt.TopLeftCorner:case kt.TopRightCorner:return kt.ReversedHorizontal;case kt.BottomLeftCorner:return kt.ReversedVertical;case kt.BottomRightCorner:return kt.Vertical;case kt.Center:return kt.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,n),function(e,t,n){const{x:o,y:r,width:i,height:l}=n;switch(e.beginPath(),e.moveTo(o,r),e.lineTo(o+i,r),t){case kt.TopLeftCorner:case kt.BottomRightCorner:e.lineTo(o+i,r+l);break;case kt.TopRightCorner:case kt.BottomLeftCorner:e.lineTo(o,r+l);break;case kt.Center:e.lineTo(o,r+l),e.lineTo(o+i,r+l);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(o,r)}(e,t.ShadingStyle,n),e.fill()),r}(e,n.CachedStyle.Gradient,l,r);const s=function(e,t,n){return t===ET.FormulaParseError?"#FFFFFF":n&&e.CachedStyle.BackgroundColor===Ar?Mr:e.CachedStyle.BackgroundColor}(n,o,i);return r!==s&&(e.fillStyle=s),e.fillRect(l.x,l.y,l.width,l.height),s}function PT(e){return e.HasError?ET.FormulaParseError:$s(e.CachedStyle.Gradient)?$s(e.CachedStyle.BackgroundColor)?ET.None:ET.Solid:ET.Gradient}var ET;function HT(e,t,n){if(e===n.RowNumbers.length-1)return!0;const o=$o(e+1,t,n);if(!o)return!0;const r=o.CachedStyle;return!r?.BackgroundColor&&!r?.Gradient&&!r?.PatternStyle}function LT(e,t,n){if(t===n.ColumnNumbers.length-1)return!0;const o=$o(e,t+1,n);if(!o)return!0;const r=o.CachedStyle;return!r?.BackgroundColor&&!r?.Gradient&&!r?.PatternStyle}void 0===window.gridRendererStringsCounter?window.gridRendererStringsCounter=1:window.gridRendererStringsCounter++,function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(ET||(ET={}));const NT="#FF9198",WT="#D42314",_T="#F8DB8F",zT="#DE6C00",GT="#A1DDAA",VT="#309048",jT="#797774",UT="#3A3A38",$T="#FAFAFA",qT="#3A3A38",XT="#D492D8",YT="#922E9B",JT="#C8C6C4",KT="#3A3A38",QT="#3A3A38",ZT="#FF9198",eI="#D42314",tI="#3A3A38",nI="#FAFAFA",oI="#83BEEC",rI="#3A3A38",iI="#3A3A38",lI="#D42314",sI="#FF9198",aI="#DE6C00",cI="#F8DB8F",uI="#309048",dI="#A1DDAA",hI="#D42314",fI="#FF9198",gI="#DE6C00",mI="#F8DB8F",CI="#309048",pI="#A1DDAA",wI="#DE6C00",SI="#F8DB8F",yI="#3A3A38",RI="#FAFAFA",TI="#DE6C00",II="#F8DB8F",vI="#D42314",bI="#FF9198",xI="#D42314",FI="#FF9198",DI="#DE6C00",MI="#F8DB8F",AI="#309048",OI="#A1DDAA",BI="#797774",kI="#C8C6C4",PI="#A1DDAA",EI="#FF9198",HI="#F8DB8F",LI="#309048",NI="#D42314",WI="#DE6C00",_I="#FAFAFA";var zI,GI;function VI(e,t){Ca(e,"ctx","drawCircleIcon"),Ca(t,"drawingContext","drawCircleIcon");const{image:n,highContrastScheme:o}=t,r=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.CircleHigh:case _y.TrafficHigh:case _y.CircleSymbolHigh:return VT;case _y.CircleMedium:case _y.TrafficMedium:case _y.CircleSymbolMedium:return zT;case _y.CircleLow:case _y.TrafficLow:case _y.CircleSymbolLow:return WT;case _y.CircleEmpty:return qT;case _y.CircleFilled:case _y.Circle25:case _y.CircleHalf:case _y.Circle75:return UT;case _y.FourCircleHigh:return eI;case _y.FourCircleLow:return QT;case _y.FourCircleMedium1:return KT;case _y.FourCircleMedium2:return YT;default:throw Error(`getCircleOutlineColor: unsupported image type = ${e}`)}}(n,o),i=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.CircleHigh:case _y.TrafficHigh:case _y.CircleSymbolHigh:return GT;case _y.CircleMedium:case _y.TrafficMedium:case _y.CircleSymbolMedium:return _T;case _y.CircleLow:case _y.TrafficLow:case _y.CircleSymbolLow:return NT;case _y.CircleEmpty:return $T;case _y.CircleFilled:return jT;case _y.FourCircleHigh:return ZT;case _y.FourCircleLow:return;case _y.FourCircleMedium1:return JT;case _y.FourCircleMedium2:return XT;case _y.Circle25:case _y.CircleHalf:case _y.Circle75:return jT;default:throw Error(`getCircleInnerColor: unsupported image type = ${e}`)}}(n,o);jI(e,t,r,i)}function jI(e,t,n,o){const{image:r,highContrastScheme:i}=t,l=function(e){const{left:t,bottom:n,size:o}=e,r=o/2,i=r-Gu;return{centerX:Math.round(t+r),centerY:Math.round(n-r),innerRadius:i,outlineRadius:r}}(t),{outlineRadius:s}=l;s<=0||(UI(e,l.centerX,l.centerY,s,Qy,tR,n),o&&l.innerRadius>0&&function(e,t,n,o,r){const{centerX:i,centerY:l,innerRadius:s}=t;if(r)!function(e,t,n,o){const{centerX:r,centerY:i}=t,l=t.innerRadius,s=function(e){switch(e){case _y.Circle25:case _y.CircleHalf:case _y.Circle75:return zI.FillPortion;case _y.CircleLow:case _y.CircleEmpty:case _y.FourCircleHigh:case _y.TrafficLow:case _y.CircleSymbolLow:case _y.CircleSymbolMedium:case _y.CircleSymbolHigh:return zI.Empty;case _y.CircleHigh:case _y.TrafficHigh:case _y.CircleFilled:return zI.Full;case _y.CircleMedium:case _y.TrafficMedium:return zI.Stripes;case _y.FourCircleLow:case _y.FourCircleMedium1:case _y.FourCircleMedium2:return zI.InnerCircle;default:throw Error(`getHighContrastFillingType: image: ${e} not supported`)}}(o),a=Qa(n.BackgroundColor),c=Qa(n.TextColor);switch(s){case zI.Full:break;case zI.FillPortion:UI(e,r,i,l,$I(o),Ky,a);break;case zI.Empty:UI(e,r,i,l,Qy,tR,a);break;case zI.InnerCircle:UI(e,r,i,l,Qy,tR,a);const t=function(e,t){switch(e){case _y.FourCircleMedium2:return t*QR;case _y.FourCircleMedium1:return t*ZR;case _y.FourCircleLow:return t*eT;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}}(o,l);UI(e,r,i,t,Qy,tR,c);break;case zI.Stripes:UI(e,r,i,l,Qy,tR,a),function(e,t,n,o,r){e.strokeStyle=r,e.beginPath();const i={p1:{x:t+o*Math.cos(tT)-Vu,y:n+o*Math.sin(tT)-Vu},p2:{x:t+o*Math.cos(Ky-tT)+Vu,y:n+o*Math.sin(Ky-tT)+Vu}},l={p1:{x:t+o*Math.cos(nT)-Vu,y:n+o*Math.sin(nT)-Vu},p2:{x:t+o*Math.cos(Ky-nT)+Vu,y:n+o*Math.sin(Ky-nT)+Vu}},s={p1:{x:t+o*Math.cos(oT)-Vu,y:n+o*Math.sin(oT)-Vu},p2:{x:t+o*Math.cos(Ky-oT)+Vu,y:n+o*Math.sin(Ky-oT)+Vu}};Su(e,i.p1.x,i.p1.y,i.p2.x,i.p2.y),Su(e,l.p1.x,l.p1.y,l.p2.x,l.p2.y),Su(e,s.p1.x,s.p1.y,s.p2.x,s.p2.y),e.stroke()}(e,r,i,l,c);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,r,o);else switch(o){case _y.Circle25:case _y.CircleHalf:case _y.Circle75:const t=$I(o);UI(e,i,l,s,Ky,t,n),UI(e,i,l,s,t,Ky,$T);break;default:UI(e,i,l,s,Qy,tR,n)}}(e,l,o,r,i))}function UI(e,t,n,o,r,i,l){e.fillStyle=l,e.beginPath(),e.moveTo(t,n),e.arc(t,n,o,r,i),e.fill()}function $I(e){switch(e){case _y.Circle25:return Qy;case _y.CircleHalf:return Zy;case _y.Circle75:return eR;default:throw Error(`getFillAngle: image: ${e} not supported`)}}function qI(e,t,n,o){const{left:r,bottom:i,highContrastScheme:l}=o,s=function(e){return e?Qa(e.TextColor):rI}(l);return{innerColor:t,outerColor:s,bottom:i,left:r+n*(e+1),height:n*(e+2),width:n}}function XI(e,t,n,o,r){const{left:i,bottom:l,highContrastScheme:s}=r,a=function(e){return e?Qa(e.TextColor):rI}(s);return{innerColor:n,outerColor:a,bottom:l-e*o,left:i+t*o,height:o,width:o}}function YI(e,t){Ca(t.outerColor,"outerColor","drawFlags");const{outerColor:n}=t,o=function(e){const{left:t,bottom:n,width:o,height:r}=e,i=r/2;return{p1:{x:t+o+Vu,y:n-i-Vu},p2:{x:t+o-i/KR+Vu,y:n-r-Vu}}}(t),r=function(e){const{left:t,bottom:n,width:o}=e,r=o/2;return{p1:{x:t+r+Vu,y:n-Vu},p2:{x:t+Vu,y:n-r*KR-Vu}}}(t);e.strokeStyle=n,e.beginPath(),Su(e,o.p1.x,o.p1.y,o.p2.x,o.p2.y),Su(e,r.p1.x,r.p1.y,r.p2.x,r.p2.y),e.stroke()}function JI(e,t,n){Ca(e,"ctx","drawTriangle"),Ca(t,"drawingContext","drawTriangle");const{innerColor:o,outerColor:r,left:i,bottom:l,height:s,width:a}=t,c=i+a/2,u=n?l+s:l-s;e.beginPath(),e.moveTo(i,l),e.lineTo(i+a,l),e.lineTo(c,u),e.closePath(),o&&(e.fillStyle=o,e.fill()),r&&(e.strokeStyle=r,e.stroke())}function KI(e,t,n,o,r){return Bg(n,e,t,o,r,!0,!0)}function QI(e,t,n){const o=Oa(ts),{left:r,bottom:i,height:l,width:s}=t,a=n===GI.Right,c=i-l,u=a?r-o:r;Ly(e,[{x:u,y:c},{x:u+s+o,y:c},{x:u+(a?s+o:0),y:c+l+o},{x:u,y:c}])}function ZI(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.TriangleLow:return hI;case _y.TriangleMedium:return gI;case _y.TriangleHigh:return CI;default:throw Error(`getTriangleOuterColor: unsupported image type = ${e}`)}}function ev(e,t){if(t)return Qa(t.BackgroundColor);switch(e){case _y.TriangleLow:return fI;case _y.TriangleMedium:return mI;case _y.TriangleHigh:return pI;default:throw Error(`getTriangleInnerColor: unsupported image type = ${e}`)}}function tv(e,t){if(!t)switch(e){case _y.SignLow:return bI;case _y.SignMedium:return II;default:throw Error(`getInnerColor: unsupported image type = ${e}`)}}function nv(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.SignLow:return vI;case _y.SignMedium:return TI;default:throw Error(`getOuterColor: unsupported image type = ${e}`)}}function ov(e,t){Ca(e,"ctx","drawSymbols"),Ca(t,"drawingContext","drawSymbols");const{image:n,highContrastScheme:o}=t,r=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.SymbolHigh:return OI;case _y.SymbolMedium:return MI;case _y.SymbolLow:return FI;case _y.CircleSymbolHigh:case _y.CircleSymbolMedium:case _y.CircleSymbolLow:return _I;default:throw Error(`getSymbolInnerColor: unsupported image type = ${e}`)}}(n,o),i=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.SymbolHigh:case _y.CircleSymbolHigh:return AI;case _y.SymbolMedium:case _y.CircleSymbolMedium:return DI;case _y.SymbolLow:case _y.CircleSymbolLow:return xI;default:throw Error(`getSymbolOuterColor: unsupported image type = ${e}`)}}(n,o);switch(n){case _y.SymbolHigh:case _y.CircleSymbolHigh:!function(e,t,n,o){let r;const{size:i,left:l,bottom:s,image:a}=t;switch(a){case _y.SymbolHigh:r=function(e,t,n){const o=t-n,r=e+nR*n,i={x:e+cR*n,y:aR*n+o};return[i,{x:e+dR*n,y:uR*n+o},{x:r,y:rR*n+o},{x:e+n,y:sR*n+o},{x:e+lR*n,y:iR*n+o},{x:r,y:oR*n+o},i]}(l+Vu,s,i);break;case _y.CircleSymbolHigh:r=function(e,t,n){const o=t-n,r=e+hR*n,i={x:e+yR*n,y:SR*n+o};return[i,{x:e+TR*n,y:RR*n+o},{x:r,y:gR*n+o},{x:e+wR*n,y:pR*n+o},{x:e+CR*n,y:mR*n+o},{x:r,y:fR*n+o},i]}(l,s,i);break;default:throw Error(`drawCheckMark: unsupported image type = ${a}`)}Kh(e,n,o,r)}(e,t,r,i);break;case _y.SymbolMedium:case _y.CircleSymbolMedium:!function(e,t,n,o){const{image:r}=t;switch(r){case _y.SymbolMedium:!function(e,t,n,o){const{size:r,left:i,bottom:l}=t,s=Math.floor(r*BR),a=Math.floor(r*DR),c=Math.floor(r*MR),u=s+Math.max(kR,Math.floor(OR*r)),d=i+Math.floor(AR*r);rv(e,d,l-(r-s),s,c,n,o),function(e,t,n,o,r,i,l,s,a){ju(e,{left:t,bottom:n-(o-a-r),outerColor:s,height:r,width:i,innerColor:l})}(e,d,l,r,a,c,n,o,u)}(e,t,n,o);break;case _y.CircleSymbolMedium:!function(e,t,n,o){const{size:r,left:i,bottom:l,image:s}=t,a=r-2*LR,c=Math.floor(a*HR),u=function(e){const t=Math.floor(e*PR);return t%2==0?t-1:t}(c),d=i+r/2,h=Math.round(d-(u+1)/2),f=l-LR,g=function(e){const t=Math.floor(e*ER);return t%2==0?t:t-1}(a),m=function(e,t,n){return e+Vu-(t-n)/2}(h,g,u),C={image:s,bottom:f,highContrastScheme:void 0,left:m,size:g};rv(e,h,Math.floor(l-LR-(g+1)),c,u,n,o),jI(e,C,o,n)}(e,t,n,o);break;default:throw Error(`drawExclamationMark: unsupported image type = ${r}`)}}(e,t,r,i);break;case _y.SymbolLow:case _y.CircleSymbolLow:!function(e,t,n,o){let r;const{size:i,left:l,bottom:s,image:a}=t;switch(a){case _y.SymbolLow:r=function(e,t,n){const o=t-n,r=vR*n,i=r+e,l=r+o,s=IR*n,a=s+e,c=s+o,u=FR*n,d=bR*n,h=d+e,f=d+o,g=xR*n,m={x:i,y:o};return[m,{x:e,y:l},{x:u+e,y:f},{x:e,y:c},{x:i,y:n+o},{x:h,y:g+o},{x:a,y:n+o},{x:e+n,y:c},{x:e+g,y:f},{x:e+n,y:l},{x:a,y:o},{x:h,y:u+o},m]}(l+Vu,s,i);break;case _y.CircleSymbolLow:r=function(e,t,n){const o=(w=n)%2==1?w+1:w,r=t-n,i=UR*o,l=i+e,s=i+r,a=$R*o,c=a+e,u=a+r,d=XR*o,h=qR*o,f=h+e,g=h+r,m=YR*o,C=JR*o,p={x:l,y:r+C};var w;return[p,{x:e+C,y:s},{x:d+e,y:g},{x:e+C,y:u},{x:l,y:o+r-C},{x:f,y:m+r},{x:c,y:o+r-C},{x:e+o-C,y:u},{x:e+m,y:g},{x:e+o-C,y:s},{x:c,y:r+C},{x:f,y:d+r},p]}(l,s,i);break;default:throw Error(`drawCrossMark: unsupported image type = ${a}`)}Kh(e,n,o,r)}(e,t,r,i);break;default:throw Error(`drawSymbols: unsupported image type = ${n}`)}}function rv(e,t,n,o,r,i,l){ju(e,{left:t,bottom:n,outerColor:l,height:o,width:r,innerColor:i})}function iv(e){let t=Math.round(NR*e);return t=t%2!=0?t+1:t,t}function lv(e){let t=Math.round(WR*e);return t=t%2!=0?t+1:t,t}function sv(e,t){Ca(e,"ctx","drawCircleSymbols"),Ca(t,"drawingContext","drawCircleSymbols"),t.size>0&&(VI(e,t),ov(e,function(e){const{left:t,bottom:n,image:o,highContrastScheme:r,size:i}=e,l=Math.round(t),s=Math.round(n);return{size:Math.round(i),left:l,bottom:s,image:o,highContrastScheme:r}}(t)))}function av(e,t,n,o,r){const i=function(e,t,n,o){const r=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:Fh(t),i=cm(r,n),l=t.CondFormat.Icon;return{size:i,image:zy[l.Set][l.Index],left:lT(e,t,i,r,n),bottom:iT(e,t,n,i),highContrastScheme:o}}(t,n,o,r),l=Py(t,n,i.left,i.bottom,i.size,!1);if(!(i.size<=4)){switch(pu(e,l),i.image){case _y.CircleLow:case _y.CircleMedium:case _y.CircleHigh:case _y.CircleEmpty:case _y.CircleFilled:case _y.FourCircleHigh:case _y.FourCircleLow:case _y.FourCircleMedium1:case _y.FourCircleMedium2:case _y.Circle25:case _y.CircleHalf:case _y.Circle75:VI(e,i);break;case _y.CircleSymbolHigh:case _y.CircleSymbolMedium:case _y.CircleSymbolLow:sv(e,i);break;case _y.TrafficHigh:case _y.TrafficMedium:case _y.TrafficLow:!function(e,t){Ca(e,"ctx","drawTrafficLightRimmed"),Ca(t,"drawingContext","drawTrafficLightRimmed");const{size:n,left:o,bottom:r,highContrastScheme:i}=t;let l=n;n%2==0&&(l=n-1);const s=function(e){return e?Qa(e.TextColor):tI}(i);ju(e,{left:o,bottom:r,outerColor:s,height:l,width:l,innerColor:void 0}),t.size=l;const a=function(e){const{image:t,left:n,bottom:o,highContrastScheme:r,size:i}=e;return{size:i-2*Gy,left:n+Gy+.5,bottom:o-Gy-.5,image:t,highContrastScheme:r}}(t);VI(e,a)}(e,i);break;case _y.SignalBarEmpty:case _y.SignalBarLow:case _y.SignalBarMedium1:case _y.SignalBarMedium2:case _y.SignalBarHigh:!function(e,t){Ca(e,"ctx","drawSignalBar"),Ca(t,"drawingContext","drawSignalBar");const{image:n,size:o,highContrastScheme:r}=t,i=Math.floor(o/5),l=function(e,t){const n=function(e){return e?Qa(e.BackgroundColor):nI}(t),o=function(e){return e?Qa(e.TextColor):oI}(t);switch(e){case _y.SignalBarEmpty:return[n,n,n,n];case _y.SignalBarLow:return[o,n,n,n];case _y.SignalBarMedium1:return[o,o,n,n];case _y.SignalBarMedium2:return[o,o,o,n];case _y.SignalBarHigh:return[o,o,o,o];default:throw Error(`getBarsColors: image: ${e} not supported`)}}(n,r);for(let n=0;n<l.length;n++)ju(e,qI(n,l[n],i,t));r&&function(e,t,n,o){const{left:r,bottom:i,highContrastScheme:l}=n,s=function(e,t,n,o){const r=function(e){switch(e){case _y.SignalBarEmpty:case _y.SignalBarLow:return 0;case _y.SignalBarMedium1:return 1;case _y.SignalBarMedium2:return 2;case _y.SignalBarHigh:return 3;default:throw Error(`getSeperators: image: ${e} not supported`)}}(e),i=[];let l=n-2*o+Vu,s=t+2*o+Vu;for(let e=0;e<r;e++)i.push({X:s,startY:l,endY:n-1.5}),l-=o,s+=o;return i}(e,r,i,o);t.strokeStyle=Qa(l.BackgroundColor),t.beginPath();for(let e=0;e<s.length;e++)Su(t,s[e].X,s[e].startY,s[e].X,s[e].endY);t.stroke()}(n,e,t,i)}(e,i);break;case _y.QuadrantEmpty:case _y.Quadrant25:case _y.QuadrantHalf:case _y.Quadrant75:case _y.QuadrantFull:!function(e,t){Ca(e,"ctx","drawQuadrantBoxes"),Ca(t,"drawingContext","drawQuadrantBoxes");const{image:n,size:o,highContrastScheme:r}=t,i=Math.floor(o/2),l=function(e,t){const n=function(e){return e?Qa(e.TextColor):oI}(t),o=function(e){return e?Qa(e.BackgroundColor):nI}(t);switch(e){case _y.QuadrantEmpty:return[[o,o],[o,o]];case _y.Quadrant25:return[[n,o],[o,o]];case _y.QuadrantHalf:return[[n,n],[o,o]];case _y.Quadrant75:return[[n,n],[n,o]];case _y.QuadrantFull:return[[n,n],[n,n]];default:throw Error(`getBoxesColors: image: ${e} not supported`)}}(n,r);for(let n=0;n<l.length;n++)for(let o=0;o<l.length;o++)ju(e,XI(n,o,l[n][o],i,t));r&&function(e,t,n,o){const{left:r,bottom:i,highContrastScheme:l}=t,s=r+n+Vu,a=i-n-Vu,c=function(e,t,n,o){switch(e){case _y.QuadrantEmpty:return[];case _y.Quadrant25:return[{x:t,y:n+o-Vu},{x:t-o+Vu,y:n}];case _y.QuadrantHalf:return[{x:t+o,y:n},{x:t,y:n+o-Vu},{x:t-o+Vu,y:n}];case _y.Quadrant75:case _y.QuadrantFull:return[{x:t,y:n-o+Vu},{x:t+o-Vu,y:n},{x:t,y:n+o-Vu},{x:t-o+Vu,y:n}];default:throw Error(`getSeparatorsCoordinates: image: ${e} not supported`)}}(o,s,a,n);e.strokeStyle=Qa(l.BackgroundColor),e.beginPath();for(let t=0;t<c.length;t++)Su(e,s,a,c[t].x,c[t].y);e.stroke()}(e,t,i,n)}(e,i);break;case _y.FlagHigh:case _y.FlagMedium:case _y.FlagLow:!function(e,t){Ca(e,"ctx","drawFlags"),Ca(t,"drawingContext","drawFlags");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t,s=Math.floor(o/2),a=Math.floor(o/3),c=function(e,t){if(t)return function(e,t){if(e===_y.FlagHigh)return Qa(t.TextColor)}(e,t);switch(e){case _y.FlagHigh:return dI;case _y.FlagMedium:return cI;case _y.FlagLow:return sI;default:throw Error(`getFlagInnerColor: unsupported image type = ${e}`)}}(n,l),u=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.FlagHigh:return uI;case _y.FlagMedium:return aI;case _y.FlagLow:return lI;default:throw Error(`getFlagOuterColor: unsupported image type = ${e}`)}}(n,l);!function(e,t,n,o,r,i){const{left:l,bottom:s,image:a,highContrastScheme:c}=i,u={left:l,bottom:s-t,outerColor:r,height:t,width:n,innerColor:o};ju(e,u),a===_y.FlagMedium&&c&&YI(e,u)}(e,s,a,c,u,t),function(e,t,n,o,r,i){const{left:l,bottom:s,size:a,image:c,highContrastScheme:u}=i,d={left:l+n,bottom:s-t+Math.floor(a/8),outerColor:r,height:t,width:n,innerColor:o};ju(e,d),c===_y.FlagMedium&&u&&YI(e,d)}(e,s,a,c,u,t),function(e,t,n,o,r){const i=o-Vu,l=i-n,s=t+Vu;e.lineWidth=Vy,e.setLineDash(ps),e.strokeStyle=function(e){return e?Qa(e.TextColor):iI}(r),e.beginPath(),Su(e,s,i,s,l),e.stroke()}(e,r,2*s,i,l)}(e,i);break;case _y.TriangleHigh:case _y.TriangleMedium:case _y.TriangleLow:!function(e,t){Ca(e,"ctx","drawTriangleSet"),Ca(t,"drawingContext","drawTriangleSet");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t;switch(n){case _y.TriangleHigh:case _y.TriangleLow:const s=function(e){const{image:t,left:n,bottom:o,size:r,highContrastScheme:i}=e,l=Math.floor(r/2),s=Math.floor(r/4),a=o-s-Vu,c=n+Vu;switch(t){case _y.TriangleHigh:return{outerColor:ZI(t,i),innerColor:ev(t,i),left:c,bottom:a,height:l,width:r};case _y.TriangleLow:return{outerColor:ZI(t,i),innerColor:ev(t,i),left:n+Vu,bottom:o-s-l-Vu,height:l,width:r};default:throw Error(`getTriangleDrawingContext: unsupported image type = ${t}`)}}(t);JI(e,s,n===_y.TriangleLow);break;case _y.TriangleMedium:{const t=Math.floor(o/3);ju(e,{left:r,outerColor:ZI(n,l),innerColor:ev(n,l),bottom:i-t,height:t,width:o});break}default:throw Error(`drawTriangleSet: unsupported image type = ${n}`)}}(e,i);break;case _y.StarHigh:case _y.StarMedium:case _y.StarLow:!function(e,t){Ca(e,"ctx","drawStarIcon"),Ca(t,"drawingContext","drawStarIcon");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t,s=Math.floor(o/2);if(s<=1)return;const a=function(e,t,n){const o=n*Jy,r=e+n+.5,i=o*$y,l=o*Xy,s=n*qy,a=o*qy,c=o*Yy,u=n*$y,d=n*Xy,h=t-n+(l-(Math.floor(l)+Vu)),f=h-l,g=h+c,m=h+d;return{topOuter:{x:r,y:h-n},topRightInner:{x:r+i,y:f},topRightOuter:{x:r+s,y:f},middleRightInner:{x:r+a,y:g},bottomRightOuter:{x:r+u,y:m},bottomInner:{x:r,y:h+o},bottomLeftOuter:{x:r-u,y:m},middleLeftInner:{x:r-a,y:g},topLeftOuter:{x:r-s,y:f},topLeftInner:{x:r-i,y:f}}}(r,i,s),c=function(e,t){if(t)return function(e,t){switch(e){case _y.StarHigh:case _y.StarMedium:return Qa(t.TextColor);case _y.StarLow:return;default:throw Error(`getStarLeftInnerColorHighContrast: unsupported image type = ${e}`)}}(e,t);switch(e){case _y.StarHigh:case _y.StarMedium:return SI;case _y.StarLow:return RI;default:throw Error(`getStarLeftInnerColor: unsupported image type = ${e}`)}}(n,l),u=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.StarHigh:case _y.StarMedium:return wI;case _y.StarLow:return yI;default:throw Error(`getStarLeftOuterColor: unsupported image type = ${e}`)}}(n,l),d=function(e,t){if(t)return function(e,t){switch(e){case _y.StarHigh:return Qa(t.TextColor);case _y.StarLow:case _y.StarMedium:return;default:throw Error(`getStarRightInnerColorHighContrast: unsupported image type = ${e}`)}}(e,t);switch(e){case _y.StarHigh:return SI;case _y.StarMedium:case _y.StarLow:return RI;default:throw Error(`getStarRightInnerColor: unsupported image type = ${e}`)}}(n,l),h=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.StarHigh:return wI;case _y.StarMedium:case _y.StarLow:return yI;default:throw Error(`getStarRightOuterColor: unsupported image type = ${e}`)}}(n,l),f=n===_y.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,a),f&&(Jh(e,d,h),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,a),Jh(e,c,u)}(e,i);break;case _y.SignLow:case _y.SignMedium:!function(e,t){Ca(e,"ctx","drawSigns"),Ca(t,"drawingContext","drawSigns");const{image:n}=t;switch(n){case _y.SignLow:!function(e,t){const{image:n,highContrastScheme:o}=t,r=tv(n,o),i=nv(n,o),l=function(e){const{size:t,left:n,bottom:o}=e,r=Math.floor(t/2),i=n+r+Vu,l=o-r-Vu;return{top:{x:i,y:l-r},right:{x:i+r,y:l},bottom:{x:i,y:l+r},left:{x:i-r,y:l}}}(t);e.beginPath(),e.moveTo(l.top.x,l.top.y),e.lineTo(l.right.x,l.right.y),e.lineTo(l.bottom.x,l.bottom.y),e.lineTo(l.left.x,l.left.y),e.lineTo(l.top.x,l.top.y),Jh(e,r,i)}(e,t);break;case _y.SignMedium:{const n=function(e){const{left:t,bottom:n,size:o,highContrastScheme:r,image:i}=e,l=t+Vu,s=n-Vu,a=tv(i,r);return{outerColor:nv(i,r),innerColor:a,left:l,bottom:s,height:o,width:o}}(t);JI(e,n,!1);break}default:throw Error(`drawSigns: unsupported image type = ${n}`)}}(e,i);break;case _y.SymbolHigh:case _y.SymbolMedium:case _y.SymbolLow:ov(e,i);break;case _y.ColoredArrowDown:case _y.ColoredArrowDownRight:case _y.ColoredArrowRight:case _y.ColoredArrowUp:case _y.ColoredArrowUpRight:case _y.GrayArrowDown:case _y.GrayArrowDownRight:case _y.GrayArrowRight:case _y.GrayArrowUp:case _y.GrayArrowUpRight:!function(e,t){Ca(e,"ctx","drawArrows"),Ca(t,"drawingContext","drawArrows");const{image:n,size:o,left:r,bottom:i,highContrastScheme:l}=t,s=function(e,t){if(t)return Qa(t.TextColor);switch(e){case _y.GrayArrowDown:case _y.GrayArrowDownRight:case _y.GrayArrowRight:case _y.GrayArrowUp:case _y.GrayArrowUpRight:return BI;case _y.ColoredArrowUp:return LI;case _y.ColoredArrowDown:return NI;case _y.ColoredArrowUpRight:case _y.ColoredArrowRight:case _y.ColoredArrowDownRight:return WI;default:throw Error(`getArrowOuterColor: unsupported image type = ${e}`)}}(n,l),a=function(e,t){if(t)return function(e,t){switch(e){case _y.GrayArrowDown:case _y.GrayArrowDownRight:case _y.GrayArrowRight:case _y.GrayArrowUp:case _y.GrayArrowUpRight:return Qa(t.TextColor);case _y.ColoredArrowUp:case _y.ColoredArrowDown:case _y.ColoredArrowUpRight:case _y.ColoredArrowRight:case _y.ColoredArrowDownRight:return Qa(t.BackgroundColor);default:throw Error(`getArrowHighContrastInnerColor: unsupported image type = ${e}`)}}(e,t);switch(e){case _y.GrayArrowDown:case _y.GrayArrowDownRight:case _y.GrayArrowRight:case _y.GrayArrowUp:case _y.GrayArrowUpRight:return kI;case _y.ColoredArrowUp:return PI;case _y.ColoredArrowDown:return EI;case _y.ColoredArrowUpRight:case _y.ColoredArrowRight:case _y.ColoredArrowDownRight:return HI;default:throw Error(`getArrowInnerColor: unsupported image type = ${e}`)}}(n,l);let c=[];switch(n){case _y.GrayArrowDown:case _y.ColoredArrowDown:c=function(e,t,n){const o=WR*n,r=iv(n),i=Math.floor(n/2+e)+Vu,l=Math.round(t),s=i+o*Math.cos(-3*jR),a=l+o*Math.sin(-3*jR),c=s+r*Math.cos(-jR),u=a+r*Math.sin(-jR),d=i-r/2,h=u+o/2*Math.sin(jR),f=h-o,g=d+r,m=f,C=g,p=h,w=i+(i-c),S=u,y=i+(i-s),R=a,T={x:i,y:l};return[T,{x:s,y:a},{x:c,y:u},{x:d,y:h},{x:d,y:Math.round(f)-Vu},{x:g,y:Math.round(m)-Vu},{x:C,y:p},{x:w,y:S},{x:y,y:R},T]}(r,i,o);break;case _y.GrayArrowUp:case _y.ColoredArrowUp:c=function(e,t,n){const o=t-n,r=WR*n,i=iv(n),l=Math.floor(n/2+e)+Vu,s=Math.round(o),a=l+r*Math.cos(3*jR),c=s+r*Math.sin(3*jR),u=a+i*Math.cos(jR),d=c+i*Math.sin(jR),h=l-i/2,f=d+r/2*Math.sin(-jR),g=f+r,m=h+i,C=g,p=m,w=f,S=l+(l-u),y=d,R=l+(l-a),T=c,I={x:l,y:s};return[I,{x:a,y:c},{x:u,y:d},{x:h,y:f},{x:h,y:Math.round(g)-Vu},{x:m,y:Math.round(C)-Vu},{x:p,y:w},{x:S,y},{x:R,y:T},I]}(r,i,o);break;case _y.GrayArrowRight:case _y.ColoredArrowRight:c=function(e,t,n){const o=t-n,r=WR*n,i=iv(n),l=Math.round(e+n),s=Math.floor(n/2+o)+Vu,a=l+r*Math.cos(-3*jR),c=s+r*Math.sin(-3*jR),u=a+i*Math.cos(3*jR),d=c+i*Math.sin(3*jR),h=u+r/2*Math.cos(jR),f=s-i/2,g=h-r,m=f,C=g,p=m+i,w=h,S=s+(s-f),y=u,R=s+(s-d),T=a,I=s+(s-c),v={x:l,y:s};return[v,{x:a,y:c},{x:u,y:d},{x:h,y:f},{x:Math.round(g)+Vu,y:m},{x:Math.round(C)+Vu,y:p},{x:w,y:S},{x:y,y:R},{x:T,y:I},v]}(r,i,o);break;case _y.GrayArrowDownRight:case _y.ColoredArrowDownRight:c=function(e,t,n){const o=t-n,r=Math.round(NR*n),i=lv(n),l=Math.floor(_R*n+e)+Vu,s=Math.floor(zR*n+o)+Vu,a=l,c=s-i,u=a-r,d=c,h=u,f=s-r-r/Math.sqrt(2),g=h+i*Math.cos(-3*jR),m=f+i*Math.sin(-3*jR),C=l-i,p=s,w=C,S=p-r,y={x:l,y:s};return[y,{x:a,y:c},{x:u,y:d},{x:h,y:f},{x:g,y:m},{x:g+r*Math.cos(3*jR),y:m+r*Math.sin(3*jR)},{x:l-r-r/Math.sqrt(2),y:S},{x:w,y:S},{x:C,y:p},y]}(r,i,o);break;case _y.GrayArrowUpRight:case _y.ColoredArrowUpRight:c=function(e,t,n){const o=t-n,r=Math.round(NR*n),i=lv(n),l=Math.floor(GR*n+e)+Vu,s=Math.floor(VR*n+o)+Vu,a=l-i,c=s,u=a,d=c+r,h=l-r-r/Math.sqrt(2),f=d,g=h+i*Math.cos(3*jR),m=f+i*Math.sin(3*jR),C=l,p=s+i,w=C-r,S=p,y={x:l,y:s};return[y,{x:a,y:c},{x:u,y:d},{x:h,y:f},{x:g,y:m},{x:g+r*Math.cos(jR),y:m+r*Math.sin(jR)},{x:w,y:s+r+r/Math.sqrt(2)},{x:w,y:S},{x:C,y:p},y]}(r,i,o);break;default:throw Error(`drawArrows: unsupported image type = ${n}`)}Kh(e,a,s,c)}(e,i);break;default:throw Error(`drawConditionalFormattingIcon: imageType: ${i.image} not supported`)}wu(e,l)}}function cv(e,t){e.lineWidth=uv(t),e.setLineDash(ps),e.strokeStyle=$s(t.highContrastScheme)?Jl:`${Qa(t.highContrastScheme.TextColor)}`}function uv(e){return Va(e)?os:ts}function dv(e,t,n,o,r,i,l){const s=o.Index,a=o.Min,c=o.Max;if(!fv(s,a,c,n.renderingRegion,!0))return;const u=t.ClientOnlyCache,d=mv(u.RowOffsetsAdjustedForDrawing,s,r,l);Su(e,-1===o.Min?0:gv(u.ColOffsetsAdjustedForDrawing,a,r,i),d,-1===o.Max?t.BlockWidth*n.scaleFactor:gv(u.ColOffsetsAdjustedForDrawing,c,r,i),d)}function hv(e,t,n,o,r,i,l){const s=o.Index,a=o.Min,c=o.Max;if(!fv(s,a,c,n.renderingRegion,!1))return;const u=t.ClientOnlyCache,d=gv(u.ColOffsetsAdjustedForDrawing,s,r,i);Su(e,d,-1===o.Min?0:mv(u.RowOffsetsAdjustedForDrawing,a,r,l),d,-1===o.Max?t.BlockHeight*n.scaleFactor:mv(u.RowOffsetsAdjustedForDrawing,c,r,l))}function fv(e,t,n,o,r){let i=r?o.startRow:o.startColumn,l=r?o.endRow:o.endColumn;return i<=(s=e)&&s<=l&&(l=r?o.endColumn:o.endRow,!(-1!==t&&t>l||(i=r?o.startColumn:o.startRow,-1!==n&&n<i)));var s}function gv(e,t,n,o){return t>=0?Xu(e[t],du(t,e),n,o):0}function mv(e,t,n,o){return t>=0?Xu(e[t],hu(t,e),n,o):0}function Cv(e,t,n,o,r,i,l){const s=t.ClientOnlyCache,a=l.FirstColumn<=0?-1:Xu(s.ColOffsetsAdjustedForDrawing[l.FirstColumn],0,o,i),c=l.FirstRow<=0?-1:Xu(s.RowOffsetsAdjustedForDrawing[l.FirstRow],0,o,r),u=l.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*n.scaleFactor+1:Xu(s.ColOffsetsAdjustedForDrawing[l.LastColumn],du(l.LastColumn,s.ColOffsetsAdjustedForDrawing),o,i),d=l.LastRow>=t.RowNumbers.length?t.BlockHeight*n.scaleFactor+1:Xu(s.RowOffsetsAdjustedForDrawing[l.LastRow],hu(l.LastRow,s.RowOffsetsAdjustedForDrawing),o,r);e.rect(a,c,u-a,d-c)}function pv(e,t,n){const o=Oa(1);e.lineWidth=1,e.fillStyle=e.strokeStyle=n?Qa(n.TextColor):pg,e.strokeRect(t.x+o,t.y+o,t.width,t.height)}function wv(e,t,n,o){const r=n?Qa(n.TextColor):"#969696";e.font=Rh(t,void 0,o),e.fillStyle=r,e.textBaseline=qs,e.textAlign="center"}function Sv(e,t,n){const o=yv(e,t,n),r=ym(e,t,!1),i=Sm(e,t,!1),l=t.OriginPTWidthAdjustedForDrawing,s=t.OriginPTHeightAdjustedForDrawing,a=o.y+o.height,c=i+s,u=o.width,d=c-a-48*n,h=Math.min(u,vg*d),f=Math.min(d,u/vg),g=(a+c)/2;return{x:r+Math.round((l-h)/2),y:Math.round(g-f/2),width:h,height:f}}function yv(e,t,n){const o=Math.round(t.OriginPTWidthAdjustedForDrawing*Tg);return{x:vv(e,t,o),y:Tv(e,t,n),width:o,height:Math.round(yg*n)}}function Rv(e,t){const n=Math.round(t.OriginPTWidth*Tg);return{x:bv(e,t,n),y:Iv(e,t),width:n-wg,height:yg-wg}}function Tv(e,t,n){return Sm(e,t,!1)+Math.round(Sg*n)}function Iv(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+Sg+wg}function vv(e,t,n){const o=Math.floor((t.OriginPTWidthAdjustedForDrawing-n)/2);return ym(e,t,!1)+o}function bv(e,t,n){const o=(t.OriginPTWidth-n)/2+wg;return function(e,t){const n=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-n[t.FirstColIndex]-t.OriginPTWidth:n[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+o}!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(zI||(zI={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(GI||(GI={}));const xv=1,Fv=1,Dv=2,Mv=1,Av=1,Ov=0,Bv=1,kv=[3,1];function Pv(e,t,n,o){if(function(e){return e>0&&e<100}(e))return{X:t+n-Oa(ts),startY:o.y+ts,endY:o.y+o.height-ts}}function Ev(e,t,n,o,r){let i=Math.round(t.width*e/100);o&&(i=-i);const l=r&&i<0?Mv:0,s=Math.min(n,n+i),a=t.x+s,c=Math.max(Math.abs(i)-l,0);return{x:a,y:t.y,width:c,height:t.height}}function Hv(e,t){return t.information.GradientColor?function(e,t){const n=function(e){const t=e.bar,n=t.x,o=n+t.width,r=e.axis?.X;return($s(r)?e.isRtl:n<r)?{startX:o,endX:n,Y:t.y}:{startX:n,endX:o,Y:t.y}}(t),o=e.createLinearGradient(n.startX,n.Y,n.endX,n.Y);return o.addColorStop(Ov,t.information.Color),o.addColorStop(Bv,t.information.GradientColor),o}(e,t):t.information.Color}function Lv(e,t,n,o){e.lineWidth=t,e.setLineDash(n),e.strokeStyle=o}function Nv(e,t,n){n!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function Wv(e,t){const n=_v(xv,t),o=_v(Fv,t),r=_v(Dv,t);return{x:e.x+n+ts,y:e.y+n+ts,width:Math.max(0,e.width-2*n-2*ts),height:Math.max(0,e.height-o-r-2*ts)}}function _v(e,t){return Math.max(e,Math.round(e*t))}function zv(e,t,n,o){Ca(e,"ctx","drawDynamicImages"),Ca(t,"model","drawDynamicImages"),Ca(n,"context","drawDynamicImages");const r=function(e,t){switch(t){case oa.Sparkline:return e.Sparklines;case oa.InCellImage:return e.InCellImages;default:throw Error(`getDynamicImages: unsupported image type = ${t}`)}}(t,o);if($s(r))return;const i=t.ClientOnlyCache.CellsToRender,l=function(e,t,n,o,r){const i=ua(e,o),l=fa(i);return!l||l.version===t&&l.url===n||ma(i),aa(i,r,t,n)}(o,r.Version,r.ImageUrl,n.blockIdentifier,n.blockIdentifier);if(l)for(let r=0;r<i.length;r++){const s=i[r];if(!Ru(s,n.renderingRegion))continue;const a=lc(s,o);$s(a)||n.isFormulaView&&!$s(s.FormulaInfo)||Ec(s.PreviewText)||s.ShowSkeleton||Gv(e,t,n,s,l,a,o)}}function Gv(e,t,n,o,r,i,l){const s=function(e){switch(e){case oa.Sparkline:return 0;case oa.InCellImage:return ts;default:throw Error(`marginForImageType: unsupported image type = ${e}`)}}(l),a=n.scaleFactor,c=a*(o.Merge?.OriginDeltaX??0),u=a*(o.Merge?.OriginDeltaY??0),d=0===c?s:0,h=0===u?s:0,f=i.ClusterOffsetX,g=i.ClusterOffsetY,m=function(e,t,n,o,r){let i=0,l=0;return Vv(r)?(i=r.ClusterImageWidth??0,l=r.ClusterImageHeight??0):(i=Zh(e,o,!1)-t,l=ef(e,o,!1)-n),{imageWidth:i,imageHeight:l}}(t,d,h,o,i),C=function(e,t,n,o,r,i){let l=0,s=0;return Vv(i)?(l=i.Width?i.Width*o-t:0,s=i.Height?i.Height*o-n:0):(l=lf(e,r)-t,s=sf(e,r)-n),{imageWidth:l,imageHeight:s}}(t,d,h,a,o,i),p=function(e,t,n,o,r,i,l,s){if(!Vv(s))return{left:0,right:0,top:0,bottom:0};const a=!!e.PivotTable?.HasExpandCollapseIndicator,c=a?xg*l:0,u=mm(a)*l,d=lf(t,e)-r,h=function(e,t,n,o,r,i,l){let s=0,a=0;if(n<=t+r+o)return{left:s,right:a};const c=n-t-o-r;switch(e){case Ht.Right:s=c;break;case Ht.Center:s=a=c/2;break;case Ht.Automatic:case Ht.Left:a=n-t-r}return i?a+=l?o+r:0:s+=l?o+r:0,{left:s,right:a}}(Xh(t,e),n,d,c,u,t.IsRtl,a),f=sf(t,e)-i,g=function(e,t,n){let o=0,r=0;if(t>n)return{top:o,bottom:r};const i=n-t;switch(e){case Lt.Top:r=i;break;case Lt.Center:o=r=i/2;break;case Lt.Bottom:default:o=i}return{top:o,bottom:r}}(e.CachedStyle?.VerticalAlignment??Lt.Bottom,o,f);return{left:h.left,right:h.right,top:g.top,bottom:g.bottom}}(o,t,C.imageWidth,C.imageHeight,d,h,a,i),w=af(t,o,!1,!0)-c+p.left,S=gf(t,o,!0)-u+p.top,y=lf(t,o)-d-p.right,R=sf(t,o)-h-p.bottom,T={x:w,y:S,width:y,height:R},I=function(e,t,n,o,r,i,l){if(!Vv(l))return{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:o};return r<n&&(e*=1-(n-r)/n,n=r),i<o&&(t*=1-(o-i)/o,o=i),{clusterImageWidth:e,clusterImageHeight:t,imageWidth:n,imageHeight:o}}(m.imageWidth,m.imageHeight,C.imageWidth,C.imageHeight,y,R,i);e.drawImage(r,f,g,I.clusterImageWidth,I.clusterImageHeight,w,S,I.imageWidth,I.imageHeight),function(e,t,n,o){if(!yo(Vt.ShowDynamicImageCardOnHover,e))return;const r=jo(e,cc(n.renderingRegion)),i=kg(e,n,o,e.IsRtl);Pf(t,r,i,JS,Cn.DynamicImage);const l=Hg(e,t,!0,!0),s=Hg(e,t,!1,!1);kf(t,r,i,Cn.DynamicImage,l,"mouseenter"),kf(t,r,i,Cn.DynamicImage,s,"mouseleave")}(t,o,n,T)}function Vv(e){return!!(e.ClusterImageWidth&&e.ClusterImageHeight&&e.Width&&e.Height)}const jv=1,Uv=1,$v=.5;function qv(e,t,n,o,r,i){const l=o.width;let s;i&&(s=Py(t,n,o.left,o.bottom,l,!0)),pu(e,s),ju(e,o);const a=o.bottom-l;r?Yv(e,o,a,l):function(e,t,n,o){Yv(e,t,n,o),function(e,t,n,o){const r=t+Math.round(o/2)+$v,i=n+jv,l=n+o-jv-Uv;e.beginPath(),Su(e,r,i,r,l),e.stroke()}(e,t.left,n,o)}(e,o,a,l),wu(e,s)}function Xv(e,t){const n=Math.floor(t*e);return n%2==0?n:n-1}function Yv(e,t,n,o){const r=Math.round(n+o/2)-$v,i=t.left+jv+Uv,l=t.left+o-Uv;e.strokeStyle=t.outerColor,e.beginPath(),Su(e,i,r,l,r),e.stroke()}function Jv(e,t,n,o){return function(e){return!!(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)}(n)?Math.ceil(n.CachedDrawingLayout.CellTextLayout.Width*o):Math.ceil(hp(e,t,n)*o)}function Kv(e,t,n){return!(!n?.PivotTable||!n?.PivotTable.CanExpandCollapse||!Ru(n,t.renderingRegion)||Ec(n.PreviewText)||n.ShowSkeleton||n.CondFormat?.Icon?.IconOnly&&!Im(n,lf(e,n),t.scaleFactor))}function Qv(e,t,n,o){return gu(Zh(e,t,!1),YC(e,t),n,gm(t),0)*o}function Zv(e,t,n,o){const r=t.PivotTable,i=!!r.ConfirmRequired,l=e.RowNumbers[t.Row]-1,s=e.ColumnNumbers[t.Col]-1,a=e=>{var t,n,o,a,c;return t=e,n=i,o=l,a=s,c=r.SourceIndex,Ca(md,"externalCallbacks","togglePivotDrill"),md.togglePivotDrillCallback(t,n,o,a,c),!0},c=yf(e,t,!0),u=function(e,t,n){return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:n,isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,c),d=jo(e,cc(n.renderingRegion));if(eb(t,d,u,ZS,a),o&&function(e,t){return!(e.x+e.width<t.left)&&(!(e.x>t.left+t.width)&&(!(e.y>t.bottom)&&!(e.y+e.height<t.bottom-t.height)))}(c,o)){const i=function(e,t,n,o){const r=n.width,i=n.left,l=n.bottom-r,s=r,a=r,c=Math.min(s,o.x+o.width-i),u=Math.max(l,o.y),d=Math.min(l+a,o.y+o.height)-u;return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:Math.max(i,o.x),y:u,width:c,height:d},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,o,c);eb(t,d,i,QS,a),Ef(t,d,i,r.ECButtonTitle,Cn.DrillIndicator),Pf(t,d,i,YS,Cn.DrillIndicator)}}function eb(e,t,n,o,r){kf(e,t,n,Cn.DrillIndicator,r,o),kf(e,t,n,Cn.DrillIndicator,ey,"touchstart")}function tb(e,t,n,o){const{scaleFactor:r}=n,i=Xv(r,bg),l=Jv(e,t,o,r),s=Zs(o),a=function(e,t,n,o,r,i){const{scaleFactor:l}=n,s=xg*l;if(i)return e.IsRtl?Math.floor(uf(e,t,!1)-s)-o:Math.floor(af(e,t,!1,!1)+s);let a=vp(e,t,n.zoom,n.devicePixelRatio),c=0;if(Fn(Sn.FixCellImageAlignmentWithRichPivotDrill)){const e=lc(t,oa.InCellImage);e?.Width&&(c=e?.Width*l)}let u=0;a>0&&t.RichValueIcon&&!t.CondFormat?.Icon&&(u=a*l,a=0);const d=t.CachedIndent||Fg,h=bp(t,d),f=Xh(e,t);if(function(e,t,n,o,r){if(!t.WrapText)return!1;const i=Qv(e,t,n,r);return t.WrapText&&i<o}(e,t,a,r,l))return function(e,t,n,o,r,i,l,s){const a=function(e,t){return t?e===Ht.Right:e===Ht.Center||e===Ht.Left}(n,e.IsRtl),c=a?bp(t,o)*s:Fg;if(e.IsRtl){const o=uf(e,t,!1);return t.WrapText&&c===Fg&&n===Ht.Left&&l<=0?Math.floor(o):Math.min(Math.floor(o-r-i-c),o)}return Math.floor(af(e,t,!1,!1)+r+c)}(e,t,f,d,s,o,Qv(e,t,a,l),l);const g=up(e,t,n)*l;switch(f){case Ht.Left:if(e.IsRtl)return Math.min(Math.floor(g+r+c+s),t.RichValueIcon?Math.floor(uf(e,t,!1)-s)-o:Number.MAX_VALUE);const n=(h+a+xg)*l;return Math.floor(af(e,t,!1,!1)+n);case Ht.CenterAcrossSelection:case Ht.Center:return e.IsRtl?Math.min(Math.floor(g+r/2+c/2+s),t.RichValueIcon?Math.floor(uf(e,t,!1)-s)-o:Number.MAX_VALUE):Math.max(Math.floor(g-r/2-c/2-u-s)-o,af(e,t,!1,!1));case Ht.Right:return e.IsRtl?Math.floor(uf(e,t,!1)-s-h*l)-o:Math.max(Math.floor(g-r-c-u-s)-o,af(e,t,!1,!1));default:throw Error(`getAdjustedButtonLeft: unsupported horizontalAlignment: ${f}`)}}(t,o,n,i,l,s),c=function(e,t,n,o,r){if(r)return Math.floor(hf(e,t)-o/2);const i=t.CachedStyle?.VerticalAlignment;if(i===Lt.Justify)return Math.floor(Math.floor(hf(e,t)-o/2));const l=function(e,t,n,o){const r=Sp(t,e);return tp(t,e,r,ef(e,t,!1)-ts,n,void 0).absoluteY*o+Ql-r*o/2/2}(e,t,i,n);return Math.round(l-o/2)}(t,o,r,i,s),u=n.highContrastScheme;return{outerColor:u?Qa(u.TextColor):"#3A3A38",innerColor:u?Qa(u.BackgroundColor):"#FAFAFA",left:a,bottom:c+i,height:i,width:i}}function nb(e,t,n,o){return vp(e,t,n.zoom,n.devicePixelRatio)*n.scaleFactor+(t.Spill?cf(e,t):af(e,t,!1,!1))>o.left}function ob(e,t,n){const o=t.left,r=t.bottom-t.height;e.beginPath(),ib(e,o,r,n,!0,t),lb(e,t,Yg),e.stroke()}function rb(e,t,n){const o=t.left,r=t.bottom-t.height;e.beginPath(),lb(e,t,Kg),ib(e,o,r,n,!1,t),e.stroke()}function ib(e,t,n,o,r,i){const{width:l}=i,s=r?em:Zg,a=Oa(_g),c=sb(t,s.x,a,l),u=sb(n,o?s.y+Qg:s.y,a,l),d=ab(u,o?-Qg:Qg,l),h=ab(c,-1,l),f=ab(c,1,l),g=ab(d,o?1:-1,l);e.moveTo(c,u),e.lineTo(c,d),e.moveTo(h,g),e.lineTo(f,g)}function lb(e,t,n){if(!n||0===n.length)return;const o=t.left,r=t.bottom-t.height,i=n[0],l=Oa(_g);e.moveTo(sb(o,i.x,l,t.width),sb(r,i.y,l,t.width));for(let i=1;i<n.length;i++){const s=n[i];e.lineTo(sb(o,s.x,l,t.width),sb(r,s.y,l,t.width))}}function sb(e,t,n,o){return Math.round(ab(e,t,o))+n}function ab(e,t,n){return e+t/Ug*n}function cb(e,t,n){Ro(e,"ctx","drawAutoFilters"),Ro(t,"model","drawAutoFilters"),Ro(n,"context","drawAutoFilters");const o=Zc(),r=t.ClientOnlyCache.CellsToRender;let i=!1,l=o?void 0:gb(n.highContrastScheme),s=o?void 0:fb(n.highContrastScheme);const a=n.highContrastScheme;let c;!o&&a&&(c=mb(a,void 0));for(let u=0;u<r.length;u++){const d=r[u];IT(t,n,d,mn.EntireCell)&&ub(d,n)&&(i||(e.setLineDash(ps),e.lineWidth=_g,o&&(l=gb(a),s=fb(a),a&&(c=mb(a,void 0))),i=!0),a||(c=mb(a,d.AutoFilter?d.AutoFilter.Type:d.PivotFilter.Type)),db(e,t,d,n,l,s,c))}}function ub(e,t){const n=e.AutoFilter;if(!n&&!e.PivotFilter)return!1;if(!Ru(e,t.renderingRegion))return!1;if(e.PivotFilter)return e.PivotFilter.DisplayFilter;if(!n.RenderingContext)return!1;const{IsHidden:o,IsRenderingPermitted:r}=n.RenderingContext;return!(o||!r||Ec(e.PreviewText)||e.ShowSkeleton)}function db(e,t,n,o,r,i,l){const s=function(e,t,n,o,r){const i=n.devicePixelRatio,l=tm(e,t,i,n.zoom);return{bottom:sm(e,t,l,i,n.zoom),left:am(e,t,l,i,n.zoom),height:l,width:l,outerColor:o,innerColor:r,radius:[$g]}}(t,n,o,r,i);Uu(e,s);const a=n.PivotFilter,c=n.AutoFilter,u=!(!a||Fn(Sn.TakeAutoFilterBeforePivotFilter)&&c);s.width>qg&&function(e,t,n,o){switch(e.strokeStyle=o,t){case zt.Both:case zt.Filtered:!function(e,t){e.beginPath(),lb(e,t,Yg),lb(e,t,Kg),e.stroke()}(e,n);break;case zt.BothAsc:case zt.BothTop:!function(e,t){rb(e,t,!0)}(e,n);break;case zt.BothDesc:case zt.BothBottom:!function(e,t){rb(e,t,!1)}(e,n);break;case zt.SortedAsc:case zt.SortedTop:!function(e,t){ob(e,t,!0)}(e,n);break;case zt.SortedDesc:case zt.SortedBottom:!function(e,t){ob(e,t,!1)}(e,n);break;default:!function(e,t){e.beginPath(),lb(e,t,Xg),e.stroke()}(e,n)}}(e,u?a.Type:c.Type,s,l);const h=(f=u?a.Type:c.Type,md.getTooltipTitle(f));var f;if(function(e,t){const n=t.PivotFilter;if(n)return n.DisplayFilter&&!n.IsHeaderSnapped;if(!e.PermissionSet)return!1;const{IsAutoFilterDisabled:o,IsSortDisabled:r}=e.PermissionSet;return!(o&&r)}(t,n)){const e=hb(t,n),r=t.ColumnNumbers[n.Col],i=u?t=>(function(e,t,n,o,r){Ca(md,"externalCallbacks","showPivotFilterMenu"),md.pivotFilterClickHandlerCallback(e,t,n,o,r)}(t,a.CommandData,a.IsPivotPageField,e,r),!0):t=>(pd(t,Og().ShowAutoFilterMenu,c.CommandData,void 0,e,r),!0);!function(e,t,n,o,r,i,l){const s=Cb(e,n,o),a=jo(e,cc(n.renderingRegion)),c=l?pb:function(e,t){return n=>(md.loadAutoFilterServicesOnMouseEnter()?.then((()=>{(function(e,t){md.requestAndUpdateAutoFilterItems?.(e,t)})(hb(e,t),e.ColumnNumbers[t.Col])})).catch((e=>{Pn.sendTraceTag(506466834,En.msoulscat_ES_EWAJSGrid,d.Error,`Error loading auto filter services on mouse enter: ${e}`)})),!1)}(e,t),u=e=>!0;Pf(t,a,s,YS,Cn.AutoFilter),Ef(t,a,s,i,Cn.AutoFilter),kf(t,a,s,Cn.AutoFilter,r,"click"),kf(t,a,s,Cn.AutoFilter,r,"touchend"),kf(t,a,s,Cn.AutoFilter,u,"pointerdown"),kf(t,a,s,Cn.AutoFilter,u,"dblclick"),kf(t,a,s,Cn.AutoFilter,ey,"touchstart"),Hf(t,a,s,Cn.AutoFilter,c)}(t,n,o,s,i,h,u)}else{const e=Cb(t,o,s),r=jo(t,cc(o.renderingRegion));Ef(n,r,e,h,Cn.AutoFilter),Pf(n,r,e,JS,Cn.AutoFilter)}}function hb(e,t){const n=e.RowNumbers[t.Row];return void 0===e.IsRow||e.IsRow?n:-1}function fb(e){return e?Qa(e.BackgroundColor):Gg}function gb(e){return e?Qa(e.TextColor):zg}function mb(e,t){return e?Qa(e.TextColor):t===zt.None?Vg:jg}function Cb(e,t,n){return kg(e,t,{x:n.left,y:n.bottom-n.height,width:n.width,height:n.height},!1)}const pb=e=>(md.onPivotFilterMouseEnter(),!1),wb="#bd67c9",Sb="#808080",yb=8,Rb="#ff0000",Tb=4,Ib=2,vb=1.5;function bb(e,t,n,o){const r=Ng+Ib;return tm(e,t,n,o)+Math.round(r*n*o)}function xb(e,t,n,o){let r=Bg(yb,e,t,n,o,!0,!0);return Mb(e,t,r,n,o)&&(r=Db(e,t,r,n,o)),r%2==1?r-1:r}function Fb(e,t,n,o,r){let i=KI(e,t,n,o,r);return Mb(e,t,i,o,r)&&(i=Db(e,t,i,o,r)),i}function Db(e,t,n,o,r){const i=bb(e,t,o,r),l=uu(r*o),s=lf(e,t)-l-i;return Math.min(n,s)}function Mb(e,t,n,o,r){if(!t.Comment)return!1;const i=gf(e,t,!1);if(t.AutoFilter&&!t.AutoFilter.RenderingContext?.IsHidden||t.PivotFilter?.DisplayFilter){const l=tm(e,t,o,r);if(sm(e,t,l,o,r)-l-n<i)return!0}return!1}function Ab(e,t,n,o){let r=!1;const i=t.ClientOnlyCache.CellsToRender;for(let a=0;a<i.length;a++){const c=i[a];if(c.Comment&&c.Comment.IsThreadedComment){if(!!c.Comment.IsResolved!==o)continue;if(!Ob(c,n.renderingRegion))continue;const i=xb(t,c,n.devicePixelRatio,n.zoom);if(i<Tb)continue;r||(r=!0,e.fillStyle=(l=n.highContrastScheme,s=o,l?Qa(s?l.LinkColor:l.TextColor):s?Sb:wb),e.beginPath()),Bb(e,t,c,n,i,kb)}}var l,s;r&&e.fill()}function Ob(e,t){return!(Fn(Sn.HideCommentIndicators)&&e.Comment.IsThreadedComment&&e.Comment.HideCommentIndicator||!Ru(e,t))}function Bb(e,t,n,o,r,i,l){const s=function(e,t,n,o,r){const i=function(e,t,n,o,r){const i=Mb(e,t,n,o,r)?bb(e,t,o,r):0;return uf(e,t,e.IsRtl)-(n+i)}(e,t,n,o,r),l=function(e,t,n){return gf(e,t,!1)+n}(e,t,n);return{left:i,bottom:l,width:n,height:n,outerColor:void 0,innerColor:void 0}}(t,n,r,o.devicePixelRatio,o.zoom);i(e,s,l),function(e,t,n,o){const r=jo(e,cc(n.renderingRegion)),i=o.width,l=Math.min(lf(e,t),sf(e,t),i*vb),s=function(e,t,n,o,r){const i=af(e,t,e.IsRtl,!1),l=uf(e,t,e.IsRtl),s=n+o-r,a=n+r;return(i>s||a>l)&&i-s>=a-l?n:s}(e,t,o.left,o.width,l),a=kg(e,n,{x:s,y:o.bottom-o.height,width:l,height:l},e.IsRtl),c=Pg(e,t,!0,!0),u=Pg(e,t,!1,!1);Pf(t,r,a,JS,Cn.Comments),kf(t,r,a,Cn.Comments,c,"mouseenter"),kf(t,r,a,Cn.Comments,u,"mouseleave"),Fn(Sn.ShowCommentOnActiveCellOnTouchDevices)&&kf(t,r,a,Cn.Comments,c,"touchstart")}(t,n,o,s)}function kb(e,t){const{left:n,bottom:o,width:r,height:i}=t,l=function(e,t,n,o){return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+o},{x:e+n/2,y:t+o/2},{x:e,y:t+o/2},{x:e,y:t}]}(n,o-i,r,i);Ly(e,l)}function Pb(e,t,n,o){const r=jo(e,cc(n.renderingRegion)),i=Math.min(lf(e,t),sf(e,t),25*n.scaleFactor),l=kg(e,n,{x:o.left,y:o.bottom-o.height,width:i,height:i},e.IsRtl);let s=Og().CardViewShowTemporaryErrorCard;const a=Eg(e,t,s,!0);s=Og().CardViewHideTemporaryCard;const c=Eg(e,t,s,!1);Pf(t,r,l,JS,Cn.RichError),kf(t,r,l,Cn.RichError,a,"mouseenter"),kf(t,r,l,Cn.RichError,c,"mouseleave")}function Eb(e,t){return!!e.HasIgnorableError&&!!Ru(e,t.renderingRegion)}function Hb(e,t,n){return{left:af(e,t,e.IsRtl,!1),bottom:gf(e,t,!1)+n,width:n,height:n,outerColor:void 0,innerColor:void 0}}function Lb(e,t){return!(!e.RichValueIcon||!Ru(e,t.renderingRegion)||e.DisplayFormula||Bu(e,t)||Ec(e.PreviewText)||e.ShowSkeleton)}function Nb(e,t,n,o,r){n.RichValueIcon.Type===en.LinkedEntity?function(e,t,n){if(!t.RichValueIcon.Unicode)throw Error("drawUnicodeIcon: RichValueIconInformation does not have a char code value.");!function(e,t,n){const{x:o,y:r,height:i}=n,l=r+i;e.fillText(t,o,l)}(e,String.fromCharCode(t.RichValueIcon.Unicode),n)}(e,n,r):function(e,t,n,o){const r=sa(t.RichValueIcon.Type===en.Disambiguation?1:2,n.blockIdentifier);r&&e.drawImage(r,o.x,o.y,o.width,o.height)}(e,n,o,r),function(e,t,n,o){const r=o.y+o.height;let i;i=kg(e,n,Hy(e,t,o.x,o.width,!1)||Ey(e,t,r,o.width)?Ny(e,t,n,o):o,!1);const l=jo(e,cc(n.renderingRegion)),s=function(e){let t;const n=e.RichValueIcon.Type;return n===en.Disambiguation?t=cT.richValueIconDisambigTooltip:n!==en.Sync&&(t=cT.richValueIconShowCard),t}(t);Pf(t,l,i,YS,Cn.RichValueIcon),kf(t,l,i,Cn.RichValueIcon,(e=>({handled:!0,stopPropagation:!1})),"pointerdown"),kf(t,l,i,Cn.RichValueIcon,(e=>(pd(e,Og().CardViewShowDataCardOrDisambiguationPane,""),!0)),"click"),kf(t,l,i,Cn.RichValueIcon,ey,"touchstart"),kf(t,l,i,Cn.RichValueIcon,ty,"touchend"),s&&Ef(t,l,i,s,Cn.RichValueIcon)}(t,n,o,r)}function Wb(e,t,n,o,r){const i=Math.round(r*o.scaleFactor),l=function(e,t){if(e.PivotTable)return!0;if(t.PivotTables&&t.PivotTables.length>0)for(let n=0;n<t.PivotTables.length;n++){const o=t.PivotTables[n];if(!o.IsEmptyPivot&&!o.IsOlap&&e.Row>=o.FirstRowIndex&&e.Row<=o.LastRowIndex&&e.Col>=o.FirstColIndex&&e.Col<=o.LastColIndex)return!0}return!1}(n,t);let s=0;if(l)s=function(e,t,n,o,r){const i=ub(n,o),l=t.IsRtl&&i?nm(t,n,o.zoom,o.devicePixelRatio):0;let s=l+Dg+af(t,n,!1,!1),a=s;const c=Xh(t,n);let u=0;n.PivotTable?.HasExpandCollapseIndicator&&(u=Math.round(gm(n)*o.scaleFactor),t.IsRtl||c===Ht.Left||(s+=u));const d=n.CachedIndent||Fg,h=Math.round(bp(n,d)*o.scaleFactor),f=up(t,n,o)*o.scaleFactor,g=e.font;e.font=Rh(n.CachedFont,void 0,t);const m=Jv(e,t,n,o.scaleFactor);e.font!==g&&(e.font=g);const C=(r+Mg)*o.scaleFactor;switch(c){case Ht.Left:a=t.IsRtl?Math.max(Math.floor(f-C),s):Math.floor(l+u+xg*o.scaleFactor+h+af(t,n,!1,!1));break;case Ht.CenterAcrossSelection:case Ht.Center:t.IsRtl,a=Math.max(Math.floor(f-m/2-C),s);break;case Ht.Right:a=t.IsRtl?Math.max(Math.floor(uf(t,n,!1)-h-xg*o.scaleFactor-u-m-C),s):Math.max(Math.floor(f-m-C),s);break;default:throw Error(`getRichValueIconDrawingContext: unsupported horizontalAlignment: ${c}`)}return a}(e,t,n,o,r);else{const e=ub(n,o),r=Fn(Sn.RichIconFilterScale)?o.zoom:o.devicePixelRatio,i=Fn(Sn.RichIconFilterScale)?o.devicePixelRatio:o.zoom,l=Fn(Sn.RichIconFilterScale)?o.scaleFactor:1;s=(t.IsRtl&&e?tm(t,n,i,r)+Math.round((Wg+Dg)*l):Fn(Sn.AddHorizontalPaddingWithScaleFactor)?Math.round(Dg*l):Dg)+af(t,n,!1,!1)}const a=function(e,t,n,o){const r=cC(rT(e,t),lC.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),i=sT(e,t,n,o,r);let l;switch(l=Fn(Sn.CellIconBottomPadding)||t.RichValueIcon.Type!==en.LinkedEntity?Math.round(o*_s):0,r){case Lt.Bottom:case Lt.Top:return i-l;case Lt.Center:return aT(e,t,i,o)?Math.floor(hf(e,t)+o/2):i-l;default:throw Error(`getIconVerticalPosition: Vertical alignment ${r} is not supported in RV Icon!`)}}(t,n,o.scaleFactor,i)-i;return{x:s,y:a,width:i,height:i}}function _b(e,t,n,o){if(!n.highContrastScheme){const n=t.CachedFont?.Color??"";e.fillStyle!==n&&(e.fillStyle=n)}const r=`${o.width}px ${Ws}`;e.font!==r&&(e.font=r)}function zb(e,t){return!(!Ru(e,t.renderingRegion)||Ec(e.PreviewText)||e.ShowSkeleton||!e.HasError&&!pm(e))}function Gb(e,t,n){const o=jo(e,cc(t.renderingRegion)),r=lf(e,n),i=sf(e,n),l=e.IsRtl,s={x:af(e,n,l,!1),y:gf(e,n,!1),width:r,height:i};Ef(n,o,{isMirrored:l,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:s,isRtl:l,blockWidth:e.BlockWidth},function(e){if(Ro(cT,"gridRendererStrings","getGeneralTooltipStringForCell"),e.HasError)return cT.formulaErrorTooltip;if(pm(e))return e.OriginalText||e.Text||"";throw"getGeneralTooltipStringForCell: unexpected tooltip string"}(n),Cn.GeneralCellTooltip)}let Vb;const jb=.25,Ub=.25,$b=96*jb,qb=96*Ub;function Xb(e,t){return!(!e.TableColHeader&&!e.TableRowHeader||!Ru(e,t.renderingRegion))}function Yb(e,t,n,o){n.TableColHeader&&n.TableRowHeader&&Jb(e,t,n,o,2),n.TableColHeader&&Jb(e,t,n,o,0),n.TableRowHeader&&Jb(e,t,n,o,1)}function Jb(e,t,n,o,r){const i=function(e,t,n,o){const r=af(e,n,e.IsRtl,!1),i=lf(e,n),l=gf(e,n,!1),s=sf(e,n),a=Math.min($b,s*jb*t.scaleFactor),c=Math.min(qb,i*Ub*t.scaleFactor);switch(o){case 0:return{x:r,y:l,width:i,height:a};case 1:return{x:r,y:l,width:c,height:s};case 2:return{x:r,y:l,width:c,height:a};default:throw Error(`getTableSelectorRectInfo: unsupported selector type for table selector event: ${o}`)}}(t,o,n,r);o.debugMode&&function(e,t){ju(e,{outerColor:"#00FF00",innerColor:"",left:t.x,bottom:t.y+t.height,width:t.width,height:t.height})}(e,i);const l=kg(t,o,i,t.IsRtl),s=jo(t,cc(o.renderingRegion)),{cursor:a,zIndex:c}=function(e,t){switch(e){case 0:return{cursor:Vb.columnSelectCursor,zIndex:Cn.ColumnOrRowSelector};case 1:return t?{cursor:Vb.rowSelectRTLCursor,zIndex:Cn.ColumnOrRowSelector}:{cursor:Vb.rowSelectLTRCursor,zIndex:Cn.ColumnOrRowSelector};case 2:return t?{cursor:Vb.tableSelectRTLCursor,zIndex:Cn.TableSelector}:{cursor:Vb.tableSelectLTRCursor,zIndex:Cn.TableSelector};default:throw Error(`getCursorAndZIndex: unsupported selector type for table selector event: ${e}`)}}(r,t.IsRtl);Pf(n,s,l,a,c),Fn(Sn.TableSelectionDragSelection)?(kf(n,s,l,c,(e=>(yd(e,t.RowNumbers[n.Row],t.ColumnNumbers[n.Col],r),2===r)),"pointerdown"),2===r&&kf(n,s,l,c,ny,"pointerup")):(kf(n,s,l,c,(e=>(yd(e,t.RowNumbers[n.Row],t.ColumnNumbers[n.Col],r),!0)),"click"),kf(n,s,l,c,ny,"pointerdown")),kf(n,s,l,c,ny,"dblclick")}let Kb=!1;function Qb(e,t){return t.zIndex-e.zIndex}function Zb(e,t){const n=e,o=e;if("touchstart"===t){const{clientX:e,clientY:t}=n.touches[0];return{clientX:e,clientY:t}}if("touchend"===t){const e=n.changedTouches.length,{clientX:t,clientY:o}=n.changedTouches[e-1];return{clientX:t,clientY:o}}return{clientX:o.clientX,clientY:o.clientY}}function ex(e,t,n,o,r,i){let l;if(0===o&&n===e.length-1)l=e.slice(0);else{l=e.slice(t,n+1),l[0]=0;for(let n=1;n<l.length;n++)l[n]=l[n]-o,l[n]<0&&($d(`getHitMapAxisOffsets: Unexpected input params: startOffsetPx: ${o}, startOffset: ${t}, offsets: ${e}`),l.splice(n,1),n--)}if(r){l=function(e,t){const n=e.slice(1).map(((t,n)=>t-e[n])).concat([t-e[e.length-1]]);return e=e.map(((e,o)=>t-e-n[o])).reverse()}(l,i);for(let e=0;e<l.length;e++)l[e]<0&&($d(`getHitMapAxisOffsets: Unexpected RTL conversion results: index: ${e}, offset: ${l[e]}`),l.splice(e,1),e--)}return l}const tx=Fn(Sn.SetTransformTelemetry);class nx{render(e,t,n){let o;try{if(Nd=[],Wd=[],!e)return zd(!1,"render:: canvas is undefined");if(!t)return zd(!1,"render:: model is undefined");if(!n)return zd(!1,"render:: context is undefined");if(function(e){Kb||(String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");let t=""+this,n=0;if($s(e)&&(n=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(e),0===t.length||0===n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");const o=t.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+=t.substring(0,o-t.length),t}),function(){const e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}(),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value(e,t){const n=t>0?0|t:0;return this.substring(n,n+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){let n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e}),function(e){try{CanvasRenderingContext2D.prototype.getLineDash||(CanvasRenderingContext2D.prototype.getLineDash=function(){return[]},yo(Vt.UseOffscreenCanvas,e)&&sc()&&(OffscreenCanvasRenderingContext2D.prototype.getLineDash||(OffscreenCanvasRenderingContext2D.prototype.getLineDash=function(){return[]})))}catch{}}(e),function(e){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}),yo(Vt.UseOffscreenCanvas,e)&&sc()&&(OffscreenCanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){}))}catch{}}(e),String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();const t=String(this),n=t.length,o=e?Number(e):0;if(o<0||o>=n)return;const r=t.charCodeAt(o);let i;return r>=55296&&r<=56319&&n>o+1&&(i=t.charCodeAt(o+1),i>=56320&&i<=57343)?1024*(r-55296)+i-56320+65536:r}),function(){try{Array.prototype.map||(Array.prototype.map=function(e){if(null==this)throw new TypeError("this is null or not defined");const t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");let o;arguments.length>1&&(o=arguments[1]);const r=new Array(n);let i=0;for(;i<n;){if(i in t){const n=t[i],l=e.call(o,n,i,t);r[i]=l}i++}return r})}catch{}}(),Date.now||(Date.now=function(){return(new Date).getTime()}),Kb=!0)}(t),t.RowOffsets.length>Co)return zd(!1,`render:: block # of rows = ${t.RowOffsets.length} > MaxAllowedRowColCount`);if(t.ColumnOffsets.length>Co)return zd(!1,`render:: block # of columns = ${t.ColumnOffsets.length} > MaxAllowedRowColCount`);if(Gd(Vd.GetContextDurationMs,(()=>{this.ctx=e.getContext2d({alpha:!n.subPixelRenderingEnabled}),this.ctx&&(this.ctx.font=cd)})),!this.ctx)return zd(!1,`render:: ctx is undefined - ${this.prepareOffscreenCanvasMsg(t)}`);const r=function(e,t){Ca(e.zoom,"context.zoom","extendRenderingContext");const n=e;return n.scaleFactor=e.devicePixelRatio*e.zoom,mr()&&(n.isDifferentialRendering=Uo(t)),n}(n,t);if(Gd(Vd.ModelPreparationsMs,(()=>{this.preprocessModel(t,n.renderingRegion,r)})),(mr()?r.isDifferentialRendering:Uo(t))&&!pc(n.renderingRegion,t))return zd(!0,"skipped rendering since rendering region doesn't have dirty cells");if(Gd(Vd.RenderInternalDurationMs,(()=>{o=this.renderInternal(e,t,r)})),Gd(Vd.RegisterHitRegionsMs,(()=>{this.shouldInitializeCanvasHitTest(t,r)&&this.initializeCanvasHitTest(e,t,r.renderingRegion,r.zoom)})),r.renderingRegion.isRendered=!0,$s(o)&&(o=zd(!0,"")),o.message+=this.prepareOffscreenCanvasMsg(t),o.succeeded){const e=function(){const e=Ed,t=Kd();return jd(),{message:e,level:t}}();o.message=$s(o.message)?e.message:o.message+"; "+e.message,o.messageLevel=e.level}else jd()}catch(e){return jd(),zd(!1,`exception caught in render: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}return o}setTransform(e,t,n,o,r){tx?Gd(Vd.SetTransformDurationMs,(()=>{this.setTransformInternal(e,t,n,o,r)}),!0,!0):this.setTransformInternal(e,t,n,o,r)}prepareOffscreenCanvasMsg(e){const t=yo(Vt.UseOffscreenCanvas,e),n=!!t&&sc();return"- offscreenCanvasFG: "+(t?`ON offscreenCanvasSupported: ${n}`:"OFF")}initializeCanvasHitTest(e,t,n,o){e.removeAllEventListeners(),function(e,t,n){const o=ex(t.ColumnOffsets,n.startColumn,n.endColumn,n.startOffsetX,t.IsRtl,n.endOffsetX),r=ex(t.RowOffsets,n.startRow,n.endRow,n.startOffsetY,!1);e.setHitMapOffsets(o,r,t.BlockWidth,t.BlockHeight,n)}(e,t,n),e.setAppZoom(o);const r=jo(t,cc(n));wc(r.CellHitRegions,(t=>{e.addRegionEventListener(t)})),wc(r.CellCursorHitRegions,(t=>{e.addCursorRegion(t)})),wc(r.CellTooltipHitRegions,(t=>{e.addTooltipRegion(t)})),wc(r.CellLongPressHitRegions,(t=>{e.addLongPressRegion(t)})),e.optimizeHitMapLookup()}setTransformInternal(e,t,n,o,r){t?this.ctx.setTransform(-e,0,0,e,r+n,o):this.ctx.setTransform(e,0,0,e,n,o)}constructor(){this.ctx=null}}let ox;function rx(e,t,n,o,r){if(Ca(n,"cell","spillCell.updateCellSpill"),Ca(t,"model","spillCell.updateCellSpill"),!n.Text||n.WrapText||n.Merge||xh(n)||n.ValueType===Wt.Number||Zs(n))return;Fa(t,n,"updateCellSpill");const i=Hh(t,n.CachedStyle,n.CachedFont);if(void 0===ox&&(ox=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.SpillCellUpdateOptimization",!1)),ox&&e){if(!$s(t.IsRow))return void function(e,t,n,o,r){const i=Pa(t.Col,n);gx(e,t,n,o,r)||!t.IsCellSnapped&&i>Us||(t.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0,IsSpillingOutsideOfBlock:!1,LastVisibleCharIndexHint:-1})}(e,n,t,o,r);if(function(e,t){if(t)return!1;if(e.AutoFilter||e.PivotFilter||e.PivotTable)return!1;if(e.PhonInfo)return!1;const n=e.CachedStyle?.HorizontalAlignment||Ht.Automatic;if(Mh(e.CachedFont))return!1;if(qh(n)||aC(e.CachedStyle.VerticalAlignment))return!1;if(e.TextRuns&&e.TextRuns.length>0)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t];if(n?.CachedFont&&Mh(n.CachedFont))return!1}return!0}(n,i)){if(gx(e,n,t,o,r))return;if(function(e,t){const n=e.CachedStyle?.HorizontalAlignment||Ht.Automatic,o=t.IsRtl;if(!hx(e,n,o))return!0;for(const r of[fn.Start,fn.End])if(dx(n,r,o)&&fx(e,t,r))return!1;return!0}(n,t)){const e={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0,IsSpillingOutsideOfBlock:!1,LastVisibleCharIndexHint:-1};return Eu()&&(e.LastVisibleCharIndexHint=n.Spill?.LastVisibleCharIndexHint??-1),void(n.Spill=e)}}}e.font=yh(n,t);let l=dp(e,t,n);i&&(l=ES(t,l,Sp(n,t),n.CachedStyle),n.Spill=void 0);const s=ix(n,t,l,fn.End,i,o,r),a=ix(n,t,l,fn.Start,i,o,r),c=s.isSpillingOutsideOfBlock||a.isSpillingOutsideOfBlock,u=s.isBlockedByCellContent||a.isBlockedByCellContent;if(0===s.spilledOverCellsCount&&0===a.spilledOverCellsCount)return void((c||u)&&(n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0,IsSpillingOutsideOfBlock:c,LastVisibleCharIndexHint:Eu()?n.Spill?.LastVisibleCharIndexHint:-1}));const d=sx(n,t,fn.Start,i),h=sx(n,t,fn.End,i),f=ax(d,n,t,fn.Start),g=ax(h,n,t,fn.End);n.Spill={SpanToStart:Math.min(a.spilledOverCellsCount,f),SpanToEnd:Math.min(s.spilledOverCellsCount,g),IsSpillBlocked:c||a.spilledOverCellsCount>f||s.spilledOverCellsCount>g,IsSpillingOutsideOfBlock:c,LastVisibleCharIndexHint:Eu()?n.Spill?.LastVisibleCharIndexHint:-1}}function ix(e,t,n,o,r,i,l){const s=qo(t,e);Ca(s,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");const a=s.HorizontalAlignment||Ht.Automatic,c=!!r||hx(e,a,t.IsRtl);return c?function(e,t,n,o,r,i,l){let s=e.Col,a=function(e,t,n,o,r,i,l){const s=Pa(t.Col,e),a=function(e,t){if(!t.PivotTable?.HasExpandCollapseIndicator)return!1;const n=Xh(e,t);return!function(e,t){const n=Xh(e,t);switch(n){case Ht.Left:case Ht.CenterAcrossSelection:case Ht.Center:return!e.IsRtl;case Ht.Right:return e.IsRtl;case Ht.Automatic:default:throw Error(`doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: ${n}`)}}(e,t)||n===Ht.Center}(e,t)?gm(t):0,c=XC(t,e,i,l)+n+a-s;if(c<=0)return 0;if(o===Ht.Center)return c/2;return dx(o,r,e.IsRtl)?c:0}(t,e,n,o,r,i,l),c=0,u=!1;if(0===a)return{spilledOverCellsCount:c,isSpillingOutsideOfBlock:u,isBlockedByCellContent:!1};const d=t.ColumnNumbers.length;for(s+=r;lx(s,d)&&a>0;)c++,a-=Pa(s,t),s+=r;return u=!lx(s,d)&&a>0,{spilledOverCellsCount:c,isSpillingOutsideOfBlock:u,isBlockedByCellContent:!1}}(e,t,n,a,o,i,l):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!c}}function lx(e,t){return e>=0&&e<t}function sx(e,t,n,o){const r=e.Row;let i=e.Col+n;for(;!o&&lx(i,t.ColumnNumbers.length);){const e=$o(r,i,t);if(e&&cx(e))return e;i+=n}return null}function ax(e,t,n,o){return e?Math.abs(e.Col-t.Col)-1:o===fn.End?n.ColumnNumbers.length-t.Col:t.Col}function cx(e){return!(!e||!e.Text&&!e.FormulaInfo?.Formula&&!e.PreviewText)}function ux(e,t,n,o,r,i,l){const s=ax(t,n,o,r);if(t&&t.Spill){const a=qo(o,t);Ca(a,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");const c=a.HorizontalAlignment||Ht.Automatic,u=-r,d=hx(t,c,o.IsRtl),h=dx(c,u,o.IsRtl);if(d&&h)if(n&&n.Text&&""!==n.Text){const e=Jo(u,t);t.Spill.IsSpillBlocked=s<=e;const n=Math.min(e,s);n!==e&&(ka(o,t),u===fn.Start?t.Spill.SpanToStart=n:t.Spill.SpanToEnd=n)}else{n.Spill=void 0;const r=Jo(u,t);rx(e,o,t,i,l),r!==Jo(u,t)&&ka(o,t)}}return s}function dx(e,t,n){return e===Ht.Center||(t===fn.Start?n?e===Ht.Left:e===Ht.Right:t===fn.End&&(e===Ht.Automatic||(n?e===Ht.Right:e===Ht.Left)))}function hx(e,t,n){return!e.RichValueIcon||t===Ht.Left||!n&&t===Ht.Automatic}function fx(e,t,n){const o=e.Row,r=e.Col+n;if(!lx(r,t.ColumnNumbers.length))return!1;const i=$o(o,r,t);return!i||!cx(i)}function gx(e,t,n,o,r){const i=yh(t,n);e.font!==i&&(e.font=i);const l=Zh(n,t,!0),s=vp(n,t,o,r);return gu(l,YC(n,t),s,mm(t.PivotTable?.HasExpandCollapseIndicator),om(n,t,o,r))>dp(e,n,t)}function mx(e,t,n,o){Zs(n)?function(e,t){const n=t.CachedFont.Size,o=px(e,t,n),r=ef(e,t,!1),i=Cx(o,r,n,0,0,!1);t.ShrunkSize=i===n?i:function(e,t,n,o){let r=Math.floor(o);if(r<id)return id;let i=px(e,t,r);for(;i<n&&r<ld;)r+=1,i=px(e,t,r);for(;i>n&&r>id;)r-=1,i=px(e,t,r);return r}(e,t,r,i)}(t,n):function(e,t,n,o){const{zoom:r,devicePixelRatio:i}=o,l=Rh(n.CachedFont,void 0,t);e.font=l;const s=hp(e,t,n),a=Zh(t,n,!1),c=n.CachedStyle.Indentation||0,u=n.CachedFont.Size,d=rm(t,n)?nm(t,n,r,i):0,h=KC(t,n,u,n.CachedFont.Italic,c||0,!0,d),f=!$s(n.LinkedEntity?.IconWidth)||!!n.RichValueIcon,g=fm(t,n,u,r,i),m=gu(a,h,0,0,function(e,t,n,o){return function(e,t){if(!t.CachedStyle?.ShrinkToFit)return!1;const n=t.CachedStyle?.HorizontalAlignment||Ht.Automatic,o=e.IsRtl?n===Ht.Right:n===Ht.Left;return t.AutoFilter&&o}(e,t)?nm(e,t,n,o):0}(t,n,r,i));if(n.ShrunkSize=Cx(s,m,u,h,g,f),n.ShrunkSize<0&&$d(`\n    ShrinkSize was calculated to be negative: ${n.ShrunkSize},\n    textWidth: ${s},\n    cellWidth: ${a},\n    cellIndentation ${c},\n    maxTextWidth: ${m},\n    originalFontSize: ${u},\n    padding: ${h}\n    `),n.ShrunkSize&&n.ShrunkSize>0){const o=Rh(n.CachedFont,n.ShrunkSize,t);e.font=o,dp(e,t,n)}}(e,t,n,o)}function Cx(e,t,n,o,r,i){if(e+r<t)return n;const l=function(e,t,n,o,r){const i=e+o;return r?Math.max(t-o,0)/(e+n):t/(i+n)}(e,t,o,r,i);return n*l}function px(e,t,n){return ep(e,n,t.CachedFont.FontName)*t.CachedDisplayText.length}const wx=1790;function Sx(e,t,n,o,r){if(n.CachedStyle||(n.CachedStyle=wn(n.CellStyleId||0,t.Styles)),n.CachedFont||(n.CachedFont=wn(n.CachedStyle.FontID||0,t.Fonts)),n.TextRuns){n.CachedFormattedText=function(e,t,n){if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:n.Fonts}}(n.Text,n,t);const e=n.CachedFormattedText;for(let o=0;o<n.CachedFormattedText.TextRuns.length;o++){const r=e.TextRuns[o],i=r.FontID||0;try{e.TextRuns[o].CachedFont=wn(i,t.Fonts)}catch(e){return Pn.sendTraceTag(520382479,En.msoulscat_ES_EWAJSGrid,d.Warning,"calculateColWidthForMetadata: Exception in getting FontID: "+i+", ich: "+r.StartIndex+" index: "+o+", ModelFontSize: "+t.Fonts.length),n.SrvDx}}}return function(e,t,n,o,r){Ro(n.CachedStyle,"CachedStyle","Preproccessor::Helper"),Ro(n.CachedFont,"CachedFont","Preproccessor::Helper");let i=0,l="",s="";if(n.TextRuns){const o=n.CachedFormattedText;s=o?.Text,i=Cw(e,o,t),l="FormattedTextWidth"}const a=Rh(n.CachedFont,n.CachedFont.Size,t);e.font!==a&&(e.font=a),n.TextRuns||(l="TextWidth",s=n.Text,i=jC(e,s,!0,!0)),Hh(t,n.CachedStyle,n.CachedFont)&&(i=ES(t,i,n.TextRuns&&Fn(Sn.FixRotatedTextWidth)?Rp(t,n.CachedFormattedText):ep(t,n.CachedFont.Size,n.CachedFont.FontName),n.CachedStyle),l="RotatedTextWidth"),yo(Vt.InCellControls,t)&&r&&n&&n.InCellControlType===bt.Checkbox&&n.CellValueType===Wt.Boolean&&(i=wm(n.CachedFont.Size,r));const c=function(e,t){const n=t.CachedStyle.VerticalText,o=t.CachedStyle.Indentation||0,r=n?0:qC(o),i=t.CachedStyle?.VerticalText?ep(e,t.CachedFont.Size,t.CachedFont.FontName):0,l=function(e,t){if(t.CondWidthIcon){const e=t.CachedFont?.Size;return cm(e,1)+um(e,1)+ts}if(t.RichValueIcon){const n=im(e,t)?Math.round(Ug+Wg):0;return t.IconWidth||0+Mg+n}return 0}(e,t)||0,s=mm(t.ExpandColButton);let a=0;return t.Autofilter&&(a=Ug,im(e,t)&&(a+=Wg)),r+i+s+l+a}(t,n),u=function(e){const t=jC(e,"1234567890",!0,!0);return Math.ceil(t/10)}(e);return Fn(Sn.LogUndefinedColWidthCalculation)&&(void 0!==i&&void 0!==c&&void 0!==u||Pn.sendTraceTag(503719492,En.msoulscat_ES_EWAJSGrid,d.Info,`getColumnWidth: Undefined value(s) found - column: ${o}, textWidth: ${i}, padding: ${c}, margin: ${u}, textWidthCalculationFlow: ${l}, textRuns: ${(n.TextRuns||[]).length}, metadataTextLength: ${s?.length}`)),Math.min(Math.round(i+c+u),wx)}(e,t,n,o,r)}function yx(e,t,n,o,r){const i=[];if(!t.ColMetadata)return i;if(void 0===n)return Pn.sendTraceTag(503940897,En.msoulscat_ES_EWAJSGrid,d.Info,"GridCanvasRenderer.preprocessAutofitWidth: colWidthCacheOverrides in unexpectedly undefined"),i;try{const l=[];for(let e=0;e<t.ColMetadata.length;e++){const o=t.ColMetadata[e],r=t.ColumnNumbers[e];o?o.SrvDx&&o.SrvDx>0&&n.getColSrvDx(r)!==o.SrvDx&&l.push(r):l.push(r)}n.resetColWidthCacheByColumns(l);let s=0;const a=[];for(let o=0;o<t.ColMetadata.length;o++){const l=t.ColMetadata[o],c=t.ColumnNumbers[o];if(t.ColumnOffsets[o]=s,l&&l.SrvDx&&l.SrvDx>0)if(n.hasOverrideForColumn(c)&&l.SrvDx===n.getColSrvDx(c)){const e=n.getCachedColumnWidth(c);e&&(i.push({colIndex:c,newWidth:e,isCacheChanged:!1}),t.ColumnWidths[o]=e)}else{if(l.CachedStyle=wn(l.CellStyleId||0,t.Styles),l.CachedFont=wn(l.CachedStyle.FontID||0,t.Fonts),l.CachedStyle.VerticalText)continue;l.CachedColWidth=Sx(e,t,l,c,r),i.push({colIndex:c,newWidth:l.CachedColWidth,isCacheChanged:!0}),t.ColumnWidths[o]=l.CachedColWidth,a.push({col:c,metadata:l})}s+=t.ColumnWidths[o]}return n.setColMetadataItems(a),t.BlockWidth=s,yo(Vt.TextWidthClientNewProcessing,t)&&void 0!==o&&void 0!==r&&function(e,t,n,o){Vo(t),Mu(t,n*o);const r=t.Cells;for(let i=0;i<r.length;i++){const l=r[i];if(l.CachedStyle=wn(l.StyleID||0,t.Styles),l.CachedFont=wn(l.CachedStyle.FontID||0,t.Fonts),!$s(l.TextRuns))for(let e=0;e<l.TextRuns.length;e++){const n=l.TextRuns[e];n.CachedFont=wn(n.FontID||0,t.Fonts)}const s=l.CachedFont.Italic,a=l.CachedFont.FontName!==ad,c=!!l.TextRuns,u=l.CachedFont.Underline!==qt.None||l.CachedFont.StrikeThrough,d=!!l.AutoFilter;if(l.Text&&(l.CachedDisplayText=Ua(l,t)),!l.DisplayFormula&&!Ec(l.PreviewText))if(l.TolType===rn.Autofit)switch(l.ValueType){case Wt.Number:l.Spill=void 0;break;case Wt.String:(s||a||u||c||d||Tx(t,l))&&rx(e,t,l,n,o)}else(l.TolType===rn.Spill||d)&&rx(e,t,l,n,o)}}(e,t,o,r),i}catch(e){return Pn.sendTraceTag(507360604,En.msoulscat_ES_EWAJSGrid,d.Warning,`GridCanvasRenderer.preprocessAutofitWidth: Error occurred while preprocessing autofit width. Error: ${e}`),i}}function Rx(e,t,n){Ca(e.Cells,"cells","GridCanvasRenderer.initializeCachedObjects"),Ca(e.Styles,"styles","GridCanvasRenderer.initializeCachedObjects"),Ca(e.Fonts,"fonts","GridCanvasRenderer.initializeCachedObjects"),Vo(e),n&&function(e,t){const n=jo(e,t),o=e.ClientOnlyCache;Uo(e)?(dr(n.CellHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap),dr(n.CellCursorHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap),dr(n.CellTooltipHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap),dr(n.CellLongPressHitRegions,o.DirtyCellsKeys,o.DirtyCellsMap)):o.RenderingRegionsHitTestCache&&(o.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}})}(e,cc(t));const o=so()?e.ClientOnlyCache.CellsToRender:e.Cells;for(let t=0;t<o.length;t++)Ba(e,o[t],!1)}function Tx(e,t){return!!Fn(Sn.SpillCellMaxWidth)&&Zh(e,t,!0)>=wx}function Ix(e,t,n,o){!function(e,t){return e.FirstRow>=t.FirstRow&&e.LastRow<=t.LastRow&&e.FirstColumn>=t.FirstColumn&&e.LastColumn<=t.LastColumn}(n,o)?function(e,t,n,o){vx(e,t,n.FirstColumn,n.LastColumn,n.FirstRow,o,!0),vx(e,t,n.FirstColumn,n.LastColumn,n.LastRow,o,!1),bx(e,t,n.FirstRow,n.LastRow,n.FirstColumn,o,!0),bx(e,t,n.FirstRow,n.LastRow,n.LastColumn,o,!1)}(e,t,n,o):function(e,t,n){const o=oy(t,(n.FirstRow-1)%fo),r=ry(t,(n.LastRow-1)%fo),i=iy(t,(n.FirstColumn-1)%go),l=ly(t,(n.LastColumn-1)%go);void 0!==o&&void 0!==r&&void 0!==i&&void 0!==l&&e.strokeRect(i-Ns,o-Ns,l-i,r-o)}(e,t,n)}function vx(e,t,n,o,r,i,l){if(r>=i.FirstRow&&r<=i.LastRow){const{start:s,end:a}=sy(i.FirstColumn,i.LastColumn,n,o),c=(r-1)%fo,u=(a-1)%go,d=iy(t,(s-1)%go),h=ly(t,u),f=l?oy(t,c):ry(t,c);void 0!==d&&void 0!==h&&void 0!==f&&function(e,t,n,o){e.moveTo(t,o),e.lineTo(n,o)}(e,d,h,f-Ns)}}function bx(e,t,n,o,r,i,l){if(r>=i.FirstColumn&&r<=i.LastColumn){const{start:s,end:a}=sy(i.FirstRow,i.LastRow,n,o),c=(r-1)%go,u=(a-1)%fo,d=oy(t,(s-1)%fo),h=ry(t,u),f=l?iy(t,c):ly(t,c);void 0!==d&&void 0!==h&&void 0!==f&&function(e,t,n,o){e.moveTo(o,t),e.lineTo(o,n)}(e,d,h,f-Ns)}}class xx extends nx{renderInternal(e,t,n){try{Cc(n.renderingRegion,t,n);const o=n.scaleFactor,r=Math.round(t.BlockWidth*o),i=n.renderingRegion,l=Math.round(-1*i.startOffsetY*o),s=Math.round(mc(t,i)*o),a=mr()?n.isDifferentialRendering:Uo(t);return a&&(this.setTransform(1,!1,s,l,r),yT(t,this.ctx)),this.setTransform(1,!1,0,0,r),this.clearCanvas(t,e.getWidth(),e.getHeight(),n),this.setTransform(1,t.IsRtl,s,l,r),Gd(Vd.DrawGridlinesDurationMs,(()=>function(e,t,n){if(!$u(t,n))return;rd(e,t);const o=Oa(ts),r=qu(t.BlockWidth,n.scaleFactor,!1),i=qu(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),e.strokeStyle=Qu(t,n,!1,!1),Ju(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*n.scaleFactor,o,i,n.renderingRegion),e.stroke(),e.beginPath(),e.strokeStyle=Qu(t,n,!1,!1),Ku(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*n.scaleFactor,o,r,n.renderingRegion),e.stroke()}(this.ctx,t,n))),n.skeletonMode?(this.setTransform(1,!1,s,l,r),Gd(Vd.DrawSkeletonMs,(()=>function(e,t,n){Ca(e,"ctx","drawSkeleton"),Ca(t,"model","drawSkeleton"),Ca(n,"context","drawSkeleton");const o=t.ClientOnlyCache;if(Ca(o,"ClientOnlyCache","drawSkeleton"),Ca(o.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),Ca(o.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),Ca(t.RowHeights,"RowHeights","drawSkeleton"),Ca(t.ColumnWidths,"ColumnWidths","drawSkeleton"),n.scaleFactor<Kl)return;e.fillStyle="#E4E4E4";const r=Of();r&&e.beginPath();for(let n=0;n<o.RowOffsetsAdjustedForDrawing.length-1;n++){const i=o.RowOffsetsAdjustedForDrawing[n],l=hu(n,o.RowOffsetsAdjustedForDrawing);for(let n=0;n<o.ColOffsetsAdjustedForDrawing.length-1;n++)Bf(e,Iu(n,t),i,du(n,o.ColOffsetsAdjustedForDrawing),l,r)}r&&e.fill()}(this.ctx,t,n))),this.debugModeDrawings(t,n,s,l,r,a,o),zd(!0,"finished grid skeleton rendering")):(Gd(Vd.ClearGridlinesMs,(()=>{Gd(Vd.ClearGridLinesForSpannedCellsMs,(()=>{!function(e,t,n){if(Ca(t,"model","clearGridLinesForText"),Ca(e,"ctx","clearGridLinesForText"),Ca(n,"context","clearGridLinesForText"),!t.ShowGridLines)return;if(!Tu(Va(n),Ga(t.BackgroundColor)))return;const o=t.ClientOnlyCache.CellsToRender,r=Oa(ts),i=qu(t.BlockWidth,n.scaleFactor,!1),l=qu(t.BlockHeight,n.scaleFactor,!0);vm(e,n,t.BackgroundColor),e.beginPath();for(let s=0;s<o.length;s++){const a=o[s],c=!$s(a)&&!$s(a.Spill),u=!$s(a)&&!$s(a.Merge)&&($s(a.CachedStyle.BackgroundColor)||!$s(n.highContrastScheme));Ru(a,n.renderingRegion)&&(c||u)&&(bm(a,e,t,r,i),u&&mf(a)&&xm(a,e,t,r,l))}e.stroke()}(this.ctx,t,n)})),Gd(Vd.ClearGridLinesForPivotTable,(()=>{!function(e,t,n){if(Ca(t,"model","clearGridLinesForEmptyPivotTables"),Ca(e,"ctx","clearGridLinesForEmptyPivotTables"),Ca(n,"context","clearGridLinesForEmptyPivotTables"),!t.ShowGridLines)return;if(!Tu(Va(n),Ga(t.BackgroundColor)))return;if(!t.PivotTables||0===t.PivotTables.length)return;let o=!1;for(let r=0;r<t.PivotTables.length;r++){const i=t.PivotTables[r];if(!i.HideGridLines)continue;if(!i.IsEmptyPivot&&$s(i.RowHeaderRange))continue;if(!Rm(t,i,n.renderingRegion,!0))continue;o||(e.fillStyle=za(n.highContrastScheme,t.BackgroundColor),e.beginPath(),o=!0);const l=ym(t,i,t.IsRtl),s=Sm(t,i,!0),a=i.OriginPTWidthAdjustedForDrawing-ts,c=i.OriginPTHeightAdjustedForDrawing-ts;e.rect(l,s,a,c)}o&&e.fill()}(this.ctx,t,n)}))})),this.setTransform(1,!1,s,l,r),Gd(Vd.DrawBackgroundFillMs,(()=>function(e,t,n){if(Ca(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),Ca(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),Ca(t.RowHeights,"model.RowHeights","drawBackgroundFill"),Ca(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),Ca(t.Styles,"model.Styles","drawBackgroundFill"),n.highContrastScheme)return;let o;const r=[],i=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let l=0;l<i.length;l++){const s=i[l],a=PT(s);a!==ET.None&&Ru(s,n.renderingRegion)&&(mf(s)?r.push([s,a]):o=kT(e,t,s,a,o))}for(let n=0;n<r.length;n++){const[i,l]=r[n];o=kT(e,t,i,l,o)}}(this.ctx,t,n))),Gd(Vd.DrawPatternMs,(()=>function(e,t,n){if(n.highContrastScheme)return;const o=new Map,r=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let e=0;e<r.length;e++){const t=r[e];if(!Ru(t,n.renderingRegion))continue;const s={styleType:(l=t).CachedStyle.PatternStyle,color:l.CachedStyle.PatternColor},a=s.styleType;if(!a||a===an.Solid)continue;const c=`${(i=s).styleType}_${i.color}`;o.has(c)?o.get(c).push(t):o.set(c,[t])}var i,l;o.forEach(((o,r)=>{const i=function(e){const t={styleType:an.None,color:""};if(!e)return t;const n=e.split("_");return 2!==n.length||(t.styleType=an[an[parseInt(n[0],10)]],t.color=n[1]),t}(r),l=function(e,t){const n=document.createElement("canvas"),o=t<=1?1:Math.trunc(t);n.width=8*o,n.height=8*o;const r=n.getContext("2d");switch(r.scale(o,o),r.fillStyle=e.color,r.strokeStyle=e.color,e.styleType){case an.Gray75:r.beginPath(),r.lineWidth=1,r.moveTo(1+Ns,0),r.lineTo(1+Ns,n.height),r.moveTo(3+Ns,0),r.lineTo(3+Ns,n.height),r.moveTo(5+Ns,0),r.lineTo(5+Ns,n.height),r.moveTo(7+Ns,0),r.lineTo(7+Ns,n.height),r.stroke(),r.beginPath(),r.setLineDash([1,1]),r.moveTo(Ns,0),r.lineTo(Ns,n.height),r.moveTo(2+Ns,1),r.lineTo(2+Ns,n.height),r.moveTo(4+Ns,0),r.lineTo(4+Ns,n.height),r.moveTo(6+Ns,1),r.lineTo(6+Ns,n.height),r.stroke();break;case an.Gray50:r.beginPath(),r.setLineDash([1,1]),r.lineWidth=1,r.moveTo(Ns,1),r.lineTo(Ns,n.height),r.moveTo(1+Ns,0),r.lineTo(1+Ns,n.height),r.moveTo(2+Ns,1),r.lineTo(2+Ns,n.height),r.moveTo(3+Ns,0),r.lineTo(3+Ns,n.height),r.moveTo(4+Ns,1),r.lineTo(4+Ns,n.height),r.moveTo(5+Ns,0),r.lineTo(5+Ns,n.height),r.moveTo(6+Ns,1),r.lineTo(6+Ns,n.height),r.moveTo(7+Ns,0),r.lineTo(7+Ns,n.height),r.stroke();break;case an.Gray25:r.beginPath(),r.setLineDash([1,1]),r.lineWidth=1,r.moveTo(1+Ns,0),r.lineTo(1+Ns,n.height),r.moveTo(3+Ns,1),r.lineTo(3+Ns,n.height),r.moveTo(5+Ns,0),r.lineTo(5+Ns,n.height),r.moveTo(7+Ns,1),r.lineTo(7+Ns,n.height),r.stroke();break;case an.Gray125:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(1+Ns,3),r.lineTo(1+Ns,n.height),r.moveTo(3+Ns,1),r.lineTo(3+Ns,n.height),r.moveTo(5+Ns,3),r.lineTo(5+Ns,n.height),r.moveTo(7+Ns,1),r.lineTo(7+Ns,n.height),r.stroke();break;case an.Gray0625:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(3+Ns,1),r.lineTo(3+Ns,n.height),r.moveTo(7+Ns,3),r.lineTo(7+Ns,n.height),r.stroke();break;case an.DiagStripe:r.beginPath(),r.setLineDash([2,2]),r.lineWidth=1,r.moveTo(2,Ns),r.lineTo(n.width,Ns),r.moveTo(1,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(0,2+Ns),r.lineTo(n.width,2+Ns),r.moveTo(3,3+Ns),r.lineTo(n.width,3+Ns),r.moveTo(2,4+Ns),r.lineTo(n.width,4+Ns),r.moveTo(1,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(0,6+Ns),r.lineTo(n.width,6+Ns),r.moveTo(3,7+Ns),r.lineTo(n.width,7+Ns),r.stroke(),r.fillRect(0,3,1,1),r.fillRect(0,7,1,1);break;case an.ThinDiagStripe:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(3,Ns),r.lineTo(n.width,Ns),r.moveTo(2,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(1,2+Ns),r.lineTo(n.width,2+Ns),r.moveTo(0,3+Ns),r.lineTo(n.width,3+Ns),r.moveTo(3,4+Ns),r.lineTo(n.width,4+Ns),r.moveTo(2,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(1,6+Ns),r.lineTo(n.width,6+Ns),r.moveTo(0,7+Ns),r.lineTo(n.width,7+Ns),r.stroke();break;case an.ReverseDiagStripe:r.beginPath(),r.setLineDash([2,2]),r.lineWidth=1,r.moveTo(1,Ns),r.lineTo(n.width,Ns),r.moveTo(2,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(3,2+Ns),r.lineTo(n.width,2+Ns),r.moveTo(0,3+Ns),r.lineTo(n.width,3+Ns),r.moveTo(1,4+Ns),r.lineTo(n.width,4+Ns),r.moveTo(2,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(3,6+Ns),r.lineTo(n.width,6+Ns),r.moveTo(0,7+Ns),r.lineTo(n.width,7+Ns),r.stroke(),r.fillRect(0,2,1,1),r.fillRect(0,6,1,1);break;case an.ThinReverseDiagStripe:r.beginPath(),r.setLineDash([1,3]),r.lineWidth=1,r.moveTo(1,Ns),r.lineTo(n.width,Ns),r.moveTo(2,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(3,2+Ns),r.lineTo(n.width,2+Ns),r.moveTo(0,3+Ns),r.lineTo(n.width,3+Ns),r.moveTo(1,4+Ns),r.lineTo(n.width,4+Ns),r.moveTo(2,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(3,6+Ns),r.lineTo(n.width,6+Ns),r.moveTo(0,7+Ns),r.lineTo(n.width,7+Ns),r.stroke();break;case an.HorzStripe:r.beginPath(),r.lineWidth=2,r.moveTo(0,1),r.lineTo(n.width,1),r.moveTo(0,5),r.lineTo(n.width,5),r.stroke();break;case an.ThinHorzStripe:r.beginPath(),r.lineWidth=1,r.moveTo(0,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(0,5+Ns),r.lineTo(n.width,5+Ns),r.stroke();break;case an.VertStripe:r.beginPath(),r.lineWidth=2,r.moveTo(1,0),r.lineTo(1,n.height),r.moveTo(5,0),r.lineTo(5,n.height),r.stroke();break;case an.ThinVertStripe:r.beginPath(),r.lineWidth=1,r.moveTo(1+Ns,0),r.lineTo(1+Ns,n.height),r.moveTo(5+Ns,0),r.lineTo(5+Ns,n.height),r.stroke();break;case an.ThinHorzCross:r.beginPath(),r.lineWidth=1,r.moveTo(0,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(0,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(3+Ns,0),r.lineTo(3+Ns,n.height),r.moveTo(7+Ns,0),r.lineTo(7+Ns,n.height),r.stroke();break;case an.ThinDiagCross:r.beginPath(),r.setLineDash([1,1]),r.lineWidth=1,r.moveTo(0+Ns,0),r.lineTo(0+Ns,n.height),r.moveTo(2+Ns,0),r.lineTo(2+Ns,n.height),r.moveTo(4+Ns,0),r.lineTo(4+Ns,n.height),r.moveTo(6+Ns,0),r.lineTo(6+Ns,n.height),r.stroke(),r.beginPath(),r.setLineDash([1,3]),r.moveTo(1+Ns,3),r.lineTo(1+Ns,n.height),r.moveTo(3+Ns,1),r.lineTo(3+Ns,n.height),r.moveTo(5+Ns,3),r.lineTo(5+Ns,n.height),r.moveTo(7+Ns,1),r.lineTo(7+Ns,n.height),r.stroke();break;case an.DiagCross:r.beginPath(),r.setLineDash([2,2]),r.lineWidth=1,r.moveTo(2,Ns),r.lineTo(n.width,Ns),r.moveTo(2,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(0,2+Ns),r.lineTo(n.width,2+Ns),r.moveTo(0,3+Ns),r.lineTo(n.width,3+Ns),r.moveTo(2,4+Ns),r.lineTo(n.width,4+Ns),r.moveTo(2,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(0,6+Ns),r.lineTo(n.width,6+Ns),r.moveTo(0,7+Ns),r.lineTo(n.width,7+Ns),r.stroke();break;case an.ThickDiagCross:r.beginPath(),r.lineWidth=1,r.moveTo(0,1+Ns),r.lineTo(n.width,1+Ns),r.moveTo(0,3+Ns),r.lineTo(n.width,3+Ns),r.moveTo(0,5+Ns),r.lineTo(n.width,5+Ns),r.moveTo(0,7+Ns),r.lineTo(n.width,7+Ns),r.stroke(),r.beginPath(),r.setLineDash([2,2]),r.moveTo(2,0+Ns),r.lineTo(n.width,0+Ns),r.moveTo(0,2+Ns),r.lineTo(n.width,2+Ns),r.moveTo(2,4+Ns),r.lineTo(n.width,4+Ns),r.moveTo(0,6+Ns),r.lineTo(n.width,6+Ns),r.stroke();break;default:throw Error(`getPatternStyleTile:: Pattern not supported: ${e.styleType}`)}return n}(i,n.devicePixelRatio),s=e.createPattern(l,"repeat");if(!s)throw Error(`CanvasPattern from patternTile is null for ${r}`);e.fillStyle=s;for(let n=0;n<o.length;n++){const r=o[n],i=Sf(t,r,!1),l=HT(r.Row,r.Col,t)?i.height:i.height-ts;let s=i.width,a=i.x;LT(r.Row,r.Col,t)||(t.IsRtl?a+=ts:s-=ts),e.fillRect(a,i.y,s,l)}}))}(this.ctx,t,n))),Gd(Vd.DrawEmptyPivotTableTitleContainers,(()=>function(e,t,n){if(Ro(t,"model","drawEmptyPivotTableTitleContainers"),Ro(e,"ctx","drawEmptyPivotTableTitleContainers"),Ro(n,"context","drawEmptyPivotTableTitleContainers"),!t.PivotTables||0===t.PivotTables.length)return;const o=Math.max(Math.round(wg*n.scaleFactor),1),r=Oa(o);let i=!1;for(let l=0;l<t.PivotTables.length;l++){const s=t.PivotTables[l];if(!s.IsEmptyPivot)continue;if(s.OriginPTHeight<Rg)continue;if(!Rm(t,s,n.renderingRegion,!1))continue;i||(e.strokeStyle=n.highContrastScheme?Qa(n.highContrastScheme.TextColor):pg,e.lineWidth=o,e.setLineDash(ps),e.beginPath(),i=!0);const a=yv(t,s,n.scaleFactor);e.rect(r+a.x,r+a.y,a.width,a.height)}i&&e.stroke()}(this.ctx,t,n))),Gd(Vd.DrawEmptyPivotTableImages,(()=>function(e,t,n){if(Ro(t,"model","drawEmptyPivotTableImages"),Ro(e,"ctx","drawEmptyPivotTableImages"),Ro(n,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(let o=0;o<t.PivotTables.length;o++){const r=t.PivotTables[o];if(!r.IsEmptyPivot)continue;if(r.OriginPTHeight<Ig)continue;if(!Rm(t,r,n.renderingRegion,!1))continue;const i=Sv(t,r,n.scaleFactor);if(i.width<80)continue;const l=sa(0,n.blockIdentifier);l?e.drawImage(l,i.x,i.y,i.width,i.height):pv(e,i,n.highContrastScheme)}}(this.ctx,t,n))),Gd(Vd.DrawDataBarsMs,(()=>function(e,t,n){Ro(t,"model","drawDataBars"),Ro(e,"ctx","drawDataBars"),Ro(n,"context","drawDataBars");const o=function(e,t){const n=e.ClientOnlyCache.CellsToRender,o=[];for(let s=0;s<n.length;s++){const a=n[s];if(!Ru(a,t.renderingRegion))continue;const c=a.CondFormat?.DataBar;if(!c)continue;if(Ec(a.PreviewText))continue;if(a.ShowSkeleton)continue;const u=c.Direction===Et.RightToLeft||e.IsRtl&&c.Direction===Et.Context,d=Sf(e,a,!1),h=Wv(d,t.scaleFactor),f=(r=c.AxisPostion,i=h.width,l=u,function(e,t,n){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return n?t-e:e}(Math.round(i*r/100),i,l)),g=Pv(c.AxisPostion,h.x,f,d),m=!$s(g),C=Ev(c.Length,h,f,u,m);o.push({information:c,axis:g,bar:C,isRtl:u})}var r,i,l;return o}(t,n),r=function(e){if(!$s(e))return`${Qa(e.TextColor)}`}(n.highContrastScheme);!function(e,t,n){let o,r=!1;const i=!$s(n);for(let l=0;l<t.length;l++){const s=t[l].axis;if(!$s(s)){if(r||(o=i?n:t[l].information.AxisColor,Lv(e,Mv,kv,o),e.beginPath(),r=!0),!i){const n=t[l].information.AxisColor;Nv(e,n,o),o=n}Su(e,s.X,s.startY,s.X,s.endY)}}r&&e.stroke()}(e,o,r),$s(r)&&function(e,t){let n;for(let o=0;o<t.length;o++){const r=t[o],i=r.bar,l=Hv(e,r);n!==l&&(e.fillStyle=l,n=l),e.fillRect(i.x,i.y,i.width,i.height)}}(e,o),function(e,t,n){let o,r=!1;const i=!$s(n);for(let s=0;s<t.length;s++){const a=t[s].information.BorderColor;if($s(n)&&$s(a))continue;const c={x:(l=t[s].bar).x+Oa(Av),y:l.y+Oa(Av),width:Math.max(l.width-Av,0),height:Math.max(l.height-Av,0)};r||(o=i?n:a,Lv(e,Av,[],o),e.beginPath(),r=!0),i||(Nv(e,a,o),o=a),c.width>0&&e.rect(c.x,c.y,c.width,c.height)}var l;r&&e.stroke()}(e,o,r)}(this.ctx,t,n))),Gd(Vd.DrawCFIconsMs,(()=>function(e,t,n){Ca(e,"ctx","drawConditionalFormattingIcons"),Ca(t,"model","drawConditionalFormattingIcons"),Ca(n,"context","drawConditionalFormattingIcons");const o=t.ClientOnlyCache.CellsToRender;o.length>0&&(e.lineWidth=Gu,e.setLineDash(ps));const r=null!==n.highContrastScheme?n.highContrastScheme:void 0;for(let i=0;i<o.length;i++){const l=o[i];l?.CondFormat?.Icon&&(Ec(l.PreviewText)||l.ShowSkeleton||Ru(l,n.renderingRegion)&&av(e,t,l,n.scaleFactor,r))}}(this.ctx,t,n))),n.modelFromCache||(Gd(Vd.DrawSparklines,(()=>{zv(this.ctx,t,n,oa.Sparkline)})),Gd(Vd.DrawInCellImagesMs,(()=>zv(this.ctx,t,n,oa.InCellImage)))),Gd(Vd.ClearGridlinesForBorderMs,(()=>{!function(e,t,n){if(!t.ShowGridLines)return;if(!Tu(Va(n),Ga(t.BackgroundColor)))return;Om(t),vm(e,n,t.BackgroundColor);const o=t.ClientOnlyCache.GridlineOverridingCellsToRender;e.beginPath();for(let r=0;r<o.length;r++){const i=o[r],l=qm(i);if(!Ru(i,n.renderingRegion))continue;if(!l)continue;if(!l.Borders||0===l.Borders.length||i.CachedStyle.BackgroundColor)continue;const s=l.Borders;for(let n=0;n<s.length;n++){const o=s[n];o.BorderLineStyle!==Ut.None&&(_m(o.BorderLineStyle)||zm(o.BorderPosition,t,i)&&Lm(e,ms,Nm(t,i,o.BorderPosition,ts),ts))}}e.stroke()}(this.ctx,t,n)})),Gd(Vd.DrawBordersMs,(()=>function(e,t,n){Om(t);const o=uu(n.scaleFactor),r=function(e,t,n,o){const r={},i=[],l=[],s={},a=e.ClientOnlyCache.GridlineOverridingCellsToRender;for(let c=0;c<a.length;c++){const u=a[c],d=qm(u);if(!Ru(u,o.renderingRegion)&&!Ym(u,o.renderingRegion))continue;if(!d)continue;if(!d.Borders||0===d.Borders.length)continue;const h=d.Borders;for(let o=0;o<h.length;o++){const a=h[o];if(a.BorderLineStyle!==Ut.None&&zm(a.BorderPosition,e,u)){if(a.BorderLineStyle===Ut.Double){let o=u.CachedStyle.BackgroundColor?yu(u.CachedStyle.BackgroundColor):n;Fn(Sn.DoubleBorderFormattingFix)&&(o=km(e,a,u,n)),Em(e,u,Bm(a.BorderPosition,o),t,l,s)}Em(e,u,a,t,i,r)}}}return{distinctBorderTypes:i,borderTypeToLineMap:r,distinctClearingDoubleBorderTypes:l,clearingDoubleBordersToLineMap:s}}(t,o,yu(za(n.highContrastScheme,t.BackgroundColor)),n);let i,l;n.highContrastScheme?(l=Qa(n.highContrastScheme.TextColor),i=Qa(n.highContrastScheme.BackgroundColor),Hm(e,r.distinctBorderTypes,r.borderTypeToLineMap,o,l),Hm(e,r.distinctClearingDoubleBorderTypes,r.clearingDoubleBordersToLineMap,o,i)):(Hm(e,r.distinctBorderTypes,r.borderTypeToLineMap,o,void 0),Hm(e,r.distinctClearingDoubleBorderTypes,r.clearingDoubleBordersToLineMap,o,void 0))}(this.ctx,t,n))),Va(n)&&Gd(Vd.DrawTableBordersMs,(()=>function(e,t,n){!function(e,t,n){Ro(e,"ctx","drawTableHighlightInHighContrast"),Ro(n,"context","drawTableHighlightInHighContrast"),Ro(t,"model","drawTableHighlightInHighContrast"),Ro(t.RowOffsets,"model.RowOffsets","drawTableHighlightInHighContrast"),Ro(t.ColumnOffsets,"model.ColumnOffsets","drawTableHighlightInHighContrast"),Ro(t.RowNumbers,"model.RowNumbers","drawTableHighlightInHighContrast"),Ro(t.ColumnNumbers,"model.ColumnNumbers","drawTableHighlightInHighContrast")}(e,t,n);const o=t.ClientOnlyCache?.TableRangesCache;if(!(o&&o.length>0&&n.highContrastScheme))return;const r={FirstRow:t.RowNumbers[0],FirstColumn:t.ColumnNumbers[0],LastRow:t.RowNumbers[fo-1],LastColumn:t.ColumnNumbers[go-1]};!function(e,t){e.lineWidth=3,e.strokeStyle=t.highContrastScheme?Qa(t.highContrastScheme.TextColor):"black"}(e,n),e.beginPath();for(let i=0;i<o.length;i++)ay(o[i],r,n.renderingRegion)&&Ix(e,t,o[i],r);e.stroke()}(this.ctx,t,n))),this.setTransform(1,t.IsRtl,s,l,r),Gd(Vd.CellTooltipRegistrationMs,(()=>function(e,t,n){Ro(e,"ctx","registerCellsTooltip"),Ro(t,"model","registerCellsTooltip"),Ro(n,"context","registerCellsTooltip");const o=t.ClientOnlyCache.CellsToRender;for(let e=0;e<o.length;e++){const r=o[e];zb(r,n)&&Gb(t,n,r)}}(this.ctx,t,n))),Gd(Vd.DrawCommentsMs,(()=>function(e,t,n){Ro(e,"ctx","drawComments"),Ro(t,"model","drawComments"),Ro(n,"context","drawComments"),function(e,t,n){let o=!1;const r=t.ClientOnlyCache.CellsToRender;for(let l=0;l<r.length;l++){const s=r[l];if(s.Comment&&!s.Comment.IsThreadedComment){if(!Ob(s,n.renderingRegion))continue;const r=Fb(t,s,8,n.devicePixelRatio,n.zoom);if(r<Tb)continue;o||(o=!0,e.fillStyle=(i=n.highContrastScheme)?Qa(i.TextColor):Rb,e.beginPath()),Bb(e,t,s,n,r,QI,GI.Right)}}var i;o&&e.fill()}(e,t,n),Ab(e,t,n,!1),Ab(e,t,n,!0)}(this.ctx,t,n))),Gd(Vd.DrawRichErrorMs,(()=>function(e,t,n){Ro(e,"ctx","drawErrorNotch"),Ro(t,"model","drawErrorNotch"),Ro(n,"context","drawErrorNotch");let o=!1,r=!1;const i=t.ClientOnlyCache.CellsToRender;for(let l=0;l<i.length;l++){const s=i[l];if(!Eb(s,n))continue;o||(r=Boolean(Og().CardViewShowTemporaryErrorCard),Ro(t.RowNumbers,"model.RowNumbers","RowNumbers"),Ro(t.ColumnNumbers,"model.ColumnNumbers","ColumnNumbers"),e.setLineDash(ps),e.beginPath(),o=!0);const a=Hb(t,s,KI(t,s,8,n.devicePixelRatio,n.zoom));QI(e,a,GI.Left),r&&Pb(t,s,n,a)}o&&(e.fillStyle=n.highContrastScheme?Qa(n.highContrastScheme.TextColor):"#156712",e.fill())}(this.ctx,t,n))),Gd(Vd.RegisterTableSelectorsMs,(()=>function(e,t,n){Ro(e,"ctx","registerTableSelectors"),Ro(t,"model","registerTableSelectors"),Ro(n,"context","registerTableSelectors"),Ro(t.RowNumbers,"model.RowNumbers","registerTableSelectors"),Ro(t.ColumnNumbers,"model.ColumnNumbers","registerTableSelectors");const o=t.ClientOnlyCache.CellsToRender;for(let r=0;r<o.length;r++){const i=o[r];Xb(i,n)&&Yb(e,t,i,n)}}(this.ctx,t,n))),yo(Vt.DropdownInCellControl,t)&&yo(Vt.InCellControls,t)&&(this.setTransform(1,!1,s,l,r),Gd(Vd.DrawInCellControls,(()=>wT(this.ctx,t,n)))),this.setTransform(n.scaleFactor,!1,s,l,r),Gd(Vd.DrawTextDurationMs,(()=>vT(this.ctx,t,n))),Gd(Vd.DrawPhoneticTextDurationMs,(()=>function(e,t,n){Ca(e,"ctx","drawCellsPhoneticText"),Ca(t,"model","drawCellsPhoneticText"),Ca(n,"context","drawCellsPhoneticText"),Ca(t.Cells,"model.Cells","drawCellsPhoneticText");const o=t.ClientOnlyCache.CellsToRender;let r=!1;IS(e,t,n.highContrastScheme);for(let i=0;i<o.length;i++){const l=o[i];if(bS(n,l))try{xS(e,t,n,l),r=!0}catch(e){throw Ud("Error drawSingleCellPhoneticText: "+e),e}}r&&Ud("drawCellsPhoneticText: Phonetic rendered")}(this.ctx,t,n))),Gd(Vd.DrawEmptyPivotTableTitleText,(()=>function(e,t,n){if(Ro(t,"model","drawEmptyPivotTableTitleText"),Ro(e,"ctx","drawEmptyPivotTableTitleText"),Ro(n,"context","drawEmptyPivotTableTitleText"),!t.PivotTables||0===t.PivotTables.length)return;let o,r=!1;for(let i=0;i<t.PivotTables.length;i++){const l=t.PivotTables[i];if(!l.IsEmptyPivot)continue;if(l.OriginPTHeight<Rg)continue;if(!Rm(t,l,n.renderingRegion,!1))continue;if(!l.PivotTableName)continue;if(!r){const i=wn(Nt.Default,t.Styles);o=wn(i.FontID||0,t.Fonts),wv(e,o,n.highContrastScheme,t),r=!0}const s=Rv(t,l),a=s.x+s.width/2,c=op(t,s.y+s.height,s.height,o.Size,o.FontName,Lt.Center);pu(e,s),e.fillText(l.PivotTableName,a,c),wu(e,s)}}(this.ctx,t,n))),this.setTransform(1,!1,s,l,r),Gd(Vd.DrawTextDecoration,(()=>function(e,t,n){let o,r;e.beginPath();const i=[],l=t.ClientOnlyCache.CellsToRender;for(let s=0;s<l.length;s++){const a=l[s];if(!Ru(a,n.renderingRegion))continue;if(Ca(a.CachedFont,"cell.CachedFont","drawTextDecoration"),!a.CachedFont.StrikeThrough&&!a.CachedFont.Underline&&!a.TextRuns)continue;if(a.CondFormat&&a.CondFormat?.Icon&&a.CondFormat?.Icon?.IconOnly)continue;if(a.ShowSkeleton)continue;Ca(a.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");const c=a.CachedDrawingLayout.TextOrientationLayout,u=a.CachedDrawingLayout.UnderlineRuns,d=a.CachedDrawingLayout.StrikethroughRuns,h=n.highContrastScheme?xu(a,n.highContrastScheme):void 0;if(c&&Hh(t,a.CachedStyle,a.CachedFont)){i.push(a);continue}const{lineColor:f,lineWidth:g}=Bp(e,o,r,h,u,d);o=f,r=g}e.stroke(),i.length>0&&function(e,t,n,o){let r,i=-1;const l=[];for(let s=0;s<o.length;s++){const a=o[s],c=(e.RowHeights[a.Row]-ts)*n.scaleFactor,u=e.ClientOnlyCache?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[a.Row]:e.RowOffsets[a.Row];a.Row!==i&&(-1!==i&&wu(t,r),r={x:0,y:u,width:e.BlockWidth*n.scaleFactor,height:c},pu(t,r),i=a.Row),mf(a)?l.push(a):Op(t,n,a)}wu(t,r);for(const e of l)Op(t,n,e)}(t,e,n,i)}(this.ctx,t,n))),Gd(Vd.DrawExpandCollapseButtonsMs,(()=>function(e,t,n){if(Ro(e,"ctx","drawExpandCollapseButtons"),Ro(t,"model","drawExpandCollapseButtons"),Ro(n,"context","drawExpandCollapseButtons"),!t.PivotTables)return;const o=t.ClientOnlyCache.CellsToRender;let r=!1;for(let i=0;i<o.length;i++){const l=o[i];if(!Kv(t,n,l))continue;let s;if(l.PivotTable?.HasExpandCollapseIndicator){if(r||(e.lineWidth=Gu,e.setLineDash(ps),r=!0),e.font=Rh(l.CachedFont,void 0,t),s=tb(e,t,n,l),l.CondFormat?.Icon&&nb(t,l,n,s))continue;qv(e,t,l,s,!!l.PivotTable.IsExpanded,!0)}Zv(t,l,n,s)}}(this.ctx,t,n))),(!Fn(Sn.ToggleIconCSE)||!t.HideDataTypeIcons)&&Gd(Vd.DrawRichValueIcons,(()=>function(e,t,n){Ro(e,"ctx","drawRichValueIcons"),Ro(t,"model","drawRichValueIcons"),Ro(n,"context","drawRichValueIcons");const o=t.ClientOnlyCache.CellsToRender;!function(e,t){const n=t.highContrastScheme;e.fillStyle=n?Qa(n.TextColor):is,e.textAlign="left",e.textBaseline="alphabetic"}(e,n);for(let r=0;r<o.length;r++){const i=o[r];if(!Lb(i,n))continue;const l=Wb(e,t,i,n,i.RichValueIcon.Width),{x:s,y:a,width:c}=l,u=Py(t,i,s,a+c,c,!0);i.RichValueIcon?.Type===en.LinkedEntity&&_b(e,i,n,l),u&&pu(e,u),Nb(e,t,i,n,l),u&&wu(e,u)}}(this.ctx,t,n))),Gd(Vd.DrawAutoFiltersMs,(()=>cb(this.ctx,t,n))),!yo(Vt.DropdownInCellControl,t)&&yo(Vt.InCellControls,t)&&Gd(Vd.DrawInCellControls,(()=>wT(this.ctx,t,n))),yo(Vt.ByExamplePreviewMode,t)&&Gd(Vd.DrawSkeletonCellsMs,(()=>function(e,t,n){if(Ca(e,"ctx","drawSkeletonCells"),Ca(t,"model","drawSkeletonCells"),Ca(n,"context","drawSkeletonCells"),n.scaleFactor<Kl)return;const o=t.ClientOnlyCache.CellsToRender;e.fillStyle="#aaaaaa";const r=Of();r&&e.beginPath();for(let i=0;i<o.length;i++){const l=o[i];if(!l?.ShowSkeleton)continue;if(!Ru(l,n.renderingRegion))continue;const s=gf(t,l,!0),a=sf(t,l);Bf(e,af(t,l,!1,!0),s,lf(t,l),a,r)}r&&e.fill()}(this.ctx,t,n))),this.setTransform(1,t.IsRtl,s,l,r),n.renderPageLayout&&(Gd(Vd.DrawPrintAreasDurationMs,(()=>function(e,t,n){if(function(e){Ca(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),Ca(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),Ca(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),Ca(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),Ca(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),Ca(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),Ca(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),!t.PrintAreas)return;cv(e,n);const o=Oa(uv(n)),r=qu(t.BlockWidth,n.scaleFactor,!1),i=qu(t.BlockHeight,n.scaleFactor,!0);e.beginPath();for(let a=0;a<t.PrintAreas?.length;a++)l=n.renderingRegion,s=t.PrintAreas[a],!(l.startRow>s.LastRow||l.startColumn>s.LastColumn||l.endRow+1<s.FirstRow||l.endColumn+1<s.FirstColumn||l.startRow>s.FirstRow&&l.startColumn>s.FirstColumn&&l.endRow<s.LastRow&&l.endColumn<s.LastColumn)&&Cv(e,t,n,o,i,r,t.PrintAreas[a]);var l,s;e.stroke()}(this.ctx,t,n))),Gd(Vd.DrawPageBreaksDurationMs,(()=>function(e,t,n){if(null==t.PageBreaks)return;cv(e,n);const o=Oa(uv(n)),r=qu(t.BlockWidth,n.scaleFactor,!1),i=qu(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),function(e,t,n,o,r,i){const l=t.PageBreaks?.Row;if(null!=l)for(let s=0;s<l.length;++s)dv(e,t,n,l[s],o,r,i)}(e,t,n,o,r,i),function(e,t,n,o,r,i){const l=t.PageBreaks?.Col;if(null!=l)for(let s=0;s<l.length;++s)hv(e,t,n,l[s],o,r,i)}(e,t,n,o,r,i),e.stroke()}(this.ctx,t,n)))),yo(Vt.ByExamplePreviewMode,t)&&Gd(Vd.DrawPreviewCellsModeOverlayMs,(()=>function(e,t,n){const o=nc(e);if(!n.isCellsPreviewMode||!o)return;if((0,Rn.isChangeGateEnabled)("ChangeGate.OfficeVSO:10898705_AddingSupportForPreviewSuppressOverlay")){const t=e.ClientOnlyCache?.PreviewCellsSettings;if(t?.SuppressOverlay)return}const r=e.RowNumbers[0],i=e.ColumnNumbers[0];if(!function(e,t,n,o){return Ro(e,"previewRange","isOverlayIntersectsRenderingRegion"),Ro(t,"renderingRegion","isOverlayIntersectsRenderingRegion"),!(e.LastRow<t.startRow+n||e.FirstRow>t.endRow+n||e.FirstColumn<t.startColumn+o||e.LastColumn>t.endColumn+o)}(o,n.renderingRegion,r,i))return;const l=function(e,t){const n=nc(e),o=function(e,t){if(t.FirstRow<e.RowNumbers[0])return-100;let n=Ja(e,t.FirstRow);return n<0&&(n=~n),e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]}(e,n),r=function(e,t,n){if(t.LastRow>e.RowNumbers[e.RowNumbers.length-1])return fu(e.BlockHeight,n)+100;let o=Ja(e,t.LastRow);o<0&&(o=~o-1);const r=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return r[o]+hu(o,r)}(e,n,t.scaleFactor),i=function(e,t){if(t.FirstColumn<e.ColumnNumbers[0])return-100;let n=Ka(e,t.FirstColumn);return n<0&&(n=~n),e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[n]}(e,n),l=function(e,t,n){if(t.LastColumn>e.ColumnNumbers[e.ColumnNumbers.length-1])return fu(e.BlockWidth,n)+100;let o=Ka(e,t.LastColumn);o<0&&(o=~o-1);const r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return r[o]+du(o,r)}(e,n,t.scaleFactor);return{x:i,y:o,width:l-i,height:r-o}}(e,n),s=n.highContrastScheme;s||(t.fillStyle="#edebe9",t.globalAlpha=e.ClientOnlyCache.PreviewCellsSettings?.RetainCellTextOnPreview?.1:.4,t.fillRect(l.x,l.y,l.width,l.height),t.globalAlpha=.35,t.shadowColor="#000000",t.shadowBlur=4,t.shadowOffsetY=4),t.strokeStyle=s?Qa(s.TextColor):"#000000",t.lineWidth=s?3:1,t.strokeRect(l.x,l.y,l.width,l.height),t.globalAlpha=1,t.shadowColor="transparent"}(t,this.ctx,n))),a&&this.ctx.restore(),this.debugModeDrawings(t,n,s,l,r,a,o),zd(!0,"finished rendering"))}catch(e){return zd(!1,`exception caught in renderInternal: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}}shouldInitializeCanvasHitTest(e,t){return!t.skeletonMode}preprocessModel(e,t,n){yo(Vt.TableBordersInHighContrast,e)&&Va(n)&&function(e){const t=(n={FirstRow:e.RowNumbers[0],FirstColumn:e.ColumnNumbers[0],LastRow:e.RowNumbers[fo-1],LastColumn:e.ColumnNumbers[go-1]},Ca(md,"externalCallbacks","getTablesRangeContainingRangeCallback"),md.getTablesRangeContainingRange(n,!1));var n;if(t){const n=_o(e);n.TableRangesCache=t,n.DisableDiffRendering=!0}}(e),Gd(Vd.InitializeCachedObjectDurationMs,(()=>{Rx(e,t,this.shouldInitializeCanvasHitTest(e,n))})),Mu(e,n.scaleFactor),Gd(Vd.UpdateCellsBeforeDurationMs,(()=>{!function(e,t,n){const o=t.ClientOnlyCache.CellsToRender,r=yo(Vt.ByExamplePreviewMode,t),i=yo(Vt.DropdownInCellControl,t);for(let i=0;i<o.length;i++){const l=o[i],s=l.CachedFont.Italic,a=l.CachedFont.FontName!==ad,c=!!l.TextRuns,u=l.CachedFont.Underline!==qt.None||l.CachedFont.StrikeThrough,d=!!l.AutoFilter;if(l.DisplayFormula=qa(l,n.isFormulaView),r){const e=nc(t);e&&n.isCellsPreviewMode&&Ll(t,e,l)||(l.PreviewText=void 0,l.PreviewNumFmt=void 0,l.PreviewCellStyle=void 0,l.RetainTextOnPreview=void 0)}else l.PreviewText&&(l.PreviewText=void 0),l.PreviewNumFmt&&(l.PreviewNumFmt=void 0),l.PreviewCellStyle&&(l.PreviewCellStyle=void 0),l.RetainTextOnPreview=void 0;if(l.Text&&(l.CachedDisplayText=Ua(l,t)),!l.DisplayFormula&&!Ec(l.PreviewText))if(l.Text&&xh(l)&&mx(e,t,l,n),yo(Vt.TextWidthClientPhase1,t))if(l.TolType===rn.Autofit)switch(l.ValueType){case Wt.Number:l.Spill=void 0;break;case Wt.String:(s||a||u||c||d||Tx(t,l))&&rx(e,t,l,n.zoom,n.devicePixelRatio)}else(l.TolType===rn.Spill||d)&&(rx(e,t,l,n.zoom,n.devicePixelRatio),yo(Vt.MoveSpillCellBeforeRendering,t)&&(ka(t,l),l.Spill&&vc(t,l)));else(s||a||u||c||d||Tx(t,l))&&rx(e,t,l,n.zoom,n.devicePixelRatio);l.Merge&&(Fn(Sn.FixingBorderInMergeCellSpanningBlocks)||ac(t,l,n.scaleFactor))}if(i&&function(e,t,n,o){const r=new Map;for(let o=0;o<t.length;o++){const i=t[o];if(i.InCellControlOptions?.Type===bt.Dropdown){const t=i.CachedFont?yh(i,e):n.font;r.has(t)||r.set(t,[]),r.get(t).push(i)}}const i=n.font;for(const[t,i]of r){n.font=t;for(const t of i)mT(e,t,o,n)}n.font=i}(t,o,e,n),Fn(Sn.FixingBorderInMergeCellSpanningBlocks)){const e=t.ClientOnlyCache.GridlineOverridingCellsToRender;for(let o=0;o<e.length;o++){const r=e[o];r.Merge&&ac(t,r,n.scaleFactor)}}}(this.ctx,e,n)})),function(e,t){if(e&&0!==e.length)for(let n=0;n<e.length;n++){const o=e[n];o.DeltaXFromOriginPTAdjustedForDrawing=Math.round(o.DeltaXFromOriginPT*t),o.DeltaYFromOriginPTAdjustedForDrawing=Math.round(o.DeltaYFromOriginPT*t),o.OriginPTHeightAdjustedForDrawing=Math.round(o.OriginPTHeight*t),o.OriginPTWidthAdjustedForDrawing=Math.round(o.OriginPTWidth*t)}}(e.PivotTables,n.scaleFactor)}clearCanvas(e,t,n,o){o.subPixelRenderingEnabled||Ga(e.BackgroundColor)?Gd(Vd.FillRectDurationMs,(()=>{this.ctx.fillStyle=za(o.highContrastScheme,e.BackgroundColor),this.ctx.fillRect(0,0,t,n)})):Gd(Vd.ClearRectDurationMs,(()=>{this.ctx.clearRect(0,0,t,n)}))}debugModeDrawings(e,t,n,o,r,i,l){t.debugMode&&(this.setTransform(1,e.IsRtl,n,o,r),function(e,t,n,o){const r=1*n.scaleFactor,i=5*n.scaleFactor,l=function(e,t){return e?_f.blue:t?_f.green:_f.red}(n.modelFromCache,o);!function(e,t,n,o){e.beginPath(),e.lineWidth=1,e.setLineDash([]),e.strokeStyle="white",e.rect(t,t,n,n),e.strokeStyle=o.color,e.rect(t,t,n,n),e.stroke()}(t,r,i,l),function(e,t,n,o,r){const i=jo(e,cc(t.renderingRegion)),l=2*o,s={isMirrored:e.IsRtl,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n,y:n,width:l,height:l},isRtl:e.IsRtl,blockWidth:e.BlockWidth};let a=e.Cells?.[0];a||(a=Eo(0,0)),Pf(a,i,s,"help",Cn.DebugWatermark),Ef(a,i,s,function(e){let t="";const n=`${e.color} - ${e.infoString}`;return Object.keys(_f).forEach((e=>t+=`${_f[e].color} - ${_f[e].infoString}\n`)),`${n}\n\n${t}`}(r),Cn.DebugWatermark)}(e,n,r,i,l)}(e,this.ctx,t,i),function(e,t,n){if(!(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.ShowBlockHash",!1))return;if(!n.blockIdentifier)return;const o=n.scaleFactor,r=12*o,i=8*o;e.save(),t.IsRtl&&e.scale(-1,1),e.font=`${r}px monospace`,e.fillStyle="rgba(255, 0, 0, 0.8)",e.textBaseline="top",e.textAlign="left";const l=`${n.blockIdentifier}`,s=e.measureText(l).width,a=r,c=t.IsRtl?-(i+s+i):i,u=i,d=t.IsRtl?-(i+s+i/2):i+i/2,h=i+i/2;e.fillStyle="rgba(255, 255, 255, 0.9)",e.fillRect(c,u,s+i,a+i),e.strokeStyle="rgba(255, 0, 0, 0.8)",e.lineWidth=1*o,e.strokeRect(c,u,s+i,a+i),e.fillStyle="rgba(255, 0, 0, 0.8)",e.fillText(l,d,h),e.restore(),function(e,t,n,o,r){const i=jo(e,cc(t.renderingRegion)),l={isMirrored:e.IsRtl,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n,y:n,width:o+n,height:r+n},isRtl:e.IsRtl,blockWidth:e.BlockWidth};let s=e.Cells?.[0];s||(s=Eo(0,0)),kf(s,i,l,Cn.DebugWatermark,(()=>{const t=JSON.stringify(e,null,2);return navigator.clipboard.writeText(t),!0}),"click"),Pf(s,i,l,"help",Cn.DebugWatermark),Ef(s,i,l,"click to copy block model to clipboard",Cn.DebugWatermark)}(t,n,i,s,a)}(this.ctx,e,t),this.setTransform(l,!1,0,0,0),t.isCanvasHitTestDebugHighlight&&zf(e,this.ctx,t.renderingRegion))}}class Fx{static throwErrorWrapper(e,t){Aa(e,`BlockModelAccessor.${t}`)}static verifyArgumentNotNull(e,t,n){Ca(e,t,`BlockModelAccessor.${n}`)}getColumnWidth(e){return Pa(e,this.model)}getRowHeight(e){return Fx.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(e>this.model.RowHeights.length-1||e<0)&&Fx.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[e]}getColumnOffset(e){return Fx.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(e>this.model.ColumnOffsets.length-1||e<0)&&Fx.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[e]}getRowOffset(e){return Fx.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(e>this.model.RowOffsets.length-1||e<0)&&Fx.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[e]}getRowNumber(e){return Fx.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[e]}getColumnNumber(e){return Fx.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[e]}getColumnOffsets(){return this.model.ColumnOffsets?.slice()}setColumnOffsets(e){Fx.verifyArgumentNotNull(e,"newOffsets","setColumnOffsets"),this.model.ColumnOffsets=e,this.setDirty("setColumnOffsets",on.ModelCoreChanges)}getColumnNumbers(){return this.model.ColumnNumbers?.slice()}setColumnNumbers(e){Fx.verifyArgumentNotNull(e,"newNumbers","setColumnNumbers"),this.model.ColumnNumbers=e,this.setDirty("setColumnNumbers",on.ModelCoreChanges)}getColumnWidths(){return this.model.ColumnWidths?.slice()}setColumnWidths(e){Fx.verifyArgumentNotNull(e,"newWidths","setColumnWidths"),this.model.ColumnWidths=e,this.setDirty("setColumnWidths",on.ModelCoreChanges)}setIsColumnWidthFixed(e,t){this.model.FixedColumns&&((e<0||e>=this.model.FixedColumns.length)&&Fx.throwErrorWrapper(`columnIndex ${e} is out of bounds!`,"setIsColumnWidthFixed"),this.model.FixedColumns[e]=t)}getRowOffsets(){return this.model.RowOffsets?.slice()}setRowOffsets(e){Fx.verifyArgumentNotNull(e,"newOffsets","setRowOffsets"),this.model.RowOffsets=e,this.setDirty("setRowOffsets",on.ModelCoreChanges)}getRowNumbers(){return this.model.RowNumbers?.slice()}setRowNumbers(e){Fx.verifyArgumentNotNull(e,"newNumbers","setRowNumbers"),this.model.RowNumbers=e,this.setDirty("setRowNumbers",on.ModelCoreChanges)}getRowHeights(){return this.model.RowHeights?.slice()}setRowHeights(e){Fx.verifyArgumentNotNull(e,"newHeights","setRowHeights"),this.model.RowHeights=e,this.setDirty("setRowHeights",on.ModelCoreChanges)}getBlockWidth(){return this.model.BlockWidth}setBlockWidth(e){this.model.BlockWidth=e,this.setDirty("setBlockWidth",on.ModelCoreChanges)}getBlockHeight(){return this.model.BlockHeight}setBlockHeight(e){this.model.BlockHeight=e,this.setDirty("setBlockHeight",on.ModelCoreChanges)}isDirty(){return this.model.ClientOnlyCache?.IsDirty??!1}hasClientChanges(){return this.model.ClientOnlyCache?.hasClientChanges??!1}isDirtyDueToViewportChangeOnly(){return!!this.model.ClientOnlyCache?.DirtyType&&this.model.ClientOnlyCache.DirtyType===on.ViewportChange}setDirty(e,t){Fx.verifyArgumentNotNull(t,"dirtyType","setDirty"),this.setDirtyInternal(t),Pn.sendTraceTag(529278243,En.msoulscat_ES_EWAJSGrid,d.Info,`BlockModelAccessor::setDirty called, caller ${e}`),_o(this.model).DisableDiffRendering=!0}onRenderingCompleted(){const e=_o(this.model);mr()?e.DirtyCellsMap=void 0:e.DirtyCellsKeys=void 0,e.DisableDiffRendering=!1,e.IsDirty=!1,e.DirtyTimestamp=void 0,e.DirtyType=on.None,e.delayRenderingToNextAnimationFrame=hn.None}getColumnIndex(e){return Fx.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),xa(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,ba)}getRowIndex(e){return Ja(this.model,e)}getHasTable(){return!!this.model.HasTable}getHasOutline(){return!!this.model.HasOutline}getIsEmptyBlocksSupported(){return Boolean(this.model.IsEmptyBlocksSupported)}getEmptyBlocksFallbackReasons(){return this.model.EmptyBlocksFallbackReasonBitFlag??0}getDirtyTimestamp(){return this.model.ClientOnlyCache?.DirtyTimestamp??-1}getMaxRowOutlineLevelInSheet(){return this.model.MaxRowOutlineLevelInSheet??0}getMaxColOutlineLevelInSheet(){return this.model.MaxColOutlineLevelInSheet??0}resetCellLookup(){_o(this.model).CellLookup=Ko(this.model)}setCellsDirty(e){if(e){if(mr()){this.ensureDirtyCellsMapInitialized();const t=_o(this.model);for(const n of e)t.DirtyCellsMap.set(n,mn.EntireCell)}else{this.ensureDirtyCellsKeysInitialized();const t=_o(this.model);t.DirtyCellsKeys=t.DirtyCellsKeys.concat(e)}this.setDirtyInternal(on.ModelCellChanges)}}getDirtyCellsCount(){if(mr()){if(this.model.ClientOnlyCache?.DirtyCellsMap)return this.model.ClientOnlyCache.DirtyCellsMap.size}else if(this.model.ClientOnlyCache?.DirtyCellsKeys)return this.model.ClientOnlyCache.DirtyCellsKeys.filter(Yo).length;return 0}getDirtyCellsKeys(){return this.model.ClientOnlyCache?.DirtyCellsKeys?this.model.ClientOnlyCache.DirtyCellsKeys:[]}getDirtyCellsMap(){return this.model.ClientOnlyCache?.DirtyCellsMap?this.model.ClientOnlyCache.DirtyCellsMap:new Map}isDifferentialRenderingSupported(){const e=Uo(this.model),t=_o(this.model),n=this.getDirtyCellsCount();return Pn.sendTraceTag(512267551,En.msoulscat_ES_EWAJSGrid,d.Info,`BlockModelAccessor::isDifferentialRenderingSupported result: ${e}, isDisabled: ${t.DisableDiffRendering}, isDirty: ${t.IsDirty}, dirtyCellsCount: ${n}, delayToNextAnimationFrame: ${t.delayRenderingToNextAnimationFrame}`),e}isRenderFlagEnabled(e){return yo(e,this.model)}overrideInCellControlCheckboxRenderFlag(e){!function(e,t,n){if(!pn(e.RenderFlagsArray)){const o=Math.floor(t/ho);if(o<e.RenderFlagsArray.length){const r=1<<t%ho;n!==!!(e.RenderFlagsArray[o]&r)&&(e.RenderFlagsArray[o]^=r)}}}(this.model,Vt.InCellControls,e)}isDelayRenderingToNextFrame(){return _o(this.model).delayRenderingToNextAnimationFrame===hn.Delay}delayRenderingToNextAnimationFrame(){const e=_o(this.model);e.delayRenderingToNextAnimationFrame!==hn.DoNotDelay&&(e.delayRenderingToNextAnimationFrame=hn.Delay)}doNotDelayRenderingToNextAnimationFrame(){_o(this.model).delayRenderingToNextAnimationFrame=hn.DoNotDelay}setDirtyInternal(e,t=!1){const n=_o(this.model);n.IsDirty||(n.DirtyTimestamp=Date.now()),n.IsDirty=!0,n.DirtyType|=e,n.hasClientChanges=!0,yo(Vt.DelayRenderToNextAnimationFrame,this.model)&&!t&&this.doNotDelayRenderingToNextAnimationFrame()}getOrCreateCanvasContext(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));const e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e}getAutoFilterMenuOffsetsFromCellStartInternal(e,t,n){const o=t*n;this.ensureCachedObjectsInitialized(this.model,e,o),Au(this.model)||Mu(this.model,o);const r=!this.model.IsRtl,i=af(this.model,e,!1,r),l=gf(this.model,e,!0),s=tm(this.model,e,n,t),a=am(this.model,e,s,n,t)-i,c=sm(this.model,e,s,n,t)-l;return{x:Math.round(a/o),y:Math.round(c/o)}}getAutoFilterButtonTotalSizeInternal(e,t,n){const o=t*n;this.ensureCachedObjectsInitialized(this.model,e,o),Au(this.model)||Mu(this.model,o);const r=tm(this.model,e,n,t),i=uu(o);return Math.round((r+i)/o)}ensureCachedObjectsInitialized(e,t,n){Fx.verifyArgumentNotNull(e,"model","ensureCachedObjectsInitialized"),Fx.verifyArgumentNotNull(t,"cell","ensureCachedObjectsInitialized"),Au(this.model)||Mu(this.model,n),t.CachedStyle&&t.CachedBorderStyle&&t.CachedFont&&t.CachedIndent&&t.CachedDrawingLayout?.UnderlineRuns&&t.CachedDrawingLayout?.StrikethroughRuns&&t.CachedDrawingLayout?.CellTextLayout||Ba(e,t,!0);const o=t.Merge;!o||o.HeightAdjustedForDrawing&&o.OriginDeltaXAdjustedForDrawing&&o.WidthAdjustedForDrawing&&o.OriginDeltaYAdjustedForDrawing||ac(e,t,n)}ensureDirtyCellsKeysInitialized(){const e=_o(this.model);return e.DirtyCellsKeys||(e.DirtyCellsKeys=[]),e.DirtyCellsKeys}ensureDirtyCellsMapInitialized(){const e=_o(this.model);return e.DirtyCellsMap||(e.DirtyCellsMap=new Map),e.DirtyCellsMap}constructor(e){this.canvasInstance=null,Fx.verifyArgumentNotNull(e,"model","constructor"),this.model=e}}class Dx extends Fx{static verifyArgumentNotNull(e,t,n){Ca(e,t,`GridBlockModelAccessor.${n}`)}getCell(e,t){return $o(e,t,this.model)}shouldCellExistInModel(e,t){if(!this.getCell(e,t))try{Go(this.model,e,t)}catch{return!1}return!0}getOrCreateCell(e,t){return zo(this.model,e,t)}getCellStyle(e){return qo(this.model,e)}getCellFont(e){return Ea(e,this.model)}hasRichText(e){return Dx.verifyArgumentNotNull(e,"cell","hasRichText"),!$s(e?.TextRuns)}cloneCellFont(e){const t=Ea(e,this.model);return t?fc(t,t.ID||0,t.RefCount||0):t}getBorderStyle(e){return Zo(this.model,e)}removeBorder(e){Dx.verifyArgumentNotNull(e,"cell","removeBorder"),Dx.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),e.BorderStyleID=e.GlobalBorderStyleID=Nt.DefaultBorder,e.CachedBorderStyle=ao(e,this.model)}getNumberOfBlockColumns(){return this.model.ColumnNumbers.length}isRtl(){return this.model.IsRtl}setIsRtl(e){this.model.IsRtl=e,this.setDirty("isRtl",on.ModelCoreChanges)}resetColMetaData(){this.model.ColMetadata=void 0}setDataTypeIconsVisible(e){this.model.HideDataTypeIcons=!e,this.setDirty("setDataTypeIconsVisible",on.ModelCellChanges),Pn.sendTraceTag(506212957,En.msoulscat_ES_EWAJSGrid,d.Important,"setDataTypeIconsVisible: "+e)}replaceCellInModel(e,t){Dx.verifyArgumentNotNull(e,"cell","replaceCellInModel"),Dx.verifyArgumentNotNull(t,"immediateModel","replaceCellInModel"),Dx.verifyArgumentNotNull(t.Styles,"immediateModel!.Styles","replaceCellInModel");const n=t.Styles[0];Dx.verifyArgumentNotNull(n,"style","replaceCellInModel"),Dx.verifyArgumentNotNull(t.Fonts,"immediateModel!.Fonts","replaceCellInModel");const o=so(),r=this.duplicateAndSetFontsInModel(t.Fonts);o&&eo().process(this.model.Fonts),e.TextRuns&&(e.TextRuns=Rc(e.TextRuns,r),o&&Tc(e.TextRuns,this.model.Fonts)),n.FontID=r[n.FontID||0],o&&(n.GlobalFontID=Io(n.FontID||0,this.model.Fonts)),e.CachedFont=co(n,this.model,e?.StyleID||0);const i=Hc(this.model)+1;if(n.ID=i,this.model.Styles.splice(i,0,n),o&&oo().process(this.model.Styles),e.StyleID=i,e.CachedStyle=n,o&&(e.GlobalCellStyleID=Io(i,this.model.Styles)),!$s(t.BorderStyles)){const n=t.BorderStyles[0];!$s(n)&&!$s(n.Borders)&&n.Borders.length>0&&(n.RefCount=1,Jn()?this.setBordersNew(e,n,!1):this.setBorders(e,n))}if(this.getCell(e.Row,e.Col)){const t=Ha(e,this.model.Cells);this.model.Cells[t]=e,this.model.ClientOnlyCache.CellLookup[Ao(e.Row,e.Col)]=e}else this.attachCellToModel(e);n.RefCount=1}attachCellToModel(e){Fc(e,this.model)}shouldApplyBorderAtPosition(e,t){return Dx.verifyArgumentNotNull(e,"cell","shouldApplyBorderAtPosition"),Dx.verifyArgumentNotNull(t,"borderPosition","shouldApplyBorderAtPosition"),function(e,t,n){if(t===$t.Top||t===$t.Left)return Da(e,t)&&Ma(e,t);const o=Yc(e,t,n),r=Jc(t);return o&&null!=r?!!(Qc(t)&&Na(e,t,o)||Kc(t)&&La(e,t,o))||Ma(o,r)&&!Da(o,r):Da(e,t)}(e,t,this.model)}shouldRemoveBorderAtPosition(e,t){return Dx.verifyArgumentNotNull(e,"cell","shouldRemoveBorderAtPosition"),Dx.verifyArgumentNotNull(t,"borderPosition","shouldRemoveBorderAtPosition"),function(e,t,n){const o=Yc(e,t,n),r=Jc(t);if(o&&null!=r){if(Qc(t)&&Na(e,t,o)||Kc(t)&&La(e,t,o))return!1;if(t===$t.Right||t===$t.Bottom)return Ma(o,r)&&!Da(o,r)}return Da(e,t)&&Ma(e,t)}(e,t,this.model)}deleteCellFromModel(e){Dx.verifyArgumentNotNull(e,"cell","deleteCellFromModel"),Dx.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","deleteCellFromModel");const t=$o(e.Row,e.Col,this.model);if(!t)return;if(t.Row!==e.Row||t.Col!==e.Col)return;const n=!!e.Merge;let o=0,r=0;const i=Ha(e,this.model.Cells);n&&(o=e.Merge.Rows,r=e.Merge.Columns);for(let t=e.Row;t<=e.Row+o;t++)for(let n=e.Col;n<=e.Col+r;n++)delete this.model.ClientOnlyCache.CellLookup[Ao(t,n)];this.model.Cells.splice(i,1)}prepareCellStyleForEdit(e){Dx.verifyArgumentNotNull(e,"cell","prepareCellStyleForEdit");const t=e?.StyleID||0,n=so();let o;if(n)try{o=wn(t,this.model.Styles)}catch(t){const n=`PrepareCellStyleEdit: Exception while retrieving cell style with message: ${t} and stacktrace: ${new Error(t).stack||""}`;Pn.sendTraceTag(507601601,En.msoulscat_ES_EWAJSGrid,d.Important,n),o=this.getCellStyle(e)}else o=this.getCellStyle(e);if($s(e.CachedStyle)&&(e.CachedStyle=o),!n&&!this.isStyleUnique(o.ID||0)&&(o.RefCount||0)<=1)return!0;const r=Hc(this.model)+1,i=uc(this.model,o,r,1);return o.RefCount=Math.max(0,(o.RefCount||0)-1),this.model.Styles.splice(r,0,i),e.CachedStyle=i,e.StyleID=r,!1}updateGlobalCellStyleIDAfterEdit(e){Dx.verifyArgumentNotNull(e,"cell","updateGlobalCellStyleIDAfterEdit");const t=this.getCellStyle(e);if(void 0===t.GlobalFontID||null===t.GlobalFontID)return void(e.GlobalCellStyleID=void 0);const n=oo().getOrCreateID(t);e.GlobalCellStyleID=n,e.CachedStyle=uo(e,this.model)}setDefaultHyperlinkStyleOnCell(e){Dx.verifyArgumentNotNull(e,"cell","setDefaultHyperlinkStyleOnCell");const t=wn(Nt.Hyperlink,this.model.Styles);e.StyleID=Nt.Hyperlink,e.CachedStyle=t,t.RefCount=gc(t.RefCount||0)}hideCommentIndicators(e){Dx.verifyArgumentNotNull(e,"isCommentIndicatorHidden","hideCommentIndicators"),Dx.verifyArgumentNotNull(this.model,"this.model","hideCommentIndicators");let t=!1;if(e&&this.model){const n=this.model.Cells||[];for(const o of n)if(o?.Comment?.IsThreadedComment){const n=e(this.getRowNumber(o.Row),this.getColumnNumber(o.Col));this.getHideCommentIndicator(o)!==n&&(this.setHideCommentIndicator(o,n),this.setCellAndSpannedOverCellsDirty(o),t=!0)}}return t}editCellFontAttributes(e,t){if(Dx.verifyArgumentNotNull(e,"cell","editFont"),Dx.verifyArgumentNotNull(e,"editFontAction","editFont"),this.attachCellToModel(e),this.prepareFontForEdit(e),e.TextRuns)for(let n=0;n<e.TextRuns.length;n++){const o=e.TextRuns[n];$s(o.CachedFont)&&(o.CachedFont=wn(o.FontID||0,this.model.Fonts)),t(o.CachedFont)}t(e.CachedFont)}copyCacheItemsToModel(e){Ca(e,"sourceModel","copyClientOnlyCacheToNewModel"),e?.ClientOnlyCache&&(this.model.ClientOnlyCache||(this.model.ClientOnlyCache={}),this.model.ClientOnlyCache.RenderingRegionsHitTestCache=e.ClientOnlyCache.RenderingRegionsHitTestCache)}prepareFontForEdit(e){if(e?.TextRuns)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t],o=$s(n.CachedFont)?wn(n.FontID||0,this.model.Fonts):n.CachedFont;this.prepareTextRunFontForEdit(o,n)}this.prepareCellFontForEdit(e)}prepareBorderStyleForEdit(e){return Dx.verifyArgumentNotNull(e,"cell","prepareBorderStyleForEdit"),Uc(e,this.model)}addLeftBorderToAdjacentCell(e){return Dx.verifyArgumentNotNull(e,"cell","addLeftBorderToAdjacentCell"),function(e,t){if(Ca(e,"cell","addLeftBorderToAdjacentCell"),e.Col===t.ColumnNumbers.length-1)return;const n=zo(t,e.Row,e.Col+1);Fc(n,t);const o=Zo(t,e);if(!o||0===o.Borders.length)return;let r;for(let e=0;e<o.Borders.length;e++){const t=o.Borders[e];if(t.BorderPosition===$t.Left){r={BorderLineStyle:t.BorderLineStyle,BorderPosition:$t.Left,Color:t.Color,Weight:t.Weight};break}}r&&Dc(n,t,r,$t.Left)}(e,this.model)}cloneBorderStyle(e){Dx.verifyArgumentNotNull(e,"cell","cloneBorderStyle");const t=this.getBorderStyle(e);return hc(t,t.ID||0,1)}setBorders(e,t){return xc(e,this.model,t)}setBordersNew(e,t,n){return Dx.verifyArgumentNotNull(e,"cell","setBordersNew"),Dx.verifyArgumentNotNull(e,"newBorderStyle","setBordersNew"),$c(e,this.model,t,n)}afterBorderStyleEdit(e){return Dx.verifyArgumentNotNull(e,"cell","afterBorderStyleEdit"),qc(e,this.model)}afterFontEdit(e){if(Dx.verifyArgumentNotNull(e,"cell","afterFontEdit"),e?.TextRuns)for(let t=0;t<e.TextRuns.length;t++){const n=e.TextRuns[t];$s(n.CachedFont)&&(n.CachedFont=co(n,this.model,void 0));const o=eo().getOrCreateID(n.CachedFont);n.GlobalFontID=o}const t=eo().getOrCreateID(e?.CachedFont);e.CachedFont.GlobalId=t,e.CachedStyle.GlobalFontID=t,e.CachedFont=co(e.CachedStyle,this.model,e?.StyleID||0),this.updateGlobalCellStyleIDAfterEdit(e)}setInCellControlOptions(e,t){Dx.verifyArgumentNotNull(e,"cell","setInCellControlOptions"),Fn(Sn.FixCopyBlankCellToACellWithCheckbox)?e.InCellControlOptions=t||void 0:(Dx.verifyArgumentNotNull(t,"controlOptions","setInCellControlOptions"),t&&(e.InCellControlOptions=t))}getInCellControlOptions(e){return Dx.verifyArgumentNotNull(e,"cell","getInCellControlOptions"),Fn(Sn.FixCopyBlankCellToACellWithCheckbox)||e.InCellControlOptions?e.InCellControlOptions:null}setHideCommentIndicator(e,t){Dx.verifyArgumentNotNull(e,"cell","setHideCommentIndicator"),e&&e.Comment&&(e.Comment.HideCommentIndicator=t)}getHideCommentIndicator(e){return Dx.verifyArgumentNotNull(e,"cell","getHideCommentIndicator"),!!(e&&e.Comment&&e.Comment.HideCommentIndicator)&&e.Comment.HideCommentIndicator}getCellCssFont(e){return Fa(this.model,e,"getCellCssFont"),yh(e,this.model)}setCellAndSpannedOverCellsDirty(e){e&&(ka(this.model,e),this.setDirtyInternal(on.ModelCellChanges))}setAdjacentCellsDirty(e){if(!e)return;const t=Fn(Sn.AdjacentCellsMergeFix)?Wo(this.model,e):No(this.model,e.Row,e.Col);this.setCellsDirty(t)}getCalcBlockModel(){const e=new Cr,t=this.model.RowNumbers.slice(),n=this.model.ColumnNumbers.slice();e.addHeaders(t,n);for(let t=0;t<this.model.Cells.length;t++){const n=this.model.Cells[t],o=e.createCell(n);e.addCell(o)}return e}updateCellSpillInformation(e,t,n){Fa(this.model,e,"updateCellSpillInformation");const o=t*n;if(Au(this.model)||Mu(this.model,o),$s(e?.CachedDrawingLayout?.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),e.Merge)return;if(e?.CachedStyle?.HorizontalAlignment===Ht.CenterAcrossSelection)return;this.setCellAndSpannedOverCellsDirty(e),e.Spill=void 0;let r=null;r=this.getOrCreateCanvasContext(),this.setContextCellFont(r,e),yo(Vt.MoveSpillCellBeforeRendering,this.model)?e.TolType=rn.Spill:(rx(r,this.model,e,t,n),void 0!==e.Spill&&this.removeBordersWithinASpillCell(e),this.setCellAndSpannedOverCellsDirty(e))}updateTolType(e){if(Fa(this.model,e,"updateTolType"),yo(Vt.TextWidthClientPhase1,this.model)){let t=null;t=this.getOrCreateCanvasContext(),this.setContextCellFont(t,e);const n=Zh(this.model,e,!0),o=jC(t,e.Text,!0,!0);if(e.ValueType===Wt.Number)o/n*100>Id(9,80)&&(e.TolType=rn.Autofit);else if(e?.Spill){const t=Cf(e,this.model),n=o/(t-this.model.ColumnWidths[Tf(e,this.model)])*100;o/t*100>Id(10,80)&&(e.TolType=rn.Spill),n<Id(11,120)&&(e.TolType=rn.Spill)}}}updateClosestNonEmptyCellsSpillInformation(e,t,n){Dx.verifyArgumentNotNull(e,"cell","updateClosestNonEmptyCellsSpillInformation"),Fa(this.model,e,"updateClosestNonEmptyCellsSpillInformation");let o=null;o=this.getOrCreateCanvasContext(),this.setContextCellFont(o,e),function(e,t,n,o,r){const i=Hh(n,t.CachedStyle,t.CachedFont),l=sx(t,n,fn.Start,i),s=sx(t,n,fn.End,i);ux(e,l,t,n,fn.Start,o,r),ux(e,s,t,n,fn.End,o,r)}(o,e,this.model,t,n)}getUserInput(e){return Dx.verifyArgumentNotNull(e,"cell","getUserInput"),e.UserInput}setUserInput(e,t){Dx.verifyArgumentNotNull(e,"cell","setUserInput"),Dx.verifyArgumentNotNull(t,"userInput","setUserInput"),e.UserInput=t}clearCellFormat(e){const t=wn(Nt.Default,this.model.Styles);e.StyleID=Nt.Default,e.CachedStyle=t,e.CachedFont=co(t,this.model,Nt.Default),e.BorderStyleID=e.GlobalBorderStyleID=Nt.DefaultBorder,e.CachedBorderStyle=ao(e,this.model)}getCellWidth(e,t){return Dx.verifyArgumentNotNull(e,"cell","getCellWidth"),Zh(this.model,e,t)}getHorizontalPadding(e,t,n){Dx.verifyArgumentNotNull(e,"cell","getHorizontalPadding");const o=t*n;return this.ensureCachedObjectsInitialized(this.model,e,o),XC(e,this.model,t,n)}getCellHeight(e,t){return Dx.verifyArgumentNotNull(e,"cell","getCellHeight"),ef(this.model,e,t)}getTextMaxWidth(e,t,n){Dx.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth");const o=t*n;return this.ensureCachedObjectsInitialized(this.model,e,o),gu(this.getCellWidth(e,!0),XC(e,this.model,t,n),vp(this.model,e,t,n),gm(e),0)}getFormattedText(e){Dx.verifyArgumentNotNull(e,"cell","getFormattedText"),Dx.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");const t=[],n=[],o=so(),r=(e,t)=>{if(o)i(e,t);else if(!n[e])if(e<this.model.Fonts.length){const t=this.model.Fonts[e];n[e]=fc(t,t.ID||0,t.RefCount||0)}else Fx.throwErrorWrapper(`Font ${e} does not exist`,"getFormattedText")},i=(e,t)=>{if(!n[e]){const o=co(t,this.model,void 0);n[e]=fc(o,e||0,o.RefCount||0)}};if(e.TextRuns)e.TextRuns.forEach((e=>{r(e.FontID||0,e),t.push(Ic(e))}));else{let n=e.CachedStyle?e.CachedStyle:this.getCellStyle(e);n=uo(e,this.model);const o={FontID:n.FontID||0,StartIndex:0};r(n.FontID||0,n),t.push(o)}return{Text:e.Text||"",TextRuns:t,Fonts:n}}getNoControlPhoneticText(e,t){return Dx.verifyArgumentNotNull(e,"phoneticInfo","getNoControlPhoneticText"),Dx.verifyArgumentNotNull(t,"cellText","getNoControlPhoneticText"),RS(e,t)}prepareTextRunFontForEdit(e,t){!so()&&(e.RefCount||0)<=1||this.duplicateAndSetNewFontOnTextRun(e,t)}prepareCellFontForEdit(e){const t=this.prepareCellStyleForEdit(e),n=e?.CachedStyle?.FontID||0;let o;if(so())try{o=wn(n,this.model.Fonts)}catch(t){const n=`PrepareCellFontEdit: Exception while retrieving font with message: ${t} and stacktrace: ${new Error(t).stack||""}`;Pn.sendTraceTag(507601600,En.msoulscat_ES_EWAJSGrid,d.Important,n),o=this.getCellFont(e)}else o=this.getCellFont(e);$s(e?.CachedFont)&&(e.CachedFont=o),t&&(o.RefCount||0)<=1||this.duplicateAndSetNewFontOnCell(o,e)}setFormattedText(e,t){Dx.verifyArgumentNotNull(e,"cell","setFormattedText"),Dx.verifyArgumentNotNull(t,"formattedText","setFormattedText"),Dx.verifyArgumentNotNull(t.TextRuns,"formattedText.TextRuns","setFormattedText"),Dx.verifyArgumentNotNull(t.Fonts,"formattedText.Fonts","setFormattedText"),Dx.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText");const n=so();this.attachCellToModel(e),e.Text=t.Text;const o=this.duplicateAndSetFontsInModel(t.Fonts),r=e.TextRuns=Rc(t.TextRuns,o);n&&(eo().process(t.Fonts),Tc(e.TextRuns,this.model.Fonts));for(let e=0;e<r.length;e++)r[e].CachedFont=co(r[e],this.model,void 0)}discardFormattedText(e){Dx.verifyArgumentNotNull(e,"cell","discardFormattedText"),e.TextRuns=void 0}serializeCell(e){return Di(e,this.model)}getOutlineState(e,t){const n=e?this.model.RowOutlinesInformation:this.model.ColumnOutlinesInformation;if(!n)return Jt.None;let o=Jt.None;for(let r=0;r<n.length;r++){const i=n[r];for(let n=0;n<i.Outlines.length;n++){const r=i.Outlines[n];if(t===r.ButtonIndex&&!r.IsExpanded)return Jt.Collapsed;this.isIndexInOutline(t,r,e)&&(o=Jt.Expanded)}}return o}compareCells(e,t,n){return o=e,r=t,i=n,l=this.model,kl(),qi(o,r,i,l,Ol,Bl,cl);var o,r,i,l}updateNumFmt(e){Dx.verifyArgumentNotNull(e,"cell","updateNumFmt"),Po(e)?Qs(e):e.NumFmt=void 0}updateCellText(e,t){Dx.verifyArgumentNotNull(e,"cell","updateCellText"),Dx.verifyArgumentNotNull(t,"text","updateCellText"),e.TextRuns=void 0,e.DisplayFormula=!1,$a(this.model,e,t)}updateCellValue(e,t){Dx.verifyArgumentNotNull(e,"cell","updateCellValue"),e.Value=t??void 0}hasPageLayout(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas}hasIntersectingPrintArea(e){const t=this.model.PrintAreas;if(Dx.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","hasIntersectingPrintArea"),Dx.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","hasIntersectingPrintArea"),t&&e){const n=this.model.RowNumbers.length,o=this.model.ColumnNumbers.length;for(let r=0;r<t.length;r++){const i=t[r];if(i.FirstRow===n||i.FirstColumn===o)continue;const l=this.getRowNumber(i.FirstRow),s=i.LastRow>=n?this.getRowNumber(n-1):this.getRowNumber(i.LastRow);if(ec(e,{FirstRow:l,FirstColumn:this.getColumnNumber(i.FirstColumn),LastRow:s,LastColumn:i.LastColumn>=o?this.getColumnNumber(o-1):this.getColumnNumber(i.LastColumn)}))return!0}}return!1}setPrintArea(e){e&&0!==e.length&&(this.model.PrintAreas=e,this.setDirty("setPrintArea",on.ModelCoreChanges))}addToPrintArea(e){e&&0!==e.length&&(this.model.PrintAreas=(this.model.PrintAreas||[]).concat(e),this.setDirty("addToPrintArea",on.ModelCoreChanges))}clearPrintArea(){this.model.PrintAreas&&(this.model.PrintAreas=void 0,this.setDirty("clearPrintArea",on.ModelCoreChanges))}hasPrintArea(){return!!this.model.PrintAreas&&this.model.PrintAreas.length>0}getPrintArea(){if(!this.model.PrintAreas)return[];const e=[];for(let t=0;t<this.model.PrintAreas.length;t++){const n=this.model.PrintAreas[t];e.push({FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn})}return e}insertPageBreak(e){(e?.Row&&0!==e.Row.length||e?.Col&&0!==e.Col.length)&&(this.insertRowBreak(e?.Row),this.insertColBreak(e?.Col),this.setDirty("insertPageBreak",on.ModelCoreChanges))}removePageBreak(e){const t=this.removeRowBreak(e?.Row),n=this.removeColBreak(e?.Col);!this.model.PageBreaks||this.model.PageBreaks.Row||this.model.PageBreaks.Col||(this.model.PageBreaks=void 0),(t||n)&&this.setDirty("removePageBreak",on.ModelCoreChanges)}resetAllPageBreak(){this.model.PageBreaks&&(this.model.PageBreaks=void 0,this.setDirty("resetAllPageBreak",on.ModelCoreChanges))}getPivotTableRanges(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)}getSparklineRanges(){return this.duplicateSparklineRangeInformations(this.model.Sparklines?.Ranges)}getSparklinesUrl(){return this.model.Sparklines?.ImageUrl??""}getAllRichValueFields(){return this.duplicateRichValueFields(this.model.AllRichValueFields)}disposeBlock(e){$s(e)||""===e||function(e,t){const n=ua(e,t);fa(n)&&ma(n)}(oa.Sparkline,e)}getAutoFilterButtonTotalSize(e,t,n){return Dx.verifyArgumentNotNull(e,"cell","getAutoFilterButtonTotalSize"),this.getAutoFilterButtonTotalSizeInternal(e,t,n)}getAutoFilterMenuOffsetsFromCellStart(e,t,n){return Dx.verifyArgumentNotNull(e,"cell","getAutoFilterMenuOffsetsFromCellStart"),this.getAutoFilterMenuOffsetsFromCellStartInternal(e,t,n)}setPreviewRange(e){const t=_o(this.model);t.PreviewCellsRange&&this.setPreviewRangeCellsDirty(t.PreviewCellsRange),t.PreviewCellsSettings?.PreviewCellsRange&&this.setPreviewRangeCellsDirty(t.PreviewCellsSettings.PreviewCellsRange),e&&this.setPreviewRangeCellsDirty(e),t.PreviewCellsRange=e||void 0}setPreviewCellsSettings(e){const t=_o(this.model);t.PreviewCellsRange&&this.setPreviewRangeCellsDirty(t.PreviewCellsRange),t.PreviewCellsSettings?.PreviewCellsRange&&this.setPreviewRangeCellsDirty(t.PreviewCellsSettings.PreviewCellsRange),e?.PreviewCellsRange&&this.setPreviewRangeCellsDirty(e.PreviewCellsRange),t.PreviewCellsSettings=e||void 0}getPreviewText(e){return Dx.verifyArgumentNotNull(e,"cell","getPreviewText"),e.PreviewText}setPreviewText(e,t){Dx.verifyArgumentNotNull(e,"cell","setPreviewText"),e.PreviewText=t}getPreviewNumFmt(e){return va(e,"cell","getPreviewNumFmt"),e.PreviewNumFmt}setPreviewNumFmt(e,t){Dx.verifyArgumentNotNull(e,"cell","setPreviewNumFmt"),e.PreviewNumFmt=t}setRetainTextOnPreview(e,t){Dx.verifyArgumentNotNull(e,"cell","setRetainTextOnPreview"),e.RetainTextOnPreview=t}getPreviewCellStyle(e){return va(e,"cell","getPreviewCellStyle"),e.PreviewCellStyle}setPreviewCellStyle(e,t){Dx.verifyArgumentNotNull(e,"cell","setPreviewCellStyle"),e.PreviewCellStyle=t}getIsTextReplacedWithHashes(e){return Dx.verifyArgumentNotNull(e,"cell","getIsTextReplacedWithHashes"),!!pm(e)}getIsHashedValue(e){return Dx.verifyArgumentNotNull(e,"cell","getIsHashedValue"),!!e.IsHashedValue}setIsHashedValue(e,t){Dx.verifyArgumentNotNull(e,"cell","setIsHashedValue"),e.IsHashedValue=t}isSkeletonCell(e){return Dx.verifyArgumentNotNull(e,"cell","isSkeletonCell"),!!e.ShowSkeleton}setShowSkeleton(e,t){Dx.verifyArgumentNotNull(e,"cell","setShowSkeleton"),e.ShowSkeleton=t}hasFilters(){for(let e=0;e<this.model.Cells.length;e++){const t=this.model.Cells[e];if(t.AutoFilter||t.PivotFilter)return!0}return!1}hasRichValueIcon(e){return null!=e&&null!=e.LinkedEntity&&null!=e.LinkedEntity.IconWidth&&e.LinkedEntity.IconWidth>0}getCellContentWidth(e){if(va(e,"cell","getCellContentWidth"),this.hasRichValueIcon(e))throw Error("getCellContentWidth: unsupported rich value icon!");const t=this.getOrCreateCanvasContext(),n={Text:e.Text,CellValueType:e.ValueType,CellStyleId:e.StyleID||0,Autofilter:null!=e.AutoFilter,ExpandColButton:e.PivotTable?.ShouldShowExpandCollapseMenu,CondWidthIcon:null!=e.CondFormat&&null!=e.CondFormat.Icon,TextRuns:e.TextRuns};return Sx(t,this.model,n,e.Col,void 0)}isCellWidthFixed(e){return va(e,"cell","isCellWidthFixed"),!!this.model.FixedColumns&&this.model.FixedColumns[e.Col]}isCellHeightFixed(e){return va(e,"cell","isCellHeightFixed"),!!this.model.IsBitwiseFixedRows&&Nc(this.model.IsBitwiseFixedRows,e.Row)}getRichValueTypes(){return this.model.RichValueTypes||[]}getCellHeightWithWrap(e,t,n,o){if(va(e,"cell","getCellHeightWithWrap"),!o||e.ValueType!==Wt.String||e.Merge||!e.Text||Nc(this.model.IsBitwiseFixedRows||0,e.Row))return this.getRowHeight(e.Row);e.CachedDrawingLayout||(e.CachedDrawingLayout={CellTextLayout:{}});const r={zoom:t,devicePixelRatio:n,debugMode:!1,isFormulaView:!1,isCanvasHitTestDebugHighlight:!1,isCellsPreviewMode:!1,modelFromCache:!1,renderPageLayout:!1,skeletonMode:!1,subPixelRenderingEnabled:!1,scaleFactor:t*n,isDifferentialRendering:!1};let i=null;i=this.getOrCreateCanvasContext(),Ba(this.model,e,!1),i.font=yh(e,this.model);const l=Zh(this.model,e,!0),s=vp(this.model,e,t,devicePixelRatio),a=gu(l,YC(this.model,e),s,mm(e.PivotTable?.HasExpandCollapseIndicator),om(this.model,e,t,devicePixelRatio)),c=this.model.RowHeights[e.Row]-ts,u=Zs(e)?c:a,d=lS(e,sS(e),u,this.model,r);if(d<=0)return this.getRowHeight(e.Row);const h=hp(i,this.model,e),f=Sp(e,this.model);return Math.ceil(h/d)*f}updateBreakOpForCell(e){Ca(e,"cell","updateBreakOpForCell");const t=Ua(e,this.model);if(!t)return;if(!Lc(t))return;const n=function(e){if(!Intl.Segmenter)return;Ra||(Ra=new Intl.Segmenter("th",{granularity:"word"}));const t=Ra.segment(e)[Symbol.iterator](),n=[];for(let t=0;t<e.length;t++)n.push("2");let o=t.next();for(;!1===o.done;){const e=o.value;e.isWordLike&&e.index>0&&(n[e.index]="1"),o=t.next()}return n.join("")}(t);n&&(e.WrapText||(e.WrapText={}),e.WrapText.BreakOp=n)}getCellHeightBasedOnContent(e,t,n){return Ca(e,"cell","getCellHeightBasedOnContent"),e.WrapText?this.getCellHeightWithWrap(e,t,n,!0):(e.CachedDrawingLayout||(e.CachedDrawingLayout={CellTextLayout:{}}),Ba(this.model,e,!1),Sp(e,this.model))}getCellPositions(e=void 0){const t=[];return this.model.Cells?.forEach((n=>{e&&!e(n)||t.push({row:n.Row,col:n.Col})})),t}insertRowBreak(e){e&&0!==e.length&&(this.model.PageBreaks?.Row&&this.model.PageBreaks.Row.length>0?this.model.PageBreaks.Row=this.model.PageBreaks.Row.concat(e):this.model.PageBreaks?this.model.PageBreaks.Row=e:this.model.PageBreaks={Row:e})}insertColBreak(e){e&&0!==e.length&&(this.model.PageBreaks?.Col&&this.model.PageBreaks.Col.length>0?this.model.PageBreaks.Col=this.model.PageBreaks.Col.concat(e):this.model.PageBreaks?this.model.PageBreaks.Col=e:this.model.PageBreaks={Col:e})}removeRowBreak(e){if(!e||0===e.length||!this.model.PageBreaks?.Row||0===this.model.PageBreaks.Row.length)return!1;const t=this.model.PageBreaks.Row.filter((t=>e.every((e=>e.Index!==t.Index)))),n=this.model.PageBreaks.Row.length!==t.length;return this.model.PageBreaks.Row=t.length>0?t:void 0,n}removeColBreak(e){if(!e||0===e.length||!this.model.PageBreaks?.Col||0===this.model.PageBreaks.Col.length)return!1;const t=this.model.PageBreaks.Col.filter((t=>e.every((e=>e.Index!==t.Index)))),n=this.model.PageBreaks.Col.length!==t.length;return this.model.PageBreaks.Col=t.length>0?t:void 0,n}isStyleUnique(e){return e===Nt.Default||e===Nt.Hyperlink}removeBordersWithinASpillCell(e){for(let t=1;t<=e.Spill.SpanToEnd;t++){const n=this.getCell(e.Row,e.Col+t);if(n){const e=this.getBorderStyle(n);e&&e.Borders&&e.Borders.length>0&&this.removeCellLeftBorder(n,e)}}}removeCellLeftBorder(e,t){const n=hc(t,t.ID||0,1);if(n&&n.Borders){const t=n.Borders.length;for(let o=0;o<t;o++){const t=n.Borders[o];t&&t.BorderPosition===$t.Left&&(n.Borders.splice(o),Jn()?this.setBordersNew(e,n,!0):this.setBorders(e,n))}}}duplicateAndSetNewFontOnTextRun(e,t){const n=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=n.newFontId,t.CachedFont=n.newFont}duplicateAndSetNewFontOnCell(e,t){const{newFontId:n,newFont:o}=this.duplicateAndSetNewFontInModel(e,!1);t.CachedFont=o,t.CachedStyle.FontID=n}duplicateAndSetFontsInModel(e){const t=[],n=Object.keys(e);for(let o=0;o<n.length;o++){const r=e[parseInt(n[o],10)||0],{newFontId:i}=this.duplicateAndSetNewFontInModel(r,!0);t[r.ID||0]=i}return t}duplicatePivotTableRangeInformations(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicatePivotTableRangeInformation(e[n]));return t}duplicatePivotTableRangeInformation(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid,SlicerConnections:e.SlicerConnections,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh,UseExpandedGeometry:e.UseExpandedGeometry,ExpandedGeometryRange:this.duplicateRangeInformation(e.ExpandedGeometryRange),FilterAreaRowCount:e.FilterAreaRowCount,FilterAreaColCount:e.FilterAreaColCount,FilterCount:e.FilterCount}}duplicateRangeInformation(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}}duplicatePivotTableFieldInfos(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicatePivotTableFieldInfo(e[n]));return t}duplicatePivotTableFieldInfo(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}duplicateAndSetNewFontInModel(e,t){const n=this.model.Fonts.length,o=fc(e,n,t?e.RefCount||0:1);return t||(e.RefCount=Math.max(0,(e.RefCount||0)-1)),this.model.Fonts.splice(n,0,o),{newFontId:n,newFont:o}}duplicateSparklineRangeInformations(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicateSparklineRangeInformation(e[n]));return t}duplicateSparklineRangeInformation(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}}duplicateRichValueFields(e){if(!e)return;const t=[];for(let n=0;n<e.length;n++)t.push(this.duplicateRichValueField(e[n]));return t}duplicateRichValueField(e){return{Index:e.Index,RefersToDotFunction:e.RefersToDotFunction,Value:e.Value}}setContextCellFont(e,t){e.font=yh(t,this.model)}setPreviewRangeCellsDirty(e){const t={FirstColumn:Math.max(e.FirstColumn-1,0),FirstRow:Math.max(e.FirstRow-1,0),LastColumn:e.LastColumn+1,LastRow:e.LastRow+1};this.setCellsInRangeDirty(t)}setCellsInRangeDirty(e){for(let t=0;t<this.model.Cells.length;t++){const n=this.model.Cells[t];Ll(this.model,e,n)&&this.setCellAndSpannedOverCellsDirty(n)}}isIndexInOutline(e,t,n){const o=n?this.model.RowNumbers.length:this.model.ColumnNumbers.length;if(t.IsNonDefaultDirection){const n=-1!==t.ButtonIndex?t.ButtonIndex+1:0,r=-1!==t.StartIndex?t.StartIndex:o-1;if(e>=n&&e<=r)return!0}else{const n=-1!==t.StartIndex?t.StartIndex:0,r=-1!==t.ButtonIndex?t.ButtonIndex-1:o-1;if(e>=n&&e<=r)return!0}return!1}}var Mx,Ax;!function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Cooldown=2]="Cooldown"}(Mx||(Mx={})),function(e){e[e.Inactive=0]="Inactive",e[e.Cooldown=1]="Cooldown"}(Ax||(Ax={}));let Ox=Mx.Inactive,Bx=Ax.Inactive,kx={};function Px(e,t){return function(){if(Ox===Mx.Inactive){const e=Id(0,1e3);Ox=Mx.Active,setTimeout(Ex,e)}return Ox===Mx.Active}()?function(e,t){const n=_d?_d.now():-1,o=e();if(_d){const e=_d.now()-n;kx[t]||(kx[t]=[]),kx[t].push(e.toFixed(4))}return o}(e,t):e()}function Ex(){const e=Id(1,4e3);Ox=Mx.Cooldown,function(){if(Bx===Ax.Inactive){Bx=Ax.Cooldown;const e=Id(2,6e4);setTimeout((()=>{!function(){const e=JSON.stringify(kx);Pn.sendTraceTag(574648710,En.msoulscat_ES_EWAJSGrid,d.Info,`HitTest::Telemetry::sendMeasurementResults: ${e}`),kx={},Bx=Ax.Inactive}()}),e)}}(),setTimeout((()=>{Ox=Mx.Inactive}),e)}const Hx=new Map;function Lx(e,t){if(!t||t.length<=1)return;const n=JSON.stringify(t.map((e=>e.zIndex)));Hx.has(e)||Hx.set(e,[]),Hx.get(e).includes(n)||(Hx.get(e).push(n),Pn.sendTraceTag(508403979,En.msoulscat_ES_EWAJSGrid,d.Info,`logRegionCollision: source:${e}, regions:${n}`))}class Nx extends Zd{addRegionEventListener(e){this.cacheRegionAndRegisterEvents(e,e.eventType)}removeAllEventListeners(){this.isRegisteredToEvents&&(this.registeredEventsHitRegions.pointerdown&&this.canvas.removeEventListener("pointerdown",this.pointerDownEventHandler),this.registeredEventsHitRegions.pointerup&&this.canvas.removeEventListener("pointerup",this.pointerUpEventHandler),this.registeredEventsHitRegions.click&&(this.canvas.removeEventListener(US,this.pointerDownEventHandler),this.canvas.removeEventListener("click",this.clickEventHandler)),this.registeredEventsHitRegions.touchstart&&this.canvas.removeEventListener("touchstart",this.touchStartEventHandler),this.registeredEventsHitRegions.dblclick&&this.canvas.removeEventListener("dblclick",this.dblClickEventHandler),this.registeredEventsHitRegions.touchend&&this.canvas.removeEventListener("touchend",this.touchEndEventHandler),this.isListeningToPointerMove&&(this.canvas.removeEventListener("pointermove",this.pointerMoveEventHandler),this.canvas.removeEventListener(jS,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!1),this.registeredEventsHitRegions={},this.isRegisteredToEvents=!1,this.isHitMapSorted=!0)}addCursorRegion(e){this.cacheRegionAndRegisterEvents(e,_S)}addTooltipRegion(e){this.cacheRegionAndRegisterEvents(e,zS)}addLongPressRegion(e){this.cacheRegionAndRegisterEvents(e,GS)}dispose(){this.removeAllEventListeners(),super.dispose()}setHitMapOffsets(e,t,n,o,r){if(e.length>Co||t.length>Co)throw Error(`setHitMapOffsets:: offsets.length exceeds max allowed offsets length. x: ${e.length}, y: ${t.length}`);const i=r?r.endOffsetX-r.startOffsetX:n,l=Nx.doOffsetsHaveEqualDistances(e,i),s=Nx.getFirstOffsetSize(e,n);l&&0===s&&Pn.sendTraceTag(522311843,En.msoulscat_ES_EWAJSGrid,d.Info,`setHitMapOffsets: width:${n} renderingRegion:${JSON.stringify(r)} offsetsX:${JSON.stringify(e)}}`),this.hitMapAxisX={areOffsetsEqual:l,equalOffsetsSize:s,offsets:e};const a=r?r.endOffsetY-r.startOffsetY:o,c=Nx.doOffsetsHaveEqualDistances(t,a),u=Nx.getFirstOffsetSize(t,o);c&&0===u&&Pn.sendTraceTag(522311872,En.msoulscat_ES_EWAJSGrid,d.Info,`setHitMapOffsets: height:${o} renderingRegion:${JSON.stringify(r)} offsetsY:${JSON.stringify(t)}}`),this.hitMapAxisY={areOffsetsEqual:c,equalOffsetsSize:u,offsets:t}}optimizeHitMapLookup(){this.isHitMapSorted||this.sortHitMap()}setAppZoom(e){this.zoom=e}setDimensions(e,t,n){super.setDimensions(e,t,n),this.setDefaultHitMapAxes(e,t)}cancelLongPressTimer(e,t){this.longPressState.callbackScheduled&&!this.longPressState.longPressModeEnabled&&clearTimeout(this.longPressState.callbackId);const n=this.canvas;n&&n.releasePointerCapture&&-1!==this.longPressState.eventPointerId&&n.releasePointerCapture(this.longPressState.eventPointerId),this.longPressState.longPressModeEnabled&&this.handleMouseLongPressEnd(this.longPressState.lastHitRegion),this.longPressState={callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0};const o=Zb(e,t),r=this.getEventCoordinatesInCanvas(o.clientX,o.clientY);this.handlePointerMove(e,r)}getHitMapOffsetsX(){return this.hitMapAxisX}getHitMapOffsetsY(){return this.hitMapAxisY}getAppZoom(){return this.zoom}getIsHitMapSorted(){return this.isHitMapSorted}getEventTypeRegisteredEventsHitRegions(e){return this.registeredEventsHitRegions[e]}getIntersectingHitMapAreasKeys(e){const t=[],n=this.getRenderingRegion();if(!n)return t;const o=n.endOffsetX-n.startOffsetX,r=n.endOffsetY-n.startOffsetY;if(!Za(e.x,e.x+e.width,0,0+o)||!Za(e.y,e.y+e.height,0,0+r))return t;let i=Nx.getOffsetPosition(e.x,this.hitMapAxisX);const l=!!eu(),s=l?0:1;let a=Nx.getOffsetPosition(e.x+e.width-s,this.hitMapAxisX,l),c=Nx.getOffsetPosition(e.y,this.hitMapAxisY),u=Nx.getOffsetPosition(e.y+e.height-s,this.hitMapAxisY,l);(i<0||c<0||a>=this.hitMapAxisX.offsets.length||u>=this.hitMapAxisY.offsets.length)&&(this.arrayOverflowInvestigationLogged||(Pn.sendTraceTag(508052569,En.msoulscat_ES_EWAJSGrid,d.Info,`InteractableCanvasElement::getIntersectingHitMapAreasKeys: xStartPosition:${i}, xEndPosition:${a}, yStartPosition:${c}, yEndPosition:${u}, hitMapAxisX:[${this.hitMapAxisX.offsets}], hitMapAxisY:[${this.hitMapAxisY.offsets}], region.x:${e.x}, region.width:${e.width}, region.y:${e.y}, region.height:${e.height}`),this.arrayOverflowInvestigationLogged=!0),i<0&&(i=0),c<0&&(c=0),a>=this.hitMapAxisX.offsets.length&&(a=this.hitMapAxisX.offsets.length-1),u>=this.hitMapAxisY.offsets.length&&(u=this.hitMapAxisY.offsets.length-1));for(let e=i;e<=a;e++)for(let n=c;n<=u;n++)t.push(Nx.getHitMapAreaKeyFromOffsetPosition(e,n));return t}getHitMapAreaKeyFromOffset(e,t){const n=Nx.getOffsetPosition(e,this.hitMapAxisX),o=Nx.getOffsetPosition(t,this.hitMapAxisY);return Nx.getHitMapAreaKeyFromOffsetPosition(n,o)}isEventStartAndEndInSameRegion(e,t,n){if(0===n.length)return!1;const{clientX:o,clientY:r}=Zb(e,t),i=this.getEventCoordinatesInCanvas(o,r),l=this.getIntersectingHitRegions(t,i);return l.length>0&&(s=n[0],a=l[0],s.zIndex===a.zIndex&&(c=s.region,u=a.region,c.x===u.x&&c.y===u.y&&c.width===u.width&&c.height==c.height));var s,a,c,u}static getHitMapAreaKeyFromOffsetPosition(e,t){return(e<<mo)+t}static getOffsetPosition(e,t,n){if(t.areOffsetsEqual)return 0===t.equalOffsetsSize&&Aa("areOffsetsEqual cannot be 0","getOffsetPosition"),n&&e%t.equalOffsetsSize==0?e/t.equalOffsetsSize-1:Math.floor(e/t.equalOffsetsSize);const o=xa(t.offsets,0,t.offsets.length,e,ba);return o<0?~o-1:n?o-1:o}static doOffsetsHaveEqualDistances(e,t){if(e.length<2)return!0;const n=e[1];for(let t=2;t<e.length;t++)if(e[t]-e[t-1]!==n)return!1;return t-e[e.length-1]===n}getDefaultHitMapAxis(e){const t=Math.floor(e/30),n=[];for(let e=0;e<30;e++)n.push(e*t);return 0===t&&Pn.sendTraceTag(522311873,En.msoulscat_ES_EWAJSGrid,d.Info,`InteractableCanvasElement::getDefaultHitMapAxis: totalSize:${e}`),{areOffsetsEqual:!0,equalOffsetsSize:t,offsets:n}}static getFirstOffsetSize(e,t){return e.length<2?t:e[1]}onPointerDown(e){if(!vd())return!1;const t="pointerdown",n=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);return this.lastPointerDownClickHitRegions=this.getIntersectingHitRegions("click",n),this.handleMouseLongPress(e,t),this.onBasicPointerEvent(e,t,this.pointerDownEventHandler)}onPointerUp(e){const t="pointerup";return this.longPressState.callbackScheduled&&this.cancelLongPressTimer(e,t),this.onBasicPointerEvent(e,t,this.pointerUpEventHandler)}onPointerLeave(e){return this.handleMouseLeaveEventTriggering(e,qS),this.lastPointerPosition=qS,this.canvas.style.cursor=XS,this.lastCursorType=XS,!0}onClick(e){const t="click";return!(!vd()||!this.isEventStartAndEndInSameRegion(e,t,this.lastPointerDownClickHitRegions))&&this.onBasicPointerEvent(e,t,this.clickEventHandler)}ondblclick(e){return!!vd()&&this.onBasicPointerEvent(e,"dblclick",this.dblClickEventHandler)}onTouchStart(e){if(!vd())return!1;const t=this.getEventCoordinatesInCanvas(e.touches?.[0]?.clientX,e.touches?.[0]?.clientY);return this.lastPointerDownTouchEndHitRegions=this.getIntersectingHitRegions("touchend",t),this.onBasicPointerEvent(e,"touchstart",this.touchStartEventHandler)}onTouchEnd(e){const t="touchend";return!(!vd()||!this.isEventStartAndEndInSameRegion(e,t,this.lastPointerDownTouchEndHitRegions))&&this.onBasicPointerEvent(e,t,this.touchEndEventHandler)}onBasicPointerEvent(e,t,n){return Px((()=>this.isEventHasRegisteredHandlers(t)?this.handleBasicPointerEvents(t,e):(this.removeUnnecessaryEventListeners(t,n),!0)),t)}removeUnnecessaryEventListeners(e,t){this.isEventHasRegisteredHandlers("longpress")||(e!==US||this.isEventHasRegisteredHandlers("click")?e===$S&&this.canvas.removeEventListener(e,t):this.canvas.removeEventListener(e,t))}onPointerMove(e){vd()&&Px((()=>{const t=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);this.handlePointerMove(e,t)}),VS)}handleBasicPointerEvents(e,t){const n=Zb(t,e),o=this.getEventCoordinatesInCanvas(n.clientX,n.clientY),r=this.getIntersectingHitRegions(e,o);return this.propagateEventToHandlers(t,r,e,(()=>!0))}handlePointerMove(e,t){this.longPressState.longPressModeEnabled||(this.handleMouseLeaveEventTriggering(e,t),this.handleMouseEnterEventTriggering(e,t),this.handleCursorType(e,t),this.handleTooltipChange(t)),this.lastPointerPosition=t}handleMouseLeaveEventTriggering(e,t){if(this.lastPointerPosition===qS)return;const n=this.getIntersectingHitRegions("mouseleave",this.lastPointerPosition);this.propagateEventToHandlers(e,n,"mouseleave",(e=>t===qS||!tc(e.region,t)))}handleMouseEnterEventTriggering(e,t){if(t===qS)return;const n=this.getIntersectingHitRegions("mouseenter",t);this.propagateEventToHandlers(e,n,"mouseenter",(e=>this.lastPointerPosition===qS||!tc(e.region,this.lastPointerPosition)))}propagateEventToHandlers(e,t,n,o){let r=Number.MAX_SAFE_INTEGER;this.getIsRegionCollisionTelemetryEnabled()&&Lx(n,t);for(let i=0;i<t.length;i++){const l=t[i];if(l.zIndex>r)throw Error(`handleEventPropagationToHandlers: expected handlers to be sorted by z-index, highest first. latestZIndex=${r}, currentZIndex=${l.zIndex}, eventType: ${n}, totalHandlersCount=${t.length}`);if(o(l)){const t=l.callback(e);if("boolean"==typeof t){if(t)return e.stopPropagation(),e.preventDefault(),!1}else if(t.handled)return t.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1}r=l.zIndex}return!0}handleCursorType(e,t){let n=XS;if(t!==qS){const o=this.getIntersectingHitRegions(_S,t);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&Lx("cursor",o);const t=o.find((t=>t.shouldChangeCursor(e)));t&&(n=t.cursorType)}}this.lastCursorType!==n&&(this.lastCursorType=n,this.canvas.style.cursor=n)}handleTooltipChange(e){let t,n="";if(e!==qS){const o=this.getIntersectingHitRegions(zS,e);if(o&&o.length>0){this.getIsRegionCollisionTelemetryEnabled()&&Lx("tooltip",o);const e=o[0],r=e.region;n=e.tooltipText,t=this.getHitMapAreaKeyFromOffset(r.x,r.y)}}const o=this.lastTooltipHitRegionKey!==t,r=this.lastTooltip!==n;if(r||o){if(this.lastTooltip=n,this.lastTooltipHitRegionKey=t,o&&!r)return this.canvas.setAttribute("title",""),void setTimeout((()=>{this.canvas.setAttribute("title",n)}),0);this.canvas.setAttribute("title",n)}}handleMouseLongPressStart(e){e&&e.onStart()}handleMouseLongPressEnd(e){e&&e.onEnd()}getLongPressHitRegion(e){if(e!==qS){const t=this.getIntersectingHitRegions(GS,e);if(t&&t.length>0)return t[0]}}cacheRegionAndRegisterEvents(e,t){this.registeredEventsHitRegions[t]||this.registerHandlersForEvent(t);const n=this.getEventHitAreaMap(t);this.addHitRegion(e,n)}registerHandlersForEvent(e){switch(e){case"pointerdown":this.canvas.addEventListener(e,this.pointerDownEventHandler);break;case"pointerup":this.canvas.addEventListener(e,this.pointerUpEventHandler);break;case"click":this.canvas.addEventListener(US,this.pointerDownEventHandler),this.canvas.addEventListener(e,this.clickEventHandler);break;case"dblclick":this.canvas.addEventListener(e,this.dblClickEventHandler);break;case"touchstart":this.canvas.addEventListener(e,this.touchStartEventHandler);break;case"touchend":this.canvas.addEventListener(e,this.touchEndEventHandler);break;case"longpress":this.canvas.addEventListener(US,this.pointerDownEventHandler),this.canvas.addEventListener($S,this.pointerUpEventHandler);break;case"cursor":case"tooltip":case"mouseenter":case"mouseleave":this.isListeningToPointerMove||(this.canvas.addEventListener(VS,this.pointerMoveEventHandler),this.canvas.addEventListener(jS,this.pointerLeaveEventHandler),this.isListeningToPointerMove=!0)}this.isRegisteredToEvents=!0}getEventHitAreaMap(e){return this.registeredEventsHitRegions[e]||(this.registeredEventsHitRegions[e]={}),this.registeredEventsHitRegions[e]}addHitRegion(e,t){const n=this.getIntersectingHitMapAreasKeys(e.region);for(let o=0;o<n.length;o++){const r=n[o];t[r]||(t[r]=[]),t[r].push(e)}this.isHitMapSorted=!1}setDefaultHitMapAxes(e,t){this.hitMapAxisX=this.getDefaultHitMapAxis(e),this.hitMapAxisY=this.getDefaultHitMapAxis(t)}getEventCoordinatesInCanvas(e,t){const n=Bd()?e:e/this.zoom,o=Bd()?t:t/this.zoom,r=this.canvas.getBoundingClientRect();return{x:(n-r.left)/(Bd()?this.zoom:1),y:(o-r.top)/(Bd()?this.zoom:1)}}getIntersectingHitRegions(e,t){const n=[];if(this.registeredEventsHitRegions[e]){const o=this.getHitMapAreaKeyFromOffset(t.x,t.y);this.optimizeHitMapLookup();const r=this.registeredEventsHitRegions[e][o];if(r&&r.length>0)for(let e=0;e<r.length;e++){const o=r[e];tc(o.region,t)&&n.push(o)}}return n}isEventHasRegisteredHandlers(e){return!!this.registeredEventsHitRegions&&!!this.registeredEventsHitRegions[e]}sortHitMap(){const e=Object.keys(this.registeredEventsHitRegions);for(let t=0;t<e.length;t++){const n=this.registeredEventsHitRegions[e[t]],o=Object.keys(n);for(let e=0;e<o.length;e++){const t=parseInt(o[e],10);n[t]=n[t].sort(Qb)}}this.isHitMapSorted=!0}handleMouseLongPress(e,t){const n=1===e.button,o="touch"===e.pointerType;if(this.longPressState.callbackScheduled&&(!e.target||!n)||o)return;const r=Zb(e,t),i=this.getEventCoordinatesInCanvas(r.clientX,r.clientY),l=this.getLongPressHitRegion(i);if(!l)return;const s=e.target,a=e.pointerId;s&&s.setPointerCapture&&-1!==a&&s.setPointerCapture(a),this.longPressState.callbackId=window.setTimeout((()=>{this.onLongPress()}),800),this.longPressState.callbackScheduled=!0,this.longPressState.eventPointerId=a,this.longPressState.lastHitRegion=l}onLongPress(){this.canvas.style.cursor=XS,this.lastCursorType=XS,this.longPressState.longPressModeEnabled=!0,this.handleMouseLongPressStart(this.longPressState.lastHitRegion)}getIsRegionCollisionTelemetryEnabled(){return void 0===this.isRegionCollisionTelemetryEnabled&&(this.isRegionCollisionTelemetryEnabled=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.RegionCollisionTelemetry",void 0)),this.isRegionCollisionTelemetryEnabled??!1}constructor(e,t){super(e,t),this.isHitMapSorted=!0,this.isRegisteredToEvents=!1,this.isListeningToPointerMove=!1,this.lastPointerPosition=qS,this.lastPointerDownClickHitRegions=[],this.lastPointerDownTouchEndHitRegions=[],this.lastCursorType=XS,this.lastTooltip="",this.longPressState={callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0},this.zoom=1,this.arrayOverflowInvestigationLogged=!1,this.registeredEventsHitRegions={},this.setDefaultHitMapAxes(this.getWidth(),this.getHeight()),this.pointerDownEventHandler=this.onPointerDown.bind(this),this.pointerUpEventHandler=this.onPointerUp.bind(this),this.pointerMoveEventHandler=this.onPointerMove.bind(this),this.clickEventHandler=this.onClick.bind(this),this.dblClickEventHandler=this.ondblclick.bind(this),this.touchStartEventHandler=this.onTouchStart.bind(this),this.touchEndEventHandler=this.onTouchEnd.bind(this),this.pointerLeaveEventHandler=this.onPointerLeave.bind(this)}}function Wx(e,t,n,o){const r=t?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(!r)return;const i=r.length;for(let e=0;e<i;e++){const t=r[e],i=t.Outlines.length;for(let e=0;e<i;e++){const r=t.Outlines[e],i=n===r.ButtonIndex&&!!r.IsButtonHidden;r.ButtonIndex>-1&&n<=r.ButtonIndex&&!i&&(o?r.ButtonIndex++:r.ButtonIndex--);const l=r.IsNonDefaultDirection?n<=r.StartIndex:n<r.StartIndex;r.StartIndex>-1&&l&&(o?r.StartIndex++:r.StartIndex--)}}}function _x(e){return e?28:30}function zx(e,t,n,o,r,i,l,s){const a=function(e,t,n){return n?t-e:t}(n,o,l);Sc(e,o,ai(a,r,t,i,l)),jx(e,o+1,l?2*n:n,t,s)}function Gx(e,t,n,o,r){yc(e,t),jx(e,t,n,o,r)}function Vx(e,t,n){for(let o=t;o<e.length;o++)e[o]=e[o]+n}function jx(e,t,n,o,r){for(let i=t;i<n;i++){const t=e[i],n=i===r;if(o){const o=n?-1:e[i-1].Row;t.Row=o+1}else{const o=n?-1:e[i-1].Col;t.Col=o+1}}}function Ux(e,t){const n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return!!n&&n>0}const $x=2*Math.PI,qx=1,Xx=2,Yx=1,Jx=6,Kx=Xx+qx,Qx=5,Zx=0,eF=4,tF=7,nF=Qx+qx;function oF(e,t,n,o,r,i){let l,s;const{startHitRegionSize:a,endHitRegionSize:c}=function(e,t,n,o){const r=e?t.height:t.width;if(r<n+o){const e=r/2;return{startHitRegionSize:e,endHitRegionSize:e}}return{startHitRegionSize:n,endHitRegionSize:o}}(t,e,r,i);if(t){const t=n?e.x+e.width-o:e.x;l={x:t,y:e.y,width:o,height:a},s={x:t,y:e.y+e.height-c,width:o,height:c}}else n?(l={x:e.x+e.width-a,y:e.y,width:a,height:o},s={x:e.x,y:e.y,width:c,height:o}):(l={x:e.x,y:e.y,width:a,height:o},s={x:e.x+e.width-c,y:e.y,width:c,height:o});return{cellStartHitRegion:l,cellEndHitRegion:s}}function rF(e,t,n,o,r,i){let l=r-t.getCellExtent(n),s=0;const a=nF,c=e.IsRow?e.RowNumbers.length:e.ColumnNumbers.length;let u=n;for(;(l>0||s<a)&&(o?++u:--u,!(u<0||u>=c));){const n=e.Cells[u],r=t.getCellExtent(u);l>0&&(i(u),l-=r),s+=r,iF(o?n.InsertButtons?.End:n.InsertButtons?.Start)>s&&i(u)}}function iF(e){return e?e.Type===Tt.InsertButton?nF:e.Type===Tt.InsertDot?Kx:0:0}const lF=.5,sF=12,aF="#107C41",cF="#ffffff";class uF extends Fx{static verifyArgumentNotNull(e,t,n){Ca(e,t,`HeaderBlockModelAccessor.${n}`)}static throwErrorWrapper(e,t){Aa(e,`HeaderBlockModelAccessor.${t}`)}static isCellSnapped(e){return uF.verifyArgumentNotNull(e,"cell","isCellSnapped"),Fn(Sn.FixHeaderSnappingAutoFilterNone)?!!e.IsCellSnapped:!!e.AutoFilter}setIsCellSnapped(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setIsCellSnapped"),this.model.Cells[e].IsCellSnapped=t||void 0}isCellSnapped(e){this.verifyRelativeIndexOfRowColNumbers(e,"isCellSnapped");const t=this.model.Cells[e];return uF.isCellSnapped(t)}getAdjacentBlocksSelectionInfo(){return _o(this.model).AdjacentBlocksSelectionInfo}setAdjacentBlocksSelectionInfo(e){_o(this.model).AdjacentBlocksSelectionInfo=void 0===e?.FirstCellOfNextBlockSelection&&void 0===e?.LastCellOfPrevBlockSelection?void 0:e}getHeaderBlockModel(){return this.model}getIsHeaderSnapped(){return!!_o(this.model).isHeaderSnapped}setIsHeaderSnapped(e){_o(this.model).isHeaderSnapped=e}setStyleId(e,t){uF.verifyArgumentNotNull(t,"styleId","setStyleId");const n=this.getCell(e);if(!n)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");if(t=uF.isCellSnapped(n)?this.getUpdatedCellAlignmentFromCenterToLeftRight(n,t):t,(n.StyleID||0)!==t){n.StyleID=t;try{this.updateGlobalCellStyleID(n)}catch(e){Pn.sendTraceTag(507130582,En.msoulscat_ES_EWAJSGrid,d.Error,`HeaderBlockModelAccessor.setStyleId: ${e}`)}return!0}return!1}getStyleId(e){const t=this.getCell(e);if(!t)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");return t.StyleID||0}updateStylesForNamedSheetView(e){const t=ci(Bt.NamedSheetView,this.model.IsRtl);this.model.Styles=e?t:ni,yo(Vt.NewDefaultTemplate,this.model)&&yo(Vt.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=Kr:this.model.Fonts=Qr,this.processStyles(this.model)}updateStylesForDefaultViewMode(e){const t=ci(Bt.Default,this.model.IsRtl);this.model.Styles=e?t:ei,yo(Vt.NewDefaultTemplate,this.model)&&yo(Vt.NewThemeFontForHeaderFBarNBox,this.model)?this.model.Fonts=Yr:this.model.Fonts=Jr,this.processStyles(this.model)}updateSpillInformation(e,t){const n=this.getOrCreateCanvasContext(),o=e*t;Au(this.model)||Mu(this.model,o);for(const o of this.model.Cells)Fa(this.model,o,"updateSpillInformation"),o.Spill=void 0,rx(n,this.model,o,e,t)}setCellExtent(e,t){const n=this.isRow?this.model.RowHeights:this.model.ColumnWidths;uF.verifyArgumentNotNull(n,"blockExtents","setCellExtent");const o=this.isRow?this.model.RowOffsets:this.model.ColumnOffsets;uF.verifyArgumentNotNull(o,"blockOffsets","setCellExtent"),(e>n.length-1||e<0)&&uF.throwErrorWrapper("Cell not in model","setCellExtent"),t<=0&&uF.throwErrorWrapper("Cell extent cannot be a non positive value","setCellExtent"),function(e,t,n,o){const r=o?e.ColumnWidths:e.RowHeights,i=n-r[t];0!==i&&(r[t]=n,Vx(o?e.ColumnOffsets:e.RowOffsets,t+1,i),o?e.BlockWidth+=i:e.BlockHeight+=i)}(this.model,e,t,!this.isRow),this.setDirty("setCellExtent",on.ModelCoreChanges)}getCellExtent(e){const t=this.isRow?this.model.RowHeights:this.model.ColumnWidths;return uF.verifyArgumentNotNull(t,"blockExtents","getCellExtent"),(e>t.length-1||e<0)&&uF.throwErrorWrapper("Cell not in model","getCellExtent"),t[e]}getAutoFilterMenuOffsetsFromCellStart(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterMenuOffsetsFromCellStart");const o=this.model.Cells[e];return this.getAutoFilterMenuOffsetsFromCellStartInternal(o,t,n)}getAutoFilterButtonTotalSize(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"getAutoFilterButtonTotalSize");const o=this.model.Cells[e];return this.getAutoFilterButtonTotalSizeInternal(o,t,n)}addRowColToModel(e,t){!function(e,t,n,o,r){const i=r?e.RowNumbers:e.ColumnNumbers;if(i.indexOf(n)>=0)throw Error(`addRowColToModel: Invalid absolute index. ${r?"Row":"Column"} ${n} already exists in model`);if(o<0||o>i.length)throw Error("addRowColToModel: Invalid relative index.");var l,s;!function(e,t,n,o){const r=(o?e.RowNumbers.length:e.ColumnNumbers.length)+1,i=Ux(e,o);if(zx(e.Cells,o,r,n,t,i,!1,0),i){const l=n+r,s=_x(o);zx(e.Cells,o,r,l,t,i,!0,s)}}(e,n,o,r),Sc(i,o,n),Sc(r?e.RowHeights:e.ColumnWidths,o,1),Sc(l=r?e.RowOffsets:e.ColumnOffsets,s=o,l[s]),Vx(l,s+1,1),r?e.BlockHeight+=1:e.BlockWidth+=1,t.resetCellLookup(),Wx(e,r,o,!0)}(this.model,this,e,t,this.isRow)}updateCellText(e,t){uF.verifyArgumentNotNull(t,"text","updateCellText"),this.verifyRelativeIndexOfRowColNumbers(e,"updateCellText");const n=this.model.Cells[e];n.Text=t,n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0}}setUnsetShowResizePill(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetShowResizePill"),this.model.Cells[e].ShowResizePill=t}setUnsetResizePillLocation(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetResizePillLocation"),this.model.Cells[e].ResizePillLocation=t??void 0}setUnsetHoveredCell(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"setUnsetHoveredCell"),this.model.Cells[e].IsHovered=t}setInsertButton(e,t,n){this.verifyRelativeIndexOfRowColNumbers(e,"setInsertButton"),Ca(n,"buttonType","setInsertButton");const o=this.model.Cells[e];$s(o.InsertButtons)&&(o.InsertButtons={Start:void 0,End:void 0});const r={Type:n};let i=!1,l=0;return t?this.areInsertButtonsSame(o.InsertButtons.Start,r)||(l=Math.max(iF(r),iF(o.InsertButtons.Start)),o.InsertButtons.Start=r,i=!0):this.areInsertButtonsSame(o.InsertButtons.End,r)||(l=Math.max(iF(o.InsertButtons.End),iF(r)),o.InsertButtons.End=r,i=!0),i&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,l),i}removeInsertButton(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"removeInsertButton");const n=this.model.Cells[e];let o=!1,r=0;return t?n.InsertButtons?.Start&&(r=iF(n.InsertButtons?.Start),n.InsertButtons.Start=void 0,o=!0):n.InsertButtons?.End&&(r=iF(n.InsertButtons?.End),n.InsertButtons.End=void 0,o=!0),o&&this.setCellsDirtyForInsertButtonSpillOnUpdate(e,t,r),o}updateCellAlignment(e,t){this.verifyRelativeIndexOfRowColNumbers(e,"updateCellAlignment");const n=this.model.Cells[e],o=n.StyleID||0;n.StyleID=t?this.getUpdatedCellAlignmentFromCenterToLeftRight(n,o):this.getUpdatedCellAlignmentFromLeftRightToCenter(n,o);try{this.updateGlobalCellStyleID(n)}catch(e){Pn.sendTraceTag(507130581,En.msoulscat_ES_EWAJSGrid,d.Error,`HeaderBlockModelAccessor.updateCellAlignment: ${e}`)}}activateCellAutoFilter(e,t){this.verifyAutoFilterArguments(e,t),this.model.Cells[e].AutoFilter=t}deactivateCellAutoFilter(e){this.verifyRelativeIndexOfRowColNumbers(e,"deactivateCellAutoFilter"),this.isRow&&uF.throwErrorWrapper("AutoFilter in headerSnapping should be deactivated only for column header, but called for row header","deactivateCellAutoFilter"),this.model.Cells[e].AutoFilter=void 0}getCellAutoFilterCommandData(e){this.verifyRelativeIndexOfRowColNumbers(e,"getCellAutoFilterCommandData");const t=this.model.Cells[e].AutoFilter;return t||uF.throwErrorWrapper(`AutoFilter should be initialized by now but is undefined, cellRelativeIndex=${e}`,"getCellAutoFilterCommandData"),t.CommandData}removeRowColFromModel(e,t){!function(e,t,n,o,r){const i=r?e.RowNumbers:e.ColumnNumbers;if(i.indexOf(n)<0)throw Error(`removeRowColFromModel: Invalid absolute index. ${r?"Row":"Column"} ${n} doesn't exists in model`);if(o<0||o>=i.length)throw Error("removeRowColFromModel: Invalid relative index.");const l=r?e.RowHeights[o]:e.ColumnWidths[o];!function(e,t,n){const o=(n?e.RowNumbers.length:e.ColumnNumbers.length)-1;if(Gx(e.Cells,t,o,n,0),Ux(e,n)){const r=t+o,i=_x(n);Gx(e.Cells,r,2*o,n,i)}}(e,o,r),yc(i,o),yc(r?e.RowHeights:e.ColumnWidths,o),function(e,t){const n=t===e.length-1?0:e[t+1]-e[t];yc(e,t),Vx(e,t,-n)}(r?e.RowOffsets:e.ColumnOffsets,o),r?e.BlockHeight-=l:e.BlockWidth-=l,t.resetCellLookup(),Wx(e,r,o,!1)}(this.model,this,e,t,this.isRow)}isLastRowColOfPreviousBlockHidden(){return this.isRow?!!this.model.AdjacentBlocksHiddensInfo?.IsLastRowOfPrevBlockHidden:!!this.model.AdjacentBlocksHiddensInfo?.IsLastColOfPrevBlockHidden}setCellDirty(e,t){const n=this.isRow?this.model.RowHeights:this.model.ColumnWidths;if(uF.verifyArgumentNotNull(n,"blockExtents","setCellDirty"),(e>n.length-1||e<0)&&uF.throwErrorWrapper(`Cell index ${e} not in model, length ${n.length}`,"setCellDirty"),mr()){const n=this.ensureDirtyCellsMapInitialized();this.setCellDirtyInternal(e,t,n)}else{const t=this.ensureDirtyCellsKeysInitialized();this.addCellToDirtyCellKeys(e,t),this.setAdjacentCellsDirtyIfHidden(e,t,void 0,gn.EntireCell),fr()&&this.setCellsDirtyForInsertButtonSpillsForCell(e,t,void 0)}yo(Vt.DelayRenderToNextAnimationFrame,this.model)?this.setDirtyInternal(on.ModelCellChanges,!0):this.setDirtyInternal(on.ModelCellChanges)}setDataCleansingIcon(e,t){const n=this.getCell(e);if(!n)throw Error("HeaderBlockModelAccessor.setDataCleansingIcon: Cell not in model");n.DataCleansingIcon=t}getCell(e){return this.model.Cells[e]}getUpdatedCellAlignmentFromCenterToLeftRight(e,t){uF.verifyArgumentNotNull(e,"cell","updateCellAlignmentLeftRight");const n=this.model.IsRtl;switch(t){case ln.Default:return n?ln.RightAlignment:ln.LeftAlignment;case ln.Hover:return n?ln.HoverRightAlignment:ln.HoverLeftAlignment;case ln.PartialRowColSelection:return n?ln.PartialRowColSelectionRightAlignment:ln.PartialRowColSelectionLeftAlignment;case ln.PartialSelectionAndHover:return n?ln.PartialSelectionAndHoverRightAlignment:ln.PartialSelectionAndHoverLeftAlignment;case ln.WholeSelectionAndHover:return n?ln.WholeSelectionAndHoverRightAlignment:ln.WholeSelectionAndHoverLeftAlignment;case ln.WholeRowColSelection:return n?ln.WholeRowColSelectionRightAlignment:ln.WholeRowColSelectionLeftAlignment;default:Pn.sendTraceTag(506849216,En.msoulscat_ES_EWAJSGrid,d.Info,`updateCellAlignmentLeftRight: styleId is unexpected, styleId=${t}, cell.col=${e.Col}`)}return t}getUpdatedCellAlignmentFromLeftRightToCenter(e,t){switch(uF.verifyArgumentNotNull(e,"cell","updateCellAlignmentCenter"),t){case ln.RightAlignment:case ln.LeftAlignment:return ln.Default;case ln.HoverRightAlignment:case ln.HoverLeftAlignment:return ln.Hover;case ln.PartialRowColSelectionRightAlignment:case ln.PartialRowColSelectionLeftAlignment:return ln.PartialRowColSelection;case ln.PartialSelectionAndHoverRightAlignment:case ln.PartialSelectionAndHoverLeftAlignment:return ln.PartialSelectionAndHover;case ln.WholeSelectionAndHoverRightAlignment:case ln.WholeSelectionAndHoverLeftAlignment:return ln.WholeSelectionAndHover;case ln.WholeRowColSelectionRightAlignment:case ln.WholeRowColSelectionLeftAlignment:return ln.WholeRowColSelection;default:Pn.sendTraceTag(506849187,En.msoulscat_ES_EWAJSGrid,d.Info,`updateCellAlignmentCenter: styleId is unexpected, styleId=${t}, cell.col=${e.Col}`)}return t}verifyRelativeIndexOfRowColNumbers(e,t){const n=this.isRow?this.model.RowNumbers.length:this.model.ColumnNumbers.length;(e<0||e>=n)&&uF.throwErrorWrapper(`Invalid header relative index, received index=${e}, but headerNumbers.length=${n}`,t)}verifyAutoFilterArguments(e,t){this.isRow&&uF.throwErrorWrapper("AutoFilter in headerSnapping should be activated only for column header, but called for row header","activateCellAutoFilter"),uF.verifyArgumentNotNull(t,"autoFilterData","activateCellAutoFilter"),this.verifyRelativeIndexOfRowColNumbers(e,"activateCellAutoFilter")}setAdjacentCellsDirtyIfHidden(e,t,n,o){const r=this.isRow?this.model.RowNumbers:this.model.ColumnNumbers;mr()?(o&gn.CellStartGridlineArea&&this.isPrevCellHidden(r,e)&&this.addCellToDirtyCellsMap(e-1,gn.CellEndGridlineArea,n),o&gn.CellEndGridlineArea&&this.isNextCellHidden(r,e)&&this.addCellToDirtyCellsMap(e+1,gn.CellStartGridlineArea,n)):(this.isPrevCellHidden(r,e)&&this.addCellToDirtyCellKeys(e-1,t),this.isNextCellHidden(r,e)&&this.addCellToDirtyCellKeys(e+1,t))}setCellsDirtyForInsertButtonSpillOnUpdate(e,t,n){const o=mr()?e=>this.addCellToDirtyCellsMap(e,gn.GutterArea,this.ensureDirtyCellsMapInitialized()):e=>this.addCellToDirtyCellKeys(e,this.ensureDirtyCellsKeysInitialized());rF(this.model,this,e,t,n,o)}setCellsDirtyForInsertButtonSpillsForCell(e,t,n){const o=mr()?e=>this.addCellToDirtyCellsMap(e,gn.GutterArea,n):e=>this.addCellToDirtyCellKeys(e,t),r=this.model.Cells[e],i=iF(r.InsertButtons?.Start),l=iF(r.InsertButtons?.End);rF(this.model,this,e,!0,i,o),rF(this.model,this,e,!1,l,o)}setCellDirtyInternal(e,t,n){const o=this.addCellToDirtyCellsMap(e,t,n);this.setAdjacentCellsDirtyIfHidden(e,void 0,n,o),fr()&&o&gn.GutterArea&&this.setCellsDirtyForInsertButtonSpillsForCell(e,void 0,n)}processStyles(e){Ca(e,"model","processStyles"),Ca(e.Fonts,"model.Fonts","HeaderBlockModelAccessor:processStyles"),Ca(e.Styles,"model.Styles","HeaderBlockModelAccessor:processStyles");const t=e.Fonts,n=e.Styles;if(so()){try{this.processStylesWithGlobalFonts(n,t)}catch(e){lo(`HeaderBlockModelAccessor::ProcessStyle:: Fonts Processing failed with exception ${e}`)}try{this.processCellsWithGlobalCellStyles(e.Cells,e.Styles)}catch(e){io(`HeaderBlockModelAccessor::ProcessStyle:: Cell Styles Processing failed with exception ${e}`)}}}processStylesWithGlobalFonts(e,t){eo().process(t);for(let n=0;n<e.length;n++){const o=e[n];if(o){const e=o.FontID||0,n=Io(e,t);if(null==n)throw new Error(`HeaderBlockModelAccessor::preprocessStylesWithGlobalFonts: Local FontID ${e} not mapped to a Global Font ID`);o.GlobalFontID=n}}}processCellsWithGlobalCellStyles(e,t){oo().process(t);for(let t=0;t<e.length;t++){const n=e[t];try{this.updateGlobalCellStyleID(n)}catch(e){Pn.sendTraceTag(507130580,En.msoulscat_ES_EWAJSGrid,d.Error,`HeaderBlockModelAccessor.processCellsWithGlobalCellStyles: ${e}`)}}}updateGlobalCellStyleID(e){if(!so())return;const t=e.StyleID||0,n=Io(t,this.model.Styles);if(null==n)throw new Error(`HeaderBlockModelAccessor::updateGlobalCellStyleID: Local Cell StyleID ${t} not mapped to a Global Style ID`);e.GlobalCellStyleID=n}addCellToDirtyCellKeys(e,t){const n=this.getHeaderRegularCellsIndex(),o=this.isRow?e:n,r=this.isRow?n:e;t.push(Ao(o,r))}addCellToDirtyCellsMap(e,t,n){const o=this.getHeaderRegularCellsIndex(),r=Ao(this.isRow?e:o,this.isRow?o:e),i=n.get(r)??0,l=this.validateAndExpandDirtyAreas(e,i|t);return n.set(r,l),l}validateAndExpandDirtyAreas(e,t){let n=t;if(0==(n&gn.EntireCell)&&n&(gn.CellStartGridlineArea|gn.CellEndGridlineArea)){let t=!0;this.isCellSnapped(e)&&(t=!1),t&&!this.isCellSizeSufficientForPartialGridlineRendering(e)&&(t=!1),t&&this.isRow&&(n|=gn.GutterArea),t||(n|=gn.EntireCell)}return 0==(n&(gn.EntireCell|gn.GutterArea|gn.CellStartGridlineArea|gn.CellEndGridlineArea))&&(n=gn.EntireCell),n&gn.EntireCell&&(n=gn.EntireCell|gn.GutterArea|gn.CellStartGridlineArea|gn.CellEndGridlineArea),n}isCellSizeSufficientForPartialGridlineRendering(e){const t=this.getCellExtent(e);if(this.isRow)return t>15;{const n=this.model.Cells[e],o=n.Text?.length;return t>(o?14*o:Us)+6}}getHeaderRegularCellsIndex(){return Ou(this.model,this.isRow)?1:0}areInsertButtonsSame(e,t){return e?.Type===t?.Type}isPrevCellHidden(e,t){return t>0&&e[t]>e[t-1]+1}isNextCellHidden(e,t){return t<e.length-1&&e[t+1]>e[t]+1}constructor(e,t){super(e),this.isRow=t,this.processStyles(e),e.AreStylesProcessed=!0}}const dF=3,hF=5,fF=5.5,gF=3.5,mF=5,CF=.25,pF=2*fF+mF,wF=hF+mF,SF=hF+1,yF=2*gF+mF,RF=dF+mF,TF=dF+1;let IF;function vF(e,t,n,o,r,i,l,s){e.strokeStyle=n,e.fillStyle=o,e.lineWidth=t,e.beginPath(),e.roundRect?.(r,i,l-t,s-t,[90]),e.fill(),e.stroke()}function bF(e){return e?Qa(e.TextColor):aF}function xF(e){return e?Qa(e.BackgroundColor):cF}function FF(e,t,n,o){return{x:uf(e,t,e.IsRtl)-20*n-2*n,y:(o&&t.ResizePillLocation===It.CellStart?gf(e,t,!1):df(e,t))-dF*n/2}}function DF(e,t,n,o){const r=(o&&t.ResizePillLocation===It.CellStart?af(e,t,e.IsRtl,!1):uf(e,t,e.IsRtl)+ts)-hF*n/2,i=gf(e,t,!1),l=_u(n);return{x:r,y:i+l+(sf(e,t)-l-16*n)/2}}const MF=10,AF=12,OF=6,BF=4;function kF(e,t,n,o,r){const i={TopPx:r?n.EndPoint.TopPx:o,LeftPx:r?o:n.EndPoint.LeftPx,Cell:t};n.Button={EdgeInformation:i,IsExpand:n.IsExpanded},e.push(n.Button)}function PF(e,t,n,o,r,i){const l=!!t.IsNonDefaultDirection;!function(e,t,n,o,r){const i=-1===t.StartIndex,l=r&&i,s=function(e,t,n,o){return e.IsRow?o?e.BlockHeight*t:0:n}(e,o,n,l),a=function(e,t,n,o){return e.IsRow?n:o?e.IsRtl?0:e.BlockWidth*t:e.IsRtl?e.BlockWidth*t:0}(e,o,n,l);t.StartPoint={TopPx:s,LeftPx:a}}(e,t,r,i,l),function(e,t,n,o,r,i){const l=!!t.IsButtonHidden;if(e.IsRow){const s=function(e,t,n,o,r,i){let l=Ns;return t?r?l=i?df(e,n)-Ns:gf(e,n,!1)+Ns:(l+=hf(e,n),l-=_F(o)):l+=i?0:e.BlockHeight*o,Math.floor(l)}(e,o,n,r,l,i);t.EndPoint={TopPx:s,LeftPx:t.StartPoint.LeftPx}}else{const s=function(e,t,n,o,r,i){let l=0;const s=e.IsRtl,a=s&&i,c=!s&&i;return t&&n?r?l+=s&&!i||c?uf(e,n,!1):af(e,n,!1,!1):(l=ff(e,n,!1),l-=_F(o)):l=c?0:!s||a?e.BlockWidth*o:0,Math.floor(l)}(e,o,n,r,l,i);t.EndPoint={TopPx:t.StartPoint.TopPx,LeftPx:s}}}(e,t,n,o,i,l)}function EF(e,t,n,o){const r=n.StartIndex,i=(e.IsRow?e.RowNumbers?.length:e.ColumnNumbers?.length)??0;r>-1&&r<i&&(function(e,t,n,o){const r=zF(e,n),i=!!t.IsNonDefaultDirection;if(e.IsRow){const n=function(e,t,n){return n?df(e,t):gf(e,t,!1)}(e,r,i);t.StartPoint.TopPx=n>0?n-Ns:0}else t.StartPoint.LeftPx=function(e,t,n,o){return e.IsRtl?function(e,t,n,o){return n?HF(e,t):LF(e,t,o)}(e,t,n,o):function(e,t,n,o){return n?LF(e,t,o):HF(e,t)}(e,t,n,o)}(e,r,i,o)}(e,n,r,o),function(e,t,n,o){const r=Math.round(BF*o),i=e.IsRow,l=t.StartPoint,s=function(e,t,n,o){return n?o?e-t-Ns:e+t+Ns:e}(l.LeftPx,r,i,e.IsRtl);Su(n,s,i?l.TopPx:l.TopPx+r,l.LeftPx,l.TopPx)}(e,n,t,o))}function HF(e,t){const n=af(e,t,!1,!1);return n>0?n-Ns:Ns}function LF(e,t,n){const o=uf(e,t,!1),r=e.BlockWidth*n;return o<r?o+Ns:r-Ns}function NF(e,t,n,o){const r=Math.round((OF+e*AF)*t);return n?Math.floor(o*t)-r:r}function WF(e,t,n){const o=t?0:ts;return e-_F(n)+o}function _F(e){return Xv(e,MF)/2}function zF(e,t){return e.IsRow?$o(t,0,e):$o(0,t,e)}function GF(e,t,n,o,r,i,l){i&&!t.IsButtonHidden&&kF(o,l,t,r,e.IsRow),Su(n,t.StartPoint.LeftPx,t.StartPoint.TopPx,t.EndPoint.LeftPx,t.EndPoint.TopPx)}function VF(e,t){return t?$r+2*XF(e):$r+ts}function jF(e,t){return t?e+ts:e-ts}function UF(e,t,n,o,r,i,l,s,a,c,u,d,h,f,g,m,C){const{hiddenFrameStartPositionsPx:p,hiddenFramePartiallySelectedStartPositionsPx:w,hiddenFrameWhollySelectedStartPositionsPx:S}=function(e,t,n,o,r,i){const l=[],s=[],a=[],{startIndex:c,endIndex:u}=function(e,t,n){return{startIndex:e>0?e-1:0,endIndex:t<n?t+1:n}}(o,r,t.length-1);let d=t[c],h=Hu(n[c]),f=!!i&&Lu(n[c]);for(let o=c+1;o<=u;o++){const r=t[o],c=Hu(n[o]),u=!!i&&Lu(n[o]);r>d+1&&qF(e[o],h&&c?s:f&&u?a:l),h=c,f=u,d=r}return{hiddenFrameStartPositionsPx:l,hiddenFramePartiallySelectedStartPositionsPx:s,hiddenFrameWhollySelectedStartPositionsPx:a}}(r,i,o,u,d,m);!function(e,t,n,o,r,i,l,s,a){let c=n;if(e){const e=i[0],t=a?.LastCellOfPrevBlockSelection;Hu(e)&&t===dn.Partial&&(c=o),s&&Lu(e)&&t===dn.Full&&(c=r),qF(l[0],c)}if(t){const e=i[i.length-1];c=n;const t=a?.FirstCellOfNextBlockSelection;Hu(e)&&t===dn.Partial&&(c=o),s&&Lu(e)&&t===dn.Full&&(c=r),qF(l[l.length-1],c)}}(h,f,p,w,S,o,r,m,C),$F(p,e,t,n,l,s,a,c,!1,!1,g,m),m&&S.length>0&&$F(S,e,t,n,l,s,a,c,!1,!0,g,m),$F(w,e,t,n,l,s,a,c,!0,!1,g,m)}function $F(e,t,n,o,r,i,l,s,a,c,u,d){if(e.length>0){const{frameOutlinesColor:h,fillColor:f}=function(e,t,n,o){return $s(e.highContrastScheme)?e.viewMode===Bt.NamedSheetView?o?{frameOutlinesColor:t||n?Yl:Xl,fillColor:Pr}:t?{frameOutlinesColor:zl,fillColor:Pr}:{frameOutlinesColor:_l,fillColor:Pr}:o?t?{frameOutlinesColor:$l,fillColor:Mr}:n?{frameOutlinesColor:ql,fillColor:Or}:{frameOutlinesColor:jl,fillColor:Ul}:t?{frameOutlinesColor:Wl,fillColor:Mr}:{frameOutlinesColor:Nl,fillColor:Fr}:{frameOutlinesColor:`${Qa(e.highContrastScheme.TextColor)}`,fillColor:`${Qa(e.highContrastScheme.BackgroundColor)}`}}(n,a,c,d);!function(e,t,n,o,r,i,l,s,a){if(a){t.fillStyle=l;for(const l of r){const r=l-XF(e);t.fillRect(i?s:r,i?r:s,n,o)}}else{t.lineWidth=ts,t.strokeStyle=l,t.beginPath();for(const e of r){const r=e-Oa(ts);t.rect(i?s:r,i?r:s,n,o)}t.stroke()}}(n,t,r,i,e,o,h,u,d),function(e,t,n,o,r,i,l){e.fillStyle=i;for(const i of o)e.fillRect(r?l:i,r?i:l,t,n)}(t,l,s,e,o,f,u)}}function qF(e,t){const n=e-Math.ceil($r/2);t.push(n)}function XF(e){return ts*Math.max(Math.round(e.scaleFactor),1)}const YF=2,JF=2,KF=3,QF=2,ZF=5,eD=11;function tD(e,t,n,o,r){const i=oD(e,t,o,r),l=Math.round((e.IsRow?af(e,t,e.IsRtl,!1):gf(e,t,!1))+zu(e.IsRow?6:1,n)),s=rD(KF,o,r),a=rD(2,o,r);return e.IsRow?{x:l,y:i,width:a,height:s}:{x:i,y:l,width:s,height:a}}function nD(e,t,n){const o=zu(YF,n),r=zu(JF,n),i=rD(KF,o,r),l=e.IsRow?sf(e,t):lf(e,t);if(l<=i)return;const s=oD(e,t,o,r);if(e.IsRow){const o=af(e,t,e.IsRtl,!1),r=zu(Gs,n),a=zu(QF,n),c=i+2*a;return c<l?{x:o,y:s-a,width:r,height:c}:{x:o,y:gf(e,t,!1),width:r,height:l}}{const o=gf(e,t,!1),r=zu(eD,n),a=zu(ZF,n),c=i+2*a;return c<l?{x:s-a,y:o,width:c,height:r}:{x:af(e,t,e.IsRtl,!1),y:o,width:l,height:r}}}function oD(e,t,n,o){const r=e.IsRow?hf(e,t):ff(e,t,e.IsRtl);return Math.round(r-n/2-o-n)}function rD(e,t,n){return e*t+(e-1)*n}const iD="header-cell-hover";let lD;function sD(e,t){const n=[];for(let o=0;o<t.length;o++){const r=yf(e,t[o],!1);n.push(r)}return n}function aD(e,t,n,o,r){const i=kg(e,t,o,e.IsRtl);Pf(n,r,i,KS,Cn.HeaderDragDropSquares,SD);const l=function(e,t){const n=e.IsRow,o=Nu(e,n?t.Row:t.Col,n);return e=>!(!TD(e)||!Fd())&&(function(e,t,n){Ca(md,"externalCallbacks","onHeaderDragStartCallback"),md.onHeaderDragStartCallback(e,t,n)}(n,o,e),!0)}(e,n);kf(n,r,i,Cn.HeaderDragDropSquares,l,US)}function cD(e,t,n,o,r){const i=function(e,t,n){return e?t?e.height>=yF*n?gF*n:e.height>=RF*n?(e.height-mF*n)/2:e.height>=TF*n?dF*n/2:e.height*CF:e.width>=pF*n?fF*n:e.width>=wF*n?(e.width-mF*n)/2:e.width>=SF*n?hF*n/2:e.width*CF:0}(e,t,o);let l,s;const a=Wu(o);if(t){const t=r?Gs*o:0,a=n?e.x:e.x+t,c=e.width-t;l={x:a,y:e.y,width:c,height:i},s={x:a,y:e.y+e.height-i,width:c,height:i}}else n?(l={x:e.x+e.width-i,y:e.y+a,width:i,height:e.height-a},s={x:e.x,y:e.y+a,width:i,height:e.height-a}):(l={x:e.x,y:e.y+a,width:i,height:e.height-a},s={x:e.x+e.width-i,y:e.y+a,width:i,height:e.height-a});return{firstResizeZoneHitRegion:l,secondResizeZoneHitRegion:s}}function uD(e,t,n,o,r,i,l){const s=function(e,t,n,o){if(!e)return 0;const r=o?lF:1,i=sF*t,l=n?e.height:e.width,s=(l-Math.min(ts,l))*r;return Math.max(0,Math.min(i,s))}(e,t,n,i);let a;return a=r?n?{x:e.x,y:e.y,width:e.width,height:s}:o?{x:e.x+e.width-s,y:e.y+l,width:s,height:e.height-l}:{x:e.x,y:e.y+l,width:s,height:e.height-l}:n?{x:e.x,y:e.y+e.height-s-Math.min(ts,e.height),width:e.width,height:s+Math.min(ts,e.height)}:o?{x:e.x,y:e.y+l,width:s+Math.min(ts,e.width),height:e.height-l}:{x:e.x+e.width-s-Math.min(ts,e.width),y:e.y+l,width:s+Math.min(ts,e.width),height:e.height-l},a}function dD(e,t,n,o,r,i,l,s,a,c,u,d){const h=pD(r,o,l,s,a,!1,c,d),f=pD(r,o,l,s,a,!0,c,d),g=function(e,t){return n=>ID(e,!0,t)&&"touch"!==n.pointerType&&"pen"!==n.pointerType}(l,d);Pf(e,t,n,i,Cn.HeaderResize,g),kf(e,t,n,Cn.HeaderResize,h,US),kf(e,t,n,Cn.HeaderResize,f,ZS),u&&(Hf(e,t,n,Cn.HeaderResize,CD(o,r,l,!0,d)),Lf(e,t,n,Cn.HeaderResize,CD(o,r,l,!1,d)))}function hD(e,t,n,o,r,i,l){Hf(e,t,n,Cn.UnhideSkittle,wD(o,r,i,!0,l)),Lf(e,t,n,Cn.UnhideSkittle,wD(o,r,i,!1,l))}function fD(e,t,n,o,r,i,l,s){const a=kg(e,t,r,!1);Pf(n,o,a,YS,Cn.HeaderInsert,function(e,t,n){return o=>Dd(e,t,n)&&"touch"!==o.pointerType&&"pen"!==o.pointerType}(i,l,s)),Hf(n,o,a,Cn.HeaderInsert,yD(i,l,s,!0)),Lf(n,o,a,Cn.HeaderInsert,yD(i,l,s,!1)),kf(n,o,a,Cn.HeaderInsert,function(e,t,n){return o=>!(!TD(o)||!Dd(e,t,n))&&(function(e,t,n,o){Ca(md,"externalCallbacks","onHeaderInsertButtonClick"),md.headerInsertButtonInvokedCallback(e,t,n,o)}(e,t,n,o),!0)}(i,l,s),QS),kf(n,o,a,Cn.HeaderInsert,function(e,t,n){return o=>!(!TD(o)||!Dd(e,t,n))}(i,l,s),US)}function gD(e,t,n){const o=n?1:0;return t?e.filter((e=>e.Col===o)):e.filter((e=>e.Row===o))}function mD(e,t,n){const o=e.IsRow,r=o?t.Row:t.Col,i=Nu(e,r,o);return e=>("touch"!==e.pointerType&&(kd()&&n&&function(e,t,n){kd()&&md.trackGridRendererEventResponseTime(e,t,void 0)}(e,[iD]),function(e,t,n,o){Ca(md,"externalCallbacks","setOrRemoveHoveredCellCallback"),md.setOrRemoveHoveredCellCallback(e,t,n,o)}(i,r,o,n)),!0)}function CD(e,t,n,o,r){return i=>(ID(n,o,r)&&"touch"!==i.pointerType&&"pen"!==i.pointerType&&function(e,t,n,o){Ca(md,"externalCallbacks","setOrRemoveResizeZoneHoveredCallback"),md.setOrRemoveResizeZoneHoveredCallback(e,t,n,o)}(e,t,n,o),!1)}function pD(e,t,n,o,r,i,l,s){return a=>(TD(a)&&ID(n,!0,s)&&(!function(e,t,n,o,r,i,l){Ca(md,"externalCallbacks","onHeaderResizeStartCallback"),md.onHeaderResizeStartCallback(e,t,n,o,r,i,l)}(a,t,e,n,o,l,i),(o||r)&&Rd(t,n,o,!1,!1)),!0)}function wD(e,t,n,o,r){return i=>("touch"!==i.pointerType&&Rd(e,t,n,o,r),!1)}function SD(e){return Fd()&&"touch"!==e.pointerType&&"pen"!==e.pointerType}function yD(e,t,n,o){return r=>("touch"!==r.pointerType&&function(e,t,n,o){Ca(md,"externalCallbacks","onHeaderInsertAreaHovered"),md.headerInsertHitAreaHoveredCallback(e,t,n,o)}(e,t,n,o),!1)}function RD(e,t,n,o){return r=>(TD(r)&&function(e,t,n,o){Ca(md,"externalCallbacks","setOutlineLevelCanvas"),md.expandCollapseOutlines(e,t,n,o)}(e,t,n,o),!0)}function TD(e){return!("dblclick"!==e.type&&"click"!==e.type&&"mouse"!==e.pointerType)&&0===e.button}function ID(e,t,n){let o=!1;return o=n?xd(e):function(e,t){if(void 0!==lD){const e=lD;return t||(lD=void 0),e}return lD=xd(e),lD}(e,t),o}function vD(e,t,n,o){const r=[];let i=e.x;for(let l=0;l<t;++l){let t=e.y;for(let e=0;e<n;++e)r.push({x:i,y:t}),t+=o;i+=o}return r}function bD(e,t,n,o,r,i){let l,s=-2;const a=t.ClientOnlyCache.CellsToRender;for(const u of a){if(!IT(t,n,u,gn.GutterArea))continue;const a=u.InsertButtons?.Start,d=u.InsertButtons?.End;if(i&&0===(t.IsRow?u.Col:u.Row))continue;const h=t.IsRow?u.Row:u.Col,f=s+1===h&&l?.Type===a?.Type;s=h,l=d;const g=!f&&a?.Type===o,m=d?.Type===o;(g||m)&&(r||(e.lineWidth=n.scaleFactor*qx,e.strokeStyle=(c=n.highContrastScheme)?Qa(c.TextColor):aF,e.fillStyle=DD(n.highContrastScheme),r=!0),g&&xD(u,t,n,a,!0,!!t.IsRow,e),m&&xD(u,t,n,d,!1,!!t.IsRow,e))}var c;return r}function xD(e,t,n,o,r,i,l){const s=n.scaleFactor,a=qx*s,{x:c,y:u,radius:d}=function(e,t,n,o,r,i,l){const{radius:s,paddingForDrawing:a}=function(e,t,n,o){let r=0,i=0;return t?(e.Type===Tt.InsertDot&&(r=Xx*o,i=Jx*o),e.Type===Tt.InsertButton&&(r=Qx*o,i=eF*o)):(e.Type===Tt.InsertDot&&(r=Xx*o,i=Yx*o),e.Type===Tt.InsertButton&&(r=Qx*o,i=Zx*o)),{radius:r,paddingForDrawing:i+r+n/2}}(e,t,o,r);let c=0,u=0;return t?(c=af(i,l,i.IsRtl,!1),u=n?gf(i,l,!1):df(i,l)):(u=gf(i,l,!1),c=n?af(i,l,i.IsRtl,!1):af(i,l,i.IsRtl,!1)+lf(i,l)),t?{x:c+a,y:u-Oa(o),radius:s}:{x:c-Oa(o),y:u+a,radius:s}}(o,i,r,a,s,t,e);o.Type===Tt.InsertDot?FD(l,c,u,d):o.Type===Tt.InsertButton&&function(e,t,n,o,r){FD(e,t,n,r),function(e,t,n,o){e.beginPath(),e.moveTo(t-o/2,n),e.lineTo(t+o/2,n),e.moveTo(t,n-o/2),e.lineTo(t,n+o/2),e.stroke()}(e,t,n,o)}(l,c,u,tF*s,d)}function FD(e,t,n,o){e.beginPath(),e.arc(t,n,o,0,$x),e.fill(),e.stroke()}function DD(e){return e?Qa(e.BackgroundColor):cF}var MD=n(233),AD=n(179);function OD(e,t,n,o){const r=Py(t,n,o.left,o.bottom,o.size,!1);pu(e,r),sv(e,o),wu(e,r)}function BD(e,t,n,o){!function(e,t,n,o,r,i){const l=kg(e,n,o,!1),s=jo(e,cc(n.renderingRegion));Pf(t,s,l,YS,Cn.DataCleansing),Ef(t,s,l,"Clean Data",Cn.DataCleansing),kf(t,s,l,Cn.DataCleansing,r,"click"),kf(t,s,l,Cn.DataCleansing,(e=>!0),"pointerdown"),kf(t,s,l,Cn.DataCleansing,(e=>!0),"dblclick"),kf(t,s,l,Cn.DataCleansing,r,"touchend"),kf(t,s,l,Cn.DataCleansing,ey,"touchstart")}(e,t,n,o,(e=>((0,MD.logCopilotSeenEvent)(MD.TelemetryStandardizedFeature.CleanData,AD.TA.EntryPoint.Canvas),pd(e,Og().DataCleansingShowTaskPane,""),Pn.sendTraceTag(506303321,En.msoulscat_ES_EWAJS,d.Important,`DataCleansingColumnHeaders: icon clicked on column ${t.Col}`),!0)))}function kD(e,t,n){return!(!e.DataCleansingIcon||Ec(e.PreviewText)||e.ShowSkeleton||!Ru(e,t.renderingRegion)||n.size<=4||e.IsCellSnapped)}function PD(e,t,n,o){const r=Fh(t),i=cm(r,n);return{size:i,image:_y.CircleSymbolMedium,left:lT(e,t,i,r,n),bottom:iT(e,t,n,i),highContrastScheme:o}}function ED(e){return{x:e.left,y:e.bottom-e.size,width:e.size,height:e.size}}function HD(e,t){const{x:n,y:o,width:r,height:i}=t;e.rect(n,o,r,i)}function LD(e,t,n,o){let{x:r,width:i,height:l}=o;var s;t.IsRow?(s=n.scaleFactor,i=zu(Gs,s)+ts,t.IsRtl&&(r=o.x+o.width-i)):l=Wu(n.scaleFactor)+ts,e.rect(r,o.y,i,l)}function ND(e,t,n,o,r){const{x:i,y:l,width:s,height:a}=o;if(t.IsRow){const t=Math.ceil(2*n.scaleFactor);r&gn.CellStartGridlineArea&&e.rect(i,l,s,t),r&gn.CellEndGridlineArea&&e.rect(i,l+a-t,s,t)}else{const o=Math.ceil(3*n.scaleFactor),c=Wu(n.scaleFactor)+ts;(t.IsRtl?r&gn.CellEndGridlineArea:r&gn.CellStartGridlineArea)&&e.rect(i,l+c,o,a-c),(t.IsRtl?r&gn.CellStartGridlineArea:r&gn.CellEndGridlineArea)&&e.rect(i+s-o,l+c,o,a-c)}}class WD extends nx{renderInternal(e,t,n){try{Cc(n.renderingRegion,t,n);const o=Va(n);let r;o&&(r=n.highContrastScheme,function(e,t){const n=t;n.HeaderPartialSelectionFontColor="#000000",e.highContrastScheme=n}(n,r));const i=Zc(),l=n.scaleFactor,s=Math.round(t.BlockWidth*l),a=n.renderingRegion,c=Math.round(-1*a.startOffsetY*l),u=Math.round(mc(t,a)*l),h=mr()?n.isDifferentialRendering:Uo(t);h&&(this.setTransform(1,!1,u,c,s),mr()?function(e,t,n){t.save(),t.beginPath();for(const[o,r]of e.ClientOnlyCache.DirtyCellsMap){const i=r,l=TT(e,o);i&gn.EntireCell?HD(t,l):(i&gn.GutterArea&&LD(t,e,n,l),i&(gn.CellStartGridlineArea|gn.CellEndGridlineArea)&&ND(t,e,n,l,i))}t.strokeStyle="transparent",t.stroke(),t.clip()}(t,this.ctx,n):yT(t,this.ctx)),this.setTransform(1,!1,0,0,s),this.clearHeaderCanvas(e.getWidth(),e.getHeight(),n);const f=function(e,t,n){let o;const r=!!t.IsRow;if(!Ou(t,r))return o;const i=n.scaleFactor,l=t.IsRtl;return o=r?{x:l?0:Math.ceil(t.ColumnOffsets[1]*i),y:0,width:l?Math.floor(t.ColumnWidths[1]*i):Math.ceil(t.ColumnWidths[1]*i),height:Math.ceil(t.BlockHeight*i)}:{x:0,y:Math.ceil(t.RowOffsets[1]*i),width:Math.ceil(t.BlockWidth*i),height:Math.ceil(t.RowHeights[1]*i)},pu(e,o),o}(this.ctx,t,n);return this.setTransform(1,!1,u,c,s),Gd(Vd.DrawBackgroundFillMs,(()=>function(e,t,n){if($s(t.Cells))return;let o;const r=Va(n),i=t.ClientOnlyCache.CellsToRender;for(let s=0;s<i.length;s++){const a=i[s];if(PT(a)===ET.None)continue;if(!Ru(a,n.renderingRegion))continue;const c=a.CachedStyle.BackgroundColor;r&&(l=c)!==Ar&&l!==Mr||(o=kT(e,t,a,ET.Solid,o,r))}var l}(this.ctx,t,n))),t.ShowHeaders&&(this.setTransform(1,t.IsRtl,u,c,s),Gd(Vd.DrawGridlinesDurationMs,(()=>function(e,t,n){if(!$u(t,n))return;if(function(e,t,n){if(!$u(t,n))return;rd(e,t);const o=Oa(ts),r=n.scaleFactor,i=qu(t.BlockWidth,r,!1),l=qu(t.BlockHeight,r,!0),s=!!t.IsRow,a=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,c=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,u=t.BlockWidth*r,d=t.BlockHeight*r,h=n.renderingRegion,f=Qu(t,n,!0,!0),g=Qu(t,n,!0,!1);e.beginPath(),e.strokeStyle=g,s?Ju(e,a,u,o,l,h):Ku(e,c,d,o,i,h),e.stroke(),e.beginPath(),e.strokeStyle=f,s?Ku(e,c,d,o,i,h):Ju(e,a,u,o,l,h),e.stroke()}(e,t,n),Va(n))return;const o=t.IsRow,r=function(e,t,n){const o=[],r=n?t.startRow:t.startColumn,i=n?t.endRow:t.endColumn,l=i+1;let s=!1;for(let t=r;t<l;++t){const n=e[t];if(!n){const n=(e,...t)=>t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{}),o=e.map(((e,t,o)=>n(e,"Row","Col")));Pn.sendTraceTag(509677844,En.msoulscat_ES_EWAJSGrid,d.Error,`getHeaderSelectedGridLines: firstGridLine:${r}, lastRowColInRenderingRegion:${i}, gridLineIndex:${t}, cells.length:${e.length}, cells:${JSON.stringify(o)}, `)}Hu(n)?(o.push(t),s=!0):s&&(o.push(t),s=!1)}return s&&o.push(l),o}(t.Cells,n.renderingRegion,o),i=Oa(ts),l=n.scaleFactor,s=qu(t.BlockHeight,l,!0),a=qu(t.BlockWidth,l,!1),c=t.ClientOnlyCache.AdjacentBlocksSelectionInfo,u=t.AdjacentBlocksHiddensInfo;o?(function(e,t,n,o,r,i,l){const s=l.length,a=n[n.length-1];e.beginPath(),e.strokeStyle=Zu(t);for(let t=0;t<s;++t){const n=l[t];if(0===n)continue;const s=Yu(o[n],r,i);Su(e,0,s,a,s)}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,i,s,r),function(e,t,n,o,r,i,l,s){if(0===t.length)return;const a=o.scaleFactor,c=ns*a,u=2*a,d=i,h=Math.max(c,u),[f,g]=[Or,Or];let m=!1;for(let o=0;o<t.length;o++){const i=t[o];if(ri.has(i.StyleID||0)){if((0===o&&l?.LastCellOfPrevBlockSelection!==dn.Full&&!s?.IsLastRowOfPrevBlockHidden||o>0&&!m&&e[o-1]===e[o]-1)&&nd(n,d,h,0,r,o,c,u,g,f),o<t.length-1){const i=t[o+1];ri.has(i.StyleID||0)||e[o+1]!==e[o]+1||od(n,d,h,0,r,o,c,u,g,f)}else o!==t.length-1||l?.FirstCellOfNextBlockSelection===dn.Full||s?.IsFirstRowOfNextBlockHidden||od(n,d,h,0,r,o,c,u,g,f);m=!0}else 0!==o||l?.LastCellOfPrevBlockSelection!==dn.Full||s?.IsLastRowOfPrevBlockHidden?o!==t.length-1||l?.FirstCellOfNextBlockSelection!==dn.Full||s?.IsFirstRowOfNextBlockHidden||od(n,d,h,0,r,o,c,u,g,f):nd(n,d,h,0,r,o,c,u,g,f),m=!1}n.stroke()}(t.RowNumbers,t.Cells,e,n,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*l,c,u)):(function(e,t,n,o,r,i,l){const s=l.length,a=o[o.length-1];e.beginPath(),e.strokeStyle=Zu(t);for(let t=0;t<s;++t){const o=l[t];if(0===o)continue;const s=Yu(n[o],r,i);Su(e,s,0,s,a)}e.stroke()}(e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,i,a,r),function(e,t,n,o,r,i,l,s){if(0===t.length)return;const a=o.scaleFactor,c=ns*a,u=2*a,d=Math.max(c,u),h=i-Wu(a),f=i,[g,m]=[Or,Or];let C=!1;for(let o=0;o<t.length;o++){const i=t[o];if(ri.has(i.StyleID||0)){if((0===o&&l?.LastCellOfPrevBlockSelection!==dn.Full&&!s?.IsLastColOfPrevBlockHidden||o>0&&!C&&e[o-1]===e[o]-1)&&ed(n,d,h,f,r,o,c,u,m,g),o<t.length-1){const i=t[o+1];ri.has(i.StyleID||0)||e[o+1]!==e[o]+1||td(n,d,h,f,r,o,c,u,m,g)}else o!==t.length-1||l?.FirstCellOfNextBlockSelection===dn.Full||s?.IsFirstColOfNextBlockHidden||td(n,d,h,f,r,o,c,u,m,g);C=!0}else 0!==o||l?.LastCellOfPrevBlockSelection!==dn.Full||s?.IsLastColOfPrevBlockHidden?o!==t.length-1||l?.FirstCellOfNextBlockSelection!==dn.Full||s?.IsFirstColOfNextBlockHidden||td(n,d,h,f,r,o,c,u,m,g):ed(n,d,h,f,r,o,c,u,m,g),C=!1}n.stroke()}(t.ColumnNumbers,t.Cells,e,n,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*l,c,u))}(this.ctx,t,n))),i||this.setTransform(1,t.IsRtl,u,c,s),Gd(Vd.ClearColumnHeaderGutterAreaDurationMs,(()=>function(e,t,n,o,r,i){if(Ca(e,"ctx","clearColumnHeaderGutterArea"),Ca(t,"model","clearColumnHeaderGutterArea"),Ca(n,"context","clearColumnHeaderGutterArea"),Ca(t.IsRow,"model.IsRow","clearColumnHeaderGutterArea"),t.IsRow)return;const l=n.viewMode===Bt.NamedSheetView&&Ou(t,!1);e.fillStyle=r?Qa(i.BackgroundColor):l?Pr:Fr,e.fillRect(0,zu(t.RowOffsets[t.RowOffsets.length-1],o),t.BlockWidth*o,Wu(o))}(this.ctx,t,n,l,o,r))),i||this.setTransform(1,t.IsRtl,u,c,s),Gd(Vd.DrawRowColDragAndDropSixSquaresDurationMs,(()=>function(e,t,n){Ca(e,"ctx","drawRowColDragAndDropSixSquares"),Ca(t,"model","drawRowColDragAndDropSixSquares"),Ca(n,"context","drawRowColDragAndDropSixSquares"),Ca(t.IsRow,"model.IsRow","drawRowColDragAndDropSixSquares");const o=t.ClientOnlyCache.CellsToRender;for(const r of o){if(!IT(t,n,r,gn.GutterArea))continue;if(!r.IsHovered)continue;if(!Fd())return;const o=n.scaleFactor;let i,l=[];const s=zu(YF,o),a=zu(JF,o),c=tD(t,r,o,s,a);if(t.IsRow){if(sf(t,r)<=c.height)continue;i=Va(n)?xu(r,n.highContrastScheme):Ea(r,t)?.Color||yr,l=vD(c,2,KF,s+a)}else{if(lf(t,r)<=c.width)continue;i=Va(n)?Qa(n.highContrastScheme.TextColor):n.viewMode===Bt.NamedSheetView&&Ou(t,!1)?Ea(r,t)?.Color||yr:Lu(r)?Or:yr,l=vD(c,KF,2,s+a)}e.fillStyle=i;for(const t of l)e.fillRect(t.x,t.y,s,s)}}(this.ctx,t,n))),this.setTransform(n.scaleFactor,!1,u,c,s),Gd(Vd.DrawTextDurationMs,(()=>vT(this.ctx,t,n))),this.setTransform(1,!1,u+2,c,s),Gd(Vd.DrawDataCleansingHeaderIcon,(()=>function(e,t,n){Ca(e,"ctx","drawDataCleansingHeaderIcon"),Ca(t,"model","drawDataCleansingHeaderIcon"),Ca(n,"context","drawDataCleansingHeaderIcon");const o=t.ClientOnlyCache.CellsToRender,r=Zc();let i=!1;!r&&o.length>0&&(e.lineWidth=Gu,e.setLineDash(ps));const l=null!==n.highContrastScheme?n.highContrastScheme:void 0;for(let s=0;s<o.length;s++){const a=o[s];if(!IT(t,n,a,mn.EntireCell))continue;const c=PD(t,a,n.scaleFactor,l);kD(a,n,c)&&(r&&!i&&(e.lineWidth=Gu,e.setLineDash(ps),i=!0),OD(e,t,a,c),BD(t,a,n,ED(c)))}}(this.ctx,t,n))),this.setTransform(1,t.IsRtl,u,c,s),Gd(Vd.DrawHiddenRowColDurationMs,(()=>function(e,t,n,o){if(function(e){Ca(e.ColumnNumbers,"model.ColumnNumbers","drawHiddenRowCol"),Ca(e.RowNumbers,"model.RowNumbers","drawHiddenRowCol")}(t),n.scaleFactor<Kl)return;const r=t.IsRow,{isLastRowColOfPrevBlockHidden:i,isFirstRowColOfNextBlockHidden:l}=function(e,t){let n=!1,o=!1;return e.AdjacentBlocksHiddensInfo?(t?(n=!!e.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden,o=!!e.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden):(n=!!e.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden,o=!!e.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden),{isLastRowColOfPrevBlockHidden:n,isFirstRowColOfNextBlockHidden:o}):{isLastRowColOfPrevBlockHidden:!1,isFirstRowColOfNextBlockHidden:!1}}(t,r),s=Ou(t,r),a=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,c=t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,u=t.ClientOnlyCache.AdjacentBlocksSelectionInfo;if(r){const r=du(s?1:0,a),d=s?a[1]:0;UF(e,n,!0,t.Cells,c,t.RowNumbers,o?jF(r,!0):r,VF(n,o),jF(r,o),$r,n.renderingRegion.startRow,n.renderingRegion.endRow,i,l,d,o,u)}else{const r=_u(n.scaleFactor),d=hu(s?1:0,c)-r,h=s?c[1]:0,f=o?h+r-ts:h+r;UF(e,n,!1,t.Cells,a,t.ColumnNumbers,VF(n,o),o?jF(d,!0):d,$r,jF(d,o),n.renderingRegion.startColumn,n.renderingRegion.endColumn,i,l,f,o,u)}}(this.ctx,t,n,this.isUnhideRowColumnUXImprovementsSlice1Enabled()))),i||this.setTransform(1,t.IsRtl,u,c,s),Gd(Vd.DrawResizePillDurationMs,(()=>function(e,t,n){Ca(e,"ctx","drawResizePill"),Ca(t,"model","drawResizePill"),Ca(n,"context","drawResizePill");const o=t.ClientOnlyCache.CellsToRender;let r=!1;void 0===IF&&(IF=gr());for(const i of o){if(IF?$s(i.ResizePillLocation):!i.ShowResizePill)continue;if(mr()&&(IF?!IT(t,n,i,i.ResizePillLocation===It.CellStart?gn.CellStartGridlineArea:gn.CellEndGridlineArea):!IT(t,n,i,gn.CellEndGridlineArea)))continue;r&&Pn.shipAssertTag(506577280,En.msoulscat_ES_EWAJSGrid,!1,"drawResizePill: Resize pill already drawn on another cell"),r=!0;const o=n.highContrastScheme,l=n.scaleFactor,s=bF(o),a=xF(o);if(t.IsRow){const n=FF(t,i,l,IF),o=20*l,r=dF*l;vF(e,l,s,a,n.x,n.y,o,r)}else{const n=DF(t,i,l,IF),o=hF*l,r=16*l;vF(e,l,s,a,n.x,n.y,o,r)}}}(this.ctx,t,n))),fr()&&(i||this.setTransform(1,t.IsRtl,u,c,s),Gd(Vd.DrawInsertDotAndInsertButton,(()=>function(e,t,n){Ro(e,"ctx","drawInsertDotAndInsertButton"),Ro(t,"model","drawInsertDotAndInsertButton"),Ro(n,"context","drawInsertDotAndInsertButton");let o=!1;const r=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation,i=(r?.length??0)>0;o=bD(e,t,n,Tt.InsertDot,o,i),bD(e,t,n,Tt.InsertButton,o,i)}(this.ctx,t,n)))),t.ClientOnlyCache?.isHeaderSnapped&&(this.setTransform(1,!1,u,c,s),Gd(Vd.DrawAutoFiltersForHeaderSnappingMs,(()=>cb(this.ctx,t,n))))),f&&wu(this.ctx,f),this.setTransform(1,!1,u,c,s),Gd(Vd.DrawOutlines,(()=>function(e,t,n){const o=t.IsRow?t.RowOutlinesInformation:t.ColumnOutlinesInformation;if(!o||0===o.length)return;const r=[];!function(e,t){const n=t.highContrastScheme;n?e.strokeStyle=Qa(n.LinkColor):t.viewMode===Bt.NamedSheetView?e.strokeStyle=zr:e.strokeStyle=_r}(e,n),e.beginPath();const i=t.IsRow,l=i&&t.IsRtl,s=n.scaleFactor;for(let n=0;n<o.length;++n){const a=o[n].Outlines,c=NF(n,s,l,t.BlockWidth),u=c+Ns,d=WF(c,i,s),h=a.length;for(let n=0;n<h;++n){const o=a[n],l=o.ButtonIndex,c=(t.IsRow?t.RowNumbers?.length:t.ColumnNumbers?.length)??0,h=l>-1&&l<c,f=h?zF(t,l):void 0;l>=c&&Ud(`Unexpected: buttonCell is outside block range. isRow: ${t.IsRow}, buttonIndex: ${l}, maxBlockRange: ${c}`),PF(t,o,f,h,u,s),o.IsExpanded||!h?(EF(t,e,o,s),GF(t,o,e,r,d,h,f),e.stroke()):kF(r,f,o,d,i)}}!function(e,t,n,o){const r=n.highContrastScheme,i=function(e,t){return e?Qa(e.LinkColor):t===Bt.NamedSheetView?zr:_r}(r,n.viewMode),l=function(e,t){return e?Qa(e.BackgroundColor):t===Bt.NamedSheetView?Pr:Fr}(r,n.viewMode);for(let r=0;r<t.length;++r){const s=t[r],a=Xv(n.scaleFactor,MF),c={outerColor:i,innerColor:l,left:s.EdgeInformation.LeftPx,bottom:s.EdgeInformation.TopPx+a,height:a,width:a};qv(o,e,s.EdgeInformation.Cell,c,s.IsExpand,!1)}}(t,r,n,e)}(this.ctx,t,n))),this.shouldInitializeCanvasHitTest(t,n)&&(i||this.setTransform(1,!1,u,c,s),Gd(Vd.RegisterHeaderHitRegionsToModelMs,(()=>function(e,t){const n=e.IsRow,o=Ou(e,n);if(!e.ShowHeaders&&!o)return;const r=jo(e,cc(t.renderingRegion)),i=e.ClientOnlyCache.CellsToRender;if(0===i.length)return;const l=o?gD(i,n,!0):i,s=sD(e,l);if(e.ShowHeaders&&(function(e,t,n,o,r){let i;Vb?i=e.IsRow?e.IsRtl?Vb.rowSelectRTLCursor:Vb.rowSelectLTRCursor:Vb.columnSelectCursor:(Pn.sendTraceTag(508924443,En.msoulscat_ES_EWAJSGrid,d.Warning,"headersHitTest: registerHeaderCellsHitRegionsToModelCache:: gridRendererCustomCursors is undefined. Using default cursor."),i=JS);for(let l=0;l<n.length;l++){const s=n[l],a=kg(e,t,o[l],!1);Pf(s,r,a,i,Cn.Headers),Hf(s,r,a,Cn.Headers,mD(e,s,!0)),Lf(s,r,a,Cn.Headers,mD(e,s,!1));const c=nD(e,s,t.scaleFactor);c&&aD(e,t,s,c,r)}}(e,t,l,s,r),function(e,t,n,o,r,i,l){const s=gr(),a=fr();for(let c=0;c<n.length;c++){const u=0===c,d=c+1===n.length,h=n[c],f=o[c],g=c,m=Nu(e,c,l),C=m-1,p=m+1;let w,S=!1;w=u?l?!!e.AdjacentBlocksHiddensInfo?.IsLastRowOfPrevBlockHidden:!!e.AdjacentBlocksHiddensInfo?.IsLastColOfPrevBlockHidden:Nu(e,c-1,l)!==C,S=d?l?!!e.AdjacentBlocksHiddensInfo?.IsFirstRowOfNextBlockHidden:!!e.AdjacentBlocksHiddensInfo?.IsFirstColOfNextBlockHidden:Nu(e,c+1,l)!==p;const y=w?c:c-1,R=cD(f,l,e.IsRtl,t.scaleFactor,a),T=kg(e,t,R.firstResizeZoneHitRegion,!1),I=kg(e,t,R.secondResizeZoneHitRegion,!1);1!==m&&dD(h,r,T,C,y,i,l,w,!1,-1===y,!w&&(s||!(-1===y)),d),l&&1048576===m||!l&&16384===m||dD(h,r,I,m,g,i,l,!1,S,!1,s||!d,d)}}(e,t,l,s,r,n?"ns-resize":"ew-resize",n),function(e,t,n,o,r,i){let l;for(let s=0;s<n.length;s++){const a=0===s,c=s+1===n.length,u=n[s],d=o[s],h=Nu(e,s,i),f=h-1,g=h+1;let m=!1,C=!1;m=a?i?!!e.AdjacentBlocksHiddensInfo?.IsLastRowOfPrevBlockHidden:!!e.AdjacentBlocksHiddensInfo?.IsLastColOfPrevBlockHidden:Nu(e,s-1,i)!==f,C=c?i?!!e.AdjacentBlocksHiddensInfo?.IsFirstRowOfNextBlockHidden:!!e.AdjacentBlocksHiddensInfo?.IsFirstColOfNextBlockHidden:Nu(e,s+1,i)!==g;const p=m&&C;void 0!==l||i||!m&&!C||(l=Wu(t.scaleFactor)),m&&hD(u,r,kg(e,t,uD(d,t.scaleFactor,i,e.IsRtl,!0,p,l??0),!1),h,i,!0,e.IsRtl),C&&hD(u,r,kg(e,t,uD(d,t.scaleFactor,i,e.IsRtl,!1,p,l??0),!1),h,i,!1,e.IsRtl)}}(e,t,l,s,r,n),fr()&&function(e,t,n,o,r,i){const l=t.scaleFactor,s=i?Gs*l:Wu(l),a=l*(i?5:7),c=l*(i?6:8);for(let l=0;l<n.length;l++){const u=n[l],d=Nu(e,l,i),{cellStartHitRegion:h,cellEndHitRegion:f}=oF(o[l],i,e.IsRtl,s,a,c);fD(e,t,u,r,h,d,i,!0),fD(e,t,u,r,f,d,i,!1)}}(e,t,l,s,r,n)),o){const o=gD(i,n,!1),l=sD(e,o);!function(e,t,n,o){const r=o?e.RowOutlinesInformation:e.ColumnOutlinesInformation;if(r)for(let i=0;i<r.length;i++){const l=r[i].Outlines,s=i+1;for(let r=0;r<l.length;r++){const i=l[r],a=i.ButtonIndex,c=Nu(e,a,o)-1;if(-1===a||i.IsButtonHidden)continue;if(!i?.Button?.EdgeInformation)continue;const u=i.Button,d=u.EdgeInformation.Cell,h=i.IsNonDefaultDirection?c+1:c-1,f=!i.IsExpanded,g=Xv(t.scaleFactor,MF),m=u.EdgeInformation.TopPx,C=kg(e,t,{x:u.EdgeInformation.LeftPx,y:m,width:g,height:g},!1);Ef(d,n,C,i.ECTitle,Cn.Headers),Pf(d,n,C,YS,Cn.Headers,(e=>!0)),kf(d,n,C,Cn.Headers,RD(o,s,h,f??!1),QS)}}}(e,t,r,n),function(e,t,n,o,r){for(let i=0;i<n.length;i++)kf(n[i],r,kg(e,t,o[i],!1),Cn.Headers,(e=>!0),US)}(e,t,o,l,r)}}(t,n)))),h&&this.ctx.restore(),n.debugMode&&(this.setTransform(l,!1,0,0,0),n.isCanvasHitTestDebugHighlight&&zf(t,this.ctx,n.renderingRegion)),zd(!0,"finished rendering.")}catch(e){return zd(!1,`exception caught in renderInternal: message: ${e.message} name: ${e.name} stack: ${e.stack} error: ${e}`)}}preprocessModel(e,t,n){Rx(e,t,this.shouldInitializeCanvasHitTest(e,n)),Mu(e,n.scaleFactor)}shouldInitializeCanvasHitTest(e,t){return mr()?!t.isDifferentialRendering:!Uo(e)}clearHeaderCanvas(e,t,n){Gd(Vd.FillRectDurationMs,(()=>{this.ctx.fillStyle=this.getCanvasBackgroundColor(n),this.ctx.fillRect(0,0,e,t)}))}getCanvasBackgroundColor(e){return Va(e)?Qa(e.highContrastScheme.BackgroundColor):e.viewMode===Bt.NamedSheetView?Pr:Fr}isUnhideRowColumnUXImprovementsSlice1Enabled(){return void 0===this.unhideRowColumnUXImprovementsSlice1&&(this.unhideRowColumnUXImprovementsSlice1=Fn(Sn.UnhideRowColumnUXImprovementsSlice1)),this.unhideRowColumnUXImprovementsSlice1}constructor(){super(...arguments),this.unhideRowColumnUXImprovementsSlice1=void 0}}class _D{getModelAccessor(e){return Ca(e,"model","CanvasRendererFactory.getModelAccessor"),new Dx(e)}getGridCanvasRenderer(){return new xx}getHeaderCanvasRenderer(){return new WD}createRenderingCanvasElement(e){return new Nx(!(Fn(Sn.FixBoldFontsOnMac)&&kc()||(!window||!window.navigator||navigator.userAgent.indexOf("Edge/")>=0||!(navigator.userAgent.indexOf("Chrome/")>=0))&&(!window||!window.navigator||!(navigator.userAgent.indexOf(" Firefox/")>=0))),!!e)}createHeaderBlockModelAccessor(e,t,n){Ca(e,"gridModel","CanvasRendererFactory.createHeaderBlockModelAccessor"),Ca(n,"viewMode","CanvasRendererFactory.createHeaderBlockModelAccessor");const o=function(e,t,n){Ro(e,"gridModel","headerBlockModel.createHeaderBlockModel");const o=function(e,t){const n=t?e.MaxRowOutlineLevelInSheet:e.MaxColOutlineLevelInSheet;return pn(n)||0===n?0:26+12*(n-1)}(e,t),r={RenderFlagsArray:fi(e.RenderFlagsArray),BlockHeight:mi(e,t,o),BlockWidth:Ci(e,t,o),IsRtl:e.IsRtl,ShowGridLines:!0,Fonts:hi(e,n),Styles:di(e,n,t),ShowHeaders:e.ShowHeaders,AdjacentBlocksHiddensInfo:gi(e.AdjacentBlocksHiddensInfo),IsRow:t,PermissionSet:e.PermissionSet};return li(r.Fonts),li(r.Styles),r.AreStylesProcessed=!1,t?function(e,t,n){return function(e,t,n){t.RowNumbers=fi(e.RowNumbers),t.RowOffsets=fi(e.RowOffsets),t.RowHeights=fi(e.RowHeights),n>0&&(t.RowOutlinesInformation=Qo(e.RowOutlinesInformation)),t.MaxRowOutlineLevelInSheet=e.MaxRowOutlineLevelInSheet??0}(e,t,n),ui(t,!0,n),function(e,t){if(0===t)e.ColumnNumbers=[0],e.ColumnOffsets=[0],e.ColumnWidths=[e.BlockWidth];else{e.ColumnNumbers=[0,1],e.ColumnOffsets=[0,t];const n=e.BlockWidth-t;e.ColumnWidths=[t,n]}}(t,n),t}(e,r,o):function(e,t,n){return function(e,t,n){t.ColumnNumbers=fi(e.ColumnNumbers),t.ColumnOffsets=fi(e.ColumnOffsets),t.ColumnWidths=fi(e.ColumnWidths),n>0&&(t.ColumnOutlinesInformation=Qo(e.ColumnOutlinesInformation)),t.MaxColOutlineLevelInSheet=e.MaxColOutlineLevelInSheet??0}(e,t,n),ui(t,!1,n),function(e,t){0===t?(e.RowNumbers=[0],e.RowOffsets=[0],e.RowHeights=[Vr]):(e.RowNumbers=[0,1],e.RowOffsets=[0,t],e.RowHeights=[t,Vr])}(t,n),t}(e,r,o)}(e,t,n);return new uF(o,t)}}const zD=new _D,GD="msofp",VD=Id(8,10),jD=Id(6,500),UD=Id(7,5e3),$D=Fn(Sn.FontFidelityCorrections),qD=document.createElement("div");function XD(e){const t=new Set;if(e.Fonts)for(let n=0;n<e.Fonts.length;n++){const o=e.Fonts[n];if(!o)continue;const r=o.FontName;if(!r)continue;const i=ih(r);t.has(r)||(mh(i)&&(BC(i)||(EC(i),kC(i))),OC(i,!1)&&MC(i,!1)!==sC.Pending||t.add(r))}return function(e){if(!OC(Ws)||MC(Ws)===sC.Pending){const t=e.ClientOnlyCache?.CellsToRender;if(t)for(let n=0;n<t.length;n++){const o=t[n],r=!!yo(Vt.InCellControls,e)&&o.InCellControlOptions&&o.InCellControlOptions.Type===bt.Checkbox&&dT(o);if(o.RichValueIcon||r)return!0}}return!1}(e)&&t.add(Ws),Array.from(t.values())}function YD(e,t){const n=Md(e),o=0===n,r=$D&&256===n;var i;return i=t,(!(!Od()||"function"!=typeof md.isFontSourceAddedToCss)&&md.isFontSourceAddedToCss(i)||!o&&!r)&&PC(t)}function JD(e){return new Promise((t=>{setTimeout((()=>KD(e,VD,t)),jD)}))}function KD(e,t,n){const o=VD-t+1;switch(bC(e)){case"loaded":Pn.sendTraceTag(542722120,En.msoulscat_ES_EWAJSGrid,d.Info,`FontLoader::handleFontIsStillLoading: ${fh(e)} was loaded successfully after ${o} retries.`),n({font:e,isSuccessful:!0});break;case"loading":if(t>1){const o=function(e){const t=1<<VD-e+1;return Math.min(t*jD,UD)}(t);setTimeout(KD,o,e,t-1,n)}else Pn.sendTraceTag(542722121,En.msoulscat_ES_EWAJSGrid,d.Info,`FontLoader::handleFontIsStillLoading: ${fh(e)} failed to load after ${o} retries.`),n({font:e,isSuccessful:!1});break;default:n({font:e,isSuccessful:!1})}}function QD(){const e=document.createElement("div");return e.style.visibility="hidden",e.innerText=".",e}var ZD;qD.innerText=".",qD.style.visibility="hidden",document?.body&&document.body.appendChild(qD),function(e){e[e.ThickBorder=0]="ThickBorder",e[e.MediumBorder=1]="MediumBorder",e[e.BoldText=2]="BoldText",e[e.CustomFont=3]="CustomFont",e[e.AppleFont=4]="AppleFont",e[e.GoogleFont=5]="GoogleFont",e[e.CellHashText=6]="CellHashText",e[e.CellTextOrientation=7]="CellTextOrientation",e[e.AccountingUnderline=8]="AccountingUnderline",e[e.SubScriptSuperScriptInWrapText=9]="SubScriptSuperScriptInWrapText",e[e.PatternStyle=10]="PatternStyle",e[e.DiagonalBorder=11]="DiagonalBorder",e[e.SpillCellAcrossBlocks=12]="SpillCellAcrossBlocks"}(ZD||(ZD={}));const eM="MissingFeatureWithoutFallback",tM="MissingFeatureWithFallback",nM="LowRenderingFeature",oM={};function rM(e,t){const n=t.CachedBorderStyle;if(n)for(let t=0;t<n.Borders.length;t++){const o=n.Borders[t];2===o.Weight?dM(e,ZD.MediumBorder):3===o.Weight&&dM(e,ZD.ThickBorder)}}function iM(e,t,n){const o=n.CachedStyle,r=n.CachedFont;o&&r&&o.Orientation&&(Hh(t,n.CachedStyle,n.CachedFont)||dM(e,ZD.CellTextOrientation))}function lM(e,t){if(!t)return;const n=function(e){const t=Md(e);return Sh(e,t),t}(t);ph(n)&&dM(e,ZD.AppleFont),wh(n)&&dM(e,ZD.GoogleFont),0===n&&dM(e,ZD.CustomFont)}function sM(e,t){const n=t.CachedFont;n&&(n.Underline!==qt.SingleAccounting&&n.Underline!==qt.DoubleAccounting||dM(e,ZD.AccountingUnderline))}function aM(e,t){const n=t.CachedBorderStyle;n&&n.HasDiagBorder&&dM(e,ZD.DiagonalBorder)}function cM(e,t){t.Spill&&t.Spill.IsSpillBlocked&&t.Spill.IsSpillingOutsideOfBlock&&dM(e,ZD.SpillCellAcrossBlocks)}function uM(e,t){const n=t.CachedDisplayTextRuns;if(t.WrapText&&n)for(let t=0;t<n.length;t++){const o=n[t].CachedFont;if(o&&(o.VerticalAlign===Xt.Subscript||o.VerticalAlign===Xt.Superscript))return void dM(e,ZD.SubScriptSuperScriptInWrapText)}}function dM(e,t){const n=ZD[t];e[n]?e[n]+=1:e[n]=1}function hM(e){const t=function(e){if(e)return{SpanToEnd:e.SpanToEnd,SpanToStart:e.SpanToStart,IsSpillBlocked:e.IsSpillBlocked,IsSpillingOutsideOfBlock:e.IsSpillingOutsideOfBlock}}(e.Spill),n=function(e){if(e)return{Columns:e.Columns,Rows:e.Rows,IsOrigin:e.IsOrigin,OriginRow:e.OriginRow||0,OriginColumn:e.OriginColumn||0,SpansBlocks:e.SpansBlocks,Width:e.Width,Height:e.Height,OriginDeltaX:e.OriginDeltaX,OriginDeltaY:e.OriginDeltaY,WidthAdjustedForDrawing:e.WidthAdjustedForDrawing,HeightAdjustedForDrawing:e.HeightAdjustedForDrawing,OriginDeltaXAdjustedForDrawing:e.OriginDeltaXAdjustedForDrawing,OriginDeltaYAdjustedForDrawing:e.OriginDeltaYAdjustedForDrawing,SpansNextBlockVertically:e.SpansNextBlockVertically,SpansNextBlockHorizontally:e.SpansNextBlockHorizontally}}(e.Merge),o=function(e){if(e)return{Start:e.Start,End:e.End,Separator:e.Separator}}(e.NumFmt),r=function(e){if(!e)return;const t=[];if(e.PhoneticTextRuns)for(let o=0;o<e.PhoneticTextRuns.length;o++)t.push({BaseStartIndex:(n=e.PhoneticTextRuns[o]).BaseStartIndex,PhoneticStartIndex:n.PhoneticStartIndex,BaseTextLength:n.BaseTextLength,PhoneticLength:n.PhoneticLength});var n;return{Text:e.Text,PhoneticTextRuns:t}}(e.PhonInfo),i=function(e){if(!e)return;let t;return e.Domain&&(t={Id:e.Domain?.Id,StringId:e.Domain?.StringId}),{Domain:t,IconWidth:e.IconWidth}}(e.LinkedEntity),l=function(e){if(e)return{Width:e.Width,Type:e.Type,Unicode:e.Unicode}}(e.RichValueIcon),s=function(e){if(e)return{Type:e.Type}}(e.InCellControlOptions),a=function(e){if(e)return{Icon:gM(e.Icon),DataBar:mM(e.DataBar)}}(e.CondFormat),c=function(e){if(!e)return;let t;return e.InternalLink&&(t={ObjectName:e.InternalLink.ObjectName,SheetName:e.InternalLink.SheetName,FirstRow:e.InternalLink.FirstRow,FirstColumn:e.InternalLink.FirstColumn,LastRow:e.InternalLink.LastRow,LastColumn:e.InternalLink.LastColumn}),{Text:e.Text,IsValidHyperlink:e.IsValidHyperlink,IsHyperlinkFormula:e.IsHyperlinkFormula,IsHyperlinkExternal:e.IsHyperlinkExternal,IsHyperlinkChecked:e.IsHyperlinkChecked,Tooltip:e.Tooltip,InternalLink:t}}(e.Hyperlink),u=CM(e.Sparkline),d=CM(e.InCellImage),h=function(e){if(e)return{HasExpandCollapseIndicator:e.HasExpandCollapseIndicator,IsExpanded:e.IsExpanded,ECButtonTitle:e.ECButtonTitle,ShouldShowExpandCollapseMenu:e.ShouldShowExpandCollapseMenu,CanExpandCollapse:e.CanExpandCollapse,SourceIndex:e.SourceIndex,ConfirmRequired:e.ConfirmRequired,CanShowDetails:e.CanShowDetails}}(e.PivotTable),f=function(e){if(e)return{Row:e.Row,Column:e.Column,IsThreadedComment:e.IsThreadedComment,HideCommentIndicator:e.HideCommentIndicator}}(e.Comment),g=function(e){if(e)return{Formula:e.Formula,FormulaType:e.FormulaType,IsArrayRoot:e.IsArrayRoot}}(e.FormulaInfo),m=function(e){if(e)return{Type:e.Type,Menu:e.Menu,RenderingContext:e.RenderingContext,CommandData:e.CommandData?e.CommandData:void 0}}(e.AutoFilter),C=function(e){if(e)return{Type:e.Type,DisplayFilter:e.DisplayFilter,IsPivotPageField:e.IsPivotPageField,CommandData:e.CommandData,IsHeaderSnapped:e.IsHeaderSnapped}}(e.PivotFilter),p=function(e){if(e)return{IsAnchor:e.IsAnchor,Range:e.Range?pM(e.Range):void 0}}(e.DynamicArrayInfo);let w=[];if(e.TextRuns)for(let t=0;t<e.TextRuns.length;t++)w.push(Ic(e.TextRuns[t],e.TextRuns[t].FontID||0));else w=void 0;return{Col:e.Col,Row:e.Row,Text:e.Text,StyleID:e.StyleID||0,GlobalCellStyleID:e.GlobalCellStyleID,Ifmt:e.Ifmt||0,IfmtStamped:e.IfmtStamped||0,BorderStyleID:e.BorderStyleID||0,GlobalBorderStyleID:e.GlobalBorderStyleID,HorizontalAlignmentSet:e.HorizontalAlignmentSet,Spill:t,Merge:n,NumFmt:o,WrapText:e.WrapText,ShrunkSize:e.ShrunkSize,AutoFilter:m,PivotFilter:C,TextRuns:w,CondFormat:a,PhonInfo:r,Comment:f,RichValueType:e.RichValueType,RichValueFieldsIndexes:e.RichValueFieldsIndexes?[...e.RichValueFieldsIndexes]:void 0,FormulaInfo:g,ValueType:e.ValueType,HasError:e.HasError,Hyperlink:c,Sparkline:u,InCellImage:d,LinkedEntity:i,RichValueIcon:l,InCellControlOptions:s,PivotTable:h,HasIgnorableError:e.HasIgnorableError,SrvDx:e.SrvDx||0,SrvDy:e.SrvDy||0,TolType:e.TolType,TableColHeader:e.TableColHeader,TableRowHeader:e.TableRowHeader,Value:e.Value,PhoneticInfo:e.PhoneticInfo,OriginalText:e.OriginalText,ErrorTooltip:e.ErrorTooltip,DynamicArrayInfo:p,BitwiseBorderPosition:e.BitwiseBorderPosition||0}}function fM(e){const t=[];if(e.Outlines)for(let o=0;o<e.Outlines.length;o++)t.push({StartIndex:(n=e.Outlines[o]).StartIndex,ButtonIndex:n.ButtonIndex,IsExpanded:n.IsExpanded,IsButtonHidden:n.IsButtonHidden,IsNonDefaultDirection:n.IsNonDefaultDirection,ECTitle:n.ECTitle});var n;return{Outlines:t}}function gM(e){if(e)return{Set:e.Set,Index:e.Index,IconOnly:e.IconOnly,CFIconHorizontalAlignment:e.CFIconHorizontalAlignment}}function mM(e){if(e)return{AxisColor:e.AxisColor,AxisPostion:e.AxisPostion,Length:e.Length,Color:e.Color,GradientColor:e.GradientColor,BorderColor:e.BorderColor,Direction:e.Direction}}function CM(e){if(e)return{ClusterOffsetX:e.ClusterOffsetX,ClusterOffsetY:e.ClusterOffsetY,AltText:e.AltText,Width:e.Width,Height:e.Height,ClusterImageWidth:e.ClusterImageWidth,ClusterImageHeight:e.ClusterImageHeight}}function pM(e){return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn}}function wM(e){return{Index:e.Index,Caption:e.Caption,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowSubtotal:e.ShowSubtotal,RepeatItemLabels:e.RepeatItemLabels,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotalAtTop:e.ShowSubtotalAtTop,IsCompactLayout:e.IsCompactLayout,BaseFieldIndex:e.BaseFieldIndex,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}}function SM(e){const t=e.RowAreaCaptions?[...e.RowAreaCaptions]:void 0,n=e.RowAreaFields?[]:void 0;if(e.RowAreaFields)for(let t=0;t<e.RowAreaFields.length;t++)n.push(wM(e.RowAreaFields[t]));const o=e.ColumnAreaFields?[]:void 0;if(e.ColumnAreaFields)for(let t=0;t<e.ColumnAreaFields.length;t++)o.push(wM(e.ColumnAreaFields[t]));const r=e.ValueAreaFields?[]:void 0;if(e.ValueAreaFields)for(let t=0;t<e.ValueAreaFields.length;t++)r.push(wM(e.ValueAreaFields[t]));const i=e.PageAreaFields?[]:void 0;if(e.PageAreaFields)for(let t=0;t<e.PageAreaFields.length;t++)i.push(wM(e.PageAreaFields[t]));const l=e.SlicerConnections?[]:void 0;if(e.SlicerConnections)for(let t=0;t<e.SlicerConnections.length;t++)l.push({Name:(s=e.SlicerConnections[t]).Name,Caption:s.Caption,WorksheetName:s.WorksheetName,Enabled:s.Enabled});var s;return{FirstRow:e.FirstRow,FirstColumn:e.FirstColumn,LastRow:e.LastRow,LastColumn:e.LastColumn,RangeType:e.RangeType,ConnectionName:e.ConnectionName,PivotTableName:e.PivotTableName,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,ColumnTotalIndexes:e.ColumnTotalIndexes,RowTotalIndexes:e.RowTotalIndexes,ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,RowMemberPropIndexes:e.RowMemberPropIndexes,OriginPTWidth:e.OriginPTWidth,OriginPTHeight:e.OriginPTHeight,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaYFromOriginPT:e.DeltaYFromOriginPT,ColumnHeaderRange:e.ColumnHeaderRange,RowHeaderRange:e.RowHeaderRange,RowAreaCaptions:t,ExternalSourceIndex:e.ExternalSourceIndex,IsActionable:e.IsActionable,IsOlap:e.IsOlap,SupportsBIExplore:e.SupportsBIExplore,HideGridLines:e.HideGridLines,IsEmptyPivot:e.IsEmptyPivot,Xluid:e.Xluid,ShowDrillIndicators:e.ShowDrillIndicators,ShowColumnStripes:e.ShowColumnStripes,ShowRowStripes:e.ShowRowStripes,ShowRowHeaders:e.ShowRowHeaders,ShowColumnHeaders:e.ShowColumnHeaders,DataSource:e.DataSource,RowLocation:e.RowLocation,ColGrandTotalOn:e.ColGrandTotalOn,RwGrandTotalOn:e.RwGrandTotalOn,IndentIncrement:e.IndentIncrement,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,SaveSourceDataWithFile:e.SaveSourceDataWithFile,RefreshOnLoad:e.RefreshOnLoad,AltText:e.AltText,AltTextSummary:e.AltTextSummary,ErrorString:e.ErrorString,NullString:e.NullString,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,HasActiveFilter:e.HasActiveFilter,IsPageArea:e.IsPageArea,RowAreaFields:n,ColumnAreaFields:o,ValueAreaFields:r,PageAreaFields:i,CurrentStyleName:e.CurrentStyleName,FirstRowIndex:e.FirstRowIndex,FirstColIndex:e.FirstColIndex,LastRowIndex:e.LastRowIndex,LastColIndex:e.LastColIndex,StyleIndex:e.StyleIndex,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,SlicerConnections:l,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaXFromOriginPTAdjustedForDrawing,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,AutoRefresh:e.AutoRefresh,SupportsAutoRefresh:e.SupportsAutoRefresh,UseExpandedGeometry:e.UseExpandedGeometry,ExpandedGeometryRange:e.ExpandedGeometryRange,FilterAreaRowCount:e.FilterAreaRowCount,FilterAreaColCount:e.FilterAreaColCount,FilterCount:e.FilterCount}}oM[ZD[ZD.AccountingUnderline]]={value:5,errorType:tM,veto:"ContentFallback"},oM[ZD[ZD.BoldText]]={value:25,errorType:nM,veto:"ContentRenderedIncorrectly"},oM[ZD[ZD.CellHashText]]={value:5,errorType:tM,veto:"ContentFallback"},oM[ZD[ZD.CellTextOrientation]]={value:5,errorType:tM,veto:"ContentFallback"},oM[ZD[ZD.CustomFont]]={value:5,errorType:tM,veto:"MissingFont"},oM[ZD[ZD.AppleFont]]={value:5,errorType:tM,veto:"MissingFont"},oM[ZD[ZD.GoogleFont]]={value:5,errorType:tM,veto:"MissingFont"},oM[ZD[ZD.DiagonalBorder]]={value:1,errorType:eM,veto:"ContentRenderFailed"},oM[ZD[ZD.MediumBorder]]={value:25,errorType:nM,veto:"ContentRenderedIncorrectly"},oM[ZD[ZD.PatternStyle]]={value:1,errorType:eM,veto:"ContentRenderFailed"},oM[ZD[ZD.SpillCellAcrossBlocks]]={value:5,errorType:tM,veto:"ContentFallback"},oM[ZD[ZD.SubScriptSuperScriptInWrapText]]={value:25,errorType:nM,veto:"ContentRenderedIncorrectly"},oM[ZD[ZD.ThickBorder]]={value:25,errorType:nM,veto:"ContentRenderedIncorrectly"};const yM=Fn(Sn.HideColMergedCellAcrossBlocks),RM=Fn(Sn.MergeInfoResetBugFix);function TM(e,t,n,o=!1){const r=Jn(),i=VM(t);var l,s,a,c;if(0!==i.length)for(const u of i){const i=Ac(e)+1,d=hc(ao(u,e),i,1),h=zM(u,e,i,d,r,n);for(const o of t)if(l=o.Row,s=o.Col,a=u.Row,c=u.Col,!((l!==a||s!==c+1&&s!==c-1)&&(s!==c||l!==a+1&&l!==a-1)||o.Row!==u.Row-1&&o.Col!==u.Col-1)){const t=GM(o,e,n);if(Object.keys(t).length>0){t.BorderPosition=n?$t.Left:$t.Top,d.Borders.splice(0,0,t);const i=Ac(e)+1;d.ID=i,u.BorderStyleID=i,e.BorderStyles.push(d),r&&(u.GlobalBorderStyleID=Yn().getOrCreateID(d)),Mc(o,e,n?$t.Right:$t.Bottom)}}const f=o?[]:HM(u,e,n);if(Object.keys(h).length>0){const t=n?$t.Top:$t.Left;h.BorderPosition=t;for(const n of f)Fc(n,e),Dc(n,e,h,t)}}}function IM(e){return{...e,SpansBlocks:!1,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0,OriginRow:void 0,OriginColumn:void 0,WidthAdjustedForDrawing:void 0,HeightAdjustedForDrawing:void 0,OriginDeltaXAdjustedForDrawing:void 0,OriginDeltaYAdjustedForDrawing:void 0,SpansNextBlockHorizontally:void 0,SpansNextBlockVertically:void 0}}function vM(e,t,n,o,r,i,l){const s=e.Merge,a=n.Cells.find((t=>(i?t.Col===e.Col:t.Row===e.Row)&&t.Merge&&t.Merge.SpansBlocks&&(i?t.Row>0:t.Col>0)));a&&function(e,t,n,o,r,i,l,s,a){s?function(e,t,n,o,r,i,l,s){e.Rows-=i+l-t.Row+1,e.OriginDeltaY=BM(o.RowHeights,t.Row,i+l)+BM(r.RowHeights,n.Row,n.Row+n.Merge.Rows),n.Merge.Rows+=l+1,e.Height=n.Merge.Height,s||(e.OriginRow=n.Merge.OriginRow)}(e,t,n,o,r,i,l,a):function(e,t,n,o,r,i,l,s){e.Columns-=i+l-t.Col+1,e.OriginDeltaX=BM(o.ColumnWidths,t.Col,i+l)+BM(r.ColumnWidths,n.Col,n.Col+n.Merge.Columns),n.Merge.Columns+=l+1,e.Width=n.Merge.Width,s||(e.OriginColumn=n.Merge.OriginColumn)}(e,t,n,o,r,i,l,a)}(s,e,a,t,n,o,r,i,l)}function bM(e,t,n,o,r,i,l,s){if(!yM)return;const a=t.Cells.find((e=>(s?e.Col===n.Col:e.Row===n.Row)&&e.Merge&&e.Merge.SpansBlocks&&(s?e.Row>0:e.Col>0)));s?a.Merge.Rows+=n.Merge.Rows+1:a.Merge.Columns+=n.Merge.Columns+1;const c=s?!(a.Row+a.Merge.Rows===t.RowNumbers[t.RowNumbers.length-1]):!(a.Col+a.Merge.Columns===t.ColumnNumbers[t.ColumnNumbers.length-1]),u=DM(a,t)||OM(a),d=MM(a,t)||AM(a);if(RM&&(s&&d&&!u||!s&&u&&!d)){const e=a?.Merge?.OriginRow,n=a?.Merge?.OriginColumn,o=t.RowNumbers[a.Row],r=t.ColumnNumbers[a.Col];a.Merge=IM(a.Merge),(s&&e&&o>e+1||!s&&n&&r>n+1)&&(a.Merge.OriginRow=e,a.Merge.OriginColumn=n)}else RM||!c||u&&d||(a.Merge=IM(a.Merge));const h=FM(n,e,s?$t.Bottom:$t.Right);if(h){const c=e.BorderStyles.length,u=t.BorderStyles.length+i.length,d=hc(ao(a,t),u,1);s?d.Borders.splice(0,0,h):d.Borders.push(h),t.BorderStyles.push(d),a.BorderStyleID=u,l&&(a.GlobalBorderStyleID=Yn().getOrCreateID(d));const f=xM(h);f.BorderPosition=s?$t.Top:$t.Left;const g=[],m=n.Col+n.Merge.Columns,C=n.Row+n.Merge.Rows;if(s)for(let t=n.Col;t<=m;t+=1)g.push(Eo(C+1,t,e.Styles,e.Fonts));else for(let t=n.Row;t<=C;t+=1)g.push(Eo(t,m+1,e.Styles,e.Fonts));const p=hc(ao(g[0],e),c,1);p.Borders.push(f),e.BorderStyles.push(p);for(const e of g)s?e.Row-=o+1:e.Col-=o+1,r.push(e),e.BorderStyleID=c,l&&(e.GlobalBorderStyleID=Yn().getOrCreateID(p))}}function xM(e){return{BorderLineStyle:e.BorderLineStyle,BorderPosition:e.BorderPosition,Color:e.Color,Weight:e.Weight}}function FM(e,t,n){const o=ao(e,t);for(const e of o.Borders)if(e.BorderPosition===n)return e;return null}function DM(e,t){const n=e.Merge;return t.ColumnOffsets[e.Col]-n.OriginDeltaX+n.Width>t.BlockWidth}function MM(e,t){const n=e.Merge;return t.RowOffsets[e.Row]-n.OriginDeltaY+n.Height>t.BlockHeight}function AM(e){if(!e)return!1;const t=e.Merge;return!(0!==e.Row||!t||!t.SpansBlocks)&&e.Row!==t.OriginRow&&t.Height>t.OriginDeltaY}function OM(e){if(!e)return!1;const t=e.Merge;return!(0!==e.Col||!t||!t.SpansBlocks)&&e.Col!==t.OriginColumn&&t.Width>t.OriginDeltaX}function BM(e,t,n){let o=0;for(let r=t;r<=n;r++)o+=e[r];return o}function kM(e,t,n,o,r){0!==ao(e,t).Borders.length&&(!r||o!==e.Col&&o!==e.Row?r||Mc(e,t,n?$t.Bottom:$t.Right):NM(e,t,n))}function PM(e,t,n){const o=[];switch(n){case $t.Top:for(const n of t)n.Row===e.Row-1&&o.push(n);break;case $t.Bottom:for(const n of t)n.Row===e.Row+1&&o.push(n);break;case $t.Left:for(const n of t)n.Col===e.Col-1&&o.push(n);break;case $t.Right:for(const n of t)n.Col===e.Col+1&&o.push(n)}return o}function EM(e,t,n){const o=n?$t.Top:$t.Left,r=FM(e,t,o);if(!r||0===Object.keys(r).length)return;const i=PM(e,t.Cells,o),l=xM(r);Mc(e,t,o),l.BorderPosition=n?$t.Bottom:$t.Right;for(const e of i)Dc(e,t,l,l.BorderPosition)}function HM(e,t,n){const o=[];if(n)for(let n=e.Col;n<=e.Col+e.Merge.Columns;n++)o.push(zo(t,e.Row+e.Merge.Rows+1,n));else for(let n=e.Row;n<=e.Row+e.Merge.Rows;n++)o.push(zo(t,n,e.Col+e.Merge.Columns+1));return o}function LM(e,t,n,o){const r=FM(e,n,o?$t.Bottom:$t.Right);if(!r)return[];const i=xM(r);i.BorderPosition=o?$t.Top:$t.Left;const l=hM(e);o?l.Row=0:l.Col=0;const s=HM(l,t,o);for(const e of s)o?e.Row=0:e.Col=0,Fc(e,t),Dc(e,t,i,i.BorderPosition);return s}function NM(e,t,n){const o=n?$t.Top:$t.Left,r=PM(e,t.Cells,o);r.length>0&&function(e,t,n){const o=n?$t.Bottom:$t.Right;for(const n of e)Mc(n,t,o)}(r,t,n)}function WM(e,t,n,o,r,i){const l=jM(o,t,i,r);if(!l)return;const s=l.Merge,a=UM(o,l),c=$M(o,l);if(i){l.Row=0,s.OriginRow=t.Merge?.OriginRow,s.Rows+=r+1,s.OriginDeltaY=BM(n.RowHeights,e.Row,e.Row+e.Merge.Rows);const i=BM(n.RowHeights,e.Row,n.RowHeights.length-1)+BM(o.RowHeights,l.Row,l.Row+l.Merge.Rows-r-1);return l.Merge.Height=i,e.Merge.Height=i,void(a&&(s.OriginDeltaX=e.Merge.OriginDeltaX,e.Merge.Width=s.Width))}l.Col=0,s.OriginColumn=t.Merge?.OriginColumn,s.Columns+=r+1,s.OriginDeltaX=BM(n.ColumnWidths,e.Col,e.Col+e.Merge.Columns);const u=BM(n.ColumnWidths,e.Col,n.ColumnWidths.length-1)+BM(o.ColumnWidths,l.Col,l.Col+l.Merge.Columns-r-1);l.Merge.Width=u,e.Merge.Width=u,c&&(s.OriginDeltaY=e.Merge.OriginDeltaY,e.Merge.Height=s.Height)}function _M(e,t,n,o){const r=jM(t,e,o,n);if(!r)return;const i=r.Merge,l=UM(t,r),s=$M(t,r);if(l||s||(r.Merge=IM(i)),o)return r.Row=n-e.Merge.Rows,r.Merge.Rows+=e.Merge?.Rows+1,void(l&&(r.Merge.OriginRow=e.Merge?.OriginRow,r.Merge.OriginDeltaY=0));r.Col=n-e.Merge?.Columns,r.Merge.Columns+=e.Merge?.Columns+1,s&&(r.Merge.OriginColumn=e.Merge?.OriginColumn,r.Merge.OriginDeltaX=0)}function zM(e,t,n,o,r,i){let l={};const s=i?o.Borders.findIndex((e=>e.BorderPosition===$t.Bottom)):o.Borders.findIndex((e=>e.BorderPosition===$t.Right));return-1!==s&&(l=xM(o.Borders[s]),o.Borders.splice(s,1),e.BorderStyleID=n,t.BorderStyles.push(o),r&&(e.GlobalBorderStyleID=Yn().getOrCreateID(o))),l}function GM(e,t,n){const o=FM(e,t,n?$t.Right:$t.Bottom);return o?xM(o):{}}function VM(e){return e.filter((e=>e.Merge&&e.Merge.SpansBlocks))}function jM(e,t,n,o){return e.Cells.find((e=>!$s(e.Merge)&&(n?e.Col===t.Col&&e.Row===o+1:e.Row===t.Row&&e.Col===o+1)))}function UM(e,t){return DM(t,e)||OM(t)}function $M(e,t){return MM(t,e)||AM(t)}const qM=Fn(Sn.EnableMergeCellSupportForFreezePanesCse),XM=Fn(Sn.EnableFreezePanesCSEForMergedEdgeCells);let YM,JM,KM,QM;function ZM(){return void 0===YM&&(YM=Fn(Sn.FreezePanesCseSlice1)),!!YM}function eA(e,t,n,o,r,i,l,s,a,c,u,d,h){const f=ZM()&&!!u,g=PA(a,s[s.length-1]),m=c?t.ColumnNumbers?.length-1:t.RowNumbers?.length-1,C=!!f&&PA(d,m),p=c?e.Col:e.Row,w=f&&PA(p,function(e,t){return t?.performDiagonalCascading||t?.skipCascadingBeforeRowColIndex?e?go-1:fo-1:t?.rowColIndexToEndRangeCascade-1}(c,u));if(!g&&!w&&!C)return!1;(g||C)&&function(e,t,n,o=!1,r){const i=n?e.Col:e.Row;if(o&&i===r&&(n?i===go-1:i===fo-1))return;const l=Jn(),s=t.BorderStyles.length,a=hc(ao(e,t),s,1),c=a.Borders.findIndex((e=>o?n?e.BorderPosition===$t.Right:e.BorderPosition===$t.Bottom:n?e.BorderPosition===$t.Bottom:e.BorderPosition===$t.Right));-1!==c&&(a.Borders.splice(c,1),e.BorderStyleID=s,t.BorderStyles.push(a),l&&(e.GlobalBorderStyleID=Yn().getOrCreateID(a)))}(e,t,c,f,d);let S=!1,y=!1,R=!1;const T=n+o.length,I=hc(wn(e.BorderStyleID||0,t.BorderStyles),T,1);return g&&(S=function(e,t,n,o,r,i,l,s,a,c,u,d,h,f,g){const m=n?g!==e.Col:g!==e.Row,C=function(e,t,n,o){return n?.skipCascadingBeforeRowColIndex?e?t.Col+n.rowColIndexToEndRangeCascade:t.Row+n.rowColIndexToEndRangeCascade:o}(n,e,h,g),p=function(e,t,n,o,r,i,l){return i?i?e?BA(t,n,o,e,r,l):OA(t,n,o,e,r,l):{}:e?BA(t,n,o,e):OA(t,n,o,e)}(n,e,t,u,d,m,C);return 0!==Object.keys(p).length&&oA(e,t,o,r,i,l,s,p,a,c,!0,u,n,h,g,f)}(e,t,c,n,o,r,i,l,T,I,a,f,u,h,d)),f&&(C&&(y=function(e,t,n,o,r){const i=e.BorderStyleID||0;return!t.has(i)&&i!==Nt.DefaultBorder&&(t.set(i,o),n.push(r),!0)}(e,i,o,T,I)),w&&(R=function(e,t,n,o,r,i,l,s,a,c,u,d,h){const f=n?e.Col:e.Row,g=function(e,t,n,o,r,i,l,s){return n?OA(e,t,o,!n,true,l):BA(e,t,i?.performDiagonalCascading?s:o,!n,true,i?.skipCascadingBeforeRowColIndex?n?e.Row+i?.rowColIndexToEndRangeCascade:e.Col+i?.rowColIndexToEndRangeCascade:l)}(e,t,n,f,0,u,d,h);return 0!==Object.keys(g).length&&oA(e,t,o,r,i,l,s,g,a,c,!1,u.performDiagonalCascading?h:f,!n,u,h,d)}(e,t,c,n,o,r,i,l,T,I,u,h,d))),S||R||y}function tA(e){return e===FA.FreezePane&&(void 0===JM&&(JM=Fn(Sn.FreezePanesCseSlice2)),!!JM&&ZM())&&qM}function nA(e,t,n,o){if(XM){if(!e.Merge)return!1;if(o){if(e.Row+e.Merge.Rows===t)return!1}else if(e.Col+e.Merge.Columns===t)return!1}return EA(e,t,n,o)}function oA(e,t,n,o,r,i,l,s,a,c,u,d,h,f,g,m){let C=!1;const p=e.BorderStyleID||0,w=Jn(),S=e.BorderStyleID||0,y=h?g!==e.Col:g!==e.Row,R=kA(e,t.Cells,d,h,!u||!!y,f?.skipCascadingBeforeRowColIndex?h?e.Col+f?.rowColIndexToEndRangeCascade:e.Row+f?.rowColIndexToEndRangeCascade:u?g:m).BorderStyleID||0;if(r&&i.get(S)&&l.get(R))e.BorderStyleID=i.get(S),w&&(e.GlobalBorderStyleID=Yn().getOrCreateID(wn(p,t.BorderStyles)));else{if(r&&(i.set(S,a),l.set(R,n+l.size)),h){const e=c.Borders;let t=e.length;for(let n=0;n<e.length;n++)e[n].BorderPosition<s.BorderPosition&&(t=n+1);c.Borders.splice(t,0,s)}else c.Borders.push(s);o.push(c),e.BorderStyleID=a,w&&(e.GlobalBorderStyleID=Yn().getOrCreateID(c)),C=!0}return C}function rA(){return void 0===KM&&(KM=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.ApplyFilterCSE",!1)&&(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.ApplyFilterCSESlice1",!1)),KM}function iA(){return void 0===QM&&(QM=(0,Rn.getIntFeatureGate)("Microsoft.Office.Excel.AutoFilterListServerRowRangesSerialization",0)>0),QM}function lA(e){return(rA()||iA())&&e===FA.ApplyFilter}function sA(e,t,n){let o=0;if(n)for(let n=0;n<t.length;n++)e.Row>t[n]&&(o+=1);else for(let n=0;n<t.length;n++)e.Col>t[n]&&(o+=1);return o}function aA(e,t,n,o,r){return r?!!t[e.Row]:e.Row<=n+o&&!t[e.Row]}const cA=64,uA=20;let dA=0,hA=!1;const fA=Fn(Sn.MergeCellBorderScenarios),gA=Fn(Sn.MungedBorderBugFixes),mA=Fn(Sn.HideDeleteCSEBlockEdgeBorderFix),CA=Fn(Sn.BorderInsertionBugFix),pA=Fn(Sn.InsertOperationBugFix),wA=Fn(Sn.EnableDeleteRowColCSEForMergeCellSpanningAcrossTwoBlocks),SA=Fn(Sn.MergeInfoOriginRowColMismatchBugFix),yA=Fn(Sn.InsertCSEForMergeCellSpanningBlocks),RA=Fn(Sn.FreezePanesSpillCellFix),TA=Fn(Sn.ModelCascadeGetStyleIdUsingGlobalStylesFix),IA=Fn(Sn.ApplyFilterCseEnableForAutofitTolType);let vA=new Map,bA=new Map;function xA(e){return yo(Vt.HideColumnMergedCellSlice1,e)&&yo(Vt.HideColumnSlice1,e)}var FA;function DA(e,t,n,o,r,i=!1,l=[]){if(lA(r)&&l?.length>0&&(0===e.RowNumbers?.length||0===e.ColumnNumbers?.length))return!0;const s=r===FA.Hide||r===FA.FreezePane,a=o?e.RowNumbers:e.ColumnNumbers;let c,u;if(lA(r)){const e=a[0],t=a[a.length-1];c=l.length>0?HA(a,l[0]):-1,u=function(e,t,n,o){const r=[];for(let i=0;i<t.length;i++)if(t[i]>=n&&t[i]<=o){const n=HA(e,t[i]);if(-1===n){r.push(-1);break}r.push(n)}return r}(a,l,e,t)}else c=HA(a,t),u=lO(a,n,c);if(-1===u[0])return!1;if(YA(e.Cells))return KA(e,u,o,s,lA(r)),!0;const d=[],h=u[u.length-1],f=FO(e,o),g=MO(e,o);for(let i=0;i<e.Cells.length;i++){const l=e.Cells[i];if(r!==FA.ApplyFilter&&TO(e,l,c,n,o,r,f,g),iO(l,u,o)||EA(l,c,n,o))l.Merge&&(sO(l,c,n,o)?!fA||c!==l.Col&&c!==l.Row||NM(l,e,o):(!s&&dO(l,c,n,o,e)&&(l.Text=void 0),aO(l,c,n,o,s,e),o?l.Row>c&&(l.Row=c):l.Col>c&&(l.Col=c),d.push(l)));else{if(l.Merge&&!s){const e=a[u[u.length-1]]-t+1;o?l.Merge?.OriginRow&&0!==l.Merge.OriginRow&&(l.Merge.OriginRow-=SA?e:n+1):l.Merge?.OriginColumn&&0!==l.Merge.OriginColumn&&(l.Merge.OriginColumn-=SA?e:n+1)}if(o)if(lA(r)){const e=sA(l,u,o);l.Row-=e}else l.Row>h&&(l.Row-=n+1);else if(lA(r)){const e=sA(l,u,o);l.Col-=e}else l.Col>h&&(l.Col-=n+1);d.push(l)}}return ZM()&&r===FA.FreezePane&&c>0&&function(e,t,n){const o=n-1,r=e.Cells.filter((e=>t?e.Row===o:e.Col===o)),i=e.Cells.filter((e=>t?e.Row===n:e.Col===n));let l=0,s=0;for(;l<i.length;){const n=s<r.length?r[s]:null,o=i[l];t?n?n.Col===o.Col?(MA(n,o,e,e),s++,l++):n.Col<o.Col?s++:(MA(n,o,e,e),l++):(MA(n,o,e,e),l++):n?n.Row===o.Row?(AA(n,o,e,e),s++,l++):n.Row<o.Row?s++:(AA(n,o,e,e),l++):(AA(n,o,e,e),l++)}}(e,o,c),KA(e,u,o,s,lA(r)),e.Cells=[],gO(e,d),i&&IO(e,o),RA&&(e.ClientOnlyCache=void 0),!0}function MA(e,t,n,o,r){const i=FM(t,o,$t.Top);if(i){e||gO(n,[e=zo(n,r||n.RowNumbers.length-1,t.Col)]);const o=hc(ao(e,n),n.BorderStyles.length,1),l=xM(i);l.BorderPosition=$t.Bottom;let s=0;for(let e=0;e<o.Borders.length;e++)if(o.Borders[e].BorderPosition>$t.Bottom){s=1,o.Borders.splice(e,0,l);break}s||o.Borders.push(l),e.GlobalBorderStyleID=Yn().getOrCreateID(o),n.BorderStyles.push(o),e.BorderStyleID=o.ID}}function AA(e,t,n,o,r){const i=FM(t,o,$t.Left);if(i){e||gO(n,[e=zo(n,t.Row,r||n.ColumnNumbers.length-1)]);const o=hc(ao(e,n),n.BorderStyles.length,1),l=xM(i);l.BorderPosition=$t.Right,o.Borders.push(l),e.GlobalBorderStyleID=Yn().getOrCreateID(o),n.BorderStyles.push(o),e.BorderStyleID=o.ID}}function OA(e,t,n,o,r,i){const l={},s=kA(e,t.Cells,n,o,r,i);if(!s)return l;const a=ao(s,t);for(const e of a.Borders)if(e.BorderPosition===$t.Left)return l.BorderLineStyle=e.BorderLineStyle,l.BorderPosition=$t.Right,l.Weight=e.Weight,l.Color=e.Color,l;return l}function BA(e,t,n,o,r,i){const l={},s=kA(e,t.Cells,n,o,r,i);if(!s)return l;const a=ao(s,t);for(const e of a.Borders)if(e.BorderPosition===$t.Top)return l.BorderLineStyle=e.BorderLineStyle,l.BorderPosition=$t.Bottom,l.Weight=e.Weight,l.Color=e.Color,l;return l}function kA(e,t,n,o,r,i){for(const l of t)if(o){if(l.Col===(r?i:e.Col)&&l.Row===n+1)return l}else if(l.Row===(r?i:e.Row)&&l.Col===n+1)return l;return null}function PA(e,t){return e===t}function EA(e,t,n,o){return!!e.Merge&&(o?XA(t,n,e.Row,e.Row+e.Merge.Rows):XA(t,n,e.Col,e.Col+e.Merge.Columns))}function HA(e,t){for(let n=0;n<e.length;n++)if(t===e[n])return n;return-1}function LA(e,t,n,o){let r=!!(t.RichValueFieldsIndexes||t.PivotFilter||t.PivotTable||t.InCellImage||t.Sparkline);const i=ZM()?n!==FA.Hide&&n!==FA.FreezePane&&n!==FA.ApplyFilter:n!==FA.Hide;return r=r||i&&!!t.CondFormat,xA(e)&&t.Merge?yM&&function(e){switch(e){case FA.Delete:return wA;case FA.Insert:return yA;case FA.Hide:return fA;default:return!1}}(n)||(r=r||!!t.Merge.SpansBlocks):r=r||!!t.Merge,CO(e)||(r=r||!!t.AutoFilter),pO(e)||(r=r||!!t.FormulaInfo),so()||(r=r||!!t.TextRuns),iA()&&IA||n===FA.ApplyFilter&&(r=r||t.ValueType===Wt.Number&&!!t.TolType&&t.TolType===rn.Autofit),r&&function(e,t,n,o){let r="";const i=[];if(t.RichValueFieldsIndexes&&i.push("RichValueFieldsIndexes"),t.PivotFilter&&i.push("PivotFilter"),t.PivotTable&&i.push("PivotTable"),t.InCellImage&&i.push("InCellImage"),t.Sparkline&&i.push("Sparkline"),t.Merge?.SpansBlocks&&i.push("MergeCellSpansBlocks"),t.CondFormat&&n!==FA.Hide&&i.push("CondFormat"),t.FormulaInfo&&!pO(e)&&i.push("FormulaInfo"),t.Merge&&!xA(e)&&i.push("MergeCell"),t.AutoFilter&&!CO(e)&&i.push("AutoFilter"),t.TextRuns&&!so()&&i.push("TextRuns"),n===FA.ApplyFilter&&t.TolType&&i.push("TolType"),i.length>0&&(r=i.join(",")),""!==r){let e="";switch(n){case FA.Hide:e="Hide";break;case FA.Unhide:e="Unhide";break;case FA.Insert:e="Insert";break;case FA.Delete:e="Delete";break;case FA.FreezePane:e="FreezePane";break;case FA.ApplyFilter:e="ApplyFilter"}e=e.concat(o?"Row":"Column"),Pn.sendTraceTag(507353300,En.msoulscat_ES_EWAJSGrid,d.Info,`CSE unattempted due to complex cell  for commandName= ${e},reason= ${r}`)}}(e,t,n,o),r}function NA(e,t){return function(e,t){for(const n of e.Borders)if(n.BorderPosition===t)return!0;return!1}(ao(e,t),$t.Left)}function WA(e,t,n,o){const r=e.Cells.filter((e=>n?e.Row===t-1:e.Col===t-1));for(const t of r){if(fA&&t.Merge)continue;const r=Jn(),i=e.BorderStyles.length,l=hc(ao(t,e),i,1),s=l.Borders.findIndex((e=>o?n?e.BorderPosition===$t.Right:e.BorderPosition===$t.Bottom:n?e.BorderPosition===$t.Bottom:e.BorderPosition===$t.Right));-1!==s&&(l.Borders.splice(s,1),t.BorderStyleID=i,e.BorderStyles.push(l),r&&(t.GlobalBorderStyleID=Yn().getOrCreateID(l)))}}function _A(e,t,n){return!!e.Merge&&(n?zA(t,e.Row,e.Row+e.Merge.Rows):zA(t,e.Col,e.Col+e.Merge.Columns))}function zA(e,t,n){return t<=e&&n>=e}function GA(e,t,n,o){LO(t,n),LO(e,n),t.ColumnNumbers?.push(e.ColumnNumbers[o]),t.ColMetadata?.push(e.ColMetadata[o]),t.ColumnWidths?.push(e.ColumnWidths[o]),t.FixedColumns?.push(e.FixedColumns[o]),t.ColumnOffsets?.push(e.ColumnOffsets[o]),e.ColumnNumbers?.splice(o,1),e.ColMetadata?.splice(o,1),e.ColumnWidths?.splice(o,1),e.FixedColumns?.splice(o,1),e.ColumnOffsets?.splice(o,1);let r=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=r,r+=e.ColumnWidths[t];e.BlockWidth=r;let i=0;for(let e=0;e<t.ColumnWidths.length;e++)t.ColumnOffsets[e]=i,i+=t.ColumnWidths[e];t.BlockWidth=i}function VA(e,t,n,o,r,i){LO(t,n),LO(e,n);const l=o.length;for(const n of o)i?(t.RowNumbers?.push(e.RowNumbers[n]),t.RowHeights?.push(e.RowHeights[n]),t.RowOutlinesInformation?.push(e.RowOutlinesInformation[n]),t.RowOffsets?.push(e.RowOffsets[n])):(t.ColumnNumbers?.push(e.ColumnNumbers[n]),t.ColMetadata?.push(e.ColMetadata[n]),t.ColumnWidths?.push(e.ColumnWidths[n]),t.FixedColumns?.push(e.FixedColumns[n]),t.ColumnOffsets?.push(e.ColumnOffsets[n]));const s=o[0];if(i){e.RowNumbers?.splice(s,l),e.RowHeights?.splice(s,l),e.RowOutlinesInformation?.splice(s,l),e.RowOffsets?.splice(s,l);let n=0;for(let t=0;t<e.RowHeights.length;t++)e.RowOffsets[t]=n,n+=e.RowHeights[t];e.BlockHeight=n;let o=0;for(let e=0;e<t.RowHeights.length;e++)t.RowOffsets[e]=o,o+=t.RowHeights[e];t.BlockHeight=o}else{e.ColumnNumbers?.splice(s,l),e.ColMetadata?.splice(s,l),e.ColumnWidths?.splice(s,l),e.FixedColumns?.splice(s,l),e.ColumnOffsets?.splice(s,l);let n=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=n,n+=e.ColumnWidths[t];e.BlockWidth=n;let o=0;for(let e=0;e<t.ColumnWidths.length;e++)t.ColumnOffsets[e]=o,o+=t.ColumnWidths[e];t.BlockWidth=o}r||(i?(ZA(t.RowNumbers,t.RowNumbers.length-l,dA),ZA(e.RowNumbers,0,dA)):(ZA(t.ColumnNumbers,t.ColumnNumbers.length-l,dA),ZA(e.ColumnNumbers,0,dA)))}function jA(e,t,n,o){LO(t,n),LO(e,n);const r=o.length,i=e.ColumnNumbers.length;for(const n of o){const o=n+r-i;t.ColumnNumbers?.splice(o,0,e.ColumnNumbers[n]),t.ColumnWidths?.splice(o,0,e.ColumnWidths[n]),t.ColMetadata?.splice(o,0,e.ColMetadata[n]),t.FixedColumns?.splice(o,0,e.FixedColumns[n])}const l=o[r-1]+r-i;nO(t.ColumnNumbers,l,r),rO(t);const s=o[0];e.ColumnNumbers?.splice(s,r),e.ColMetadata?.splice(s,r),e.ColumnWidths?.splice(s,r),e.FixedColumns?.splice(s,r),e.ColumnOffsets?.splice(s,r),rO(e)}function UA(e,t,n){const o=n.length,r=e.RowNumbers.length;for(const i of n){const n=i+o-r;t.RowNumbers?.splice(n,0,e.RowNumbers[i]),t.RowHeights?.splice(n,0,e.RowHeights[i]),t.RowOutlinesInformation?.splice(n,0,e.RowOutlinesInformation[i])}const i=n[o-1]+o-r;nO(t.RowNumbers,i,o),oO(t);const l=n[0];e.RowNumbers?.splice(l,o),e.RowHeights?.splice(l,o),e.RowOffsets?.splice(l,o),e.RowOutlinesInformation?.splice(l,o),oO(e)}function $A(e,t,n){return n?e.Row===t:e.Col===t}function qA(e,t,n,o){return o?e.Row<=t+n&&e.Row>=t:e.Col<=t+n&&e.Col>=t}function XA(e,t,n,o){return n<=e+t&&o>=e}function YA(e){return!e||0===e.length}function JA(e,t){e.ColumnNumbers?.splice(t,1),e.ColMetadata?.splice(t,1),e.ColumnWidths?.splice(t,1),e.FixedColumns?.splice(t,1),e.ColumnOffsets?.splice(t,1);let n=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=n,n+=e.ColumnWidths[t];e.BlockWidth=n}function KA(e,t,n,o,r=!1){const i=t[0],l=t.length;if(n){if(dA=QA(e,t,n),r)for(let n=t.length-1;n>=0;n--)e.RowNumbers?.splice(t[n],1),e.RowHeights?.splice(t[n],1),e.RowOffsets?.splice(t[n],1),e.RowOutlinesInformation?.splice(t[n],1);else e.RowNumbers?.splice(i,l),e.RowHeights?.splice(i,l),e.RowOffsets?.splice(i,l),e.RowOutlinesInformation?.splice(i,l);let s=0;for(let t=0;t<e.RowHeights.length;t++)e.RowOffsets[t]=s,s+=e.RowHeights[t];e.BlockHeight=s,o||r||ZA(e.RowNumbers,i,dA)}else{if(dA=QA(e,t,n),r)for(let n=t.length-1;n>=0;n--)e.ColumnNumbers?.splice(t[n],1),e.ColMetadata?.splice(t[n],1),e.ColumnWidths?.splice(t[n],1),e.FixedColumns?.splice(t[n],1),e.ColumnOffsets?.splice(t[n],1);else e.ColumnNumbers?.splice(i,l),e.ColMetadata?.splice(i,l),e.ColumnWidths?.splice(i,l),e.FixedColumns?.splice(i,l),e.ColumnOffsets?.splice(i,l);let s=0;for(let t=0;t<e.ColumnWidths.length;t++)e.ColumnOffsets[t]=s,s+=e.ColumnWidths[t];e.BlockWidth=s,o||r||ZA(e.ColumnNumbers,i,dA)}}function QA(e,t,n){const o=t.length;return n?e.RowNumbers[t[o-1]]-e.RowNumbers[t[0]]+1:e.ColumnNumbers[t[o-1]]-e.ColumnNumbers[t[0]]+1}function ZA(e,t,n){for(let o=t;o<e.length;o++)e[o]=e[o]-n}function eO(e,t){const n=t.length,o=0===t[0],r=t[0]-1;let i,l;o||!Nc(e.IsBitwiseFixedRows||0,r)?(i=uA,l={}):(i=e.RowHeights?.[r],l=e.RowOutlinesInformation?.[r]);for(let n=0;n<t.length;n++){const o=t[n],r=0===o?1:e.RowNumbers[o-1]+1;e.RowNumbers?.splice(o,0,r),e.RowHeights?.splice(o,0,i),e.RowOutlinesInformation?.splice(o,0,l)}const s=t[n-1];nO(e.RowNumbers,s,n),oO(e)}function tO(e,t){const n=t.length,o=0===t[0],r=t[0]-1;let i,l,s;o?(i=cA,l={},s=!1):(i=e.ColumnWidths?.[r],l=e.ColMetadata?.[r],s=e.FixedColumns?.[r]);for(let n=0;n<t.length;n++){const o=t[n],r=0===o?1:e.ColumnNumbers[o-1]+1;e.ColumnNumbers?.splice(o,0,r),e.ColumnWidths?.splice(o,0,i),e.ColMetadata?.splice(o,0,l),e.FixedColumns?.splice(o,0,s)}const a=t[t.length-1];nO(e.ColumnNumbers,a,n),rO(e)}function nO(e,t,n){for(let o=t+1;o<e.length;o++)e[o]=e[o]+n}function oO(e){let t=0;for(let n=0;n<e.RowHeights.length;n++)e.RowOffsets[n]=t,t+=e.RowHeights[n];e.BlockHeight=t}function rO(e){let t=0;for(let n=0;n<e.ColumnWidths.length;n++)e.ColumnOffsets[n]=t,t+=e.ColumnWidths[n];e.BlockWidth=t}function iO(e,t,n){if(n){for(const n of t)if(e.Row===n)return!0;return!1}for(const n of t)if(e.Col===n)return!0;return!1}function lO(e,t,n){if(-1===n)return[-1];if(rA()||iA()){if(e&&0===e.length)return[];t>=e.length&&(t=e.length-1)}const o=[n];for(let r=1;r<=t;r++){const t=HA(e,e[n+r]);if(-1===t)return[-1];o.push(t)}return o}function sO(e,t,n,o){return o?e.Row>=t&&e.Row+e.Merge?.Rows<=t+n:e.Col>=t&&e.Col+e.Merge?.Columns<=t+n}function aO(e,t,n,o,r,i){const l=e.Merge;let s=-1,a=-1;if(function(e,t,n,o,r){const[i,l]=hO(r,t,n,o),[s,a]=fO(e,r,o);return i>s&&l<a}(e,t,n,o,i))o?l.Rows-=n+1:l.Columns-=n+1,s=t,a=t+n+1;else if(dO(e,t,n,o,i)){if(fA&&kM(e,i,o,t,!0),r&&(cO(e,i,l),l.IsOrigin=void 0),o){const o=t-e.Row+n+1;l.Rows-=o,!r&&l.OriginRow&&(SA?l.OriginRow=i.RowNumbers[t]-1||0:l.OriginRow-=n-o+1),s=e.Row}else{const o=t-e.Col+n+1;l.Columns-=o,!r&&l.OriginColumn&&(SA?l.OriginColumn=i.ColumnNumbers[t]-1||0:l.OriginColumn-=n-o+1),s=e.Col}a=t+n+1,!SA||r||l.SpansBlocks||(e.Merge=IM(e.Merge))}else if(function(e,t,n,o,r){const[i,l]=hO(r,t,n,o),[s,a]=fO(e,r,o);return i>s&&l>=a}(e,t,n,o,i)){let n;fA&&kM(e,i,o,t,!1),r&&cO(e,i,l),o?(n=e.Row+e.Merge.Rows-t+1,l.Rows-=n):(n=e.Col+e.Merge.Columns-t+1,l.Columns-=n),s=t,a=t+n}l.SpansBlocks&&(o?function(e,t,n,o){for(let r=e;r<t;r++)n.Height-=o.RowHeights[r]}(s,a,l,i):function(e,t,n,o){for(let r=e;r<t;r++)n.Width-=o.ColumnWidths[r]}(s,a,l,i))}function cO(e,t,n){0!==n?.OriginRow&&void 0!==n?.OriginRow||(n.OriginRow=t.RowNumbers[e.Row]-1||0),0!==n?.OriginColumn&&void 0!==n?.OriginColumn||(n.OriginColumn=t.ColumnNumbers[e.Col]-1||0)}function uO(e,t,n,o,r,i,l){const s=e.Merge;s.OriginColumn=t.ColumnNumbers[e.Col]-1,s.OriginRow=t.RowNumbers[e.Row]-1,s.SpansBlocks=!0,s.Width=BM(t.ColumnWidths,e.Col,e.Col+s.Columns),s.Height=BM(t.RowHeights,e.Row,e.Row+s.Rows),r?(i?(l||(s.OriginRow-=o+1),s.Rows=n+o-e.Row):(l||(s.OriginColumn-=o+1),s.Columns=n+o-e.Col),s.IsOrigin=!0):(i?(l||(s.OriginRow-=o+1),s.Rows-=n+o-e.Row+1,s.OriginDeltaY=BM(t.RowHeights,e.Row,n+o)):(l||(s.OriginColumn-=o+1),s.Columns-=n+o-e.Col+1,s.OriginDeltaX=BM(t.ColumnWidths,e.Col,n+o)),s.IsOrigin=!1)}function dO(e,t,n,o,r){const[i,l]=hO(r,t,n,o),[s,a]=fO(e,r,o);return i<=s&&l<a}function hO(e,t,n,o){return o?[e.RowNumbers[t],e.RowNumbers[t+n]]:[e.ColumnNumbers[t],e.ColumnNumbers[t+n]]}function fO(e,t,n){return n?[0===(e.Merge?.OriginRow||0)?t.RowNumbers[e.Row]:(e.Merge?.OriginRow||0)+1,t.RowNumbers[e.Row+e.Merge.Rows]]:[0===(e.Merge?.OriginColumn||0)?t.ColumnNumbers[e.Col]:(e.Merge?.OriginColumn||0)+1,t.ColumnNumbers[e.Col+e.Merge.Columns]]}function gO(e,t){for(const n of t){const t=Ha(n,e.Cells);e.Cells.splice(t,0,n)}}function mO(e,t){for(const n of t){const t=Ha(n,e.Cells);e.Cells.splice(t,1)}}function CO(e){return yo(Vt.HideColumnAutoFilterSlice1,e)&&yo(Vt.HideColumnSlice1,e)}function pO(e){return yo(Vt.HideColumnFormulaSlice1,e)&&yo(Vt.HideColumnSlice1,e)}function wO(e,t,n,o,r){const i=e.Merge;if(yA?(i.OriginRow||i.OriginColumn||(i.OriginColumn=t.ColumnNumbers[e.Col]-1,i.OriginRow=t.RowNumbers[e.Row]-1),i.SpansBlocks||(i.Width=BM(t.ColumnWidths,e.Col,e.Col+i.Columns),i.Height=BM(t.RowHeights,e.Row,e.Row+i.Rows),i.SpansBlocks=!0)):(i.OriginColumn=t.ColumnNumbers[e.Col]-1,i.OriginRow=t.RowNumbers[e.Row]-1,i.SpansBlocks=!0,i.Width=BM(t.ColumnWidths,e.Col,e.Col+i.Columns),i.Height=BM(t.RowHeights,e.Row,e.Row+i.Rows)),o)r?(i.OriginDeltaY=BM(t.RowHeights,e.Row,e.Row+i.Rows-(n+1)+(fo+n-(e.Row+e.Merge.Rows))),i.Rows=n-(fo+n+1-(e.Row+e.Merge.Rows+1))):(i.OriginDeltaX=BM(t.ColumnWidths,e.Col,e.Col+i.Columns-(n+1)+(go+n-(e.Col+e.Merge.Columns))),i.Columns=n-(go+n+1-(e.Col+e.Merge.Columns+1)));else if(r){const t=fo+n+1-(e.Row+e.Merge.Rows+1);i.Rows=i.Rows+t-(n+1),i.IsOrigin=!0}else{const t=go+n+1-(e.Col+e.Merge.Columns+1);i.Columns=i.Columns+t-(n+1)}}function SO(e,t,n){const o=t?e.Col:e.Row;return n.skipCascadingBeforeRowColIndex?o<n.rowColIndexToEndRangeCascade:o>=n.rowColIndexToEndRangeCascade}function yO(e,t,n,o,r){return!!r&&(r?.skipCascadingBeforeRowColIndex&&!o?e.Row-=r?.rowColIndexToEndRangeCascade:r?.performDiagonalCascading&&!o&&(e.Col-=n+1,e.Row=t.RowNumbers.length-r?.rowColIndexToEndRangeCascade+e.Row),!0)}function RO(e,t){gA||(function(e,t){const n=FO(e,t);(function(e,t,n){const o=t?$t.Top:$t.Left,r=t?$t.Bottom:$t.Right;for(let i=0;i<e.Cells.length;i++){const l=e.Cells[i];if(l.Merge||l[t?"Row":"Col"]===(t?(e.RowNumbers?.length||0)-1:(e.ColumnNumbers?.length||0)-1))continue;l.CachedBorderStyle||(l.CachedBorderStyle=ao(l,e));const s=l.CachedBorderStyle?.Borders.find((e=>e.BorderPosition===o));if(s&&Da(l,r)){const r=t?$o(l.Row+1,l.Col,e):$o(l.Row,l.Col+1,e);if(!r||!Ma(r,o)){if(r&&r.Merge)continue;const e=t?Ao(l.Row+1,l.Col):Ao(l.Row,l.Col+1);n.set(e,s)}}}})(e,t,n),DO(e,t,n);const o=MO(e,t);(function(e,t,n,o){const r=t?$t.Bottom:$t.Right,i=t?$t.Top:$t.Left;for(let l=0;l<e.Cells.length;l++){const s=e.Cells[l];if(!s.Merge&&s[t?"Row":"Col"]!==(t?(e.RowNumbers?.length||0)-1:(e.ColumnNumbers?.length||0)-1)&&(s.CachedBorderStyle||(s.CachedBorderStyle=ao(s,e)),s.CachedBorderStyle&&s.CachedBorderStyle.Borders&&s.CachedBorderStyle.Borders.length>0&&Da(s,r))){const r=t?$o(s.Row+1,s.Col,e):$o(s.Row,s.Col+1,e);if(r&&Ma(r,i)&&!Da(r,i)){if(r&&r.Merge)continue;const e=t?Ao(s.Row+1,s.Col):Ao(s.Row,s.Col+1);if(o.has(e)){const t=o.get(e);if(t&&t.BorderPosition===i)continue}n.set(e,i)}}}})(e,t,o,n),AO(e,t,o)}(e,t),vO(e,t),bO(e,t))}function TO(e,t,n,o,r,i,l,s){gA&&(i!==FA.Hide&&i!==FA.Delete?function(e,t,n,o,r,i,l){if((r?t.Row:t.Col)===n){const n=r?$o(t.Row-1,t.Col,e):$o(t.Row,t.Col-1,e);if(!n)return;if(t.CachedBorderStyle=ao(t,e),n.CachedBorderStyle=ao(n,e),pA){if(r?Da(n,$t.Bottom)&&Ma(t,$t.Top):Da(n,$t.Right)&&Ma(t,$t.Left)){if(!r&&!Da(t,$t.Left)||r&&!Da(t,$t.Top)){const e=Ao(r?t.Row+o+1:t.Row,r?t.Col:t.Col+o+1);l.set(e,r?$t.Top:$t.Left)}const n=Ao(t.Row,t.Col),s=FM(t,e,r?$t.Top:$t.Left);s&&i.set(n,s),DO(e,r,i),AO(e,r,l)}}else if(Da(n,$t.Right)&&Ma(t,$t.Left)){if(!Da(t,$t.Left)){const e=Ao(r?t.Row+o+1:t.Row,r?t.Col:t.Col+o+1);l.set(e,$t.Left)}const n=Ao(t.Row,t.Col),s=FM(t,e,$t.Left);s&&i.set(n,s),DO(e,r,i),AO(e,r,l)}}}(e,t,n,o,r,l,s):function(e,t,n,o,r,i,l){const s=r?t.Row:t.Col;if(s===n){const n=r?$o(t.Row-1,t.Col,e):$o(t.Row,t.Col-1,e);if(n&&(t.CachedBorderStyle=ao(t,e),n.CachedBorderStyle=ao(n,e),r?Da(n,$t.Bottom)&&Ma(t,$t.Top):Da(n,$t.Right)&&Ma(t,$t.Left))){const n=FM(t,e,r?$t.Top:$t.Left);if(n){const o=Ao(t.Row,t.Col);i.set(o,n),DO(e,r,i)}}}if(s===n+o){const n=r?$o(t.Row+1,t.Col,e):$o(t.Row,t.Col+1,e);if(!n)return;if(t.CachedBorderStyle=ao(t,e),n.CachedBorderStyle=ao(n,e),r?!Da(n,$t.Top)&&Ma(n,$t.Top)&&Da(t,$t.Bottom):!Da(n,$t.Left)&&Ma(n,$t.Left)&&Da(t,$t.Right)){const t=Ao(r?n.Row-o-1:n.Row,r?n.Col:n.Col-o-1);l.set(t,r?$t.Top:$t.Left),AO(e,r,l)}}}(e,t,n,o,r,l,s))}function IO(e,t){gA&&(bO(e,t),vO(e,t))}function vO(e,t){const n=FO(e,t);for(let t=0;t<e.Cells.length;t++){const o=e.Cells[t],r=Ao(o.Row,o.Col);if(n.has(r)){o.CachedBorderStyle=ao(o,e);const t=n.get(r);t&&(CA?JO(o,e,t,t.BorderPosition):Dc(o,e,t,t.BorderPosition)),n.delete(r)}}for(const t of Array.from(n.keys())){const{row:o,column:r}=Oo(t),i=Eo(o,r);i.GlobalBorderStyleID=Yn().getOrCreateID({Borders:[],ID:0}),i.CachedBorderStyle=ao(i,e);const l=n.get(t);l&&(CA?JO(i,e,l,l.BorderPosition):Dc(i,e,l,l.BorderPosition));const s=Ha(i,e.Cells);e.Cells.splice(s,0,i),n.delete(t)}DO(e,t,n)}function bO(e,t){const n=MO(e,t);if(0!==n.size){for(let t=0;t<e.Cells.length;t++){const o=e.Cells[t],r=Ao(o.Row,o.Col);if(n.has(r)){o.CachedBorderStyle=ao(o,e);const t=n.get(r);(t&&!gA||void 0!==t)&&Mc(o,e,t),n.delete(r)}}AO(e,t,n)}}function xO(e,t){return t?e.ColumnNumbers[0]:e.RowNumbers[0]}function FO(e,t){const n=xO(e,t);let o=vA.get(n);return o||(o=new Map),o}function DO(e,t,n){const o=xO(e,t);vA.set(o,n)}function MO(e,t){const n=xO(e,t);let o=bA.get(n);return o||(o=new Map),o}function AO(e,t,n){const o=xO(e,t);bA.set(o,n)}function OO(e,t,n){return n?t.Index>=e.RowNumbers.length||t.Index<0:t.Index>=e.ColumnNumbers.length||t.Index<0}function BO(e,t,n,o,r){const i=r?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],l=r?n.FirstRow:n.FirstColumn,s=r?n.LastRow:n.LastColumn;return i+1>=l&&i<s&&o===FA.Delete}function kO(e,t,n,o,r,i){const l=r?e.RowNumbers[t.Index]:e.ColumnNumbers[t.Index],s=r?n.FirstRow:n.FirstColumn,a=r?n.LastRow:n.LastColumn;l>=a?t.Index+=i:l+1>=s&&l<a&&(o===FA.Insert||o===FA.Unhide?t.Index+=i:o===FA.Hide&&(t.Index-=t.Index-HA(r?e.RowNumbers:e.ColumnNumbers,s)+1))}function PO(e,t,n){e&&e.PageBreaks&&(0!==t.length?n?e.PageBreaks.Row=t:e.PageBreaks.Col=t:n?e.PageBreaks.Row=void 0:e.PageBreaks.Col=void 0)}function EO(e){e&&e.PageBreaks&&(e.PageBreaks.Row&&0===e.PageBreaks.Row.length&&(e.PageBreaks.Row=void 0),e.PageBreaks.Col&&0===e.PageBreaks.Col.length&&(e.PageBreaks.Col=void 0),e.PageBreaks.Row||e.PageBreaks.Col||(e.PageBreaks=void 0))}function HO(e){return e===FA.Hide||e===FA.Delete}function LO(e,t){t?.resetCache();const n=[];for(let t=0;t<e.ColumnNumbers.length;t++)n.push(null);e.ColMetadata=n}function NO(e,t,n){const o=n?$o(t.Row+1,t.Col,e):$o(t.Row,t.Col+1,e);if(!o)return;const r=_O(e,t,n),i=_O(e,o,n);if(0===r.length||0===i.length)return;let l=0,s=0;const a=[];for(;l<r.length&&s<i.length;){const e=r[l].BorderPosition,n=i[s].BorderPosition;if(e===n){if(WO(t,o,r[l],i[s])){const e={...r[l]};e.BorderPosition===$t.Bottom?e.BorderPosition=$t.Top:e.BorderPosition===$t.Right&&(e.BorderPosition=$t.Left),a.push(e)}l++,s++}else e<n?l++:s++}return{ID:e.BorderStyles.length,Borders:a,RefCount:0}}function WO(e,t,n,o){const r=Da(e,n.BorderPosition),i=Da(t,o.BorderPosition);return(r&&i||!r&&!i)&&(s=o,a=(l=n).Color,c=s.Color,a.Blue===c.Blue&&a.Green===c.Green&&a.Red===c.Red&&l.Weight===s.Weight&&l.BorderLineStyle===s.BorderLineStyle);var l,s,a,c}function _O(e,t,n){const o=ao(t,e)?.Borders,r=[];for(const e of o)(Da(t,e.BorderPosition)||n&&$t.Left===e.BorderPosition||!n&&$t.Top===e.BorderPosition)&&r.push(e);return function(e,t,n,o){if(!(o&&Da(t,$t.Bottom)||!o&&Da(t,$t.Right)))return;const r=o?$o(t.Row+1,t.Col,e):$o(t.Row,t.Col+1,e);if(!r||o&&Da(t,$t.Bottom)&&Da(r,$t.Top)||!o&&Da(t,$t.Right)&&Da(r,$t.Left))return;const i=ao(r,e),l=i?.Borders;if(0!==l.length)for(const e of l)if(o&&e.BorderPosition===$t.Top||!o&&e.BorderPosition===$t.Left){const t={...e};t.BorderPosition=o?$t.Bottom:$t.Right,zO(n,t)}}(e,t,r,n),r}function zO(e,t){let n=0;for(;n<e.length&&e[n].BorderPosition<t.BorderPosition;)n++;e.splice(n,0,t)}function GO(e,t,n,o,r,i){if(!(e&&e.PrintAreas&&t&&t.FirstRow&&t.FirstColumn&&t.LastRow&&t.LastColumn))return void(e&&i.length>0&&(e.PrintAreas=i));const l=e.PrintAreas.length,s=i.length,a=[];for(let s=0;s<l;s++){const l=e.PrintAreas[s],c=r?t.FirstRow:t.FirstColumn,u=r?t.LastRow:t.LastColumn,d=r?l.FirstRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[l.FirstRow]:l.FirstColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[l.FirstColumn],h=r?l.LastRow>e.RowNumbers.length-1?e.RowNumbers[e.RowNumbers.length-1]+1:e.RowNumbers[l.LastRow]:l.LastColumn>e.ColumnNumbers.length-1?e.ColumnNumbers[e.ColumnNumbers.length-1]+1:e.ColumnNumbers[l.LastColumn],f=o===FA.Hide||o===FA.Delete?-n:n;if(c<=d&&u<=d)r?(l.FirstRow+=f,l.LastRow+=f):(l.FirstColumn+=f,l.LastColumn+=f);else if(c<d&&u>d&&u<=h){const e=o===FA.Hide||o===FA.Delete?-1*(d-c):n;r?(l.FirstRow+=e,l.LastRow+=f):(l.FirstColumn+=e,l.LastColumn+=f)}else if(c>=d&&u<=h)r?l.LastRow+=f:l.LastColumn+=f;else if(c>d&&c<=h&&u>=h){const e=o===FA.Hide||o===FA.Delete?-1*(h-c+1):n;r?l.LastRow+=e:l.LastColumn+=e}else if(c>h);else if(o===FA.Delete)hA=!0;else{if(o===FA.Hide)continue;o===FA.Insert&&(r?(l.FirstRow+=n,l.LastRow+=n):(l.FirstColumn+=n,l.LastColumn+=n))}if(UO(e,l,r))a.push(l);else{const t={...l};XO(e,l,o,r)&&a.push(l),i.push(t)}}e.PrintAreas=a;for(let t=0;t<s;t++){const n=i[t];$O(e,n,o,r)||e.PrintAreas.push(n)}return!1}function VO(e,t,n){return n?t.LastRow>e.RowNumbers.length-1||t.FirstRow<0:t.LastColumn>e.ColumnNumbers.length-1||t.FirstColumn<0}function jO(e,t,n,o,r){const i={...n};switch(o){case FA.Hide:case FA.Delete:r?(i.FirstRow=n.FirstRow+t.RowNumbers.length,n.FirstRow=0,i.LastRow=t.RowNumbers.length):(i.FirstColumn=n.FirstColumn+t.ColumnNumbers.length,n.FirstColumn=0,i.LastColumn=t.ColumnNumbers.length);break;case FA.Insert:case FA.Unhide:r?(n.LastRow=e.RowNumbers.length,i.FirstRow=0,i.LastRow-=n.LastRow):(n.LastColumn=e.ColumnNumbers.length,i.FirstColumn=0,i.LastColumn-=n.LastColumn)}return i}function UO(e,t,n){return n?!(t.FirstRow<0&&t.LastRow<0||t.FirstRow>e.RowNumbers.length-1&&t.LastRow>e.RowNumbers.length-1):!(t.FirstColumn<0&&t.LastColumn<0||t.FirstColumn>e.ColumnNumbers.length-1&&t.LastColumn>e.ColumnNumbers.length-1)}function $O(e,t,n,o){if(!e.PrintAreas||0===e.PrintAreas.length)return!1;for(const r of e.PrintAreas)if(qO(r,t,n,o))return o?n===FA.Hide||n===FA.Delete?r.LastRow=t.LastRow:r.FirstRow=t.FirstRow:n===FA.Hide||n===FA.Delete?r.LastColumn=t.LastColumn:r.FirstColumn=t.FirstColumn,!0;return!1}function qO(e,t,n,o){return o?e.FirstColumn===t.FirstColumn&&e.LastColumn===t.LastColumn&&(n===FA.Hide||n===FA.Delete?e.LastRow===t.FirstRow:e.FirstRow===t.LastRow):e.FirstRow===t.FirstRow&&e.LastRow===t.LastRow&&(n===FA.Hide||n===FA.Delete?e.LastColumn===t.FirstColumn:e.FirstColumn===t.LastColumn)}function XO(e,t,n,o){let r=!1;return o?n===FA.Insert||n===FA.Unhide?t.FirstRow===e.RowNumbers.length&&(t.LastRow=e.RowNumbers.length,r=!0):t.LastRow===e.RowNumbers.length&&(t.FirstRow=e.RowNumbers.length,r=!0):n===FA.Insert||n===FA.Unhide?t.FirstColumn===e.ColumnNumbers.length&&(t.LastColumn=e.ColumnNumbers.length,r=!0):t.LastColumn===e.ColumnNumbers.length&&(t.FirstColumn=e.ColumnNumbers.length,r=!0),r}function YO(e,t,n){t.CachedBorderStyle=ao(t,e);const o=n?$o(t.Row-1,t.Col,e):$o(t.Row,t.Col-1,e);(n?!Da(t,$t.Top)&&Ma(t,$t.Top):!Da(t,$t.Left)&&Ma(t,$t.Left))&&(o?Da(o,n?$t.Bottom:$t.Right)||Mc(t,e,n?$t.Top:$t.Left):Mc(t,e,$t.Left))}function JO(e,t,n,o){const r=Zo(t,e);if(!r)return;let i=r.Borders.length;for(let e=0;e<r.Borders.length;e++){const t=r.Borders[e];if(t.BorderPosition>o){i=e;break}if(t.BorderPosition===o)return}Uc(e,t),Zo(t,e).Borders.splice(i,0,n),qc(e,t)}!function(e){e.Hide="Hide",e.Unhide="Unhide",e.Insert="Insert",e.Delete="Delete",e.FreezePane="FreezePane",e.ApplyFilter="ApplyFilter"}(FA||(FA={}));class KO{static updateDefaultRowsAndColumnsPerBlock(e,t){!function(e,t){if(wo)throw new Error("updateDefaultRowsAndColumnsPerBlock can be called only once!");if(0===e||0===t)throw new Error("Rows and columns must be greater than 0");!function(e,t){const n=So(t),o=So(e),r=Math.max(1<<n,1<<o),i=Math.max(n,o);if(i>30)throw new Error(`Rows and columns must be such that the maximum of them is less than or equal to 2^30. Received rows: ${e}, columns: ${t}`);mo=i,Co=r,po=r,fo=e,go=t,wo=!0}(e,t)}(e,t)}static lookupPerfMetricName(e){return Vd[e]}static measureTextWidth(e,t,n,o){const r=KO.canvasContext();return KO.measureTextWidthWithContext(r,e,t,n,o)}static measureTextWidthOffscreen(e,t,n,o){const r=KO.offScreenCanvasContext();return KO.measureTextWidthWithContext(r,e,t,n,o)}static measureTextWidthWithContext(e,t,n,o,r){if(!e)throw Error("measureTextWidthWithContext: ctx is undefined");return e.font=n,jC(e,t,o,r)}static compareFormattedTexts(e,t){return function(e,t){if(kl(),e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};Ki(e.TextRuns,e.Fonts),Ki(t.TextRuns,t.Fonts)}return Yi(e,t,Tl,Ol,cl)}(e,t)}static compareMergeInformation(e,t){return function(e,t){return kl(),Yi(e,t,Rl,Ol,cl)}(e,t)}static compareInCellControlOptions(e,t){return function(e,t){return kl(),Yi(e,t,Sl,Ol,cl)}(e,t)}static compareNumberFormatInformation(e,t){return function(e,t){return kl(),Yi(e,t,yl,Ol,cl)}(e,t)}static compareHeaderBlockModels(e,t){return function(e,t){const n=Yi(e,t,Pl,El,Ri);return n.isEqual?Ji(e,t,void 0,El,Hl,Ri):{isEqual:!1,message:n.message,canDiffRender:!1,changedCellsKeys:void 0}}(e,t)}static compareGridBlockModels(e,t,n,o,r){return function(e,t,n,o,r){kl();const i=Yi(e,t,Il,Ol,cl);return i.isEqual?Ji(e,t,n,Ol,Bl,cl,o,r):{isEqual:i.isEqual,message:i.message,canDiffRender:!1,changedCellsKeys:void 0}}(e,t,n,o,r)}static comparePartialGridBlockModels(e,t,n,o,r,i){return Al(e,t,n,o,r,i)}static serializeCell(e,t){return Di(e,t)}static registerActionOnFontLoad(e,t,n,o,r){(function(e,t,n,o,r){if(!SC()||!Ya(t))return;r&&0!==r.length||(r=XD(e));const i=function(e){if(0===e.length)return e;const t=new Set;for(let n=0;n<e.length;n++){const o=e[n];if(t.has(o)||OC(o)&&MC(o)===sC.Loaded)continue;const r=ih(o);BC(r)||(kC(r),!YD(o,r))?t.add(o):AC(o,sC.Loaded)}return Array.from(t.values())}(r);if(i.length>0)return t(0),function(e){const t=[];for(let o=0;o<e.length;o++)!OC(n=e[o])&&!vC(n,sC.Loaded)&&t.push(e[o]);var n;if(0!==t.length){if(1===t.length){const e=t[0];return TC(qD,e),void AC(e,sC.Pending)}!function(e){const t=QD();for(let n=0;n<e.length;n++){const o=e[n],r=QD();TC(r,o),t.appendChild(r)}qD.appendChild(t);for(let t=0;t<e.length;t++)AC(e[t],sC.Pending);setTimeout((()=>{window.requestAnimationFrame((()=>{qD.removeChild(t)}))}),jD)}(t)}}(i),function(e,t,n){const o=[],r=[];return yC().then((()=>function(e,t,n){const o=[];for(let r=0;r<e.length;r++){const i=e[r];vC(i,sC.Loaded)?t.push(i):vC(i,sC.Failed)?n.push(i):"loading"===bC(i)&&o.push(JD(i))}return Promise.all(o)}(e,o,r))).then((e=>{if(!Ya(t))return;const[i,l]=function(e){const t=[],n=[];for(let o=0;o<e.length;o++){const r=e[o];r.isSuccessful?t.push(r.font):n.push(r.font)}return[t,n]}(e);!function(e){for(let t=0;t<e.length;t++){const n=e[t];MC(n)!==sC.Loaded&&(Yf(n),AC(n,sC.Loaded))}}(o.concat(i)),function(e,t){const n=Ya(t);for(let o=0;o<e.length;o++){const r=e[o];AC(r,sC.Failed),n&&mh(r)&&t(gh(r))}}(r.concat(l),n),(o.length>0||i.length>0)&&t(1),t(2)})).catch((e=>{!function(e,t){Ya(e)&&Ya(t)&&(t("API_Failure"),e(2))}(t,n)}))}(i,t,n);o&&t(1)})(e,t,n,o,r)?.catch((e=>{throw e}))}static getFontsLoadStatus(e){return function(e){if(0===e.length)return[];const t=new Map;return e.forEach((e=>{t.set(e.toLowerCase(),{font:e,status:5,fromCache:!1})})),function(e){let t=0;for(const n in CC){const o=FC(MC(n)),r=e.get(n);void 0!==r&&xC(r.status,o)&&(void 0===r.status&&t++,r.status=o,r.fromCache=!0)}return t===e.size}(t)||function(e){if("function"!=typeof document.fonts.values)return;e.forEach((e=>{5===e.status&&(e.status=4)}));const t=document.fonts.values();let n=t.next();for(;!n.done;){if(n.value){const t=n.value.family.replace(/[\""]/g,"").toLowerCase(),o=e.get(t),r=DC(n.value.status);void 0!==o&&xC(o.status,r)&&(o.status=r)}n=t.next()}}(t),Array.from(t.values())}(e)}static registerExternalCallbacks(e){!function(e){md=e}(e)}static isExternalCallbacksRegistered(){return Od()}static initializeLogger(e){e&&function(e){if(!e)throw new Error("The 'logger' argument is missing");Pn.setLogger(e)}(e)}static initializeChangeGates(e){(0,Rn.setChangeGateDictionaryGetter)((()=>e))}static initializeFeatureGates(e){(0,Rn.setFeatureGateDictionaryGetter)((()=>e))}static initializeGridRendererImageLoader(e,t){!function(e,t){ra.onImageLoadSuccessCallback=e,ra.onImageLoadFailureCallback=t}(e,t)}static setStaticImageUrl(e,t){!function(e,t){Ro(t,"url","setStaticImageUrl");const n=ca(e),o=fa(n);if(o){if(o.url)throw Error(`setStaticImageUrl: image url already defined. image: ${e}, old url: ${o.url}, new url: ${t}`);o.url=t,ha(o)}else ga(n,{blockIdentifiers:[],status:na.Initialized,url:t})}(e,t)}static loadPreviewFont(e){!function(e){TC(qD,GD),yC().then((()=>{vC(GD,sC.Failed)&&e("ERROR")}),(()=>{e("API_Failure")}))}(e)}static loadPreviewFontFamily(e,t){!function(e,t){"loaded"!==bC(e)&&("unloaded"===bC(e)&&TC(qD,e),yC().then((()=>{vC(e,sC.Failed)&&t("ERROR")}),(()=>{t("API_Failure")})))}(e,t)}static isFontLoadApiSupported(){return SC()}static initGridRendererStrings(e){!function(e){cT=e,$s(cT)&&Pn.sendTraceTag(507847511,En.msoulscat_ES_EWAJSGrid,d.Error,"initGridRendererStrings: gridRendererStrings is null or undefined")}(e)}static isGridRendererStringsInitialized(){return!$s(cT)}static initGridRendererCustomCursors(e){!function(e){Pn.sendTraceTag(509110487,En.msoulscat_ES_EWAJSGrid,d.Info,`GridRendererCustomCursors: initGridRendererCustomCursors:: isNullOrUndefined(strings): ${$s(e)}`),Vb=e}(e)}static isGridRendererCustomCursorsInitialized(){return!$s(Vb)}static preprocessModel(e,t,n,o){if("UseGeometryCacheOverridesPerSheetGateOff"!==o){const r=yx(KO.canvasContext(),e,o,t,n);return r?.length>0&&oc(o,e.PivotTables),r}{const o=yx(KO.canvasContext(),e,KO.colWidthCacheOverrides,t,n);return o?.length>0&&oc(KO.colWidthCacheOverrides,e.PivotTables),o}}static getColWidthCacheKeys(){return KO.colWidthCacheOverrides.getColWidthCacheKeys()}static getProcessedColumnWidth(e,t){return KO.colWidthCacheOverrides.getProcessedColumnWidth(e,t)}static resetColWidthCache(){KO.colWidthCacheOverrides.resetCache()}static resetColWidthCacheByCol(e){KO.colWidthCacheOverrides.resetColWidthCacheByColumns([e])}static analyzeLowRenderingFidelity(e){return function(e){const t={};for(let r=0;r<e.Cells.length;r++){const i=e.Cells[r];i&&(n=t,o=i,void 0!==Sa||(Sa=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.AddMissing3PFontsToAsha",!1)),Sa?function(e,t){if(!t.Text)return;const n=t.CachedDisplayTextRuns;if(n){for(let t=0;t<n.length;t++)if(n[t].CachedFont){lM(e,n[t].CachedFont.FontName);break}}else t.CachedFont&&lM(e,t.CachedFont.FontName)}(n,o):function(e,t){if(!t.Text)return;const n=t.CachedDisplayTextRuns;if(n){for(let t=0;t<n.length;t++)if(n[t].CachedFont&&!Ch(n[t].CachedFont.FontName)){dM(e,ZD.CustomFont);break}}else t.CachedFont&&!Ch(t.CachedFont.FontName)&&dM(e,ZD.CustomFont)}(n,o),rM(t,i),iM(t,e,i),sM(t,i),uM(t,i),aM(t,i),cM(t,i))}var n,o;return t}(e)}static hasRenderingFidelityThresholdExceeded(e,t){return function(e,t){return t>oM[e].value}(e,t)}static getErrorTypeForRenderingFidelityProblem(e){return function(e){return oM[e].errorType+"_"+e}(e)}static getVetoForRenderingFidelityProblem(e){return function(e){return oM[e].veto}(e)}static renderingRegionContainsDirtyCells(e,t){return pc(e,t)}static calculateRowHeaderWidth(e){return si(e)}static canRowColHideOrCascade(e,t,n,o){return function(e,t,n,o){if(YA(e.Cells))return!0;const r=HA(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===r)return!1;const i=e.Cells;for(let t=0;t<i.length;t++){const l=i[t];let s=!1;if(l.Merge&&(s=_A(l,r,n),Pn.sendTraceTag(507353301,En.msoulscat_ES_EWAJSGrid,d.Info,`ModelCascadeHelper::canCellsOfRowColHideOrCascade called, MergedCellAcrossBlocks: ${!!l.Merge.SpansBlocks}, rowColIndex: ${r}, cell.Col: ${l.Col}, cell.Row: ${l.Row}, isMergedCellIntersectRowCol: ${s}`)),($A(l,r,n)||s)&&LA(e,l,o,n))return!1}return!0}(e,t,n,o)}static canMultipleRowColHideOrCascade(e,t,n,o,r,i=[]){return function(e,t,n,o,r,i=[]){if(YA(e.Cells))return!0;const l=o?e.RowNumbers:e.ColumnNumbers;let s=-1;if(rA()||iA())try{if(0===i.length||r!==FA.ApplyFilter)s=HA(l,t);else if(l[0]>i[i.length-1])n=i.length,s=HA(l,t);else if(lA(r))return function(e,t){if(0===t.length)return!1;const n=e.RowNumbers;let o=!1;const r=t.filter((e=>e<n[0]));0===r.length&&(o=!0);const i={};let l=-1;if(o){const e=n.length,o=t.filter((t=>t<=n[e-1]));l=HA(n,o[0]);for(let e=0;e<o.length;e++)i[HA(n,t[e])]=!0}else{const e=r.length;l=HA(n,n[0]);for(let o=e;o<t.length;o++)i[HA(n,t[o])]=!0}const s=e.Cells;for(let n=0;n<s.length;n++){const r=s[n];if(aA(r,i,l,t.length,o)&&LA(e,r,FA.ApplyFilter,!0))return!1}return!0}(e,i)}catch(e){return Pn.sendTraceTag(505989001,En.msoulscat_ES_EWAJSGrid,d.Info,`canCellsOfMultipleRowColHideOrCascade returning false for operation= ${r},reason= ${e}`),!1}else s=HA(l,t);if(-1===s)return!1;const a=e.Cells;for(let t=0;t<a.length;t++){const i=a[t];if(tA(r)&&nA(i,s,n,o))return!1;if((qA(i,s,n,o)||EA(i,s,n,o))&&LA(e,i,r,o))return!1}return!0}(e,t,n,o,r,i)}static performModelCascade(e,t,n,o,r){return function(e,t,n,o,r){if(r)return{isSuccess:!1,exception:"Rows are not supported"};const i={};try{const l=Jn(),s=so(),a=performance.now(),c=HA(r?e.RowNumbers:e.ColumnNumbers,o);if(-1===c)return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(YA(e.Cells))return i.timeTaken=performance.now()-a,GA(e,t,n,c),{isSuccess:!0,metric:i};const u=[],d=[],h=[],f=new Map,g=[],m=new Map,C=[],p=new Map,w=t.Styles.length,S=t.Fonts.length,y=t.BorderStyles.length,R=t.ColumnNumbers.length;let T=!1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let I=!1,v=!1,b=!1;To(e),To(t);for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];let i=!1;if(o.Col!==c){o.Col-=1,d.push(o);continue}if(o.Merge&&!sO(o,c,0,r)){const t=hM(o);uO(t,e,c,0,i,!1,!0),i=!0,t.Col=0,d.push(t)}o.Merge&&i&&uO(o,e,c,0,i,!1,!0);const a=o.Col;o.Col=R,u.push(o);const x=o.StyleID||0;let F=!1,D=!1;if(!f.has(x)&&x!==Nt.Default&&x!==Nt.Hyperlink){const t=wn(x,e.Styles),n=t.FontID||0;if(F=!s||$s(o.GlobalCellStyleID),D=!s||$s(t.GlobalFontID),D&&!m.has(n)){const t=S+m.size;m.set(n,t);const o=fc(wn(n,e.Fonts),t,1);g.push(o),b=!0}if(F){let e=Nt.Default;e=w-pa+h.length,f.set(x,e);const o=dc(t,e,1);o.FontID=m.get(n),h.push(o),v=!0}}const M=o.BorderStyleID||0,A=!l||$s(o.GlobalBorderStyleID);if(A){if(!p.has(M)&&M!==Nt.DefaultBorder){const t=y+p.size;p.set(M,t);const n=hc(wn(M,e.BorderStyles),t,1),i=OA(o,e,a,r);0!==Object.keys(i).length&&n.Borders.push(i),NA(o,e)&&(T=!0),C.push(n),I=!0}}else if(l){const n=OA(o,e,a,r),i=0!==Object.keys(n).length,l=NA(o,e);if(i||l){const r=t.BorderStyles.length,s=hc(ao(o,e),r,1);i&&(s.Borders.push(n),o.GlobalBorderStyleID=Yn().getOrCreateID(s)),o.BorderStyleID=r,t.BorderStyles.push(s),T=l}}F&&(o.StyleID=x===Nt.Default?Nt.Default:f.get(x)),A&&(o.BorderStyleID=M===Nt.DefaultBorder?Nt.DefaultBorder:p.get(M))}I&&t.BorderStyles.push(...C),T&&WA(t,R,r),GA(e,t,n,c);for(const e of u){const n=Ha(e,t.Cells);t.Cells.splice(n,0,e)}if(v)for(const e of h)t.Styles.splice(e.ID||0,0,e);b&&t.Fonts.push(...g),e.Cells=d,i.countOfStylesMoved=f.size,i.countOfFontsMoved=m.size,i.countOfBorderStylesMoved=p.size,i.timeTaken=performance.now()-a}catch(e){return{isSuccess:!1,exception:e,metric:i}}return{isSuccess:!0,metric:i}}(e,t,"UseGeometryCacheOverridesPerSheetGateOff"!==r?r:KO.colWidthCacheOverrides,n,o)}static performModelCascadeRowColsOperations(e,t,n,o,r,i,l,s,a){return function(e,t,n,o,r,i,l,s,a){const c=i===FA.Hide||i===FA.FreezePane||lA(i);return c||i===FA.Delete?function(e,t,n,o,r,i,l,s,a){const c={};try{if((rA()||iA())&&a&&a.length>0&&0===e.RowNumbers.length&&0===t.RowNumbers.length)return{isSuccess:!0};const u=Jn(),d=so(),h=performance.now(),f=i?e.RowNumbers:e.ColumnNumbers,g=HA(f,o);try{if((rA()||iA())&&a&&a.length>0){const t=a.filter((e=>e<f[0])),n=[];let l=0,s=t.length;for(const e of f)if(e===a[s]?(n.push(e),s++):l++,l===t.length)break;e&&n.length>0&&DA(e,o,r,i,FA.ApplyFilter,!1,n),r=a.length>0?t.length-1:r}}catch(e){return{isSuccess:!1,exception:e,metric:c}}const m=lO(f,r,g),C=ZM()&&!!s;if(-1===m[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(C){if(YA(e.Cells)&&!s?.performDiagonalCascading)return c.timeTaken=performance.now()-h,VA(e,t,n,m,l,i),{isSuccess:!0,metric:c}}else if(YA(e.Cells))return c.timeTaken=performance.now()-h,VA(e,t,n,m,l,i),RO(t,i),IO(t,i),{isSuccess:!0,metric:c};const p=[],w=[],S=[],y=new Map,R=[],T=new Map,I=[],v=new Map,b=new Map,x=t.Styles.length,F=t.Fonts.length,D=t.BorderStyles.length,M=r+1,A=i?t.RowOffsets.length:t.ColumnOffsets.length;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0;let O=!1,B=!1,k=!1,P=!1,E=!1,H=!1;To(e),To(t);for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];let a=!1;const c=i?o.Row:o.Col,h=i?o.Col:o.Row;if(C&&SO(o,i,s)){w.push(o);continue}if(!iO(o,m,i)){i?o.Row-=M:o.Col-=M,w.push(o);continue}if(o.Merge)if(sO(o,g,r,i))o.Merge.SpansBlocks?bM(e,t,o,r,w,I,u,i):H=!0;else{const n=hM(o);n.Merge.SpansBlocks&&yM?(vM(n,e,t,g,r,i,l),fA||0!==n.Merge.Columns&&0!==n.Merge.Rows||(P=!0)):uO(n,e,g,r,a,i,l),!fA||0!==n.Merge.Columns&&0!==n.Merge.Rows||(P=!0),o.Merge.SpansBlocks||(a=!0),i?n.Row=0:n.Col=0,fA&&n.Merge&&Mc(n,e,i?$t.Top:$t.Left),w.push(n)}if(o.Merge)if(a)uO(o,e,g,r,a,i,l),!fA||0!==o.Merge.Columns&&0!==o.Merge.Rows||(E=!0);else if(o.Merge.SpansBlocks&&!a)continue;const f=i?o.Row:o.Col;i?o.Row=A+f:o.Col=A+f,C&&yO(o,t,r,i,s),p.push(o);const L=o.StyleID||0;let N=!1,W=!1;if(N=!d||$s(o.GlobalCellStyleID),!y.has(L)&&L!==Nt.Default&&L!==Nt.Hyperlink){const t=TA?uo(o,e):wn(L,e.Styles);W=!d||$s(t.GlobalFontID);const n=t.FontID||0;if(W&&!T.has(n)){const o=F+T.size;T.set(n,o);const r=fc(TA?co(t,e,L):wn(n,e.Fonts),o,1);R.push(r),k=!0}if(N){const e=x-pa+S.length;y.set(L,e);const o=dc(t,e,1);o.FontID=T.get(n),S.push(o),B=!0}}const _=o.BorderStyleID||0,z=!u||$s(o.GlobalBorderStyleID);if(z&&!v.has(_)&&_!==Nt.DefaultBorder){const t=D+I.length;v.set(_,t);const n=hc(TA?ao(o,e):wn(_,e.BorderStyles),t,1);I.push(n),O=!0}const G=o.BorderStyleID||0;let V={};if(TA&&(V=ao(o,e)),N&&(o.StyleID=L===Nt.Default?Nt.Default:y.get(L)),z&&(o.BorderStyleID=_===Nt.DefaultBorder?Nt.DefaultBorder:v.get(_)),C){const t=eA(o,e,D,I,z,v,b,m,f,i,s,h,c);O=O||t}else if(!o.Merge&&PA(f,m[m.length-1])){let t=!1,n={},r={};if(i?(n=BA(o,e,f,i),t=0!==Object.keys(n).length):(r=OA(o,e,f,i),t=0!==Object.keys(r).length),t){const t=o.BorderStyleID||0,l=D+I.length,s=kA(o,e.Cells,f,i).BorderStyleID||0;if(z&&v.get(t)&&b.get(s))o.BorderStyleID=v.get(t),u&&(o.GlobalBorderStyleID=Yn().getOrCreateID(TA?V:wn(G,e.BorderStyles)));else{z&&(v.set(t,l),b.set(s,D+b.size));const a=hc(TA?V:wn(G,e.BorderStyles),l,1);if(i){const e=a.Borders;let t=e.length;for(let o=0;o<e.length;o++)CA&&e[o].BorderPosition>n.BorderPosition?t=o:!CA&&e[o].BorderPosition<n.BorderPosition&&(t=o+1);a.Borders.splice(t,0,n)}else a.Borders.push(r);I.push(a),o.BorderStyleID=l,u&&(o.GlobalBorderStyleID=Yn().getOrCreateID(a)),O=!0}}}}O&&t.BorderStyles.push(...I),(!C||C&&!s?.performDiagonalCascading)&&(WA(t,A,i),VA(e,t,n,m,l,i));for(const n of p){const o=Ha(n,t.Cells);if(mA&&(i?n.Row+r===t.RowNumbers.length-1:n.Col+r===t.ColumnNumbers.length-1)&&YO(t,n,i),t.Cells.splice(o,0,n),n.Merge){if(EM(n,t,i),!H){Mc(n,t,$t.Right);continue}if(i?n.Merge.Rows===r:n.Merge.Columns===r){const o=LM(n,e,t,i);for(const e of o)w.push(e)}}}if(B)for(const e of S)t.Styles.splice(e.ID||0,0,e);if(k&&t.Fonts.push(...R),C&&s?.performDiagonalCascading||RO(t,i),yM){const t=[];for(const e of w){const n=Ha(e,t);t.splice(n,0,e)}e.Cells=t}else e.Cells=w;P&&TM(e,w,i),fA&&E&&TM(t,p,i,E),IO(t,i),c.countOfStylesMoved=y.size,c.countOfFontsMoved=T.size,c.countOfBorderStylesMoved=v.size,c.timeTaken=performance.now()-h}catch(e){return{isSuccess:!1,exception:e,metric:c}}return{isSuccess:!0,metric:c}}(e,t,n,o,r,l,c,s,a):function(e,t,n,o,r,i){const l={};try{const s=performance.now(),a=i?e.RowNumbers:e.ColumnNumbers,c=HA(a,o),u=lO(a,r,c);if(-1===u[0])return{isSuccess:!1,exception:"Incorrect rowColIndex found"};if(YA(e.Cells)&&YA(t.Cells))return l.timeTaken=performance.now()-s,i?UA(e,t,u):jA(e,t,n,u),RO(t,i),IO(e,i),{isSuccess:!0,metric:l};const d=[],h=[],f=[],g=e.ColumnNumbers.length,m=e.RowNumbers.length,C=r+1;e.ClientOnlyCache=void 0,t.ClientOnlyCache=void 0,To(e),To(t);for(let e=0;e<t.Cells.length;e++){const n=t.Cells[e];i?n.Row+=C:n.Col+=C;const o=n.Merge;yA&&!$s(o)&&o.SpansBlocks&&(i?n.Merge.OriginRow+=r+1:n.Merge.OriginColumn+=r+1)}for(let n=0;n<e.Cells.length;n++){const o=e.Cells[n];let l=!1,s={},a=!1,h=!1,p=!1;if(yA&&(a=o.Merge&&o.Merge.SpansBlocks,h=o.Merge&&(DM(o,e)||OM(o)),p=o.Merge&&(MM(o,e)||AM(o))),!iO(o,u,i)&&!EA(o,c,r,i))continue;if(o.Merge)if(sO(o,c,r,i)){if(yA&&o.Merge.SpansBlocks){_M(o,t,r,i);continue}}else s=hM(o),wO(o,e,r,l,i),l=!0;if(o.Merge&&l&&0!==Object.keys(s).length&&(wO(s,e,r,l,i),yA&&a&&(WM(o,s,e,t,r,i),i&&p||!i&&h)))continue;l||d.push(o);const w=i?o.Row:o.Col;let S;S=l?s:hM(o),i?S.Merge&&l?S.Row=0:S.Row=w+C-m:S.Merge&&l?S.Col=0:S.Col=w+C-g,f.push(S)}i?UA(e,t,u):jA(e,t,n,u),mO(e,d),gO(e,h),gO(t,f),RO(t,i),function(e,t,n,o){(function(e,t,n){const o=e.Cells.filter((e=>n?e.Row===t:e.Col===t));for(let t=0;t<o.length;t++){const r=o[t];if(n){if(FM(r,e,$t.Bottom)){const t=hc(ao(r,e),e.BorderStyles.length,1),n=t.Borders.findIndex((e=>e.BorderPosition===$t.Bottom));-1!==n&&t.Borders.splice(n,1),r.GlobalBorderStyleID=Yn().getOrCreateID(t),e.BorderStyles.push(t),r.BorderStyleID=t.ID}}else if(FM(r,e,$t.Right)){const t=hc(ao(r,e),e.BorderStyles.length,1),n=t.Borders.findIndex((e=>e.BorderPosition===$t.Right));-1!==n&&t.Borders.splice(n,1),r.GlobalBorderStyleID=Yn().getOrCreateID(t),e.BorderStyles.push(t),r.BorderStyleID=t.ID}}})(t,n,o),function(e,t,n){const o=n?e.RowNumbers.length-1:e.ColumnNumbers.length-1,r=e.Cells.filter((e=>n?e.Row===o:e.Col===o)),i=t.Cells.filter((e=>n?0===e.Row:0===e.Col));let l=0,s=0;for(;s<i.length;){const o=l<r.length?r[l]:null,a=i[s];n?o?o.Col===a.Col?(MA(o,a,e,t),l++,s++):o.Col<a.Col?l++:(MA(o,a,e,t),s++):(MA(o,a,e,t),s++):o?o.Row===a.Row?(AA(o,a,e,t),l++,s++):o.Row<a.Row?l++:(AA(o,a,e,t),s++):(AA(o,a,e,t),s++)}}(e,t,o)}(e,t,r,i),IO(e,i),l.countOfStylesMoved=0,l.countOfFontsMoved=0,l.countOfBorderStylesMoved=0,l.timeTaken=performance.now()-s}catch(e){return{isSuccess:!1,exception:e,metric:l}}return{isSuccess:!0,metric:l}}(e,t,n,o,r,l)}(e,t,"UseGeometryCacheOverridesPerSheetGateOff"!==a?a:KO.colWidthCacheOverrides,n,o,r,i,l,s)}static hideRowCols(e,t,n){return function(e,t,n){if(n)return!1;const o=HA(n?e.RowNumbers:e.ColumnNumbers,t);if(-1===o)return!1;if(YA(e.Cells))return JA(e,o),!0;const r=[];for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t];i.Col===o||_A(i,o,!1)?i.Merge&&(sO(i,o,0,n)||(aO(i,o,0,!1,!0,e),r.push(i))):(i.Col>o&&(i.Col-=1),r.push(i))}return JA(e,o),e.Cells=r,!0}(e,t,n)}static performModelRowColOperation(e,t,n,o,r,i=!1,l=[]){return function(e,t,n,o,r,i=!1,l=[]){return vA=new Map,bA=new Map,o===FA.Hide||o===FA.FreezePane||o===FA.Delete||lA(o)?DA(e,t,n,r,o,i,l):function(e,t,n,o,r,i=!1){const l=o?e.RowNumbers:e.ColumnNumbers,s=HA(l,t),a=lO(l,n,s);if(-1===a[0])return!1;if(YA(e.Cells))return o?eO(e,a):tO(e,a),!0;const c=[],u=FO(e,o),d=MO(e,o),h=[];for(let t=0;t<e.Cells.length;t++){const i=e.Cells[t];TO(e,i,s,n,o,r,u,d);const l=a[0]-1;let f=0,g=0;if(o){if(i.Row>=s){r===FA.Insert&&i.Merge&&i.Merge?.OriginRow&&0!==i.Merge.OriginRow&&(i.Merge.OriginRow+=n+1),i.Row+=n+1,c.push(i);continue}if(i.Merge&&i.Row<s&&i.Row+i.Merge.Rows>=s){i.Merge.Rows+=n+1,c.push(i),yA&&i.Merge.SpansBlocks&&h.push(i);continue}}else{if(i.Col>=s){r===FA.Insert&&i.Merge&&i.Merge?.OriginColumn&&0!==i.Merge.OriginColumn&&(i.Merge.OriginColumn+=n+1),i.Col+=n+1,c.push(i);continue}if(i.Merge&&i.Col<s&&i.Col+i.Merge.Columns>=s){i.Merge.Columns+=n+1,c.push(i),yA&&i.Merge.SpansBlocks&&h.push(i);continue}}if(-1===l){c.push(i);continue}o?i.Merge?i.Row+i.Merge.Rows===l&&(f=i.Merge.Columns+1,g=a.length):i.Row===l&&(f=1,g=a.length):i.Merge?i.Col+i.Merge.Columns===l&&(f=a.length,g=i.Merge.Rows+1):i.Col===l&&(f=a.length,g=1);const m=uo(i,e);let C,p,w;if(i.HorizontalAlignmentSet)C=oo().getOrCreateID(m),p=m;else{const t=Hc(e)+1,n=uc(e,uo(i,e),t,1);n.HorizontalAlignment=Ht.Automatic,e.Styles?.splice(t,0,n),C=oo().getOrCreateID(n),p=n}let S=0,y=0;g>0&&f>0&&(w=NO(e,i,o),w&&(w.RefCount=Math.max(f,g),S=w.ID||0,e.BorderStyles?.push(w)),y=void 0===w?0:Yn().getOrCreateID(w));for(let e=0;e<g;e++)for(let t=0;t<f;t++){const n=Eo(o?a[0]+e:i.Row+e,o?i.Col+t:a[0]+t);n.GlobalCellStyleID=C,n.CachedStyle=p,n.StyleID=p.ID||0,n.WrapText=i.WrapText,n.BorderStyleID=S,n.GlobalBorderStyleID=y,c.push(n)}c.push(i)}e.Cells=[],gO(e,c),o?eO(e,a):tO(e,a);for(const t of h)o?t.Merge.Height=BM(e.RowHeights,t.Row,t.Row+t.Merge.Rows):t.Merge.Width=BM(e.ColumnWidths,t.Col,t.Col+t.Merge.Columns);return i&&IO(e,o),!0}(e,t,n,r,o,i)}(e,t,n,o,r,i,l)}static cloneModel(e){return function(e){if(!e)return null;const t=e.ColumnNumbers?[...e.ColumnNumbers]:void 0,n=e.ColumnWidths?[...e.ColumnWidths]:void 0,o=e.ColumnOffsets?[...e.ColumnOffsets]:void 0,r=e.ColMetadata?[...e.ColMetadata]:void 0,i=e.FixedColumns?[...e.FixedColumns]:void 0,l=e.RowNumbers?[...e.RowNumbers]:void 0,s=e.RowHeights?[...e.RowHeights]:void 0,a=e.RowOffsets?[...e.RowOffsets]:void 0,c=[];if(e.Cells)for(let t=0;t<e.Cells.length;t++)c.push(hM(e.Cells[t]));const u=[];if(e.Styles)for(let t=0;t<e.Styles.length;t++){let n=e.Styles[t];n&&(n=dc(n,n.ID||0,n.RefCount||0)),u.push(n)}const d=[];if(e.BorderStyles)for(let t=0;t<e.BorderStyles.length;t++){let n=e.BorderStyles[t];n&&(n=hc(n,n.ID||0,n.RefCount||0)),d.push(n)}const h=[];if(e.Fonts)for(let t=0;t<e.Fonts.length;t++){let n=e.Fonts[t];n&&(n=fc(n,n.ID||0,n.RefCount||0)),h.push(n)}const f=e.PrintAreas?[]:void 0;if(e.PrintAreas)for(let t=0;t<e.PrintAreas.length;t++)f.push(pM(e.PrintAreas[t]));const g=e.PivotTables?[]:void 0;if(e.PivotTables)for(let t=0;t<e.PivotTables.length;t++)g.push(SM(e.PivotTables[t]));const m=e.AllRichValueFields?[]:void 0;if(e.AllRichValueFields)for(let t=0;t<e.AllRichValueFields.length;t++)m.push({Index:(C=e.AllRichValueFields[t]).Index,RefersToDotFunction:C.RefersToDotFunction,Value:C.Value});var C;const p=[...e.RenderFlagsArray],w=e.PageBreaks?{Row:(R=e.PageBreaks).Row?[...R.Row]:void 0,Col:R.Col?[...R.Col]:void 0}:void 0,S=e.Sparklines?function(e){const t=[];for(let o=0;o<e.Ranges.length;o++)t.push({LocationRow:(n=e.Ranges[o]).LocationRow,LocationColumn:n.LocationColumn,SparklineType:n.SparklineType,FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn,RangeType:n.RangeType});var n;return{Ranges:t,ImageUrl:e.ImageUrl,Version:e.Version}}(e.Sparklines):void 0,y=e.InCellImages?{ImageUrl:(T=e.InCellImages).ImageUrl,Version:T.Version}:void 0;var R,T;const I=e.PermissionSet?{IsAutoFilterDisabled:(v=e.PermissionSet).IsAutoFilterDisabled,IsSortDisabled:v.IsSortDisabled}:void 0;var v;const b=e.AdjacentBlocksHiddensInfo?{IsFirstColOfNextBlockHidden:(x=e.AdjacentBlocksHiddensInfo).IsFirstColOfNextBlockHidden,IsFirstRowOfNextBlockHidden:x.IsFirstRowOfNextBlockHidden,IsLastRowOfPrevBlockHidden:x.IsLastRowOfPrevBlockHidden,IsLastColOfPrevBlockHidden:x.IsLastColOfPrevBlockHidden}:void 0;var x;const F=e.RowOutlinesInformation?[]:void 0;if(e.RowOutlinesInformation)for(let t=0;t<e.RowOutlinesInformation.length;t++)F.push(fM(e.RowOutlinesInformation[t]));const D=e.ColumnOutlinesInformation?[]:void 0;if(e.ColumnOutlinesInformation)for(let t=0;t<e.ColumnOutlinesInformation.length;t++)D.push(fM(e.ColumnOutlinesInformation[t]));return{BlockWidth:e.BlockWidth,BlockHeight:e.BlockHeight,RowOffsets:a,ColumnOffsets:o,RowHeights:s,ColumnWidths:n,RowNumbers:l,ColumnNumbers:t,ColMetadata:r,FixedColumns:i,RowOutlinesInformation:F,ColumnOutlinesInformation:D,MaxRowOutlineLevelInSheet:e.MaxRowOutlineLevelInSheet,MaxColOutlineLevelInSheet:e.MaxColOutlineLevelInSheet,ShowGridLines:e.ShowGridLines,ShowHeaders:e.ShowHeaders,IsRtl:e.IsRtl,PermissionSet:I,GridLineColor:e.GridLineColor,BackgroundColor:e.BackgroundColor,Cells:c,Styles:u,Fonts:h,BorderStyles:d,CellsEncoding:e.CellsEncoding||0,RenderFlagsArray:p,HandleFlagsMismatch:e.HandleFlagsMismatch,PageBreaks:w,PrintAreas:f,PivotTables:g,Sparklines:S,InCellImages:y,AllRichValueFields:m,AdjacentBlocksHiddensInfo:b,HasTable:e.HasTable,HasOutline:e.HasOutline,IsBitwiseFixedRows:e.IsBitwiseFixedRows,HideDataTypeIcons:e.HideDataTypeIcons}}(e)}static getRenderedFontsTelemetry(){return ch.documentFontsCheckCount=rh,ch}static getFlickeredFontsInBootPhase(){return mC.forEach((e=>{dC.has(e)?hC.add(e):mh(e)?fC.add(e):gC.add(e)})),{defaultAptosFonts:Array.from(hC),oldFonts:Array.from(fC),newOrCustomFonts:Array.from(gC)}}static preprocessModelStyles(e){return To(e)}static preprocessStyles(e){return function(e){(function(e){return!pn(e.Cells)||!pn(e.Fonts)&&!pn(e.Styles)})(e)&&(void 0===Do&&(Do=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.GlobalStylesWithoutLimits",!1)),Do||(void 0!==vo&&void 0!==bo&&void 0!==xo||function(){const e=(0,Rn.getStringFeatureGate)("Microsoft.Office.Excel.ThresholdCountOfStylesForGlobalStylesDisabling","120|35|160");if(""===e||pn(e))return vo=120,bo=35,void(xo=160);const t=e.split("|");vo=parseInt(t[0],10),bo=parseInt(t[1],10),xo=parseInt(t[2],10)}(),e.BorderStyles&&e.BorderStyles.length>vo&&Kn("Border styles processing disabled due to large number."),e.Fonts&&e.Fonts.length>bo&&lo("Font styles processing disabled due to large number."),e.Styles&&e.Styles.length>xo&&io("Cell styles processing disabled due to large number.")),To(e))}(e)}static isGlobalBorderStylesEnabled(){return Jn()}static isGlobalFontsAndCellStylesEnabled(){return so()}static getGlobalStylesTelemetry(){return`{"GlobalBorderStylesCount": ${Yn().count}, "GlobalFontsCount": ${eo().count}, "GlobalCellStylesCount": ${oo().count} }`}static disableGlobalBorderStyles(e){return Kn(e)}static getFontsToDownload(e){return XD(e)}static getChangedCells(e,t){return function(e,t){const n=[];if(!e)return n;if(e.Cells&&0===e.Cells.length)return n;for(let o=0;o<e.Cells.length;o++){const r=e.Cells[o];if(!r)continue;const i=e.RowNumbers[r.Row],l=e.ColumnNumbers[r.Col];(r.Text||r.Value)&&(t(i,l)||Vc(r,e,t))&&n.push({rowNum:i,colNum:l,cellText:""})}return n}(e,t)}static updateReferenceUpdateForModel(e,t,n,o){return function(e,t,n,o){const r=[];if(!e)return r;if(e.Cells&&0===e.Cells.length)return r;let i,l;for(let s=0;s<e.Cells.length;s++){const a=e.Cells[s];if(!a)continue;let c;const u=e.RowNumbers[a.Row],d=e.ColumnNumbers[a.Col];if(a.FormulaInfo&&a.FormulaInfo.FormulaType!==_t.Value){const n=o(a.FormulaInfo.Formula);if(n&&n.newFormula){if(a.FormulaInfo.Formula=n.newFormula,c=n.newFormula,a.CachedDisplayText=void 0,a.CachedDisplayTextRuns=void 0,n.isRefError){if(a.Text=t,a.HasIgnorableError=!0,a.ValueType=Wt.Error,a.Value="4",c=t,!i){const{refErrorStyle:t,refErrorGlobalId:n}=zc(e,a);i=t,l=n}Gc(a,i,l)}r.push({rowNum:u,colNum:d,cellText:c||a.Text||""});continue}}(a.Text||a.Value)&&(n(u,d)||Vc(a,e,n))&&r.push({rowNum:u,colNum:d,cellText:a.Text||""})}return r}(e,t,n,o)}static removeExtraModelRowCol(e){return function(e){const t=e.ColumnNumbers.length,n=e.RowNumbers.length,o=fo,r=go,i=[];if(t>r){const n=t-r;if(e.ColumnNumbers?.splice(r,n),e.ColMetadata?.splice(r,n),e.ColumnWidths?.splice(r,n),e.FixedColumns?.splice(r,n),e.ColumnOffsets?.splice(r,n),rO(e),!YA(e.Cells))for(const t of e.Cells)(t.Col>=r||t.Col>r)&&i.push(t)}if(n>o){const t=n-o;if(e.RowNumbers?.splice(o,t),e.RowHeights?.splice(o,t),e.RowOutlinesInformation?.splice(o,t),e.RowOffsets?.splice(o,t),oO(e),!YA(e.Cells))for(const t of e.Cells)(t.Row>=o||t.Row>o)&&i.push(t)}mO(e,i)}(e)}static updateWithClientRowHeights(e,t){return function(e,t){return function(e,t){const n={skippedOverrides:[]};if(!t||0===t.size)return n;let o=!1;for(const[r,i]of t){const t=Ja(e,r);if(t<0)continue;const l=e.RowHeights[t];void 0!==ya||(ya=(0,Rn.getBooleanFeatureGate)("Microsoft.Office.Excel.AdditionalBlockHeightCSETelemetry",!1)),(ya?Wc(i,l):_c(i,l))?(i.serverHeight=l,e.RowHeights[t]=i.clientHeight,o=!0):n.skippedOverrides.push({rowNumber:r,clientHeight:i.clientHeight,serverHeight:l})}return o&&jc(e),n}(e,t)}(e,t)}static removeRowHeightOverridesFromModel(e,t){return function(e,t){!function(e,t){if(!t||0===t.size)return;let n=!1;for(const[o,r]of t){const t=Ja(e,o);-1!==t&&void 0!==r.serverHeight&&r.clientHeight===e.RowHeights[t]&&(e.RowHeights[t]=r.serverHeight,n=!0)}n&&jc(e)}(e,t)}(e,t)}static getWholeSelectionHeadersStylesSet(){return ri}static getPartialSelectionHeadersStylesSet(){return oi}static getHoverHeadersStylesSet(){return ii}static updatedPageBreaksOfCurrentBlockPair(e,t,n,o,r,i){return function(e,t,n,o,r,i){const l=r===FA.Hide||r===FA.Delete?-1*n:n,s=i?e?.PageBreaks?.Row:e?.PageBreaks?.Col,a=i?t?.PageBreaks?.Row:t?.PageBreaks?.Col,c=[],u=[],d=[];if(s){for(let t=0;t<s.length;t++)if(!BO(e,s[t],o,r,i))if(kO(e,s[t],o,r,i,l),OO(e,s[t],i)){const n=i?e.RowNumbers.length:e.ColumnNumbers.length;s[t].Index+=r===FA.Hide||r===FA.Delete?n:-1*n,d.push(s[t])}else c.push(s[t]);PO(e,c,i)}if(a){for(let e=0;e<a.length;e++)BO(t,a[e],o,r,i)||(kO(t,a[e],o,r,i,l),u.push(a[e]));PO(t,u,i)}!function(e,t,n,o){if(!e||0===t.length)return;if(e.PageBreaks||(e.PageBreaks={}),o&&!e.PageBreaks.Row)return void(e.PageBreaks.Row=t);if(!o&&!e.PageBreaks.Col)return void(e.PageBreaks.Col=t);const r=o?e.PageBreaks.Row:e.PageBreaks.Col;HO(n)?r.push(...t):r.unshift(...t)}(t,d,r,i),EO(e),EO(t)}(e,t,n,o,r,i)}static updatePrintAreasOfCurrentBlockPair(e,t,n,o,r,i){return function(e,t,n,o,r,i){const l=[];if(GO(e,o,n,r,i,l),hA)return hA=!1,!0;if(function(e,t,n,o){if(e&&0!==t.length)for(const r of t)o?HO(n)?(r.LastRow+=e.RowNumbers.length,r.FirstRow+=e.RowNumbers.length):(r.LastRow-=e.RowNumbers.length,r.FirstRow-=e.RowNumbers.length):HO(n)?(r.LastColumn+=e.ColumnNumbers.length,r.FirstColumn+=e.ColumnNumbers.length):(r.LastColumn-=e.ColumnNumbers.length,r.FirstColumn-=e.ColumnNumbers.length)}(t,l,r,i),e&&e.PrintAreas)for(const n of e?.PrintAreas)VO(e,n,i)&&!XO(e,n,r,i)&&l.push(jO(e,t,n,r,i));return GO(t,o,n,r,i,l),hA?(hA=!1,!0):(e&&e.PrintAreas&&0===e.PrintAreas.length&&(e.PrintAreas=void 0),t&&t.PrintAreas&&0===t.PrintAreas.length&&(t.PrintAreas=void 0),!1)}(e,t,n,o,r,i)}static canvasInstance(){return KO.canvas||(KO.canvas=document.createElement("canvas")),KO.canvas}static offScreenCanvasInstance(){return KO.offScreenCanvas||(KO.offScreenCanvas=new OffscreenCanvas(1,1)),KO.offScreenCanvas}static canvasContext(){return KO.canvasInstance().getContext("2d")}static offScreenCanvasContext(){return KO.offScreenCanvasInstance().getContext("2d")}static isMergedCellSpanningAcrossBlocks(e){return function(e){const t=VM(e.Cells);if(0===t.length)return!1;for(const n of t)if(DM(n,e)&&MM(n,e))return!0;return!1}(e)}static setModifyIgnoreListsConfiguration(e){try{Ai.instance.propertiesToAddConfiguration=JSON.parse(e)}catch(e){Ai.instance.propertiesToAddConfiguration={},Pn.sendTraceTag(504973058,En.msoulscat_ES_EWAJSGrid,d.Error,"GridModelIgnoreList propertiesToAddConfiguration parsing error.")}}static isFirstNonNeutralCharacterRTL(e){return function(e){if(!e||0===e.length)return!1;for(let t=0;t<e.length;t++){const n=e.charAt(t),o=n.charCodeAt(0);if(!(o>=48&&o<=57||bu(n)))return vu(n)}return!1}(e)}}KO.colWidthCacheOverrides=new class{getColWidthCacheKeys(){return Object.keys(this.colWidthCache).map((e=>Number(e)))}getColSrvDx(e){const t=this.getColMetadata(e);return t?t.SrvDx:-1}getCachedColumnWidth(e){const t=this.getColMetadata(e);return t?t.CachedColWidth:void 0}setColMetadataItems(e){for(const{col:t,metadata:n}of e)this.colWidthCache[t]=n}resetCache(){this.colWidthCache={}}resetColWidthCacheByColumns(e){for(const t of e)this.colWidthCache[t]=void 0}getProcessedColumnWidth(e,t){const n=this.getColMetadata(e);return n&&n.SrvDx===t&&n.CachedColWidth||t}getColWidthOverrideDiff(e){const t=this.getColMetadata(e);return t&&t.SrvDx&&t.CachedColWidth?t.CachedColWidth-t.SrvDx:0}hasOverrideForColumn(e){return void 0!==this.getColMetadata(e)}getColMetadata(e){return this.colWidthCache[e]}constructor(){this.colWidthCache={}}};const QO="UnavailabilityToast";class ZO{setVisibility(e){this.toastElement.style.visibility=e?"visible":"hidden"}dispose(){this.toastElement.parentNode?.removeChild(this.toastElement)}setTitle(e){e?this.toastTitleElement?this.toastTitleElement.innerText=e:(this.toastTitleElement=this.createToastTitle(e),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)}setMessage(e){e?this.toastMessageElement?this.toastMessageElement.innerText=e:(this.toastMessageElement=this.createToastMessage(e),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)}setIcon(e,t){this.hasSpinner=!!t,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(e),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)}createToastContainer(){const e=document.createElement("div");return e.id=QO,e.setAttribute("role","alert"),e.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),e.appendChild(this.toastIconElement),e}createToastIcon(e){const t=document.createElement("span");if(t.id="UnavailabilityToastIcon",this.hasSpinner)!function(e,t){const n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),t?n.style.marginLeft="7px":n.style.marginRight="7px";const o=document.createElement("style");o.type="text/css";const r=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");o.appendChild(r),n.appendChild(o),e.appendChild(n)}(t,this.isRTL);else{const n=e??this.OpenWorkbookIcon;t.setAttribute("style",`display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,${n}");`+this.elementsMargin)}return t}createToastTitle(e){const t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t}createToastMessage(e){const t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t}constructor(e,t,n,o,r,i){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=i??!1,this.isRTL=o,this.elementsMargin=o?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(r),this.toastElement=this.createToastContainer(),this.setTitle(t),this.setMessage(n),e.appendChild(this.toastElement)}}class eB{static createInstance(e,t,n,o,r,i){return new ZO(e,t,n,o,r,i)}}function tB(e,t){return e?t(e)?e:tB(e.parentElement,t):null}var nB=n(582);let oB;class rB{static getInstance(){return oB||(oB=new rB),oB}showToast(e,t,n,o,r,i,l,s){if(!this.isToastVisible()||s){if(this.toast)this.toast.setIcon(o,r),this.toast.setTitle(e),this.toast.setMessage(t);else{const l=document.createElement("div");l.setAttribute("style",(e=>`position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ${e?"40px":"8px"};\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;`)(i)),document.body.appendChild(l),this.toast=eB.createInstance(l,e,t,n,o,r),requestAnimationFrame((()=>{l.style.opacity="1"}))}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,l),this.displayTime=window.performance.now()}}dismissToast(e){this.isToastVisible()&&(this.toast?.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,e),this.displayTime=void 0)}isToastVisible(){return(0,nB.isChangeGateEnabled)("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===document.getElementById(QO)?.style.visibility&&!tB(document.getElementById(QO),(e=>"none"===getComputedStyle(e).display)):this.isVisible||"visible"===document.getElementById(QO)?.style.visibility}logToastVisibilityChange(e,t){let n="Unavailability Toast Visibility Changed: "+(e?"Shown":"Dismissed");!e&&this.displayTime&&(n+=`, Duration Visible: ${Math.trunc(window.performance.now()-this.displayTime)}`),t&&(n+=`, Kind: ${t}`),Pn.sendTraceTag(537249949,En.msoulscat_Wac_Telemetry,d.Info,n)}constructor(){this.toast=void 0,this.isVisible=!1}}}();var r=window="undefined"==typeof window?{}:window;for(var i in o)r[i]=o[i];o.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/gridRenderer.min.js.map/3560d89d0d96ec7a3d7418f99cad6184/gridRenderer.min.js.map