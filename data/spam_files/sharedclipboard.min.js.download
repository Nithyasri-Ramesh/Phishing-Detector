var sharedClipboard;!function(){"use strict";var e={406:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.promises=function(){return void 0===r[i]&&(r[i]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),r[i]};const r={},i="promises"},392:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof crypto?crypto:"undefined"!=typeof msCrypto?msCrypto:void 0;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push(`crypto: ${JSON.stringify(e)}`)}}let i=!1;const o="undefined"!=typeof performance?performance:void 0;try{o&&o.now&&o.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push(`perfNow: ${JSON.stringify(e)}`)}for(let r=0;r<e.length;r+=1){try{if(i){t.perfNow=!0;let e=Math.floor(100*o.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}}catch(e){t.exceptions.push(`Math.random: ${JSON.stringify(e)}`)}e[r]=Math.floor(16*Math.random())}return t}(e);let r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const i=15&e[r];return r+=1,("x"===t?i:3&i|8).toString(16)})),t]}},516:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0,t.replaceChildren=e=>{if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)},t.isReplaceChildrenSupported=e=>!!e.replaceChildren},945:function(e,t,r){Object.defineProperty(t,"BJ",{value:!0}),t.RR=t.UX=t.Cr=t.Cy=t.TZ=t.we=t.nh=t.kp=t.Hv=t.Wp=t.WM=t.ke=t.bj=t.kA=void 0;const i=r(244);t.Wp=i;const o=r(793);Object.defineProperty(t,"Hv",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"kp",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"nh",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"Cy",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"Cr",{enumerable:!0,get:function(){return o.ConsoleLogger}});const n=r(406);t.we=n;const a=r(839);t.TZ=a;const s=r(882);Object.defineProperty(t,"UX",{enumerable:!0,get:function(){return s.initStopwatchFactory}});const l=r(987);Object.defineProperty(t,"RR",{enumerable:!0,get:function(){return l.TelemetryCollector}});var d=r(392);Object.defineProperty(t,"kA",{enumerable:!0,get:function(){return d.getNewGuid}});var c=r(603);Object.defineProperty(t,"bj",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"ke",{enumerable:!0,get:function(){return c.TextAreaInputMode}});var g=r(516);Object.defineProperty(t,"WM",{enumerable:!0,get:function(){return g.replaceChildren}})},793:function(e,t){var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(t.TraceLevel=r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(i||(t.LogCategory=i={})),t.ULS={getFromExternalLogger:function(e){const t=e;return{ULS:{trace:(e,r,i)=>t.traceTag(0,e,r,i),traceTag:(e,r,i,o)=>t.traceTag(e,r,i,o),debugTrace:(e,r,i)=>t.debugTraceTag(0,e,r,i),debugTraceTag:(e,r,i,o)=>t.debugTraceTag(e,r,i,o),assert:(e,r,i)=>t.assertTag(0,e,r,i),assertTag:(e,r,i,o)=>t.assertTag(e,r,i,o),shipAssert:(e,r,i)=>t.shipAssertTag(0,e,r,i),shipAssertTag:(e,r,i,o)=>t.shipAssertTag(e,r,i,o),dnmTrace:(e,r,i)=>t.dnmTraceTag(0,e,r,i),dnmTraceTag:(e,r,i,o)=>t.dnmTraceTag(e,r,i,o)}}}},t.ConsoleLogger=class{shipAssertTag(e,t,r,i){console.assert(r,"shipAssertTag:",e,t,i)}assertTag(e,t,r,i){console.assert(r,"assertTag",e,t,i)}traceTag(e,t,r,i){console.log("traceTag",e,i,t,r)}dnmTraceTag(e,t,r,i){console.log("dnmTraceTag",e,i,t,r)}debugTraceTag(e,t,r,i){console.log("debugTraceTag",e,i,t,r)}},t.NulLogger=class{shipAssertTag(){}assertTag(){}traceTag(){}debugTraceTag(){}dnmTraceTag(){}}},839:function(e,t){function r(){const e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function i(e,t,i){e[t]=r()-i}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){const t=r(),o=e,n=t,a={},s=(e,t,r)=>function(e,t,r,o,n,a){i(e,"end",r);const s={sessionName:t,result:o?"success":"failure",message:a,marks:e};n(JSON.stringify(s))}(a,o,n,e,t,r);return a.start=0,{mark:e=>(e=>i(a,e,n))(e),end:e=>s(!0,e),success:(e,t)=>s(!0,e,t),failure:(e,t)=>s(!1,e,t)}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=r},603:function(e,t){var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(r||(t.TextAreaVirtualKeyboardPolicy=r={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(i||(t.TextAreaInputMode=i={}))},882:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=function(e,t=1){return"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=()=>self.performance.now()),function(i){let o=r(),n=i;return{reset(e){null!=e&&(n=e),o=r()},stop(i){const a=r()-o,s=JSON.stringify({Target:n,Duration:a.toFixed(t),StopInfo:i});e(s)}}}};let r=()=>Date.now()},987:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0,t.TelemetryCollector=class{getJsonForLogging(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"}addEvent(e,t){null!=e&&null!=t&&(this.events[e]=t)}clearEvents(){this.events={}}getEventsLoggableString(){return JSON.stringify(this.events)}incrementCounter(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)}getCountersLoggableString(){return JSON.stringify(this.counters)}clearCounters(){this.counters={}}startTimer(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})}endTimer(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)}getTimerDuration(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"}getTimersLoggableString(){return JSON.stringify(this.timers)}constructor(){this.counters={},this.timers={},this.events={}}}},244:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultToJSONResultWhenStringifyFails=void 0,t.forEachPromise=function(e,t,r){return e.reduce(((e,i)=>e.then((()=>r&&r.stop?Promise.resolve(void 0):t(i,r)))),Promise.resolve(void 0))},t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(i(e))}catch{return t.defaultToJSONResultWhenStringifyFails}},t.getPerfWatchMarkName=function(e){if(!e)return"";let t=e.trim().substring(0,200).trim().replace(n,o).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===o&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===o&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error(`utils.retry: attempts expected to be greater than 0 but got ${t}`));let r=Promise.reject();for(let i=1;i<=t;i+=1)r=r.catch((t=>e(i,t)));return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();let r=t(e[0]);for(let i=1;i<e.length;i+=1){const o=e[i];r=r.catch((()=>t(o)))}return r},t.getQueryParameterByName=function(e,t){const r=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;let t=5381,r=t;const i=e.length;for(let o=0;o<i&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==i-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));let o=t+35685*r+(23896*r<<16)&4294967295;return o<0&&(o+=4294967296),o},t.defaultToJSONResultWhenStringifyFails="...";const r=5;function i(e,t=0){if(t<0||t>r)return e;if(null==e||"object"!=typeof e)return e;const o={};Object.getOwnPropertyNames(e).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(o[t]=e[t])}));const n=Object.getPrototypeOf(e);n&&"object"==typeof n&&Object.keys(n).forEach((t=>{"stack"!==t&&t.toUpperCase()!==t&&(o[t]=e[t])}));const a={};return Object.keys(o).forEach((e=>{a[e]=i(o[e],t+1)})),a}const o="_",n=new RegExp("\\W+","g")}},t={};function r(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};r.r(i),r.d(i,{ConsoleLogger:function(){return o.Cr},LogCategory:function(){return o.nh},NulLogger:function(){return o.Cy},TelemetryCollector:function(){return o.RR},TextAreaInputMode:function(){return o.ke},TextAreaVirtualKeyboardPolicy:function(){return o.bj},TraceLevel:function(){return o.kp},ULS:function(){return o.Hv},__esModule:function(){return o.BJ},browserSupport:function(){return o.we},getNewGuid:function(){return o.kA},initStopwatchFactory:function(){return o.UX},initialize:function(){return pt},perfWatch:function(){return o.TZ},replaceChildren:function(){return o.WM},utils:function(){return o.Wp}});var o=r(945);let n;function a(){return n}function s(e){if(!e)throw new Error("The 'logger' argument is missing");n=o.Hv.getFromExternalLogger(e)}const l="";var d,c,g,p,u,h,m;function f(e){if(e&&"object"==typeof e){if(S(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(S(JSON.parse(e.innerError).reason))return!0}catch{}}if("string"==typeof e)try{if(S(JSON.parse(e).reason))return!0}catch{}return!1}function S(e){return e===g.LocalStorageInitilizationInaccessible}(c=d||(d={}))[c.SystemClipboard=0]="SystemClipboard",c[c.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",c[c.InMemory=4]="InMemory",c[c.LocalStorage=5]="LocalStorage",c[c.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",c[c.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",c[c.AsyncSystemClipboard=8]="AsyncSystemClipboard",c[c.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage",c[c.AsyncSystemClipboardAndInMemory=10]="AsyncSystemClipboardAndInMemory",(p=g||(g={}))[p.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",p[p.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",p[p.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",p[p.SetClipboardItems=3]="SetClipboardItems",p[p.GetClipboardItems=5]="GetClipboardItems",p[p.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",p[p.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",p[p.ClearClipboardItems=9]="ClearClipboardItems",p[p.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",p[p.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",p[p.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",p[p.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",p[p.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",p[p.SelectClipboardStrategy=15]="SelectClipboardStrategy",p[p.IframeInitialization=16]="IframeInitialization",p[p.UnsupportedOperationCode=26]="UnsupportedOperationCode",p[p.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",p[p.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",p[p.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",p[p.IframeInitializationTimeout=30]="IframeInitializationTimeout",p[p.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",p[p.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",p[p.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",p[p.CreateWindowRPCServer=36]="CreateWindowRPCServer",p[p.RefreshMetadata=37]="RefreshMetadata",p[p.DeserializedMetadata=38]="DeserializedMetadata",p[p.SerializedMetadata=39]="SerializedMetadata",p[p.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",p[p.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",p[p.IframeProxyGeneralError=42]="IframeProxyGeneralError",p[p.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage",p[p.AsyncClipboardReadFailure=44]="AsyncClipboardReadFailure",p[p.AsyncClipboardWriteFailure=45]="AsyncClipboardWriteFailure",function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext",e[e.FailedToReadFromAsyncClipboard=16]="FailedToReadFromAsyncClipboard"}(h||(h={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(m||(m={}));class w extends Error{static augmentParameterValue(e){return e&&"string"==typeof e?e.trim():l}constructor(e,t,r){const i=w.augmentParameterValue(e);if(super(i),this.name=w.augmentParameterValue(t),this.errorName=this.name,this.name?a().ULS.traceTag(596456211,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Error '${this.name}': ${i}`):a().ULS.traceTag(596456212,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Error message: ${i}`),r){this.innerError=r;let e=this.innerError.message;e||(e=this.innerError.name);const t=w.augmentParameterValue(e);t.length>0&&a().ULS.traceTag(596456213,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Inner error message: ${t}`)}this.stack||(this.stack=(new Error).stack)}}class C extends w{constructor(e,t){super(e,"NoValidKeyError",t)}}class b extends w{static getDefaultMessage(e){let t="Missing argument";return e.length>0&&(t=`Missing argument: '${e}'`),t}constructor(e,t,r){const i=w.augmentParameterValue(t),o=b.getDefaultMessage(i);let n=w.augmentParameterValue(e);0===n.length&&(n=o),super(n,"MissingArgumentError",r),this.name=i}}class y extends w{static getDefaultMessage(e,t){return e.length>0?`Invalid '${e}' argument: '${t}'`:"Invalid argument"}constructor(e,t,r,i){const o=w.augmentParameterValue(t);let n=r;n||(n=l);const a=y.getDefaultMessage(o,n);let s=w.augmentParameterValue(e);0===e.length&&(s=a),super(s,"InvalidArgumentError",i),this.name=o,this.value=n}}class E extends w{constructor(e,t){super(e,"InvalidOperationError",t)}}class T extends w{constructor(e,t,r,i,o){super(t||`reason=${e}`,r,i),this.reason=e,o&&(this.errorName=o)}}class I extends T{constructor(e,t,r){var i,o;super(e,t,"ClipboardPlatformError",r,function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(i=e,o=g)?o[i]:l)}}new RegExp("(\\bTrident/| MSIE )");const v=(e,t,r,i)=>{e.postMessage(t,r,i)},P="text/plain",A=function(){const e={items:{}};return{getData:()=>e,getItem:e=>{},setItem:(e,t)=>{throw new E(`Cannot set an item with clipboard data format '${e}' in an immutable empty clipboard (content is ${t&&t.length>0?"not ":l}empty)`)},setDeferredItem:(e,t)=>{throw new E(`Cannot set a deferred item with clipboard data format '${e}' in an immutable empty clipboard`)},hasDeferredItem:e=>!1,getDeferredItem:e=>{},get:()=>k(void 0)}}();function L(){return A}function M(e){return e&&e.items?Object.keys(e.items).length:0}function _(e){return M(e&&e.getData())}function W(e=void 0){let t=e;t||(t={items:{}});const r={getItem:e=>function(e,t){if(!e)throw new b(l,"clipboardItemsData");if(!e.items)throw new y(l,"clipboardItemsData.items");const r=e.items[t];if(!(r&&r instanceof Promise))return r}(t,e),setItem:(e,r)=>{x(t,e,r)},setDeferredItem:(e,r)=>{x(t,e,r)},hasDeferredItem:e=>{if(!t||!t.items)return!1;const r=t.items[e];return!!r&&r instanceof Promise},getDeferredItem:e=>function(e,t){if(!e)throw new b(l,"clipboardItemsData");if(!e.items)throw new y(l,"clipboardItemsData.items");const r=e.items[t];return!r||r instanceof Promise?r:Promise.resolve(new Blob([r],{type:P}))}(t,e),getData:()=>t,get:()=>k(t)};return r}function x(e,t,r){if(!e)throw new b(l,"clipboardItemsData");if(!e.items)throw new y(l,"clipboardItemsData.items");e.items[t]=r}function k(e){const t=[];if(0===M(e))return t;for(const r in e.items){let i=e.items[r];i||(i=l);const o={clipboardDataFormat:r,data:i,deferred:i instanceof Promise};t.push(o)}return t}var O,$,R;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(O||(O={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.Copilot=8192]="Copilot",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths",e[e.PasteWithCopilot=8196]="PasteWithCopilot"}($||($={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(R||(R={}));const D="BulsEndpointUrl",U="usid",F="-",J="sharedClipboardSettings",H=1,N=3600,z=2;let j=q(),V=!1;function B(){if(!V)throw new E("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return j}function K(){V=!1,function(){if(!window||!(J in window))return j=q(),void(V=!0);const e=window[J];if(!e||"object"!=typeof e)return j=q(),void(V=!0);!function(e){if(!e)throw new b(l,"sharedClipboardSettingsCandidate");const t=q();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return j=t,void(V=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return a().ULS.traceTag(596124181,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),j=t,void(V=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();let r=t.sharedClipboardHostingApp;const i=r.indexOf(F);i>=0&&(r=r.substr(i+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch{a().ULS.traceTag(579737680,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((e=>!e||!e.trim())))return a().ULS.traceTag(596124182,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],j=t,void(V=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch{a().ULS.traceTag(579737681,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((e=>!e||!e.trim())))return a().ULS.traceTag(596124183,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],j=t,void(V=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return a().ULS.traceTag(596124184,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],j=t,void(V=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return a().ULS.traceTag(596124185,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '${t.sharedClipboardHostingApp}' or '${r}' should be listed in sharedClipboardHostingApps`),t.sharedClipboardHostingApp=l,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],j=t,void(V=!0)}t.whitelistOriginComponents=!0,j=t,V=!0}(e)}()}function q(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:l,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:H,sharedClipboardExpirationInMinutes:N,clipboardPromiseTimeoutInMinutes:z,remoteLoggerPath:l}}const G="://",X="http",Q="https",Z=".",Y="/",ee=":",te=new RegExp("^\\d+$");let re,ie,oe=!1;function ne(e){if(!e)throw new b(l,"origin");const t=e.trim().toLowerCase();let r=l,i=t.split(G,3);if(!i||0===i.length||!i[0]||i[0]!==X&&i[0]!==Q)throw new y("Missing protocol","origin",e);if(1===i.length)throw new y("Missing domain","origin",e);if(i.length>2)throw new y(`'${G}' should appear once`,"origin",e);let n=i[1];if(!n)throw new y("Missing domain","origin",e);if(r=i[0]+G,n=n.trim(),i=n.trim().split(Y,3),!i||0===i.length||!i[0]||!i[0].trim())throw new y("Missing domain","origin",e);if(i.length>2)throw new y("The last part of the origin should be the domain","origin",e);if(2===i.length&&i[1])throw new y("The last part of the origin should be the domain","origin",e);if(i=n.split(ee,3),!i||0===i.length||!i[0]||!i[0].trim())throw new y("Missing domain","origin",e);if(i.length>2||2===i.length&&(!i[1]||!i[1].trim()))throw new y("The last part of the origin should be the domain and an optional port number","origin",e);if(n=i[0].trim(),r+=n,2===i.length){const t=i[1].trim(),o=te.exec(t);if(!o||1!==o.length)throw new y("Invalid port number","origin",e);const n=Number(t);if(isNaN(n))throw new y("Invalid port number","origin",e);r+=ee+t}return a().ULS.traceTag(596452423,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`getValidatedOrigin: origin = '${e}'; validated origin = '${r}'`),r}function ae(e){ce();const t=ne(e),r=ne(function(){let e=l;return window&&window.location&&window.location.origin?(e=window.location.origin,e||(e=l)):(a().ULS.traceTag(595932950,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`windowLocation.getWindowLocation: is window exist: ${!!window}. is window.location exist: ${window&&!!window.location}. is window.location.origin exist ${window&&window.location&&!!window.location.origin}. is window.location.protocol exist ${window&&window.location&&!!window.location.protocol}. is window.location.hostname exist ${window&&window.location&&!!window.location.hostname}. is window.location.port exist ${window&&window.location&&!!window.location.port}`),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}().origin);if(t===r)return t;if(!B().whitelistOriginComponents)throw new E(`validateOriginForReceivedMessage: Caller origin '${e}' doesn't match the current window's origin '${r}'`);const i=se(t),n=se(r);if(i.protocol!==n.protocol)throw new E(`validateRemoteWindowOrigin: Caller origin's protocol '${i.protocol}' doesn't match the current window origin's protocol '${n.protocol}'`);if(i.environment!==n.environment)throw new E(`validateRemoteWindowOrigin: Caller origin's environment '${i.environment}' doesn't match the current window origin's environment '${n.environment}'`);return t}function se(e){ce();const t=e.split(G,2),r=t[0],i=le(t[1]),o={protocol:r};if(o.environment=de(e,i,ie),i.length<=o.environment.length+1)throw new y("Missing app component","origin",e);if(i.charAt(o.environment.length)!==Z)throw new y("Missing a domain separator after the environment component","origin",e);const n=i.substr(o.environment.length+Z.length);if(o.app=de(e,n,re),o.app.length<n.length&&n.charAt(o.app.length)!==F)throw new y(`When the Office Online app name is not the domain prefix, '${F}' should precede it`,"origin",e);return o}function le(e){if(!e)throw new b(l,"stringToReverse");const t=e.length;let r=l;for(let i=t-1;i>=0;i-=1)r+=e.charAt(i);return r}function de(e,t,r){if(!t)throw new b(l,"reversedValidatedHostname");if(!r)throw new b(l,"reversedStringsToLengthMap");const i=t.length,o=Object.keys(r).filter((e=>{const o=r[e];return o<=i&&t.substr(0,o)===e}));if(o&&o.length>0)return le(o[0]);throw new y("Invalid origin","validatedOrigin",e)}function ce(){if(oe)return;const e=B();e.whitelistOriginComponents&&(re=ge(e.sharedClipboardHostingApps),ie=ge(e.sharedClipboardHostingEnvironments),oe=!0)}function ge(e){const t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((e=>{t[le(e)]=e.length})),t):t}function pe(){return(Math.random()+1).toString(36).substring(7)}class ue{}function he(e){return"get"===e||"set"===e||"init"===e}ue.localStorageData="localStorage/data",ue.localStorageMetadata="localStorage/metadata",ue.initIframe="initIframe";const me=function(e){if(!e)throw new b(l,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new b(l,"id");if(!e.operationCode)throw new b(l,"operationCode");if(!e.destination)throw new b(l,"destination");if(!he(e.operationCode))throw new y(l,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new y(`'${e.operationCode}' expects no clipboard items`,"clipboardItemsData")};function fe(e,t,r,i,o){const n={id:e,operationCode:t,failed:r,error:i,clipboardItemsData:o};return Se(n),n}const Se=function(e){if(!e)throw new b(l,"clipboardOperationResultMessage");const t=["failed","error","clipboardItemsData","operationCode","id","userHash"];let r=!1;for(const i of t)if(e.hasOwnProperty(i)){r=!0;break}if(!r)throw new C("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw a().ULS.traceTag(553747865,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Missing argument 'id'. keys: ${JSON.stringify(Object.keys(e))}, isConstructorObject: ${e.constructor===Object}, operationCode: ${e.operationCode}, id: ${e.id}, failed: ${e.failed}, error: ${e.error}.`),new b(l,"id");if(!e.operationCode)throw new b(l,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new y(l,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new y(`A failed '${e.operationCode}' operation expects a non-empty error argument`,"error");if(e.clipboardItemsData)throw new y(`A failed '${e.operationCode}' operation does not expect a clipboardItemsData argument`,"clipboardItemsData")}else{if(e.error)throw new y(`'${e.operationCode}' expects an empty error argument`,"error");if("unknownresult"===e.operationCode)throw new y(`'${e.operationCode}' can only be used with a failure message`,"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new y(`'${e.operationCode}' expects a clipboardItems argument`,"clipboardItemsData")}else if(e.clipboardItemsData)throw new y(`'${e.operationCode}' expects no clipboardItemsData argument`,"clipboardItemsData")};function we(e){if(!e||0===e.trim().length)throw new y(l,"className",e);return(()=>{let t=!1;function r(t){return`${e}:${t}: already disposed`}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&a().ULS.traceTag(596456217,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new E(r(e))}}})()}class Ce{initialize(e){return e.then((e=>(this.clipboardStorage=e,a().ULS.traceTag(596453007,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Clipboard strategy type '${this.clipboardStrategyType}' was initialized.`),Promise.resolve(this))),(e=>(a().ULS.traceTag(596453008,o.nh.msoulscat_ES_EWAJS,f(e)?o.kp.Info:o.kp.Error,`Failed to initialize clipboard strategy type '${this.clipboardStrategyType}'. Error: ${o.Wp.getStringifiedError(e)}`),Promise.reject(e))))}set(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){const e="ClipboardStrategyBase.set: this.clipboardStorage should be defined";return a().ULS.shipAssertTag(596121485,o.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new I(g.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new I(g.SetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).set`,e))}}get(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){const e="ClipboardStrategyBase.get: this.clipboardStorage should be defined";return a().ULS.shipAssertTag(596121486,o.nh.msoulscat_ES_EWAJS,!1,e),Promise.reject(new I(g.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((e=>(this.clipboardDataProcessor&&this.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)))).catch((t=>{throw a().ULS.traceTag(507848131,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ${e.id}, Error: ${o.Wp.getStringifiedError(t)}`),t}))}catch(e){return Promise.reject(new I(g.GetClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).get`,e))}}onSystemClipboardChangedExternally(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(L(),e):(a().ULS.shipAssertTag(595882508,o.nh.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new I(g.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new I(g.ClearClipboardItems,`Failed in (clipboard ${this.clipboardStrategyType}).onSystemClipboardChangedExternally`,e))}}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())}constructor(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=we(`${e}`)}}const be=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function ye(e){let t=e;return t&&0!==t.trim().length||(t=pe()),new ve(t)}function Ee(){return be?window.performance.now():Date.now()}function Te(e){return be?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Ie(e,t,r){if(!r)throw new b(l,"creationTimestamp");return`${e?"Fulfilled":"Still unfulfilled"} after ${e?t?t-r:"?":Ee()-r}ms`}class ve{fulfilled(){return this.isFulfilled}resolve(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):a().ULS.traceTag(596456257,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Deferred promise - resolve: the resolve for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}reject(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):a().ULS.traceTag(596456260,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Deferred promise - reject: the reject for deferred promise #${this.sequenceId} with id '${this.id}' is not tracked with a callback`)}markAsFulfilled(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Ee(),a().ULS.traceTag(596456261,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: marking promise #${this.sequenceId} with id '${this.id}' as fulfilled (${this.rejected?"rejected":"resolved"}). ${Ie(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`))}fulfillmentCheck(e){return a().ULS.traceTag(596456258,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: asked to ${e} deferred promise #${this.sequenceId} with id '${this.id}'`),this.isFulfilled&&a().ULS.traceTag(596456259,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`Deferred promise: cannot ${e} deferred promise #${this.sequenceId} with id '${this.id}' since it was ${this.rejected?"rejected":"resolved"} already on ${Te(this.fulfillmentTimestamp)}. ${Ie(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)}`),this.isFulfilled}constructor(e){this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=function(e){if(!e)throw new b(l,"id");const t=e.trim().toLowerCase();if(0===t.length)throw new y(l,"id");return t}(e),ve.sequenceId+=1,this.sequenceId=ve.sequenceId,this.creationTimestamp=Ee(),a().ULS.traceTag(596456225,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: creating deferred promise #${this.sequenceId} with id '${this.id}' on ${Te(this.creationTimestamp)}`),this.promise=new Promise(((e,t)=>{a().ULS.traceTag(596456226,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Deferred promise: registering callback for promise #${this.sequenceId} with id '${this.id}' on ${Te(Ee())}`),this.internalResolve=e,this.internalReject=t}))}}ve.sequenceId=0;const Pe="initmessageid",Ae="unknownmessageid",Le="CreatorOrigin";function Me(e){if(!e)throw new b(l,"remoteWindow");if(!("window"in e)||!e.window)throw new b(l,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new b(l,"remoteWindow.windowOrigin");const t=ae(e.windowOrigin);return{window:e.window,windowOrigin:t}}class _e{get disposableImplementationExtension(){return this._disposableImplementationExtension}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(function(e){if(!e||!Array.isArray(e)||0===e.length)return void a().ULS.traceTag(596456214,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,"rethrowAfterAllActions: no actions to execute");let t,r=0;if(e.forEach((e=>{if(r+=1,e)try{e()}catch(e){a().ULS.traceTag(596456216,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`rethrowAfterAllActions: callback action #${r} threw an exception: ${e.message}`),t||(t=new E(e.message,e))}else a().ULS.traceTag(596456215,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,`rethrowAfterAllActions: callback action #${r} is empty`)})),t)throw t}([()=>{this.sender&&this.sender.dispose()},()=>{this.receiver&&this.receiver.dispose()}]),this.disposableImplementationExtension.dispose())}postMessage(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new b(l,"outgoingMessage");if(!this.sender){const e="WindowRPCBase::postMessage - this.sender should be defined";throw a().ULS.shipAssertTag(596121484,o.nh.msoulscat_ES_EWAJS,!1,e),new E(e)}this.sender.postMessage(e)}constructor(e,t,r,i){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=we(i)}}function We(){return xe}const xe={addEventListener:(e,t)=>window.addEventListener(e,t),removeEventListener:(e,t)=>window.removeEventListener(e,t)},ke="message";class Oe{dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||(We().removeEventListener(ke,this.windowMessageHandler),this.disposableImplementationExtension.dispose())}shouldFilterMessageEvent(e){try{if(!e.origin||!e.source)return a().ULS.traceTag(596452370,o.nh.msoulscat_ES_EWAJS,o.kp.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return a().ULS.traceTag(596452371,o.nh.msoulscat_ES_EWAJS,o.kp.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return a().ULS.traceTag(596452372,o.nh.msoulscat_ES_EWAJS,o.kp.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return a().ULS.traceTag(596452373,o.nh.msoulscat_ES_EWAJS,o.kp.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1}onMessageReceived(e){if(this.shouldFilterMessageEvent(e))return;let t;try{t=this.deserializer.deserialize(e.data)}catch(e){a().ULS.traceTag(596452374,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Window RPC Receiver: unable to deserialize incoming message. ${o.Wp.getStringifiedError(e)}`);try{this.handler.handleDeserializationError(e)}catch(e){a().ULS.traceTag(596452184,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`Window RPC Receiver: unable to handle deserialization error. ${o.Wp.getStringifiedError(e)}`)}return}if(t)try{this.handler.handleMessage(t).catch((e=>{a().ULS.traceTag(595985880,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`Window RPC Receiver: unable to process incoming message. ${o.Wp.getStringifiedError(e)}`)}))}catch(e){a().ULS.traceTag(596452186,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`Window RPC Receiver: unable to process incoming message. ${o.Wp.getStringifiedError(e)}`)}else a().ULS.traceTag(596452185,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"Window RPC Receiver: the incoming message is empty")}constructor(e,t,r){if(this.deserializer=e,this.handler=t,this.windowMessageHandler=e=>this.onMessageReceived(e),!e)throw new b(l,"deserializer");if(!t)throw new b(l,"handler");if(!r)throw new b(l,"windowRPC");this.disposableImplementationExtension=we("WindowRPCReceiverInternal"),this.remoteWindow=Me(r.remoteWindow),We().addEventListener(ke,this.windowMessageHandler)}}class $e{postMessage(e){if(!e)throw new b(l,"outgoingMessage");if(!this.remoteWindow.window)throw new E("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new E("The remote window does not support postMessage");const t=this.serializer.serialize(e);v(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e,t,r=!1){if(this.serializer=e,this.delayedQueueEnabled=r,!e)throw new b(l,"serializer");if(!t)throw new b(l,"windowRPC");this.disposableImplementationExtension=we("WindowRPCSenderInternal"),this.remoteWindow=Me(t.remoteWindow)}}const Re="OfficeOnlineCCP_",De=Re+"Metadata_",Ue=Re+"Data_",Fe="_LocalStorageChangedFlag";function Je(e){return De+e}var He;!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(He||(He={}));class Ne{get(e){this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(595716238,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`localStorageClipboardStorage.get: commandParameters.id='${e?e.id:l}'`);const t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(L());try{const e=JSON.parse(t);if(!e||0===M(e))return Promise.resolve(L());const r=W(e);return Promise.resolve(r)}catch(e){return Promise.resolve(L())}}set(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(595716239,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`localStorageClipboardStorage.set: item count=${_(e)}'; commandParameters.id='${t?t.id:l}'`),0===_(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));const r=`${this.localStorageKey+Fe}`,i=pe();return a().ULS.traceTag(595654546,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`localStorageClipboardStorage.set: set local storage value. eventFalgKey = ${r}. eventFlagValue = ${i}`),localStorage.setItem(r,i),Promise.resolve()}getSupportedDataFormats(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[P,"text/html","data/shadow-workbook"]}dispose(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()}constructor(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new I(g.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new I(g.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=O.LocalStorage,this.disposableImplementationExtension=we("LocalStorageClipboardStorage")}}function ze(e){return a().ULS.traceTag(595716236,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Attempting to create clipboard strategy type '${d.LocalStorage}' with localStorageKey: '${e}'`),(new je).initialize(function(e){try{a().ULS.traceTag(595716237,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`Attempting to create clipboard storage type '${O.LocalStorage}'`);const t=new Ne(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}class je extends Ce{constructor(e){super(d.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},e)}}class Ve{onStorageChanged(e){a().ULS.shipAssertTag(595716249,o.nh.msoulscat_ES_EWAJS,null!=e,"e should not be null"),a().ULS.traceTag(595716288,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ${e.key}. localStorageKeyToWatch = ${this.localStorageKeyToWatch}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),a().ULS.traceTag(595716289,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((()=>{this.raiseMetadataChangedEvent()}),(()=>{a().ULS.traceTag(595716295,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))}raiseMetadataChangedEvent(){return a().ULS.traceTag(595715525,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.clipboardStrategy.get({userHash:0}).then((e=>{this.listener(e),a().ULS.traceTag(595716232,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ${this.lastLocalStorageValue}`)}),(e=>{a().ULS.traceTag(595716233,o.nh.msoulscat_ES_EWAJS,o.kp.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))}isLocalStorageValueChanged(){const e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return a().ULS.traceTag(595715526,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ${this.lastLocalStorageValue}. currentLocalStorageValue = ${e}`),this.lastLocalStorageValue=e,t}waitForLocalStorageValueToChange(e){if(a().ULS.traceTag(595715527,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged())return a().ULS.traceTag(595715528,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ${this.lastLocalStorageValue}`),Promise.resolve();const t=ye(),r=new Date,i=setInterval((()=>{const n=(new Date).getTime()-r.getTime();a().ULS.traceTag(595715529,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),this.isLocalStorageValueChanged()?(clearInterval(i),a().ULS.traceTag(595716234,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.resolve()):n>e&&(clearInterval(i),a().ULS.traceTag(595716235,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ${r}. elapseTime = ${n}. lastLocalStorageValue = ${this.lastLocalStorageValue}`),t.reject())}),200);return t.promise}constructor(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}}new RegExp("(\n\r)|(\r\n)|(\r)","g"),new RegExp("(\t)","g");var Be,Ke=r(793);!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(Be||(Be={}));const qe=1e3;var Ge,Xe;(Xe=Ge||(Ge={}))[Xe.Error=10]="Error",Xe[Xe.Warning=15]="Warning",Xe[Xe.Important=20]="Important",Xe[Xe.Info=50]="Info",Xe[Xe.Verbose=100]="Verbose",Xe[Xe.Spam=200]="Spam";class Qe{handleTrace(e){e.message.length>Qe.messageMaxChars&&(e.message=e.message.substr(0,Qe.messageMaxChars-Qe.trimmedMessage.length)+Qe.trimmedMessage),this.logCache.push(e),(this.logCache.length>Qe.uploadTriggerSize||e.level===Ge.Error)&&this.triggerUploadAsync()}constructor(e,t,r){this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=()=>{this.triggerUpload(!1,!1)},this.flush=()=>{this.triggerUploadAsync()},this.triggerUploadAsync=()=>{window.setTimeout((()=>this.triggerUpload(!0,!0)),0)},this.triggerUpload=(e,t)=>{window.clearTimeout(this.timeoutId),this.logCache.length>0&&(this.uploadId+=1,function(e,t,r){if(!t)return;const i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(t,e)}catch{}!function(e,t,r){const i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,r),i.send(e))}(e,t,r)}(function(e,t,r,i){const o=[],n=e.map((e=>function(e,t,r){const i={};if(i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category,e.correlationId){let t=r.findIndex((t=>t===e.correlationId));t<0&&(t=r.push(e.correlationId)-1),i.I=t}const o=e.type*qe+e.level;return i.D=o,i}(e,i,o))),a=function(e,t,r,i,o){const n={};return n.T=e,n.L=t,n.S=r,n.I=i,o&&o.length>0&&(n.W=o),n.V=1,n}(i,n,t,r,o);return JSON.stringify(a)}(this.logCache,this.userSessionId,this.uploadId,this.timestampBase),this.remoteUrlEndpoint,t),this.logCache=[],this.timestampBase=Date.now()),e&&(this.timeoutId=window.setTimeout(this.triggerUploadAsync,Qe.uploadCadenceInMsSec))},this.userSessionId=e;let i=t+"?usid="+e;void 0!==r&&r.forEach(((e,t)=>{i+="&"+t+"="+e})),this.remoteUrlEndpoint=i,window.setTimeout((()=>this.triggerUpload(!0,!0)),0)}}function Ze(e,t,r,i,o,n){if(i>Ge.Info)return;const a={timestamp:Date.now(),category:r,tag:t,level:i,type:Be.Trace,message:o,correlationId:n};e.handleTrace(a)}Qe.messageMaxChars=3072,Qe.uploadCadenceInMsSec=3e4,Qe.uploadTriggerSize=30,Qe.trimmedMessage="... [Trimmed]";class Ye{handleMessage(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):tt(t,new I(g.UnsupportedOperationCode,`Operation code '${e?e.operationCode:"incomingMessage is null"}' is unsupported`))}addMessageHandler(e,t){e?e in this._handlers?a().ULS.shipAssertTag(595944464,o.nh.msoulscat_ES_EWAJS,!1,`BaseMessageHandler.addMessageHandler: handle for operation: ${e} already exist`):this._handlers[e]=t:a().ULS.shipAssertTag(595944463,o.nh.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")}constructor(){this._handlers={}}}class et extends Ye{get(e,t){const r={userHash:e.userHash};return this.clipboardStrategy.get(r).then((e=>(t.clipboardItemsData=e.getData(),Promise.resolve(t))),(e=>tt(t,e)))}set(e,t){const r={userHash:e.userHash};let i;return e.clipboardItemsData&&(i=e.clipboardItemsData),this.clipboardStrategy.set(W(i),r).then((()=>Promise.resolve(t)),(e=>tt(t,e)))}constructor(e){super(),this.clipboardStrategy=e,this.nameForTelemetry=`ClipboardStrategyMessageHandler_StrategyType_${e.clipboardStrategyType}`,this.addMessageHandler("get",{handleMessage:this.get.bind(this)}),this.addMessageHandler("set",{handleMessage:this.set.bind(this)})}}function tt(e,t){return rt(e,t),Promise.resolve(e)}function rt(e,t){e.failed=!0,e.error=o.Wp.getStringifiedError(t)}class it extends _e{handleMessage(e){if(a().ULS.traceTag(596452360,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`RPC Server - handleMessage: incomingMessage.id='${e&&e.id}'; incomingMessage.operationCode='${e&&e.operationCode}'; incomingMessage.clipboardItems.length=${M(e&&e.clipboardItemsData)}`),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return a().ULS.traceTag(596129562,o.nh.msoulscat_ES_EWAJS,o.kp.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();const t=e&&e.id?e.id:Ae,r=!e||!e.operationCode||!he(e.operationCode),i={id:t,failed:r,error:void 0,operationCode:r?"unknownresult":`${e.operationCode}result`};return this.routeOperation(e,i).then((e=>this.postMessage(e))).catch((e=>(a().ULS.traceTag(596452182,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`RPC Server - handleMessage: unable to send result message. Sending a failure message. ${o.Wp.getStringifiedError(e)}`),i.clipboardItemsData=void 0,rt(i,e),this.postMessage(i)))).catch((e=>(a().ULS.traceTag(596452183,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`RPC Server - handleMessage: unable to send failure result message. ${o.Wp.getStringifiedError(e)}`),Promise.reject(e))))}routeOperation(e,t){if(this.windowRPCServerState.isInitializationPending())return tt(t,new I(g.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return tt(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);const r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):tt(t,new I(g.SelectClipboardStrategy,"messageHandler does not exist"))}handleDeserializationError(e){return this.postMessage({id:Ae,failed:!0,error:o.Wp.getStringifiedError(e),operationCode:"unknownresult"}).catch((e=>{a().ULS.traceTag(596451867,o.nh.msoulscat_ES_EWAJS,o.kp.Error,`RPC Server - handleDeserializationError: unable to send failure result message. ${o.Wp.getStringifiedError(e)}`)}))}postMessage(e){try{return super.postMessage(e),Promise.resolve()}catch(t){return Promise.reject(new E(`Unable to post message for operation '${e&&e.operationCode?e.operationCode:l}'`,t))}}constructor(e,t,r,i){if(super(t,e,r,"WindowRPCServerInternal"),this.windowRPCServerState=i,!i)throw new I(g.CreateWindowRPCServer,"windowRPCServerState is undefined.");this.receiver=function(e,t,r){return new Oe(e,t,r)}(e,this,this),this.sender=function(e,t){return new $e(e,t)}(t,this)}}class ot{sendMessage(e){if(this.windowRPCServer){const t=fe(pe(),this.operationCode,!1,void 0,e);this.windowRPCServer.postMessage(t)}}constructor(e,t){this.windowRPCServer=e,this.operationCode=t}}class nt extends ot{raiseMetadataChangedEvent(e){this.sendMessage(e.getData())}constructor(e,t,r){super(r,"getMetadata_longPollingresult"),this.localStorageKeyChangeTracker=new Ve(t,e,this.raiseMetadataChangedEvent.bind(this))}}function at(e,t){if(!t)return Promise.resolve(!1);const r=function(e,t){try{const r=window.parent,i=e;if(!i)throw new b("remoteWindowOrigin is undefined","remoteWindowOrigin");return new it(function(e){if(!e)throw new b(l,"validator");return{deserialize:t=>function(e,t){if(!e)throw new b(l,"incomingMessage");if(!t)throw new b(l,"validator");if(0===e.length)throw new y("An empty message is invalid","incomingMessage");const r=e.trim();if(0===r.length)throw new y("A message cannot contain only spaces","incomingMessage");let i;try{i=JSON.parse(r)}catch(t){throw new y("Deserialization failed","incomingMessage",`Contains ${e.length.toString()} characters`,t)}if(!i)throw new y("Deserialization returned nothing","incomingMessage");return t(i),i}(t,e)}}(me),function(e){if(!e)throw new b(l,"validator");return{serialize:t=>function(e,t){if(!e)throw new b(l,"outgoingMessage");if(!t)throw new b(l,"validator");return t(e),function(e){let t;try{t=JSON.stringify(e)}catch(t){throw new y("Serialization failed","outgoingMessage",`${Object.keys(e).length} properties`,t)}return a().ULS.traceTag(596452375,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`The length of the serialized message is ${t.length}`),t}(e)}(t,e)}}(Se),{window:r,windowOrigin:i},t)}catch(e){return void a().ULS.shipAssertTag(595981475,o.nh.msoulscat_ES_EWAJS,!1,`createWindowRPCServer failed with exception: ${o.Wp.getStringifiedError(e)}`)}}(e,st);if(!r)return a().ULS.traceTag(595947554,o.nh.msoulscat_ES_EWAJS,o.kp.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);const i=ye(Pe);return lt={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:i,windowRPCServer:r},lt.initializationDeferredPromise.promise.then((()=>function(){const e=ct();if(a().ULS.shipAssertTag(595947555,o.nh.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new E("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));const t=fe(gt(),"initresult",!1);return e.postMessage(t)}()),(e=>function(e){const t=ct();if(a().ULS.shipAssertTag(595947584,o.nh.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new E("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));const r=fe(gt(),"initresult",!0,o.Wp.getStringifiedError(e));return t.postMessage(r)}(e))).catch((()=>{})),t.then((e=>(lt&&(lt.metadataDataChangedMessageSender=new nt(e.metadataClipboardStrategy,e.localStorageMetadataKeyToWatch,r)),function(e){const t=Object.keys(e).map((t=>`Name: ${t}, handlerName: ${e[t]&&e[t].nameForTelemetry}`)).join(", ");a().ULS.traceTag(595947585,o.nh.msoulscat_ES_EWAJS,o.kp.Info,`markInitializationSuccess: Created and initialized ClipboardStrategies '${t}'`),a().ULS.shipAssertTag(595947586,o.nh.msoulscat_ES_EWAJS,!!lt,"markInitializationSuccess: windowRPCServerInternalState must be defined"),lt&&(lt.clipboardOperationMessageHandlerMap=e,lt.clipboardInitError=void 0,lt.clipboardInitTimestamp=Date.now(),lt.initializationDeferredPromise&&lt.initializationDeferredPromise.resolve())}(e.messageHandlers),Promise.resolve(!0))),(e=>(function(e){a().ULS.traceTag(595947587,o.nh.msoulscat_ES_EWAJS,f(e)?o.kp.Info:o.kp.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),a().ULS.shipAssertTag(595947588,o.nh.msoulscat_ES_EWAJS,!!lt,"markInitializationFailure: windowRPCServerInternalState must be defined"),lt&&(lt.clipboardOperationMessageHandlerMap=void 0,lt.clipboardInitError=e,lt.clipboardInitTimestamp=Date.now(),lt.initializationDeferredPromise&&lt.initializationDeferredPromise.reject(lt.clipboardInitError))}(e),Promise.resolve(!1))))}const st={getMessageHandler:function(e){if(lt)if(e)if(lt.clipboardOperationMessageHandlerMap){if(e in lt.clipboardOperationMessageHandlerMap)return lt.clipboardOperationMessageHandlerMap[e];a().ULS.shipAssertTag(595945237,o.nh.msoulscat_ES_EWAJS,!1,`getMessageHandler: ${e} is not part of ClipboardStrategyMap`)}else a().ULS.shipAssertTag(595945236,o.nh.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");else a().ULS.shipAssertTag(595945235,o.nh.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined")},isInitializationPending:dt,isInitializedSuccessfully:function(){return!!lt&&(!dt()&&!!lt.clipboardOperationMessageHandlerMap)},getClipboardInitError:function(){if(lt)return lt.clipboardInitError}};let lt;function dt(){return!lt||!lt.initializationDeferredPromise||!lt.initializationDeferredPromise.fulfilled()}function ct(){if(lt)return lt.windowRPCServer}function gt(){if(!lt)return l;const e=lt.initMessageIdUniqueRunningSuffix;return lt.initMessageIdUniqueRunningSuffix+=1,`${Pe}${e}`}function pt(){s(new Ke.ConsoleLogger),K();let e=o.Wp.getQueryParameterByName(window.location.href,Le)||"";if(!e)throw new b("remoteWindowOrigin is undefined","remoteWindowOrigin");e=ae(e);try{const t=o.Wp.getQueryParameterByName(window.location.href,U)||"";let r=o.Wp.getQueryParameterByName(window.location.href,D)||"";if(!r){const i=B().remoteLoggerPath;i&&t&&(r=`${e}${i}`)}r&&s(function(e,t){const r=function(e,t){const r=new Qe(e,t);return{sendTraceTag:(e,t,i,o)=>Ze(r,e,t,i,o,""),shipAssertTag:(e,t,i,o)=>{i&&Ze(r,e,t,Ge.Error,o,"")},debugAssertTag:()=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose,setCorrelationId:()=>{}}}(t,e);return{assertTag:(e,t,i,o)=>r.shipAssertTag(e,t,!i,o),shipAssertTag:(e,t,i,o)=>r.shipAssertTag(e,t,!i,o),debugTraceTag:r.sendTraceTag,traceTag:r.sendTraceTag}}(r,t))}catch{}const t=B().sharedClipboardSchemaVersion,r=function(e){return Ue+e}(t),i=ze(r).then((e=>{const r=Je(t),i=function(e){return Je(e)+Fe}(t);return ze(r).then((t=>{const r={};return r[ue.localStorageData]=new et(e),r[ue.localStorageMetadata]=new et(t),{messageHandlers:r,localStorageMetadataKeyToWatch:i,dataClipboardStrategy:e,metadataClipboardStrategy:t}}))}));return at(e,i)}sharedClipboard=i}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/sharedClipboard.min.js.map/231e4ae596e7126bf4441196550f8f38/sharedClipboard.min.js.map